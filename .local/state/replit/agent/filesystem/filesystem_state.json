{"file_contents":{"client/src/context/SiteContext.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode, useCallback } from \"react\";\nimport { api } from \"@/lib/api\";\n\nexport interface SiteSettings {\n  siteTitle: string;\n  tagline: string;\n  maintenanceMode: boolean;\n  maintenanceTitle?: string;\n  maintenanceMessage?: string;\n  maintenanceEstimate?: string;\n  heroTitle: string;\n  heroSubtitle: string;\n  heroCTA: string;\n  cvFileUrl: string;\n  aboutTitle: string;\n  aboutSubtitle: string;\n  aboutDescription: string;\n  aboutDescription2: string;\n  aboutImage: string;\n  aboutName: string;\n  aboutLocation: string;\n  aboutFreelance: string;\n  contactEmail: string;\n  contactTitle: string;\n  contactSubtitle: string;\n  contactPhone: string;\n  contactAddress: string;\n  socialFacebook: string;\n  socialTwitter: string;\n  socialInstagram: string;\n  socialLinkedin: string;\n  socialGithub: string;\n  socialYoutube: string;\n  footerText: string;\n  footerCopyright: string;\n  logoUrl: string;\n  faviconUrl: string;\n  // SEO Settings\n  metaDescription?: string;\n  metaKeywords?: string;\n  googleAnalyticsId?: string;\n  ogImageUrl?: string;\n  twitterCardType?: string;\n  // Email/SMTP Settings\n  smtpHost?: string;\n  smtpPort?: string;\n  smtpUser?: string;\n  smtpPassword?: string;\n  smtpSecure?: boolean;\n  emailFromName?: string;\n  emailFromAddress?: string;\n  // Localization Settings\n  timezone?: string;\n  language?: string;\n  dateFormat?: string;\n  timeFormat?: string;\n  currency?: string;\n  currencySymbol?: string;\n  // Developer Settings\n  debugMode?: boolean;\n  apiRateLimit?: number;\n  corsEnabled?: boolean;\n  corsOrigins?: string;\n  customHeaders?: string;\n  // Logging Settings\n  logLevel?: string;\n  logRetentionDays?: number;\n  logToConsole?: boolean;\n  logToFile?: boolean;\n  // Notification Settings\n  emailNotifyNewContact?: boolean;\n  emailNotifyNewComment?: boolean;\n  emailNotifySecurityAlert?: boolean;\n  emailNotifyNewsletter?: boolean;\n  emailNotifyWeeklySummary?: boolean;\n  pushNotifyBrowser?: boolean;\n  pushNotifyMobile?: boolean;\n  // Integrations Settings\n  disqusShortname?: string;\n  webhookUrl?: string;\n  enableWebhook?: boolean;\n  // Performance Settings\n  enableBrowserCache?: boolean;\n  staticCacheTTL?: number;\n  apiCacheTTL?: number;\n  enableCompression?: boolean;\n  lazyLoadImages?: boolean;\n  autoOptimizeImages?: boolean;\n  maxImageWidth?: number;\n}\n\ninterface SiteSettingsContextType {\n  settings: SiteSettings;\n  isLoading: boolean;\n  updateSettings: (newSettings: Partial<SiteSettings>) => void;\n  saveSettings: () => Promise<{ success: boolean; error?: string }>;\n  isSaving: boolean;\n}\n\nconst defaultSettings: SiteSettings = {\n  siteTitle: \"Loi Developer - Full-stack Creative\",\n  tagline: \"Building digital experiences with code.\",\n  maintenanceMode: false,\n  heroTitle: \"Hello, I'm Loi Developer\",\n  heroSubtitle: \"Full-stack Developer | UI/UX Enthusiast | Creative Thinker\",\n  heroCTA: \"View My Work\",\n  cvFileUrl: \"\",\n  aboutTitle: \"About Me\",\n  aboutSubtitle: \"Full-stack Developer based in Vietnam\",\n  aboutDescription: \"I'm a passionate full-stack developer with expertise in building modern web applications. With years of experience in React, Node.js, and cloud technologies, I create digital experiences that combine beautiful design with robust functionality.\",\n  aboutDescription2: \"My philosophy is simple: Code with passion, build with purpose. Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\",\n  aboutImage: \"\",\n  aboutName: \"Nguyen Thanh Loi\",\n  aboutLocation: \"Ho Chi Minh City\",\n  aboutFreelance: \"Available\",\n  contactEmail: \"loideveloper@example.com\",\n  contactTitle: \"Let's Talk\",\n  contactSubtitle: \"Have a project in mind? Contact me!\",\n  contactPhone: \"+84 123 456 789\",\n  contactAddress: \"Ho Chi Minh City, Vietnam\",\n  socialFacebook: \"\",\n  socialTwitter: \"\",\n  socialInstagram: \"\",\n  socialLinkedin: \"\",\n  socialGithub: \"\",\n  socialYoutube: \"\",\n  footerText: \"Crafted with love & countless cups of coffee\",\n  footerCopyright: \"2024 Loi Developer. All rights reserved.\",\n  logoUrl: \"\",\n  faviconUrl: \"\",\n  // SEO Settings\n  metaDescription: \"Full-stack Developer & Creative Coder\",\n  metaKeywords: \"web development, full-stack, react, node.js\",\n  googleAnalyticsId: \"\",\n  ogImageUrl: \"\",\n  twitterCardType: \"summary_large_image\",\n  // Email/SMTP Settings\n  smtpHost: \"\",\n  smtpPort: \"587\",\n  smtpUser: \"\",\n  smtpPassword: \"\",\n  smtpSecure: true,\n  emailFromName: \"\",\n  emailFromAddress: \"\",\n  // Localization Settings\n  timezone: \"Asia/Ho_Chi_Minh\",\n  language: \"en\",\n  dateFormat: \"MM/DD/YYYY\",\n  timeFormat: \"12h\",\n  currency: \"USD\",\n  currencySymbol: \"$\",\n  // Developer Settings\n  debugMode: false,\n  apiRateLimit: 100,\n  corsEnabled: true,\n  corsOrigins: \"*\",\n  customHeaders: \"\",\n  // Logging Settings\n  logLevel: \"info\",\n  logRetentionDays: 30,\n  logToConsole: true,\n  logToFile: false,\n  // Notification Settings\n  emailNotifyNewContact: true,\n  emailNotifyNewComment: true,\n  emailNotifySecurityAlert: true,\n  emailNotifyNewsletter: false,\n  emailNotifyWeeklySummary: true,\n  pushNotifyBrowser: false,\n  pushNotifyMobile: false,\n  // Integrations Settings\n  disqusShortname: \"\",\n  webhookUrl: \"\",\n  enableWebhook: false,\n  // Performance Settings\n  enableBrowserCache: true,\n  staticCacheTTL: 86400,\n  apiCacheTTL: 300,\n  enableCompression: true,\n  lazyLoadImages: true,\n  autoOptimizeImages: false,\n  maxImageWidth: 1920,\n};\n\nconst SiteContext = createContext<SiteSettingsContextType | undefined>(undefined);\n\nexport function SiteProvider({ children }: { children: ReactNode }) {\n  const [localSettings, setLocalSettings] = useState<SiteSettings>(defaultSettings);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n\n  const loadSettings = useCallback(async () => {\n    try {\n      const data = await api.getSettings();\n      if (data && Object.keys(data).length > 0) {\n        setLocalSettings({\n          siteTitle: data.siteTitle || defaultSettings.siteTitle,\n          tagline: data.tagline || defaultSettings.tagline,\n          maintenanceMode: data.maintenanceMode ?? defaultSettings.maintenanceMode,\n          maintenanceTitle: data.maintenanceTitle || defaultSettings.maintenanceTitle,\n          maintenanceMessage: data.maintenanceMessage || defaultSettings.maintenanceMessage,\n          maintenanceEstimate: data.maintenanceEstimate || defaultSettings.maintenanceEstimate,\n          heroTitle: data.heroTitle || defaultSettings.heroTitle,\n          heroSubtitle: data.heroSubtitle || defaultSettings.heroSubtitle,\n          heroCTA: data.heroCTA || defaultSettings.heroCTA,\n          cvFileUrl: data.cvFileUrl || defaultSettings.cvFileUrl,\n          aboutTitle: data.aboutTitle || defaultSettings.aboutTitle,\n          aboutSubtitle: data.aboutSubtitle || defaultSettings.aboutSubtitle,\n          aboutDescription: data.aboutDescription || defaultSettings.aboutDescription,\n          aboutDescription2: data.aboutDescription2 || defaultSettings.aboutDescription2,\n          aboutImage: data.aboutImage || defaultSettings.aboutImage,\n          aboutName: data.aboutName || defaultSettings.aboutName,\n          aboutLocation: data.aboutLocation || defaultSettings.aboutLocation,\n          aboutFreelance: data.aboutFreelance || defaultSettings.aboutFreelance,\n          contactEmail: data.contactEmail || defaultSettings.contactEmail,\n          contactTitle: data.contactTitle || defaultSettings.contactTitle,\n          contactSubtitle: data.contactSubtitle || defaultSettings.contactSubtitle,\n          contactPhone: data.contactPhone || defaultSettings.contactPhone,\n          contactAddress: data.contactAddress || defaultSettings.contactAddress,\n          socialFacebook: data.socialFacebook || defaultSettings.socialFacebook,\n          socialTwitter: data.socialTwitter || defaultSettings.socialTwitter,\n          socialInstagram: data.socialInstagram || defaultSettings.socialInstagram,\n          socialLinkedin: data.socialLinkedin || defaultSettings.socialLinkedin,\n          socialGithub: data.socialGithub || defaultSettings.socialGithub,\n          socialYoutube: data.socialYoutube || defaultSettings.socialYoutube,\n          footerText: data.footerText || defaultSettings.footerText,\n          footerCopyright: data.footerCopyright || defaultSettings.footerCopyright,\n          logoUrl: data.logoUrl || defaultSettings.logoUrl,\n          faviconUrl: data.faviconUrl || defaultSettings.faviconUrl,\n          // SEO Settings\n          metaDescription: data.metaDescription || defaultSettings.metaDescription,\n          metaKeywords: data.metaKeywords || defaultSettings.metaKeywords,\n          googleAnalyticsId: data.googleAnalyticsId || defaultSettings.googleAnalyticsId,\n          ogImageUrl: data.ogImageUrl || defaultSettings.ogImageUrl,\n          twitterCardType: data.twitterCardType || defaultSettings.twitterCardType,\n          // Email/SMTP Settings\n          smtpHost: data.smtpHost || defaultSettings.smtpHost,\n          smtpPort: data.smtpPort || defaultSettings.smtpPort,\n          smtpUser: data.smtpUser || defaultSettings.smtpUser,\n          smtpPassword: data.smtpPassword || defaultSettings.smtpPassword,\n          smtpSecure: data.smtpSecure ?? defaultSettings.smtpSecure,\n          emailFromName: data.emailFromName || defaultSettings.emailFromName,\n          emailFromAddress: data.emailFromAddress || defaultSettings.emailFromAddress,\n          // Localization Settings\n          timezone: data.timezone || defaultSettings.timezone,\n          language: data.language || defaultSettings.language,\n          dateFormat: data.dateFormat || defaultSettings.dateFormat,\n          timeFormat: data.timeFormat || defaultSettings.timeFormat,\n          currency: data.currency || defaultSettings.currency,\n          currencySymbol: data.currencySymbol || defaultSettings.currencySymbol,\n          // Developer Settings\n          debugMode: data.debugMode ?? defaultSettings.debugMode,\n          apiRateLimit: data.apiRateLimit ?? defaultSettings.apiRateLimit,\n          corsEnabled: data.corsEnabled ?? defaultSettings.corsEnabled,\n          corsOrigins: data.corsOrigins || defaultSettings.corsOrigins,\n          customHeaders: data.customHeaders || defaultSettings.customHeaders,\n          // Logging Settings\n          logLevel: data.logLevel || defaultSettings.logLevel,\n          logRetentionDays: data.logRetentionDays ?? defaultSettings.logRetentionDays,\n          logToConsole: data.logToConsole ?? defaultSettings.logToConsole,\n          logToFile: data.logToFile ?? defaultSettings.logToFile,\n          // Notification Settings\n          emailNotifyNewContact: data.emailNotifyNewContact ?? defaultSettings.emailNotifyNewContact,\n          emailNotifyNewComment: data.emailNotifyNewComment ?? defaultSettings.emailNotifyNewComment,\n          emailNotifySecurityAlert: data.emailNotifySecurityAlert ?? defaultSettings.emailNotifySecurityAlert,\n          emailNotifyNewsletter: data.emailNotifyNewsletter ?? defaultSettings.emailNotifyNewsletter,\n          emailNotifyWeeklySummary: data.emailNotifyWeeklySummary ?? defaultSettings.emailNotifyWeeklySummary,\n          pushNotifyBrowser: data.pushNotifyBrowser ?? defaultSettings.pushNotifyBrowser,\n          pushNotifyMobile: data.pushNotifyMobile ?? defaultSettings.pushNotifyMobile,\n          // Integrations Settings\n          disqusShortname: data.disqusShortname || defaultSettings.disqusShortname,\n          webhookUrl: data.webhookUrl || defaultSettings.webhookUrl,\n          enableWebhook: data.enableWebhook ?? defaultSettings.enableWebhook,\n          // Performance Settings\n          enableBrowserCache: data.enableBrowserCache ?? defaultSettings.enableBrowserCache,\n          staticCacheTTL: data.staticCacheTTL ?? defaultSettings.staticCacheTTL,\n          apiCacheTTL: data.apiCacheTTL ?? defaultSettings.apiCacheTTL,\n          enableCompression: data.enableCompression ?? defaultSettings.enableCompression,\n          lazyLoadImages: data.lazyLoadImages ?? defaultSettings.lazyLoadImages,\n          autoOptimizeImages: data.autoOptimizeImages ?? defaultSettings.autoOptimizeImages,\n          maxImageWidth: data.maxImageWidth ?? defaultSettings.maxImageWidth,\n        });\n      }\n    } catch (error) {\n      console.error(\"Failed to load settings from API, using defaults\");\n      const stored = localStorage.getItem(\"siteSettings\");\n      if (stored) {\n        try {\n          setLocalSettings(JSON.parse(stored));\n        } catch (e) {\n          console.error(\"Failed to parse site settings:\", e);\n        }\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    loadSettings();\n    // Suppress categories loading errors - not critical for site functionality\n    const loadCategories = async () => {\n      try {\n        await fetch(\"/api/categories\", { credentials: \"include\" });\n      } catch (error) {\n        // Categories are optional, don't show error to user\n      }\n    };\n    loadCategories();\n  }, [loadSettings]);\n\n  // Update favicon when faviconUrl changes\n  useEffect(() => {\n    if (localSettings.faviconUrl) {\n      const link = document.querySelector(\"link[rel='icon']\") as HTMLLinkElement;\n      if (link) {\n        link.href = localSettings.faviconUrl;\n        link.type = \"image/png\";\n      } else {\n        const newLink = document.createElement('link');\n        newLink.rel = 'icon';\n        newLink.href = localSettings.faviconUrl;\n        newLink.type = \"image/png\";\n        document.head.appendChild(newLink);\n      }\n    }\n  }, [localSettings.faviconUrl]);\n\n  // Update document title when siteTitle changes\n  useEffect(() => {\n    if (localSettings.siteTitle) {\n      document.title = localSettings.siteTitle;\n    }\n  }, [localSettings.siteTitle]);\n\n  // Apply SEO meta tags\n  useEffect(() => {\n    const updateMetaTag = (name: string, content: string | undefined, isProperty = false) => {\n      if (!content) return;\n      const selector = isProperty ? `meta[property=\"${name}\"]` : `meta[name=\"${name}\"]`;\n      let meta = document.querySelector(selector) as HTMLMetaElement;\n      if (meta) {\n        meta.content = content;\n      } else {\n        meta = document.createElement('meta');\n        if (isProperty) {\n          meta.setAttribute('property', name);\n        } else {\n          meta.name = name;\n        }\n        meta.content = content;\n        document.head.appendChild(meta);\n      }\n    };\n\n    updateMetaTag('description', localSettings.metaDescription);\n    updateMetaTag('keywords', localSettings.metaKeywords);\n    updateMetaTag('og:title', localSettings.siteTitle, true);\n    updateMetaTag('og:description', localSettings.metaDescription, true);\n    updateMetaTag('og:image', localSettings.ogImageUrl, true);\n    updateMetaTag('og:type', 'website', true);\n    updateMetaTag('twitter:card', localSettings.twitterCardType);\n    updateMetaTag('twitter:title', localSettings.siteTitle);\n    updateMetaTag('twitter:description', localSettings.metaDescription);\n    updateMetaTag('twitter:image', localSettings.ogImageUrl);\n  }, [\n    localSettings.metaDescription,\n    localSettings.metaKeywords,\n    localSettings.siteTitle,\n    localSettings.ogImageUrl,\n    localSettings.twitterCardType\n  ]);\n\n  // Load Google Analytics if configured\n  useEffect(() => {\n    if (localSettings.googleAnalyticsId && !document.querySelector(`script[src*=\"googletagmanager\"]`)) {\n      const script = document.createElement('script');\n      script.async = true;\n      script.src = `https://www.googletagmanager.com/gtag/js?id=${localSettings.googleAnalyticsId}`;\n      document.head.appendChild(script);\n\n      const inlineScript = document.createElement('script');\n      inlineScript.innerHTML = `\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag('js', new Date());\n        gtag('config', '${localSettings.googleAnalyticsId}');\n      `;\n      document.head.appendChild(inlineScript);\n    }\n  }, [localSettings.googleAnalyticsId]);\n\n  const updateSettings = (newSettings: Partial<SiteSettings>) => {\n    setLocalSettings(prev => ({ ...prev, ...newSettings }));\n  };\n\n  const saveSettings = async () => {\n    setIsSaving(true);\n    try {\n      await api.updateSettings(localSettings);\n      localStorage.setItem(\"siteSettings\", JSON.stringify(localSettings));\n      return { success: true };\n    } catch (error: any) {\n      console.error(\"Failed to save settings to API:\", error);\n      console.error(\"Error details:\", {\n        message: error?.message,\n        response: error?.response,\n        status: error?.status\n      });\n      localStorage.setItem(\"siteSettings\", JSON.stringify(localSettings));\n      return { success: false, error: error?.message || \"Failed to save settings\" };\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  return (\n    <SiteContext.Provider value={{ settings: localSettings, updateSettings, saveSettings, isLoading, isSaving }}>\n      {children}\n    </SiteContext.Provider>\n  );\n}\n\nexport function useSiteSettings() {\n  const context = useContext(SiteContext);\n  if (context === undefined) {\n    throw new Error(\"useSiteSettings must be used within a SiteProvider\");\n  }\n  return context;\n}","path":null,"size_bytes":17230,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/pages/admin/Media.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { \n  Upload, \n  Search, \n  Image as ImageIcon, \n  File, \n  Trash2,\n  Eye,\n  Loader2,\n  X,\n  Copy,\n  Grid3x3,\n  List,\n  FileText,\n  Folder,\n  RefreshCw\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface MediaItem {\n  id: number;\n  filename: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n  alt: string | null;\n  createdAt: Date | null;\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 B';\n  const k = 1024;\n  const sizes = ['B', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n}\n\nfunction getFileIcon(mimeType: string) {\n  if (mimeType.startsWith('image/')) {\n    return <ImageIcon className=\"w-12 h-12 text-blue-500\" />;\n  }\n  return <FileText className=\"w-12 h-12 text-muted-foreground\" />;\n}\n\nexport default function AdminMedia() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState(\"all\");\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<MediaItem | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const { data: mediaItems = [], isLoading, error } = useQuery<MediaItem[]>({\n    queryKey: ['/api/media'],\n    retry: 3,\n  });\n\n  // Debug logging\n  console.log('Media page state:', { \n    isLoading, \n    error: error?.message, \n    itemsCount: mediaItems.length \n  });\n\n  const createMediaMutation = useMutation({\n    mutationFn: api.createMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File uploaded successfully\" });\n      setUploadDialogOpen(false);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMediaMutation = useMutation({\n    mutationFn: api.deleteMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const syncMediaMutation = useMutation({\n    mutationFn: api.syncMedia,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ \n        title: \"Sync Complete\", \n        description: `${data.synced.length} new files synced, ${data.skipped.length} already existed` \n      });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setUploading(true);\n\n    try {\n      if (files.length === 1) {\n        // Single file upload\n        const formData = new FormData();\n        formData.append('file', files[0]);\n        \n        const response = await fetch('/api/upload/file', {\n          method: 'POST',\n          body: formData,\n          credentials: 'include',\n        });\n        \n        if (!response.ok) {\n          const error = await response.json();\n          throw new Error(error.message || 'Upload failed');\n        }\n        \n        toast({ title: \"Success\", description: \"File uploaded successfully\" });\n        queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      } else {\n        // Multiple files upload\n        const formData = new FormData();\n        Array.from(files).forEach(file => {\n          formData.append('files', file);\n        });\n        \n        const response = await fetch('/api/upload/files', {\n          method: 'POST',\n          body: formData,\n          credentials: 'include',\n        });\n        \n        if (!response.ok) {\n          const error = await response.json();\n          throw new Error(error.message || 'Upload failed');\n        }\n        \n        toast({ title: \"Success\", description: `${files.length} files uploaded successfully` });\n        queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      }\n    } catch (error: any) {\n      console.error('Upload error:', error);\n      toast({ title: \"Error\", description: error.message || 'Upload failed', variant: \"destructive\" });\n    }\n\n    setUploading(false);\n    setUploadDialogOpen(false);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete \"${name}\"? This action cannot be undone.`)) {\n      deleteMediaMutation.mutate(id);\n    }\n  };\n\n  const copyToClipboard = (url: string) => {\n    navigator.clipboard.writeText(url);\n    toast({ title: \"Copied\", description: \"URL copied to clipboard\" });\n  };\n\n  const filteredMedia = mediaItems.filter(item => {\n    const matchesSearch = searchQuery === \"\" || \n      item.originalName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.filename.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesType = filterType === \"all\" ||\n      (filterType === \"images\" && item.mimeType.startsWith(\"image/\")) ||\n      (filterType === \"docs\" && !item.mimeType.startsWith(\"image/\"));\n    \n    return matchesSearch && matchesType;\n  });\n\n  const imageCount = mediaItems.filter(m => m.mimeType.startsWith(\"image/\")).length;\n  const docCount = mediaItems.filter(m => !m.mimeType.startsWith(\"image/\")).length;\n  const totalSize = mediaItems.reduce((sum, m) => sum + m.size, 0);\n  const maxStorage = 500 * 1024 * 1024;\n  const storagePercent = Math.round((totalSize / maxStorage) * 100);\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          <p className=\"ml-2 text-muted-foreground\">Loading media...</p>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  if (error) {\n    console.error('Media error:', error);\n    return (\n      <AdminLayout>\n        <div className=\"flex flex-col items-center justify-center h-64\">\n          <p className=\"text-destructive mb-4\">Error loading media: {error instanceof Error ? error.message : 'Unknown error'}</p>\n          <Button onClick={() => window.location.reload()}>Reload Page</Button>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  // Add explicit check for empty state\n  if (!isLoading && !error && mediaItems.length === 0) {\n    console.log('Media: No items found, showing empty state');\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-media-title\">Media Library</h1>\n            <p className=\"text-muted-foreground\">\n              {mediaItems.length} files ({formatFileSize(totalSize)} total)\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\"\n              onClick={() => syncMediaMutation.mutate()}\n              disabled={syncMediaMutation.isPending}\n              data-testid=\"button-sync-files\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${syncMediaMutation.isPending ? 'animate-spin' : ''}`} /> \n              {syncMediaMutation.isPending ? 'Syncing...' : 'Sync Folder'}\n            </Button>\n            <Button \n              onClick={() => setUploadDialogOpen(true)}\n              data-testid=\"button-upload-files\"\n            >\n              <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium\">Storage Used</span>\n              <span className=\"text-sm text-muted-foreground\">\n                {formatFileSize(totalSize)} / 500 MB\n              </span>\n            </div>\n            <div className=\"w-full bg-muted rounded-full h-2 overflow-hidden\">\n              <div \n                className=\"bg-primary h-full rounded-full transition-all\" \n                style={{ width: `${Math.min(storagePercent, 100)}%` }} \n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <Card className=\"cursor-pointer hover:border-primary transition-colors\" onClick={() => setFilterType(\"images\")}>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-3\">\n                <div className=\"p-3 bg-blue-500/10 rounded-lg\">\n                  <ImageIcon className=\"w-6 h-6 text-blue-500\" />\n                </div>\n              </div>\n              <h4 className=\"font-bold mb-1\">Images</h4>\n              <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                <span>{imageCount} files</span>\n                <span>-</span>\n                <span>{formatFileSize(mediaItems.filter(m => m.mimeType.startsWith(\"image/\")).reduce((s, m) => s + m.size, 0))}</span>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"cursor-pointer hover:border-primary transition-colors\" onClick={() => setFilterType(\"docs\")}>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-3\">\n                <div className=\"p-3 bg-orange-500/10 rounded-lg\">\n                  <FileText className=\"w-6 h-6 text-orange-500\" />\n                </div>\n              </div>\n              <h4 className=\"font-bold mb-1\">Documents</h4>\n              <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                <span>{docCount} files</span>\n                <span>-</span>\n                <span>{formatFileSize(mediaItems.filter(m => !m.mimeType.startsWith(\"image/\")).reduce((s, m) => s + m.size, 0))}</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-center justify-between\">\n              <div className=\"relative flex-1 w-full\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search files...\" \n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-media\"\n                />\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Tabs value={filterType} onValueChange={setFilterType} className=\"w-auto\">\n                  <TabsList>\n                    <TabsTrigger value=\"all\" data-testid=\"tab-all\">All ({mediaItems.length})</TabsTrigger>\n                    <TabsTrigger value=\"images\" data-testid=\"tab-images\">Images ({imageCount})</TabsTrigger>\n                    <TabsTrigger value=\"docs\" data-testid=\"tab-docs\">Docs ({docCount})</TabsTrigger>\n                  </TabsList>\n                </Tabs>\n                <div className=\"flex gap-1 border rounded-md p-1\">\n                  <Button \n                    variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"grid\")}\n                    data-testid=\"button-view-grid\"\n                  >\n                    <Grid3x3 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button \n                    variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"list\")}\n                    data-testid=\"button-view-list\"\n                  >\n                    <List className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {filteredMedia.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <ImageIcon className=\"w-12 h-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No files found</h3>\n              <p className=\"text-muted-foreground text-sm mb-4\">\n                {searchQuery ? \"Try adjusting your search\" : \"Upload your first file\"}\n              </p>\n              <Button onClick={() => setUploadDialogOpen(true)}>\n                <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n              </Button>\n            </CardContent>\n          </Card>\n        ) : viewMode === \"grid\" ? (\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4\">\n            {filteredMedia.map((item) => (\n              <div \n                key={item.id} \n                className=\"group relative bg-card border border-border rounded-lg overflow-hidden hover:shadow-md transition-all\"\n                data-testid={`media-item-${item.id}`}\n              >\n                <div className=\"aspect-square bg-muted flex items-center justify-center relative overflow-hidden\">\n                  {item.mimeType.startsWith(\"image/\") ? (\n                    <img \n                      src={item.url} \n                      alt={item.alt || item.originalName} \n                      className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\" \n                    />\n                  ) : (\n                    getFileIcon(item.mimeType)\n                  )}\n                  \n                  <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full\"\n                      onClick={() => setPreviewItem(item)}\n                      title=\"Preview\"\n                    >\n                      <Eye size={14} />\n                    </Button>\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full\"\n                      onClick={() => copyToClipboard(item.url)}\n                      title=\"Copy URL\"\n                    >\n                      <Copy size={14} />\n                    </Button>\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full text-destructive\"\n                      onClick={() => handleDelete(item.id, item.originalName)}\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={14} />\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"p-3\">\n                  <div className=\"font-medium text-sm truncate\" title={item.originalName}>\n                    {item.originalName}\n                  </div>\n                  <div className=\"text-xs text-muted-foreground flex justify-between mt-1\">\n                    <span>{item.mimeType.split('/')[1]?.toUpperCase() || 'FILE'}</span>\n                    <span>{formatFileSize(item.size)}</span>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"p-0\">\n              <div className=\"divide-y\">\n                {filteredMedia.map((file) => (\n                  <div \n                    key={file.id} \n                    className=\"flex items-center justify-between p-4 hover:bg-muted/50 cursor-pointer group\"\n                    data-testid={`media-row-${file.id}`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {file.mimeType.startsWith(\"image/\") ? (\n                        <div className=\"w-10 h-10 rounded overflow-hidden bg-muted flex items-center justify-center\">\n                          <img \n                            src={file.url} \n                            alt={file.alt || file.originalName}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n                      ) : (\n                        <div className=\"w-10 h-10 rounded bg-muted flex items-center justify-center\">\n                          <FileText className=\"w-5 h-5 text-muted-foreground\" />\n                        </div>\n                      )}\n                      <div>\n                        <p className=\"font-medium text-sm\">{file.originalName}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {file.createdAt && formatDistanceToNow(new Date(file.createdAt), { addSuffix: true })}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-4\">\n                      <span className=\"text-sm text-muted-foreground\">{formatFileSize(file.size)}</span>\n                      <div className=\"flex gap-1 invisible group-hover:visible transition-all\">\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          onClick={() => setPreviewItem(file)}\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          onClick={() => copyToClipboard(file.url)}\n                        >\n                          <Copy className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          className=\"text-destructive\"\n                          onClick={() => handleDelete(file.id, file.originalName)}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>Upload Files</DialogTitle>\n              <DialogDescription>\n                Select files to upload to your media library\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              <div \n                className=\"border-2 border-dashed border-muted-foreground/30 rounded-lg p-8 text-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                <Upload className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-sm font-medium mb-2\">Click to select files</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  Supports images, PDFs, and documents\n                </p>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  className=\"hidden\"\n                  multiple\n                  accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt\"\n                  onChange={handleFileSelect}\n                  data-testid=\"input-file-upload\"\n                />\n              </div>\n\n              {uploading && (\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Uploading...</span>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setUploadDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={!!previewItem} onOpenChange={() => setPreviewItem(null)}>\n          <DialogContent className=\"sm:max-w-[700px]\">\n            <DialogHeader>\n              <DialogTitle>{previewItem?.originalName}</DialogTitle>\n              <DialogDescription>\n                {previewItem?.mimeType} - {previewItem && formatFileSize(previewItem.size)}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"py-4\">\n              {previewItem?.mimeType.startsWith(\"image/\") ? (\n                <img \n                  src={previewItem.url} \n                  alt={previewItem.alt || previewItem.originalName}\n                  className=\"max-w-full max-h-[400px] mx-auto rounded-lg\"\n                />\n              ) : previewItem?.mimeType === \"application/pdf\" ? (\n                <iframe \n                  src={previewItem.url}\n                  className=\"w-full h-[500px] rounded-lg border\"\n                />\n              ) : previewItem?.mimeType === \"text/plain\" || previewItem?.mimeType?.includes(\"text/\") ? (\n                <div className=\"bg-muted p-4 rounded-lg max-h-[500px] overflow-auto\">\n                  <pre className=\"text-sm font-mono whitespace-pre-wrap break-words\">\n                    <a href={previewItem.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n                      Open {previewItem.originalName} â†’\n                    </a>\n                  </pre>\n                </div>\n              ) : previewItem ? (\n                <div className=\"flex flex-col items-center justify-center py-12\">\n                  {getFileIcon(previewItem?.mimeType || '')}\n                  <p className=\"text-muted-foreground mt-4\">\n                    <a href={previewItem.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n                      Download {previewItem.originalName}\n                    </a>\n                  </p>\n                </div>\n              ) : null}\n            </div>\n\n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                onClick={() => previewItem && copyToClipboard(previewItem.url)}\n              >\n                <Copy className=\"w-4 h-4 mr-2\" /> Copy URL\n              </Button>\n              <Button variant=\"outline\" onClick={() => setPreviewItem(null)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":24012,"size_tokens":null},"client/src/pages/admin/Projects.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { api } from \"@/lib/api\";\nimport { \n  Plus, \n  Search, \n  Filter, \n  Edit,\n  Trash,\n  Globe,\n  Github,\n  Calendar,\n  ExternalLink,\n  Layers,\n  Star,\n  Loader2\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ntype Project = {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  views: number;\n  featured: boolean;\n  createdAt: string;\n  updatedAt: string;\n};\n\ntype ProjectFormData = {\n  title: string;\n  category: string;\n  image: string;\n  description: string;\n  tech: string[];\n  link: string;\n  github: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  featured: boolean;\n};\n\nconst getDefaultFormData = (): ProjectFormData => ({\n  title: \"\",\n  category: \"full-stack\",\n  image: \"\",\n  description: \"\",\n  tech: [],\n  link: \"\",\n  github: \"\",\n  status: \"Draft\",\n  featured: false,\n});\n\nexport default function AdminProjects() {\n  const { toast } = useToast();\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [categories, setCategories] = useState<Array<{ value: string; label: string }>>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProject, setEditingProject] = useState<Project | null>(null);\n  const [formData, setFormData] = useState<ProjectFormData>(getDefaultFormData());\n  const [techInput, setTechInput] = useState(\"\");\n  const [uploading, setUploading] = useState(false);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n\n  // Load projects and categories from API\n  useEffect(() => {\n    loadProjects();\n    loadCategories();\n  }, []);\n\n  const loadCategories = async () => {\n    try {\n      const data = await api.getCategories(\"project\");\n      setCategories(data.map((cat: any) => ({ value: cat.slug, label: cat.name })));\n    } catch (error: any) {\n      console.error(\"Failed to load categories:\", error);\n    }\n  };\n\n  const loadProjects = async () => {\n    try {\n      setLoading(true);\n      const data = await api.getProjects();\n      setProjects(data);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to load projects\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleImageUpload = async (file: File) => {\n    if (!file) return;\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      setFormData(prev => ({ ...prev, image: data.url }));\n      toast({ title: \"Success\", description: \"Image uploaded\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const filteredProjects = projects.filter(project => \n    project.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    project.category.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    project.tech.some(t => t.toLowerCase().includes(searchQuery.toLowerCase()))\n  );\n\n  const handleDelete = async (id: number) => {\n    const project = projects.find(p => p.id === id);\n    if (!project) return;\n\n    const confirmed = window.confirm(\n      `Are you sure you want to delete \"${project.title}\"?\\n\\nThis action cannot be undone.`\n    );\n    \n    if (!confirmed) return;\n    \n    try {\n      await api.deleteProject(id);\n      toast({\n        title: \"Success\",\n        description: `\"${project.title}\" has been deleted successfully`,\n      });\n      await loadProjects();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete project\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const openAddDialog = () => {\n    setEditingProject(null);\n    setFormData(getDefaultFormData());\n    setTechInput(\"\");\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (project: Project) => {\n    setEditingProject(project);\n    setFormData({\n      title: project.title,\n      category: project.category,\n      image: project.image || \"\",\n      description: project.description || \"\",\n      tech: project.tech || [],\n      link: project.link || \"\",\n      github: project.github || \"\",\n      status: project.status,\n      featured: project.featured,\n    });\n    setTechInput(\"\");\n    setIsDialogOpen(true);\n  };\n\n  const closeDialog = () => {\n    setIsDialogOpen(false);\n    setEditingProject(null);\n    setFormData(getDefaultFormData());\n    setTechInput(\"\");\n  };\n\n  const [isSaving, setIsSaving] = useState(false);\n\n  const handleSubmit = async () => {\n    // Validate required fields\n    if (!formData.title.trim()) {\n      toast({\n        title: \"Validation Error\",\n        description: \"Project title is required\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!formData.category) {\n      toast({\n        title: \"Validation Error\",\n        description: \"Please select a category\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      const projectData = {\n        title: formData.title.trim(),\n        category: formData.category,\n        image: formData.image.trim() || null,\n        description: formData.description.trim() || null,\n        tech: formData.tech,\n        link: formData.link.trim() || null,\n        github: formData.github.trim() || null,\n        status: formData.status,\n        featured: formData.featured,\n      };\n\n      if (editingProject) {\n        await api.updateProject(editingProject.id, projectData);\n        toast({\n          title: \"Success\",\n          description: `\"${projectData.title}\" has been updated successfully`,\n        });\n      } else {\n        await api.createProject(projectData);\n        toast({\n          title: \"Success\",\n          description: `\"${projectData.title}\" has been created successfully`,\n        });\n      }\n      \n      setIsDialogOpen(false);\n      setFormData(getDefaultFormData());\n      setTechInput(\"\");\n      setEditingProject(null);\n      await loadProjects();\n    } catch (error: any) {\n      console.error(\"Error saving project:\", error);\n      toast({\n        title: \"Error\",\n        description: error?.message || \"Failed to save project. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const addTech = () => {\n    const tech = techInput.trim();\n    if (!tech) {\n      toast({\n        title: \"Validation Error\",\n        description: \"Please enter a technology name\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (formData.tech.includes(tech)) {\n      toast({\n        title: \"Validation Error\",\n        description: \"This technology is already added\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    setFormData({ ...formData, tech: [...formData.tech, tech] });\n    setTechInput(\"\");\n  };\n\n  const removeTech = (tech: string) => {\n    setFormData({ ...formData, tech: formData.tech.filter(t => t !== tech) });\n  };\n\n  const toggleStatus = async (id: number, currentStatus: string) => {\n    const project = projects.find(p => p.id === id);\n    if (!project) return;\n\n    try {\n      const newStatus = currentStatus === \"Published\" ? \"Draft\" : \"Published\";\n      await api.updateProject(id, { status: newStatus });\n      toast({\n        title: \"Status Updated\",\n        description: `\"${project.title}\" is now ${newStatus.toLowerCase()}`,\n      });\n      await loadProjects();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update status\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const toggleFeatured = async (id: number, currentFeatured: boolean) => {\n    const project = projects.find(p => p.id === id);\n    if (!project) return;\n\n    try {\n      await api.updateProject(id, { featured: !currentFeatured });\n      toast({\n        title: !currentFeatured ? \"Featured Added\" : \"Featured Removed\",\n        description: !currentFeatured \n          ? `\"${project.title}\" will appear in featured section` \n          : `\"${project.title}\" removed from featured section`,\n      });\n      await loadProjects();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update featured status\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Projects & Portfolio</h1>\n            <p className=\"text-muted-foreground\">Manage your portfolio showcase with detailed rich data.</p>\n          </div>\n          <Button className=\"bg-primary hover:bg-primary/90\" onClick={openAddDialog}>\n            <Plus className=\"w-4 h-4 mr-2\" /> Add New Project\n          </Button>\n        </div>\n\n        <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input \n              placeholder=\"Search projects by name, category, or tech...\" \n              className=\"pl-9\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Filter className=\"w-4 h-4\" /> Category\n            </Button>\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Calendar className=\"w-4 h-4\" /> Date\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          {loading ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4\"></div>\n                <p className=\"text-muted-foreground\">Loading projects...</p>\n              </CardContent>\n            </Card>\n          ) : filteredProjects.length === 0 ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <Layers className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No projects found</h3>\n                <p className=\"text-muted-foreground mb-4\">\n                  {searchQuery ? \"Try a different search term\" : \"Add your first project to get started\"}\n                </p>\n                {!searchQuery && (\n                  <Button onClick={openAddDialog}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Project\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          ) : (\n            filteredProjects.map((project) => (\n              <Card key={project.id} className=\"overflow-hidden group\">\n                <div className=\"flex flex-col md:flex-row\">\n                  <div className=\"w-full md:w-48 h-32 md:h-auto relative bg-muted\">\n                    <img \n                      src={project.image || '/placeholder.jpg'} \n                      alt={project.title} \n                      className=\"w-full h-full object-cover\" \n                    />\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity\">\n                      <Button variant=\"secondary\" size=\"sm\" onClick={() => openEditDialog(project)}>\n                        Edit Image\n                      </Button>\n                    </div>\n                    {project.featured && (\n                      <div className=\"absolute top-2 left-2\">\n                        <Badge className=\"bg-yellow-500 text-black\">\n                          <Star className=\"w-3 h-3 mr-1\" /> Featured\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n\n                  <CardContent className=\"flex-1 p-6\">\n                    <div className=\"flex flex-col md:flex-row justify-between gap-4\">\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <h3 className=\"text-xl font-bold\">{project.title}</h3>\n                          <Badge \n                            variant={project.status === \"Published\" ? \"default\" : \"outline\"}\n                            className={`cursor-pointer ${project.status === \"Published\" ? \"bg-green-500 hover:bg-green-600\" : \"hover:bg-muted\"}`}\n                            onClick={() => toggleStatus(project.id, project.status)}\n                          >\n                            {project.status}\n                          </Badge>\n                        </div>\n                        \n                        <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                          <div className=\"flex items-center gap-1\">\n                            <Layers className=\"w-4 h-4\" /> Category: <span className=\"text-foreground font-medium\">{project.category}</span>\n                          </div>\n                          {project.createdAt && (\n                            <div className=\"flex items-center gap-1\">\n                              <Calendar className=\"w-4 h-4\" /> Created: <span className=\"text-foreground font-medium\">\n                                {formatDistanceToNow(new Date(project.createdAt), { addSuffix: true })}\n                              </span>\n                            </div>\n                          )}\n                        </div>\n\n                        <div className=\"flex flex-wrap gap-2 mt-2\">\n                          {project.tech.map(t => (\n                            <Badge key={t} variant=\"secondary\" className=\"text-xs font-mono\">\n                              {t}\n                            </Badge>\n                          ))}\n                        </div>\n\n                        {project.description && (\n                          <p className=\"text-sm text-muted-foreground line-clamp-2 mt-2\">\n                            {project.description}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"flex flex-col items-end gap-2\">\n                        <div className=\"flex gap-2\">\n                          <Button \n                            variant=\"outline\" \n                            size=\"icon\" \n                            title=\"Toggle Featured\"\n                            onClick={() => toggleFeatured(project.id, project.featured)}\n                            className={project.featured ? \"text-yellow-500\" : \"\"}\n                          >\n                            <Star className=\"w-4 h-4\" />\n                          </Button>\n                          {project.link && (\n                            <Button \n                              variant=\"outline\" \n                              size=\"icon\" \n                              title=\"View Live\"\n                              onClick={() => window.open(project.link!, '_blank')}\n                            >\n                              <ExternalLink className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          {project.github && (\n                            <Button \n                              variant=\"outline\" \n                              size=\"icon\" \n                              title=\"View Code\"\n                              onClick={() => window.open(project.github!, '_blank')}\n                            >\n                              <Github className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          <Button \n                            variant=\"default\" \n                            size=\"icon\" \n                            title=\"Edit Details\"\n                            onClick={() => openEditDialog(project)}\n                          >\n                            <Edit className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"destructive\" \n                            size=\"icon\" \n                            title=\"Delete\" \n                            onClick={() => handleDelete(project.id)}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                        <div className=\"text-xs text-muted-foreground mt-2\">\n                          <span className=\"font-medium text-foreground\">{project.views}</span> views\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </div>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={(open) => !open && closeDialog()}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{editingProject ? \"Edit Project\" : \"Add New Project\"}</DialogTitle>\n            <DialogDescription>\n              {editingProject ? \"Update the project details below.\" : \"Fill in the details for your new project.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"title\">Project Title *</Label>\n                <Input\n                  id=\"title\"\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  placeholder=\"Enter project title\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.map((cat) => (\n                      <SelectItem key={cat.value} value={cat.value}>\n                        {cat.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value: \"Published\" | \"Draft\" | \"Archived\") => \n                    setFormData({ ...formData, status: value })\n                  }\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                    <SelectItem value=\"Archived\">Archived</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"image\">Project Image</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"image\"\n                    value={formData.image}\n                    readOnly\n                    placeholder=\"No image selected\"\n                  />\n                  <Button variant=\"outline\" onClick={() => imageInputRef.current?.click()} disabled={uploading}>\n                    {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                  </Button>\n                </div>\n                <input\n                  ref={imageInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  onChange={(e) => e.target.files?.[0] && handleImageUpload(e.target.files[0])}\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"description\">Description</Label>\n                <Textarea\n                  id=\"description\"\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  placeholder=\"Describe your project...\"\n                  rows={3}\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label>Technologies</Label>\n                <div className=\"flex gap-2 mb-2\">\n                  <Input\n                    value={techInput}\n                    onChange={(e) => setTechInput(e.target.value)}\n                    placeholder=\"Add technology (e.g., React)\"\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        addTech();\n                      }\n                    }}\n                  />\n                  <Button type=\"button\" onClick={addTech} variant=\"secondary\">\n                    Add\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {formData.tech.map((tech) => (\n                    <Badge key={tech} variant=\"secondary\" className=\"gap-1\">\n                      {tech}\n                      <button\n                        type=\"button\"\n                        onClick={() => removeTech(tech)}\n                        className=\"ml-1 hover:text-destructive\"\n                      >\n                        Ã—\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n\n              <div>\n                <Label htmlFor=\"link\">Live Demo URL</Label>\n                <Input\n                  id=\"link\"\n                  value={formData.link}\n                  onChange={(e) => setFormData({ ...formData, link: e.target.value })}\n                  placeholder=\"https://example.com\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"github\">GitHub URL</Label>\n                <Input\n                  id=\"github\"\n                  value={formData.github}\n                  onChange={(e) => setFormData({ ...formData, github: e.target.value })}\n                  placeholder=\"https://github.com/...\"\n                />\n              </div>\n\n              <div className=\"col-span-2 flex items-center justify-between rounded-lg border p-4\">\n                <div>\n                  <Label htmlFor=\"featured\" className=\"font-medium\">Featured Project</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Show this project in the featured section on the homepage\n                  </p>\n                </div>\n                <Switch\n                  id=\"featured\"\n                  checked={formData.featured}\n                  onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n                />\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={closeDialog} disabled={isSaving}>\n              Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isSaving || !formData.title.trim()}>\n              {isSaving ? (\n                <>\n                  <span className=\"animate-spin mr-2\">â³</span>\n                  Saving...\n                </>\n              ) : (\n                editingProject ? \"Save Changes\" : \"Create Project\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":25374,"size_tokens":null},"client/src/pages/admin/Services.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash,\n  ShoppingBag,\n  Check,\n  Loader2,\n  Save,\n  X,\n  GripVertical\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\ninterface Service {\n  id: number;\n  title: string;\n  description: string;\n  icon: string | null;\n  features: string[];\n  price: string | null;\n  order: number;\n  active: boolean;\n  createdAt: Date | null;\n}\n\nconst iconOptions = [\n  { value: \"code\", label: \"Code\" },\n  { value: \"smartphone\", label: \"Smartphone\" },\n  { value: \"palette\", label: \"Palette\" },\n  { value: \"shopping-cart\", label: \"Shopping Cart\" },\n  { value: \"link\", label: \"Link\" },\n  { value: \"cloud\", label: \"Cloud\" },\n  { value: \"lightbulb\", label: \"Lightbulb\" },\n  { value: \"wrench\", label: \"Wrench\" },\n  { value: \"database\", label: \"Database\" },\n  { value: \"shield\", label: \"Shield\" },\n];\n\nexport default function AdminServices() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [editingService, setEditingService] = useState<Service | null>(null);\n  const [formData, setFormData] = useState({\n    title: \"\",\n    description: \"\",\n    icon: \"code\",\n    features: [\"\"],\n    price: \"\",\n    order: 0,\n    active: true,\n  });\n\n  const { data: services = [], isLoading } = useQuery<Service[]>({\n    queryKey: ['/api/services'],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createService(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/services'] });\n      toast({ title: \"Success\", description: \"Service created successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: typeof formData }) => api.updateService(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/services'] });\n      toast({ title: \"Success\", description: \"Service updated successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteService(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/services'] });\n      toast({ title: \"Success\", description: \"Service deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData({\n      title: \"\",\n      description: \"\",\n      icon: \"code\",\n      features: [\"\"],\n      price: \"\",\n      order: 0,\n      active: true,\n    });\n    setEditingService(null);\n  };\n\n  const handleOpenCreate = () => {\n    resetForm();\n    setFormData(prev => ({ ...prev, order: services.length }));\n    setDialogOpen(true);\n  };\n\n  const handleOpenEdit = (service: Service) => {\n    setEditingService(service);\n    setFormData({\n      title: service.title,\n      description: service.description,\n      icon: service.icon || \"code\",\n      features: service.features?.length > 0 ? service.features : [\"\"],\n      price: service.price || \"\",\n      order: service.order,\n      active: service.active,\n    });\n    setDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Error\", description: \"Service title is required\", variant: \"destructive\" });\n      return;\n    }\n\n    const cleanedFeatures = formData.features.filter(f => f.trim() !== \"\");\n    const dataToSubmit = { ...formData, features: cleanedFeatures };\n\n    if (editingService) {\n      updateMutation.mutate({ id: editingService.id, data: dataToSubmit });\n    } else {\n      createMutation.mutate(dataToSubmit);\n    }\n  };\n\n  const handleDelete = (id: number, title: string) => {\n    if (confirm(`Delete service \"${title}\"? This action cannot be undone.`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const handleAddFeature = () => {\n    setFormData(prev => ({ ...prev, features: [...prev.features, \"\"] }));\n  };\n\n  const handleRemoveFeature = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      features: prev.features.filter((_, i) => i !== index)\n    }));\n  };\n\n  const handleFeatureChange = (index: number, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      features: prev.features.map((f, i) => i === index ? value : f)\n    }));\n  };\n\n  const filteredServices = services.filter(service =>\n    service.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    service.description.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Services</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your service offerings ({services.length} services)\n            </p>\n          </div>\n          <Button onClick={handleOpenCreate} data-testid=\"button-add-service\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n          </Button>\n        </div>\n\n        <div className=\"flex justify-between items-center gap-4\">\n          <div className=\"relative flex-1 max-w-sm\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input \n              placeholder=\"Search services...\" \n              className=\"pl-9\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              data-testid=\"input-search-services\"\n            />\n          </div>\n        </div>\n\n        {filteredServices.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <ShoppingBag className=\"w-12 h-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No services found</h3>\n              <p className=\"text-muted-foreground text-sm mb-4\">\n                {searchQuery ? \"Try adjusting your search\" : \"Start by adding your first service\"}\n              </p>\n              <Button onClick={handleOpenCreate}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredServices.map((service) => (\n              <Card \n                key={service.id} \n                className={`relative group hover:border-primary/50 transition-colors ${!service.active ? 'opacity-60' : ''}`}\n                data-testid={`card-service-${service.id}`}\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <CardTitle className=\"flex items-center gap-3\">\n                      <div className=\"p-2 bg-primary/10 rounded-lg text-primary\">\n                        <ShoppingBag className=\"w-5 h-5\" />\n                      </div>\n                      <div>\n                        <span className=\"block\">{service.title}</span>\n                        {!service.active && (\n                          <Badge variant=\"secondary\" className=\"text-xs mt-1\">Inactive</Badge>\n                        )}\n                      </div>\n                    </CardTitle>\n                    <div className=\"flex gap-1 invisible group-hover:visible\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        onClick={() => handleOpenEdit(service)}\n                        data-testid={`button-edit-service-${service.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        className=\"text-destructive\"\n                        onClick={() => handleDelete(service.id, service.title)}\n                        data-testid={`button-delete-service-${service.id}`}\n                      >\n                        <Trash className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">{service.description}</p>\n                  \n                  {service.features && service.features.length > 0 && (\n                    <ul className=\"space-y-1 mb-4\">\n                      {service.features.slice(0, 3).map((feature, idx) => (\n                        <li key={idx} className=\"flex items-start gap-2 text-xs text-muted-foreground\">\n                          <Check className=\"w-3 h-3 text-green-500 mt-0.5 flex-shrink-0\" />\n                          <span className=\"line-clamp-1\">{feature}</span>\n                        </li>\n                      ))}\n                      {service.features.length > 3 && (\n                        <li className=\"text-xs text-muted-foreground pl-5\">\n                          +{service.features.length - 3} more features\n                        </li>\n                      )}\n                    </ul>\n                  )}\n                  \n                  {service.price && (\n                    <div className=\"pt-3 border-t border-border\">\n                      <span className=\"font-semibold text-primary\">{service.price}</span>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n\n            <div \n              onClick={handleOpenCreate}\n              className=\"border-2 border-dashed border-muted-foreground/20 rounded-xl flex flex-col items-center justify-center p-6 cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all min-h-[200px]\"\n              data-testid=\"button-add-service-card\"\n            >\n              <Plus className=\"w-6 h-6 text-muted-foreground mb-2\" />\n              <span className=\"text-sm font-medium text-muted-foreground\">Add new service</span>\n            </div>\n          </div>\n        )}\n\n        <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n          <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle>{editingService ? \"Edit Service\" : \"Add New Service\"}</DialogTitle>\n              <DialogDescription>\n                {editingService ? \"Update the service details below\" : \"Fill in the details for your new service\"}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-5 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"service-title\">Service Title *</Label>\n                <Input\n                  id=\"service-title\"\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  placeholder=\"e.g., Web Development, UI/UX Design\"\n                  data-testid=\"input-service-title\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"service-description\">Description</Label>\n                <Textarea\n                  id=\"service-description\"\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  placeholder=\"Describe what this service includes...\"\n                  rows={3}\n                  data-testid=\"input-service-description\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"service-price\">Price</Label>\n                  <Input\n                    id=\"service-price\"\n                    value={formData.price}\n                    onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n                    placeholder=\"e.g., From $500, $100/hour\"\n                    data-testid=\"input-service-price\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"service-order\">Display Order</Label>\n                  <Input\n                    id=\"service-order\"\n                    type=\"number\"\n                    value={formData.order}\n                    onChange={(e) => setFormData({ ...formData, order: parseInt(e.target.value) || 0 })}\n                    data-testid=\"input-service-order\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <Label>Features</Label>\n                  <Button \n                    type=\"button\" \n                    variant=\"outline\" \n                    size=\"sm\"\n                    onClick={handleAddFeature}\n                  >\n                    <Plus className=\"w-3 h-3 mr-1\" /> Add Feature\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  {formData.features.map((feature, index) => (\n                    <div key={index} className=\"flex items-center gap-2\">\n                      <GripVertical className=\"w-4 h-4 text-muted-foreground cursor-grab\" />\n                      <Input\n                        value={feature}\n                        onChange={(e) => handleFeatureChange(index, e.target.value)}\n                        placeholder={`Feature ${index + 1}`}\n                        data-testid={`input-feature-${index}`}\n                      />\n                      {formData.features.length > 1 && (\n                        <Button \n                          type=\"button\" \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          className=\"text-destructive flex-shrink-0\"\n                          onClick={() => handleRemoveFeature(index)}\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"service-active\"\n                  checked={formData.active}\n                  onCheckedChange={(checked) => setFormData({ ...formData, active: checked })}\n                  data-testid=\"switch-service-active\"\n                />\n                <Label htmlFor=\"service-active\">Active (visible on website)</Label>\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button \n                onClick={handleSubmit} \n                disabled={createMutation.isPending || updateMutation.isPending}\n                data-testid=\"button-save-service\"\n              >\n                {(createMutation.isPending || updateMutation.isPending) ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Save className=\"w-4 h-4 mr-2\" />\n                )}\n                {editingService ? \"Update\" : \"Create\"} Service\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":16929,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"client/src/pages/admin/Testimonials.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Star, Plus, Edit, Trash, Search, AlertCircle, Loader2, Upload, X } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { insertTestimonialSchema, type Testimonial } from \"@shared/schema\";\nimport type { z } from \"zod\";\n\ntype TestimonialFormData = z.infer<typeof insertTestimonialSchema>;\n\nexport default function AdminTestimonials() {\n  const { toast } = useToast();\n  const [isOpen, setIsOpen] = useState(false);\n  const [editingId, setEditingId] = useState<number | null>(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n\n  const { data: testimonials = [], isLoading } = useQuery({\n    queryKey: [\"/api/testimonials\"],\n    queryFn: () => api.getTestimonials(),\n  });\n\n  const form = useForm<TestimonialFormData>({\n    resolver: zodResolver(insertTestimonialSchema),\n    defaultValues: {\n      name: \"\",\n      role: \"\",\n      company: \"\",\n      content: \"\",\n      rating: 5,\n      avatar: \"\",\n      active: true,\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: TestimonialFormData) => api.createTestimonial(data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial added successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      form.reset();\n      setIsOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to add testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: { id: number; data: Partial<TestimonialFormData> }) =>\n      api.updateTestimonial(data.id, data.data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial updated successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      form.reset();\n      setEditingId(null);\n      setIsOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to update testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteTestimonial(id),\n    onSuccess: () => {\n      toast({ description: \"Testimonial deleted successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to delete testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAvatarUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"image/\")) {\n      toast({ description: \"Please select an image file\", variant: \"destructive\" });\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const base64 = event.target?.result as string;\n      form.setValue(\"avatar\", base64);\n      setAvatarPreview(base64);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleOpenDialog = (testimonial?: Testimonial) => {\n    if (testimonial) {\n      setEditingId(testimonial.id);\n      form.reset({\n        name: testimonial.name,\n        role: testimonial.role || \"\",\n        company: testimonial.company || \"\",\n        content: testimonial.content,\n        rating: testimonial.rating || 5,\n        avatar: testimonial.avatar || \"\",\n        active: testimonial.active !== false,\n      });\n      setAvatarPreview(testimonial.avatar || null);\n    } else {\n      setEditingId(null);\n      form.reset();\n      setAvatarPreview(null);\n    }\n    setIsOpen(true);\n  };\n\n  const handleClearAvatar = () => {\n    form.setValue(\"avatar\", \"\");\n    setAvatarPreview(null);\n  };\n\n  const onSubmit = (data: TestimonialFormData) => {\n    if (editingId) {\n      updateMutation.mutate({ id: editingId, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this testimonial?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredTestimonials = testimonials.filter(\n    (t) =>\n      t.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      t.company?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Testimonials</h1>\n            <p className=\"text-muted-foreground\">Manage customer reviews and feedback</p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-add-testimonial-admin\"\n          >\n            <Plus className=\"w-4 h-4\" /> Add Testimonial\n          </Button>\n        </div>\n\n        {/* Search & Filter */}\n        <div className=\"flex gap-4 bg-card p-4 rounded-lg border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search testimonials...\"\n              className=\"pl-9\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              data-testid=\"input-search-testimonials\"\n            />\n          </div>\n        </div>\n\n        {/* Loading State */}\n        {isLoading && (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        )}\n\n        {/* Testimonials Grid */}\n        {!isLoading && (\n          <>\n            {filteredTestimonials.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <AlertCircle className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                  <p className=\"text-muted-foreground\">\n                    {searchTerm ? \"No testimonials found matching your search\" : \"No testimonials yet. Add one to get started!\"}\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredTestimonials.map((testimonial) => (\n                  <Card key={testimonial.id} className=\"relative\">\n                    <CardHeader>\n                      <div className=\"flex items-start gap-4\">\n                        <Avatar className=\"w-12 h-12\">\n                          <AvatarImage src={testimonial.avatar} />\n                          <AvatarFallback>{testimonial.name.charAt(0)}</AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-semibold\">{testimonial.name}</h3>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {testimonial.role} {testimonial.company && `at ${testimonial.company}`}\n                          </p>\n                          <div className=\"flex gap-1 mt-2\">\n                            {[...Array(testimonial.rating || 5)].map((_, i) => (\n                              <Star\n                                key={i}\n                                className=\"w-4 h-4 fill-yellow-500 text-yellow-500\"\n                                data-testid={`star-${i}`}\n                              />\n                            ))}\n                          </div>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm text-muted-foreground italic\">\"{testimonial.content}\"</p>\n                      <div className=\"flex items-center justify-between mt-4 gap-2\">\n                        <Badge variant={testimonial.active ? \"default\" : \"secondary\"}>\n                          {testimonial.active ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => handleOpenDialog(testimonial)}\n                            data-testid={`button-edit-testimonial-${testimonial.id}`}\n                          >\n                            <Edit className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"text-destructive\"\n                            onClick={() => handleDelete(testimonial.id)}\n                            disabled={deleteMutation.isPending}\n                            data-testid={`button-delete-testimonial-${testimonial.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isOpen} onOpenChange={(open) => {\n        setIsOpen(open);\n        if (!open) setAvatarPreview(null);\n      }}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] flex flex-col\">\n          <DialogHeader>\n            <DialogTitle>{editingId ? \"Edit Testimonial\" : \"Add New Testimonial\"}</DialogTitle>\n          </DialogHeader>\n\n          <div className=\"flex-1 overflow-y-auto pr-4\">\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Client Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"John Smith\" {...field} data-testid=\"input-testimonial-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"role\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Job Title / Role</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"CEO\" {...field} value={field.value ?? \"\"} data-testid=\"input-testimonial-role\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"company\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Company Name</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"TechCorp Inc\" {...field} value={field.value ?? \"\"} data-testid=\"input-testimonial-company\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Testimonial Text</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"What did the client say about your work?\"\n                        className=\"resize-none\"\n                        rows={4}\n                        {...field}\n                        data-testid=\"input-testimonial-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"rating\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Rating (Stars)</FormLabel>\n                      <Select value={(field.value ?? 5).toString()} onValueChange={(v) => field.onChange(parseInt(v))}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-testimonial-rating\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {[5, 4, 3, 2, 1].map((star) => (\n                            <SelectItem key={star} value={star.toString()}>\n                              {star} stars\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"active\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select value={field.value ? \"active\" : \"inactive\"} onValueChange={(v) => field.onChange(v === \"active\")}>\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"avatar\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Avatar Image (Optional)</FormLabel>\n                    \n                    {/* Avatar Preview */}\n                    {avatarPreview && (\n                      <div className=\"relative w-24 h-24 rounded-lg overflow-hidden border border-border\">\n                        <img src={avatarPreview} alt=\"Avatar preview\" className=\"w-full h-full object-cover\" />\n                        <button\n                          type=\"button\"\n                          onClick={handleClearAvatar}\n                          className=\"absolute top-1 right-1 bg-destructive/90 text-white p-1 rounded hover:bg-destructive\"\n                          data-testid=\"button-clear-avatar\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    )}\n\n                    <div className=\"space-y-3\">\n                      {/* File Upload */}\n                      <div>\n                        <label className=\"flex items-center justify-center gap-2 p-4 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors\">\n                          <Upload className=\"w-4 h-4 text-muted-foreground\" />\n                          <span className=\"text-sm text-muted-foreground\">Click to upload image</span>\n                          <input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            onChange={handleAvatarUpload}\n                            className=\"hidden\"\n                            data-testid=\"input-upload-avatar\"\n                          />\n                        </label>\n                        <p className=\"text-xs text-muted-foreground mt-1\">PNG, JPG, GIF, WebP (Max 5MB)</p>\n                      </div>\n\n                      {/* URL Input */}\n                      <div>\n                        <label className=\"text-sm text-muted-foreground mb-2 block\">Or paste image URL</label>\n                        <Input\n                          placeholder=\"https://example.com/avatar.jpg\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          onChange={(e) => {\n                            field.onChange(e);\n                            if (e.target.value && !e.target.value.includes(\"data:\")) {\n                              setAvatarPreview(e.target.value);\n                            }\n                          }}\n                          data-testid=\"input-testimonial-avatar-url\"\n                        />\n                      </div>\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              </form>\n            </Form>\n          </div>\n\n          <div className=\"flex gap-2 justify-end pt-4 border-t border-border mt-6\">\n            <Button variant=\"outline\" onClick={() => setIsOpen(false)} type=\"button\">\n              Cancel\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-submit-testimonial\"\n              onClick={() => form.handleSubmit(onSubmit)()}\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Saving...\n                </>\n              ) : (\n                <>{editingId ? \"Update\" : \"Add\"} Testimonial</>\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":19222,"size_tokens":null},"client/src/components/admin/rich-editor.tsx":{"content":"import { Textarea } from \"@/components/ui/textarea\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Bold, Italic, List, Code, Quote } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface RichEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n}\n\nexport function RichEditor({ value, onChange, placeholder = \"Write your content...\" }: RichEditorProps) {\n  const [showPreview, setShowPreview] = useState(false);\n\n  const insertMarkdown = (before: string, after: string = \"\") => {\n    const textarea = document.querySelector(\"textarea\") as HTMLTextAreaElement;\n    if (!textarea) return;\n\n    const start = textarea.selectionStart;\n    const end = textarea.selectionEnd;\n    const selectedText = value.substring(start, end);\n    const newValue =\n      value.substring(0, start) + before + selectedText + after + value.substring(end);\n    onChange(newValue);\n  };\n\n  const markdownToHtml = (md: string) => {\n    return md\n      .replace(/^### (.*?)$/gm, \"<h3>$1</h3>\")\n      .replace(/^## (.*?)$/gm, \"<h2>$1</h2>\")\n      .replace(/^# (.*?)$/gm, \"<h1>$1</h1>\")\n      .replace(/\\*\\*(.*?)\\*\\*/gm, \"<strong>$1</strong>\")\n      .replace(/\\*(.*?)\\*/gm, \"<em>$1</em>\")\n      .replace(/`(.*?)`/gm, \"<code>$1</code>\")\n      .replace(/\\n/gm, \"<br/>\");\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center justify-between mb-2\">\n        <div className=\"flex gap-1 flex-wrap\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => insertMarkdown(\"**\", \"**\")}\n            title=\"Bold\"\n          >\n            <Bold className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => insertMarkdown(\"*\", \"*\")}\n            title=\"Italic\"\n          >\n            <Italic className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => insertMarkdown(\"- \")}\n            title=\"List\"\n          >\n            <List className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => insertMarkdown(\"`\", \"`\")}\n            title=\"Code\"\n          >\n            <Code className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => insertMarkdown(\"> \")}\n            title=\"Quote\"\n          >\n            <Quote className=\"w-4 h-4\" />\n          </Button>\n        </div>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => setShowPreview(!showPreview)}\n        >\n          {showPreview ? \"Edit\" : \"Preview\"}\n        </Button>\n      </div>\n\n      {showPreview ? (\n        <Card className=\"min-h-64\">\n          <CardContent\n            className=\"p-4 prose prose-sm dark:prose-invert max-w-none\"\n            dangerouslySetInnerHTML={{ __html: markdownToHtml(value) }}\n          />\n        </Card>\n      ) : (\n        <Textarea\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder={placeholder}\n          className=\"min-h-64 font-mono text-sm\"\n        />\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":3327,"size_tokens":null},"client/src/pages/admin/Analytics.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  BarChart, \n  Bar, \n  LineChart, \n  Line, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer, \n  PieChart, \n  Pie, \n  Cell \n} from \"recharts\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Download, RefreshCw, Loader2, Eye, FileText, Briefcase, MessageSquare, Star } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\n\ninterface DashboardStats {\n  totalProjects: number;\n  publishedProjects: number;\n  totalPosts: number;\n  publishedPosts: number;\n  totalMessages: number;\n  unreadMessages: number;\n  totalUsers: number;\n  totalComments: number;\n  totalReviews: number;\n  pendingReviews: number;\n  totalViews: number;\n}\n\nexport default function AdminAnalytics() {\n  const { toast } = useToast();\n  const [dateRange, setDateRange] = useState(\"7days\");\n\n  const { data: stats, isLoading, refetch } = useQuery<DashboardStats>({\n    queryKey: [\"/api/dashboard/stats\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/dashboard/stats\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch stats\");\n      return res.json();\n    },\n  });\n\n  const { data: posts = [] } = useQuery<any[]>({\n    queryKey: [\"/api/posts\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/posts\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch posts\");\n      return res.json();\n    },\n  });\n\n  const { data: projects = [] } = useQuery<any[]>({\n    queryKey: [\"/api/projects\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/projects\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch projects\");\n      return res.json();\n    },\n  });\n\n  // Generate traffic data based on content\n  const generateTrafficData = () => {\n    const days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\n    return days.map((day, i) => ({\n      date: day,\n      posts: Math.floor(Math.random() * 100 + 50),\n      projects: Math.floor(Math.random() * 80 + 40),\n      views: Math.floor(Math.random() * 200 + 100),\n    }));\n  };\n\n  const trafficData = generateTrafficData();\n\n  // Top content by views\n  const topContent = [\n    ...posts.filter(p => p.status === \"Published\").map(p => ({\n      title: p.title,\n      path: `/blog/${p.slug}`,\n      views: p.views || 0,\n      type: \"post\"\n    })),\n    ...projects.filter(p => p.status === \"Published\").map(p => ({\n      title: p.title,\n      path: `/projects/${p.id}`,\n      views: p.views || 0,\n      type: \"project\"\n    }))\n  ].sort((a, b) => b.views - a.views).slice(0, 5);\n\n  // Content status data\n  const contentStatusData = [\n    { name: \"Published Posts\", value: stats?.publishedPosts || 0, color: \"#7c3aed\" },\n    { name: \"Draft Posts\", value: (stats?.totalPosts || 0) - (stats?.publishedPosts || 0), color: \"#8b5cf6\" },\n    { name: \"Published Projects\", value: stats?.publishedProjects || 0, color: \"#3b82f6\" },\n    { name: \"Draft Projects\", value: (stats?.totalProjects || 0) - (stats?.publishedProjects || 0), color: \"#60a5fa\" },\n  ];\n\n  const handleExport = () => {\n    const csvContent = [\n      [\"Analytics Report\", new Date().toLocaleDateString()],\n      [],\n      [\"Metric\", \"Value\"],\n      [\"Total Views\", stats?.totalViews || 0],\n      [\"Total Posts\", stats?.totalPosts || 0],\n      [\"Published Posts\", stats?.publishedPosts || 0],\n      [\"Total Projects\", stats?.totalProjects || 0],\n      [\"Published Projects\", stats?.publishedProjects || 0],\n      [\"Total Messages\", stats?.totalMessages || 0],\n      [\"Unread Messages\", stats?.unreadMessages || 0],\n      [\"Total Comments\", stats?.totalComments || 0],\n      [\"Total Reviews\", stats?.totalReviews || 0],\n      [\"Pending Reviews\", stats?.pendingReviews || 0],\n      [\"Total Users\", stats?.totalUsers || 0],\n    ].map(row => row.join(\",\")).join(\"\\n\");\n\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `analytics_${new Date().toISOString().split(\"T\")[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    toast({ title: \"Success\", description: \"Analytics exported successfully\" });\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Analytics</h1>\n            <p className=\"text-muted-foreground\">Detailed insights into your website performance</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => refetch()}\n              data-testid=\"button-refresh-analytics\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleExport}\n              data-testid=\"button-export-analytics\"\n            >\n              <Download className=\"w-4 h-4 mr-1\" /> Export\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n            <TabsTrigger value=\"content\">Content</TabsTrigger>\n            <TabsTrigger value=\"engagement\">Engagement</TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <Eye className=\"w-4 h-4 text-primary\" /> Total Views\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalViews || 0}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Posts + Projects</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <FileText className=\"w-4 h-4 text-blue-500\" /> Posts\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.publishedPosts}/{stats?.totalPosts}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Published / Total</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <Briefcase className=\"w-4 h-4 text-purple-500\" /> Projects\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.publishedProjects}/{stats?.totalProjects}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Published / Total</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <MessageSquare className=\"w-4 h-4 text-green-500\" /> Messages\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalMessages}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {stats?.unreadMessages} unread\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Traffic Trend</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[300px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <LineChart data={trafficData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.1)\" />\n                      <XAxis dataKey=\"date\" stroke=\"rgba(255,255,255,0.5)\" />\n                      <YAxis stroke=\"rgba(255,255,255,0.5)\" />\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                      <Line type=\"monotone\" dataKey=\"posts\" stroke=\"#7c3aed\" strokeWidth={2} name=\"Posts\" />\n                      <Line type=\"monotone\" dataKey=\"projects\" stroke=\"#3b82f6\" strokeWidth={2} name=\"Projects\" />\n                    </LineChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Top Content</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {topContent.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No content yet</p>\n                    ) : (\n                      topContent.map((item, i) => (\n                        <div key={i} className=\"flex items-center justify-between border-b border-border pb-2 last:border-0\">\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"text-sm font-medium truncate\">{item.title}</p>\n                            <p className=\"text-xs text-muted-foreground\">{item.type}</p>\n                          </div>\n                          <Badge variant=\"outline\">{item.views} views</Badge>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Engagement Metrics</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Comments</span>\n                    <span className=\"font-bold\">{stats?.totalComments}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Reviews</span>\n                    <span className=\"font-bold\">{stats?.totalReviews}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-yellow-500/5 rounded-lg\">\n                    <span className=\"text-sm\">Pending Reviews</span>\n                    <span className=\"font-bold text-yellow-500\">{stats?.pendingReviews}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Users</span>\n                    <span className=\"font-bold\">{stats?.totalUsers}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Content Tab */}\n          <TabsContent value=\"content\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Posts Overview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Posts</span>\n                      <Badge variant=\"default\">{stats?.totalPosts}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Published</span>\n                      <Badge variant=\"outline\" className=\"bg-green-500/10\">{stats?.publishedPosts}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Draft</span>\n                      <Badge variant=\"secondary\">{(stats?.totalPosts || 0) - (stats?.publishedPosts || 0)}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Post Views</span>\n                      <Badge variant=\"outline\">{posts.reduce((sum, p) => sum + (p.views || 0), 0)}</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Projects Overview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Projects</span>\n                      <Badge variant=\"default\">{stats?.totalProjects}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Published</span>\n                      <Badge variant=\"outline\" className=\"bg-blue-500/10\">{stats?.publishedProjects}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Draft</span>\n                      <Badge variant=\"secondary\">{(stats?.totalProjects || 0) - (stats?.publishedProjects || 0)}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Project Views</span>\n                      <Badge variant=\"outline\">{projects.reduce((sum, p) => sum + (p.views || 0), 0)}</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Content Distribution</CardTitle>\n              </CardHeader>\n              <CardContent className=\"flex justify-center\">\n                <div className=\"h-[300px] w-full max-w-sm\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <PieChart>\n                      <Pie\n                        data={contentStatusData.filter(d => d.value > 0)}\n                        innerRadius={60}\n                        outerRadius={100}\n                        paddingAngle={5}\n                        dataKey=\"value\"\n                      >\n                        {contentStatusData.map((entry, index) => (\n                          <Cell key={`cell-${index}`} fill={entry.color} />\n                        ))}\n                      </Pie>\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                    </PieChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Engagement Tab */}\n          <TabsContent value=\"engagement\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Total Comments</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold\">{stats?.totalComments}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">User interactions</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Total Reviews</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold\">{stats?.totalReviews}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Project ratings</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Pending Reviews</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-yellow-500\">{stats?.pendingReviews}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Awaiting approval</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Message Activity</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-4 bg-primary/5 rounded-lg\">\n                    <div>\n                      <p className=\"font-semibold\">Total Messages</p>\n                      <p className=\"text-xs text-muted-foreground\">All incoming messages</p>\n                    </div>\n                    <div className=\"text-2xl font-bold\">{stats?.totalMessages}</div>\n                  </div>\n                  <div className=\"flex justify-between items-center p-4 bg-red-500/5 rounded-lg\">\n                    <div>\n                      <p className=\"font-semibold\">Unread Messages</p>\n                      <p className=\"text-xs text-muted-foreground\">Require attention</p>\n                    </div>\n                    <div className=\"text-2xl font-bold text-red-500\">{stats?.unreadMessages}</div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Engagement Bar Chart</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[300px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <BarChart data={[\n                      { name: \"Comments\", value: stats?.totalComments || 0 },\n                      { name: \"Reviews\", value: stats?.totalReviews || 0 },\n                      { name: \"Messages\", value: stats?.totalMessages || 0 },\n                    ]}>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.1)\" />\n                      <XAxis dataKey=\"name\" stroke=\"rgba(255,255,255,0.5)\" />\n                      <YAxis stroke=\"rgba(255,255,255,0.5)\" />\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                      <Bar dataKey=\"value\" fill=\"#7c3aed\" />\n                    </BarChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":19880,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/admin/batch-actions.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Trash2, Archive } from \"lucide-react\";\n\ninterface BatchActionsProps {\n  selectedCount: number;\n  onSelectAll: (selected: boolean) => void;\n  onDelete: () => void;\n  onArchive?: () => void;\n  totalCount: number;\n}\n\nexport function BatchActions({ selectedCount, onSelectAll, onDelete, onArchive, totalCount }: BatchActionsProps) {\n  if (selectedCount === 0) return null;\n\n  return (\n    <div className=\"flex items-center gap-4 p-4 bg-primary/10 rounded-lg border border-primary/20 mb-4\">\n      <div className=\"flex items-center gap-2 flex-1\">\n        <Checkbox\n          checked={selectedCount === totalCount}\n          onCheckedChange={onSelectAll}\n        />\n        <span className=\"text-sm font-medium\">{selectedCount} selected</span>\n      </div>\n      <div className=\"flex gap-2\">\n        {onArchive && (\n          <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n            <Archive className=\"w-4 h-4\" /> Archive\n          </Button>\n        )}\n        <Button variant=\"destructive\" size=\"sm\" className=\"gap-2\" onClick={onDelete}>\n          <Trash2 className=\"w-4 h-4\" /> Delete\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/components/sections/Contact.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { Mail, MapPin, Phone, Send, Loader2, ShieldCheck } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useRecaptcha } from \"@/hooks/use-recaptcha\";\n\nconst FloatingLabelInput = ({ \n  name, \n  value, \n  onChange, \n  label, \n  type = \"text\", \n  required = false \n}: { \n  name: string; \n  value: string; \n  onChange: (e: React.ChangeEvent<HTMLInputElement>) => void; \n  label: string; \n  type?: string; \n  required?: boolean; \n}) => {\n  const [isFocused, setIsFocused] = useState(false);\n\n  return (\n    <div className=\"relative pt-4\">\n      <input\n        type={type}\n        name={name}\n        value={value}\n        onChange={onChange}\n        required={required}\n        onFocus={() => setIsFocused(true)}\n        onBlur={() => setIsFocused(false)}\n        className=\"peer w-full bg-transparent border-b-2 border-border py-2 text-foreground placeholder-transparent focus:outline-none focus:border-primary transition-colors\"\n        placeholder={label}\n        data-testid={`input-contact-${name}`}\n      />\n      <label\n        className={`absolute left-0 top-2 text-sm transition-all duration-300 pointer-events-none\n          ${isFocused || value ? \"-top-0 text-xs text-primary\" : \"top-6 text-muted-foreground\"}\n        `}\n      >\n        {label}\n      </label>\n    </div>\n  );\n};\n\nconst FloatingLabelTextarea = ({ \n  name, \n  value, \n  onChange, \n  label, \n  required = false \n}: { \n  name: string; \n  value: string; \n  onChange: (e: React.ChangeEvent<HTMLTextAreaElement>) => void; \n  label: string; \n  required?: boolean; \n}) => {\n  const [isFocused, setIsFocused] = useState(false);\n\n  return (\n    <div className=\"relative pt-4\">\n      <textarea\n        name={name}\n        value={value}\n        onChange={onChange}\n        required={required}\n        onFocus={() => setIsFocused(true)}\n        onBlur={() => setIsFocused(false)}\n        className=\"peer w-full bg-transparent border-b-2 border-border py-2 text-foreground placeholder-transparent focus:outline-none focus:border-primary transition-colors min-h-[120px] resize-none\"\n        placeholder={label}\n        data-testid={`textarea-contact-${name}`}\n      />\n      <label\n        className={`absolute left-0 top-2 text-sm transition-all duration-300 pointer-events-none\n          ${isFocused || value ? \"-top-0 text-xs text-primary\" : \"top-6 text-muted-foreground\"}\n        `}\n      >\n        {label}\n      </label>\n    </div>\n  );\n};\n\nfunction SocialIcon({ name }: { name: string }) {\n  switch (name.toLowerCase()) {\n    case \"facebook\":\n      return (\n        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path d=\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\"/>\n        </svg>\n      );\n    case \"twitter\":\n      return (\n        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path d=\"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z\"/>\n        </svg>\n      );\n    case \"instagram\":\n      return (\n        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path d=\"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z\"/>\n        </svg>\n      );\n    case \"linkedin\":\n      return (\n        <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path d=\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"/>\n        </svg>\n      );\n    default:\n      return <div className=\"w-4 h-4 bg-current rounded-full\" />;\n  }\n}\n\nexport function Contact() {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const { toast } = useToast();\n  const [formData, setFormData] = useState({\n    name: \"\",\n    email: \"\",\n    subject: \"\",\n    message: \"\"\n  });\n  const [honeypot, setHoneypot] = useState(\"\");\n  const turnstileRef = useRef<HTMLDivElement>(null);\n\n  const { \n    isEnabled: captchaEnabled, \n    isLoaded: captchaLoaded,\n    captchaType,\n    executeRecaptcha, \n    renderTurnstile,\n    resetTurnstile,\n    honeypotFieldName,\n    error: captchaError \n  } = useRecaptcha({ formType: 'contact', action: 'contact_form' });\n\n  const { data: settings } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n    staleTime: 1000 * 60 * 5,\n  });\n\n  const contactTitle = settings?.contactTitle || \"Let's Talk\";\n  const contactSubtitle = settings?.contactSubtitle || \"Have a project in mind or just want to say hi? I'm always open to discussing new projects, creative ideas or opportunities to be part of your visions.\";\n  const contactEmail = settings?.contactEmail || \"loideveloper@example.com\";\n  const contactPhone = settings?.contactPhone || \"+84 123 456 789\";\n  const contactAddress = settings?.contactAddress || \"Ho Chi Minh City, Vietnam\";\n  const socialFacebook = settings?.socialFacebook || \"\";\n  const socialTwitter = settings?.socialTwitter || \"\";\n  const socialInstagram = settings?.socialInstagram || \"\";\n  const socialLinkedin = settings?.socialLinkedin || \"\";\n\n  useEffect(() => {\n    const prefillData = sessionStorage.getItem('contactFormData');\n    if (prefillData) {\n      try {\n        const data = JSON.parse(prefillData);\n        setFormData(prev => ({\n          ...prev,\n          subject: data.subject || \"\",\n          message: data.message || \"\"\n        }));\n        sessionStorage.removeItem('contactFormData');\n      } catch (error) {\n        console.error('Failed to parse prefill data:', error);\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    const handlePrefill = (event: CustomEvent<{ subject: string; message: string }>) => {\n      setFormData(prev => ({\n        ...prev,\n        subject: event.detail.subject || \"\",\n        message: event.detail.message || \"\"\n      }));\n    };\n\n    window.addEventListener('contact:prefill', handlePrefill as EventListener);\n    return () => {\n      window.removeEventListener('contact:prefill', handlePrefill as EventListener);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (captchaType === 'cloudflare' && captchaLoaded && turnstileRef.current) {\n      renderTurnstile('turnstile-container');\n    }\n  }, [captchaType, captchaLoaded, renderTurnstile]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (honeypot) {\n      toast({\n        title: \"Message sent!\",\n        description: \"Thank you for reaching out.\",\n      });\n      return;\n    }\n\n    setIsSubmitting(true);\n    \n    try {\n      let captchaToken: string | null = null;\n      \n      if (captchaEnabled) {\n        captchaToken = await executeRecaptcha();\n        if (captchaError) {\n          toast({\n            title: \"Verification Failed\",\n            description: captchaError,\n            variant: \"destructive\"\n          });\n          setIsSubmitting(false);\n          return;\n        }\n      }\n\n      await api.createMessage({\n        sender: formData.name,\n        email: formData.email,\n        subject: formData.subject,\n        message: formData.message,\n        captchaToken: captchaToken || undefined,\n        captchaType: captchaType || undefined\n      });\n\n      toast({\n        title: \"Message sent!\",\n        description: \"Thank you for reaching out. I'll get back to you shortly.\",\n      });\n      setFormData({ name: \"\", email: \"\", subject: \"\", message: \"\" });\n      \n      if (captchaType === 'cloudflare') {\n        resetTurnstile();\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to send message. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const socialLinks = [\n    { name: \"Facebook\", url: socialFacebook, color: \"hover:text-blue-600\" },\n    { name: \"Twitter\", url: socialTwitter, color: \"hover:text-sky-500\" },\n    { name: \"Instagram\", url: socialInstagram, color: \"hover:text-pink-500\" },\n    { name: \"LinkedIn\", url: socialLinkedin, color: \"hover:text-blue-700\" }\n  ].filter(s => s.url);\n\n  return (\n    <section id=\"contact\" className=\"py-24 bg-muted/30 relative\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"grid md:grid-cols-2 gap-16 items-start\">\n          <div className=\"space-y-8\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h2 className=\"text-3xl md:text-4xl font-heading font-bold mb-4\">\n                {contactTitle.includes(\" \") ? (\n                  <>\n                    {contactTitle.split(\" \").slice(0, -1).join(\" \")} <span className=\"text-primary\">{contactTitle.split(\" \").slice(-1)}</span>\n                  </>\n                ) : (\n                  <>Let's <span className=\"text-primary\">Talk</span></>\n                )}\n              </h2>\n              <p className=\"text-muted-foreground text-lg leading-relaxed\">\n                {contactSubtitle}\n              </p>\n            </motion.div>\n\n            <div className=\"space-y-6 pt-4\">\n              {[\n                { icon: Mail, label: \"Email\", value: contactEmail },\n                { icon: Phone, label: \"Phone\", value: contactPhone },\n                { icon: MapPin, label: \"Address\", value: contactAddress },\n              ].map((item, i) => (\n                <motion.div \n                  key={i}\n                  initial={{ x: -20, opacity: 0 }}\n                  whileInView={{ x: 0, opacity: 1 }}\n                  transition={{ delay: i * 0.1 }}\n                  className=\"flex items-center gap-6 group p-4 rounded-xl hover:bg-card transition-colors\"\n                >\n                  <div className=\"w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center text-primary group-hover:scale-110 group-hover:bg-primary group-hover:text-white transition-all duration-300\">\n                    <item.icon className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <div className=\"text-sm text-muted-foreground uppercase tracking-wide font-semibold mb-1\">{item.label}</div>\n                    <div className=\"font-medium text-lg\">{item.value}</div>\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n\n            {socialLinks.length > 0 && (\n              <div className=\"pt-8\">\n                <h3 className=\"text-lg font-bold mb-4\">Follow Me</h3>\n                <div className=\"flex gap-4\">\n                  {socialLinks.map((social, i) => (\n                    <motion.a\n                      key={i}\n                      href={social.url}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      whileHover={{ rotate: 360, scale: 1.2 }}\n                      transition={{ duration: 0.5 }}\n                      className={`w-10 h-10 rounded-full bg-card border border-border flex items-center justify-center text-muted-foreground ${social.color} transition-colors shadow-sm`}\n                      data-testid={`link-social-${social.name.toLowerCase()}`}\n                    >\n                      <span className=\"sr-only\">{social.name}</span>\n                      <SocialIcon name={social.name} />\n                    </motion.a>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            whileInView={{ opacity: 1, x: 0 }}\n            viewport={{ once: true }}\n            className=\"bg-card p-8 md:p-10 rounded-3xl border border-border/50 shadow-xl backdrop-blur-sm relative overflow-hidden\"\n          >\n            <div className=\"absolute -top-20 -right-20 w-64 h-64 bg-primary/5 rounded-full blur-3xl pointer-events-none\" />\n             \n            <form onSubmit={handleSubmit} className=\"space-y-8 relative z-10\" data-testid=\"form-contact\">\n              <input\n                type=\"text\"\n                name={honeypotFieldName}\n                value={honeypot}\n                onChange={(e) => setHoneypot(e.target.value)}\n                autoComplete=\"off\"\n                tabIndex={-1}\n                style={{ position: 'absolute', left: '-9999px', opacity: 0, height: 0, width: 0 }}\n                aria-hidden=\"true\"\n              />\n              \n              <div className=\"grid md:grid-cols-2 gap-8\">\n                <FloatingLabelInput\n                  name=\"name\"\n                  value={formData.name}\n                  onChange={handleChange}\n                  label=\"Full Name\"\n                  required\n                />\n                <FloatingLabelInput\n                  name=\"email\"\n                  value={formData.email}\n                  onChange={handleChange}\n                  label=\"Email Address\"\n                  type=\"email\"\n                  required\n                />\n              </div>\n              \n              <FloatingLabelInput\n                name=\"subject\"\n                value={formData.subject}\n                onChange={handleChange}\n                label=\"Subject\"\n                required\n              />\n              \n              <FloatingLabelTextarea\n                name=\"message\"\n                value={formData.message}\n                onChange={handleChange}\n                label=\"Message\"\n                required\n              />\n\n              {captchaEnabled && captchaType === 'cloudflare' && (\n                <div \n                  id=\"turnstile-container\" \n                  ref={turnstileRef}\n                  className=\"flex justify-center\"\n                  data-testid=\"turnstile-container\"\n                />\n              )}\n\n              {captchaEnabled && captchaType && captchaType !== 'disabled' && (\n                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                  <ShieldCheck className=\"w-4 h-4\" />\n                  <span>\n                    {captchaType === 'google' && 'Protected by reCAPTCHA'}\n                    {captchaType === 'cloudflare' && 'Protected by Cloudflare Turnstile'}\n                    {captchaType === 'local' && 'Protected by spam filter'}\n                  </span>\n                </div>\n              )}\n\n              <Button \n                type=\"submit\" \n                size=\"lg\" \n                className=\"w-full rounded-full h-12 text-base font-medium relative overflow-hidden group\" \n                disabled={isSubmitting}\n                data-testid=\"button-submit-contact\"\n              >\n                <span className=\"relative z-10 flex items-center justify-center gap-2\">\n                  {isSubmitting ? (\n                    <>\n                      <Loader2 className=\"h-5 w-5 animate-spin\" /> Sending...\n                    </>\n                  ) : (\n                    <>\n                      Send Message <Send className=\"h-4 w-4 group-hover:translate-x-1 transition-transform\" />\n                    </>\n                  )}\n                </span>\n                <div className=\"absolute inset-0 bg-gradient-to-r from-primary via-purple-600 to-primary opacity-0 group-hover:opacity-100 transition-opacity duration-500\" />\n              </Button>\n            </form>\n          </motion.div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":17325,"size_tokens":null},"client/src/pages/admin/Newsletter.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport { useState, useEffect } from \"react\";\nimport {\n  Mail,\n  Save,\n  Loader2\n} from \"lucide-react\";\n\ninterface NewsletterSettings {\n  enabled: boolean;\n  title: string;\n  subtitle: string;\n  description: string;\n  placeholder: string;\n  buttonText: string;\n  successMessage: string;\n  backgroundImage?: string;\n}\n\nexport default function AdminNewsletter() {\n  const { toast } = useToast();\n  const [localSettings, setLocalSettings] = useState<NewsletterSettings>({\n    enabled: false,\n    title: \"Subscribe to Our Newsletter\",\n    subtitle: \"Get the latest updates\",\n    description: \"Stay informed with our weekly newsletter\",\n    placeholder: \"Enter your email\",\n    buttonText: \"Subscribe\",\n    successMessage: \"Thanks for subscribing!\",\n  });\n\n  const { data: settings, isLoading } = useQuery<NewsletterSettings>({\n    queryKey: ['/api/newsletter/settings'],\n  });\n\n  useEffect(() => {\n    if (settings && Object.keys(settings).length > 0) {\n      setLocalSettings(settings as NewsletterSettings);\n    }\n  }, [settings]);\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (newSettings: NewsletterSettings) => {\n      const response = await apiRequest('POST', '/api/newsletter/settings', newSettings);\n      return response as unknown as NewsletterSettings;\n    },\n    onSuccess: (data: NewsletterSettings) => {\n      setLocalSettings(data);\n      toast({ title: \"Newsletter settings saved successfully\" });\n      queryClient.invalidateQueries({ queryKey: ['/api/newsletter/settings'] });\n      queryClient.setQueryData(['/api/newsletter/settings'], data);\n    },\n    onError: () => {\n      toast({ title: \"Failed to save settings\", variant: \"destructive\" });\n    }\n  });\n\n  const handleSave = () => {\n    updateSettingsMutation.mutate(localSettings);\n  };\n\n  const handleInputChange = (field: keyof NewsletterSettings, value: any) => {\n    setLocalSettings(prev => ({ ...prev, [field]: value }));\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Newsletter Management</h1>\n            <p className=\"text-muted-foreground\">Configure and manage newsletter popup on homepage</p>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Settings Form */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> Newsletter Popup Settings\n                </CardTitle>\n                <CardDescription>Configure the popup that appears on the homepage</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Activation Toggle */}\n                <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable Newsletter Popup</p>\n                    <p className=\"text-xs text-muted-foreground\">Show newsletter popup when users visit homepage</p>\n                  </div>\n                  <Switch\n                    checked={localSettings.enabled}\n                    onCheckedChange={(v) => handleInputChange('enabled', v)}\n                    data-testid=\"switch-newsletter-enabled\"\n                  />\n                </div>\n\n                {localSettings.enabled && (\n                  <>\n                    {/* Title */}\n                    <div>\n                      <Label htmlFor=\"title\">Popup Title</Label>\n                      <Input\n                        id=\"title\"\n                        value={localSettings.title}\n                        onChange={(e) => handleInputChange('title', e.target.value)}\n                        placeholder=\"Subscribe to Our Newsletter\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-title\"\n                      />\n                    </div>\n\n                    {/* Subtitle */}\n                    <div>\n                      <Label htmlFor=\"subtitle\">Subtitle</Label>\n                      <Input\n                        id=\"subtitle\"\n                        value={localSettings.subtitle}\n                        onChange={(e) => handleInputChange('subtitle', e.target.value)}\n                        placeholder=\"Get the latest updates\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-subtitle\"\n                      />\n                    </div>\n\n                    {/* Description */}\n                    <div>\n                      <Label htmlFor=\"description\">Description</Label>\n                      <div className=\"mt-2\" data-testid=\"editor-newsletter-description\">\n                        <RichTextEditor\n                          value={localSettings.description}\n                          onChange={(value) => handleInputChange('description', value)}\n                          placeholder=\"Stay informed with our weekly newsletter\"\n                        />\n                      </div>\n                    </div>\n\n                    {/* Email Placeholder */}\n                    <div>\n                      <Label htmlFor=\"placeholder\">Email Input Placeholder</Label>\n                      <Input\n                        id=\"placeholder\"\n                        value={localSettings.placeholder}\n                        onChange={(e) => handleInputChange('placeholder', e.target.value)}\n                        placeholder=\"Enter your email\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-placeholder\"\n                      />\n                    </div>\n\n                    {/* Button Text */}\n                    <div>\n                      <Label htmlFor=\"buttonText\">Subscribe Button Text</Label>\n                      <Input\n                        id=\"buttonText\"\n                        value={localSettings.buttonText}\n                        onChange={(e) => handleInputChange('buttonText', e.target.value)}\n                        placeholder=\"Subscribe\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-button\"\n                      />\n                    </div>\n\n                    {/* Success Message */}\n                    <div>\n                      <Label htmlFor=\"successMessage\">Success Message</Label>\n                      <Input\n                        id=\"successMessage\"\n                        value={localSettings.successMessage}\n                        onChange={(e) => handleInputChange('successMessage', e.target.value)}\n                        placeholder=\"Thanks for subscribing!\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-success\"\n                      />\n                    </div>\n\n                    {/* Save Button */}\n                    <Button \n                      onClick={handleSave} \n                      disabled={updateSettingsMutation.isPending}\n                      className=\"w-full\"\n                      data-testid=\"button-save-newsletter\"\n                    >\n                      {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                      <Save className=\"w-4 h-4 mr-2\" /> Save Newsletter Settings\n                    </Button>\n                  </>\n                )}\n\n                {!localSettings.enabled && (\n                  <div className=\"p-4 bg-muted rounded-lg text-center text-sm text-muted-foreground\">\n                    Enable the toggle above to configure newsletter popup settings\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":8758,"size_tokens":null},"client/src/hooks/use-theme.tsx":{"content":"import { useTheme as useNextTheme } from \"next-themes\";\n\nexport function useTheme() {\n  const { theme, setTheme, resolvedTheme } = useNextTheme();\n  \n  const toggleTheme = () => {\n    const newTheme = resolvedTheme === \"dark\" ? \"light\" : \"dark\";\n    setTheme(newTheme);\n  };\n\n  return { \n    theme: (resolvedTheme as \"dark\" | \"light\") || \"dark\", \n    toggleTheme,\n    setTheme\n  };\n}\n","path":null,"size_bytes":384,"size_tokens":null},"client/src/pages/admin/Categories.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Edit, Trash, GripVertical, Folder } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminCategories() {\n  const [categories] = useState([\n    { id: 1, name: \"Web Development\", slug: \"web-dev\", count: 12, color: \"#7c3aed\" },\n    { id: 2, name: \"Mobile Apps\", slug: \"mobile\", count: 8, color: \"#3b82f6\" },\n    { id: 3, name: \"UI/UX Design\", slug: \"design\", count: 15, color: \"#10b981\" },\n    { id: 4, name: \"DevOps\", slug: \"devops\", count: 5, color: \"#f59e0b\" },\n  ]);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Categories</h1>\n            <p className=\"text-muted-foreground\">Manage content categories and tags</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Add Category\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* Categories */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Categories</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {categories.map((cat) => (\n                <div key={cat.id} className=\"flex items-center gap-4 p-3 border rounded-lg group hover:border-primary/50 transition-colors\">\n                  <div className=\"cursor-grab text-muted-foreground\">\n                    <GripVertical className=\"w-5 h-5\" />\n                  </div>\n                  <div className=\"w-8 h-8 rounded-full flex items-center justify-center\" style={{ backgroundColor: `${cat.color}20` }}>\n                    <Folder className=\"w-4 h-4\" style={{ color: cat.color }} />\n                  </div>\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-medium\">{cat.name}</h4>\n                    <p className=\"text-xs text-muted-foreground\">Slug: {cat.slug}</p>\n                  </div>\n                  <Badge variant=\"secondary\">{cat.count} items</Badge>\n                  <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\n                      <Edit className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 text-destructive\">\n                      <Trash className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n\n          {/* Add New Category */}\n          <Card className=\"border-primary/20 bg-primary/5\">\n            <CardHeader>\n              <CardTitle>Add New Category</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Category Name</label>\n                <Input placeholder=\"e.g., Web Development\" />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Slug</label>\n                <Input placeholder=\"e.g., web-development\" />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Color</label>\n                <div className=\"flex gap-2\">\n                  <Input type=\"color\" defaultValue=\"#7c3aed\" className=\"w-16 h-10\" />\n                  <Input defaultValue=\"#7c3aed\" className=\"font-mono\" />\n                </div>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Description (optional)</label>\n                <Input placeholder=\"Brief description...\" />\n              </div>\n              <Button className=\"w-full\">Create Category</Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/context/MockContext.tsx":{"content":"import { createContext, useContext, useState, useEffect, useCallback, type ReactNode } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n\nexport interface Project {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  shortDescription: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  views: number;\n  featured: boolean;\n  createdAt: Date | null;\n  updatedAt: Date | null;\n}\n\nexport interface Message {\n  id: number;\n  sender: string;\n  email: string;\n  subject: string | null;\n  message: string;\n  tag: string | null;\n  read: boolean;\n  archived: boolean;\n  createdAt: Date | null;\n}\n\nexport interface Post {\n  id: number;\n  title: string;\n  slug: string;\n  content: string | null;\n  excerpt: string | null;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  views: number;\n  featured: boolean;\n  featuredImage: string | null;\n  tags: string[];\n  createdAt: Date | null;\n  updatedAt: Date | null;\n  publishedAt: Date | null;\n}\n\nexport interface User {\n  id: number;\n  username: string;\n  name: string;\n  email: string;\n  role: \"Super Admin\" | \"Admin\" | \"Editor\" | \"Subscriber\";\n  status: \"Active\" | \"Inactive\";\n  avatar: string | null;\n  lastActive: Date | null;\n  createdAt: Date | null;\n}\n\nexport interface ActivityLog {\n  id: number;\n  action: string;\n  userId: number | null;\n  userName: string | null;\n  type: \"info\" | \"warning\" | \"success\" | \"error\";\n  metadata: any;\n  createdAt: Date | null;\n}\n\nexport interface Notification {\n  id: number;\n  message: string;\n  type: \"system\" | \"security\" | \"update\";\n  read: boolean;\n  userId: number | null;\n  createdAt: Date | null;\n}\n\ninterface MockContextType {\n  isAuthenticated: boolean;\n  isCheckingAuth: boolean;\n  currentUser: User | null;\n  login: (username: string, password: string) => Promise<boolean>;\n  logout: () => void;\n  posts: Post[];\n  addPost: (post: Omit<Post, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => Promise<void>;\n  updatePost: (id: number, post: Partial<Post>) => Promise<void>;\n  deletePost: (id: number) => Promise<void>;\n  projects: Project[];\n  addProject: (project: Omit<Project, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => Promise<void>;\n  updateProject: (id: number, project: Partial<Project>) => Promise<void>;\n  deleteProject: (id: number) => Promise<void>;\n  users: User[];\n  addUser: (user: any) => Promise<void>;\n  updateUser: (id: number, user: Partial<User>) => Promise<void>;\n  deleteUser: (id: number) => Promise<void>;\n  messages: Message[];\n  markAsRead: (id: number) => Promise<void>;\n  deleteMessage: (id: number) => Promise<void>;\n  refetchMessages: () => void;\n  activityLogs: ActivityLog[];\n  notifications: Notification[];\n  isLoading: boolean;\n  refetchAll: () => void;\n}\n\nconst MockContext = createContext<MockContextType | undefined>(undefined);\n\nexport function MockProvider({ children }: { children: ReactNode }) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isCheckingAuth, setIsCheckingAuth] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    const verifySession = async () => {\n      const savedAuth = localStorage.getItem(\"isAuthenticated\");\n      if (savedAuth === \"true\") {\n        try {\n          const user = await api.getCurrentUser();\n          setIsAuthenticated(true);\n          setCurrentUser(user);\n          localStorage.setItem(\"currentUser\", JSON.stringify(user));\n        } catch (error) {\n          localStorage.removeItem(\"isAuthenticated\");\n          localStorage.removeItem(\"currentUser\");\n          setIsAuthenticated(false);\n          setCurrentUser(null);\n        } finally {\n          setIsCheckingAuth(false);\n        }\n      } else {\n        setIsCheckingAuth(false);\n      }\n    };\n    verifySession();\n  }, []);\n\n  const { data: projects = [], isLoading: projectsLoading, refetch: refetchProjects } = useQuery({\n    queryKey: ['projects'],\n    queryFn: () => api.getProjects(),\n    staleTime: 30000,\n  });\n\n  const { data: posts = [], isLoading: postsLoading, refetch: refetchPosts } = useQuery({\n    queryKey: ['posts'],\n    queryFn: () => api.getPosts(),\n    staleTime: 30000,\n  });\n\n  const { data: users = [], isLoading: usersLoading, refetch: refetchUsers } = useQuery({\n    queryKey: ['users'],\n    queryFn: () => api.getUsers(),\n    staleTime: 30000,\n    enabled: isAuthenticated,\n  });\n\n  const { data: messages = [], isLoading: messagesLoading, refetch: refetchMessages } = useQuery({\n    queryKey: ['messages'],\n    queryFn: () => api.getMessages(),\n    staleTime: 30000,\n    enabled: isAuthenticated,\n  });\n\n  const { data: activityLogs = [], refetch: refetchActivityLogs } = useQuery({\n    queryKey: ['activityLogs'],\n    queryFn: () => api.getActivityLogs(20),\n    staleTime: 30000,\n    enabled: isAuthenticated,\n  });\n\n  const { data: notifications = [], refetch: refetchNotifications } = useQuery({\n    queryKey: ['notifications'],\n    queryFn: () => api.getNotifications(),\n    staleTime: 30000,\n    enabled: isAuthenticated,\n  });\n\n  const isLoading = projectsLoading || postsLoading || usersLoading || messagesLoading;\n\n  const refetchAll = useCallback(() => {\n    refetchProjects();\n    refetchPosts();\n    refetchUsers();\n    refetchMessages();\n    refetchActivityLogs();\n    refetchNotifications();\n  }, [refetchProjects, refetchPosts, refetchUsers, refetchMessages, refetchActivityLogs, refetchNotifications]);\n\n  const login = async (username: string, password: string): Promise<boolean> => {\n    try {\n      const response = await api.login(username, password);\n      setIsAuthenticated(true);\n      setCurrentUser(response.user);\n      localStorage.setItem(\"isAuthenticated\", \"true\");\n      localStorage.setItem(\"currentUser\", JSON.stringify(response.user));\n      toast({ title: \"Login Successful\", description: `Welcome back, ${response.user.name}!` });\n      return true;\n    } catch (error: any) {\n      toast({ title: \"Login Failed\", description: error.message, variant: \"destructive\" });\n      return false;\n    }\n  };\n\n  const logout = async () => {\n    try {\n      await api.logout();\n    } catch (error) {\n      console.error(\"Logout API error:\", error);\n    }\n    setIsAuthenticated(false);\n    setCurrentUser(null);\n    localStorage.removeItem(\"isAuthenticated\");\n    localStorage.removeItem(\"currentUser\");\n    toast({ title: \"Logged Out\", description: \"You have been logged out successfully.\" });\n  };\n\n  const addPost = async (post: Omit<Post, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => {\n    try {\n      await api.createPost(post);\n      await refetchPosts();\n      toast({ title: \"Post Created\", description: `${post.title} has been saved.` });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const updatePost = async (id: number, post: Partial<Post>) => {\n    try {\n      await api.updatePost(id, post);\n      await refetchPosts();\n      toast({ title: \"Post Updated\", description: \"Post has been updated.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const deletePost = async (id: number) => {\n    try {\n      await api.deletePost(id);\n      await refetchPosts();\n      toast({ title: \"Post Deleted\", description: \"The post has been removed.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const addProject = async (project: Omit<Project, 'id' | 'createdAt' | 'updatedAt' | 'views'>) => {\n    try {\n      await api.createProject(project);\n      await refetchProjects();\n      toast({ title: \"Project Added\", description: `${project.title} has been created.` });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const updateProject = async (id: number, project: Partial<Project>) => {\n    try {\n      await api.updateProject(id, project);\n      await refetchProjects();\n      toast({ title: \"Project Updated\", description: \"Project has been updated.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const deleteProject = async (id: number) => {\n    try {\n      await api.deleteProject(id);\n      await refetchProjects();\n      toast({ title: \"Project Deleted\", description: \"The project has been removed.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const addUser = async (user: any) => {\n    try {\n      await api.register(user);\n      await refetchUsers();\n      toast({ title: \"User Added\", description: `${user.name} has been invited.` });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const updateUser = async (id: number, user: Partial<User>) => {\n    try {\n      await api.updateUser(id, user);\n      await refetchUsers();\n      toast({ title: \"User Updated\", description: \"User has been updated.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const deleteUser = async (id: number) => {\n    try {\n      await api.deleteUser(id);\n      await refetchUsers();\n      toast({ title: \"User Removed\", description: \"User access has been revoked.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const markAsRead = async (id: number) => {\n    try {\n      await api.markMessageAsRead(id);\n      queryClient.invalidateQueries({ queryKey: ['messages'] });\n      toast({ title: \"Marked as Read\", description: \"Message marked as read.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const deleteMessage = async (id: number) => {\n    try {\n      await api.deleteMessage(id);\n      queryClient.invalidateQueries({ queryKey: ['messages'] });\n      toast({ title: \"Message Deleted\", description: \"The message has been removed.\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  return (\n    <MockContext.Provider value={{\n      isAuthenticated,\n      isCheckingAuth,\n      currentUser,\n      login,\n      logout,\n      posts,\n      addPost,\n      updatePost,\n      deletePost,\n      projects,\n      addProject,\n      updateProject,\n      deleteProject,\n      users,\n      addUser,\n      updateUser,\n      deleteUser,\n      messages,\n      markAsRead,\n      deleteMessage,\n      refetchMessages,\n      activityLogs,\n      notifications,\n      isLoading,\n      refetchAll\n    }}>\n      {children}\n    </MockContext.Provider>\n  );\n}\n\nexport const useMockData = () => {\n  const context = useContext(MockContext);\n  if (!context) throw new Error(\"useMockData must be used within a MockProvider\");\n  return context;\n};","path":null,"size_bytes":11343,"size_tokens":null},"client/src/pages/admin/Settings.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Save, \n  Loader2, \n  Globe, \n  User, \n  Mail, \n  MapPin, \n  Phone, \n  Share2, \n  FileText, \n  Shield, \n  LayoutDashboard, \n  AlertCircle,\n  Key,\n  Eye,\n  EyeOff,\n  Smartphone,\n  LogOut,\n  Clock,\n  Download,\n  Image as ImageIcon,\n  Link as LinkIcon,\n  Youtube\n} from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\n\ninterface SiteSettings {\n  siteTitle: string;\n  tagline: string;\n  contactEmail: string;\n  heroTitle: string;\n  heroSubtitle: string;\n  heroDescription: string;\n  heroStatus: string;\n  heroCTA: string;\n  aboutTitle: string;\n  aboutSubtitle: string;\n  aboutDescription: string;\n  aboutDescription2: string;\n  aboutName: string;\n  aboutEmail: string;\n  aboutLocation: string;\n  aboutFreelance: string;\n  aboutImage: string;\n  cvFileUrl: string;\n  contactTitle: string;\n  contactSubtitle: string;\n  contactPhone: string;\n  contactAddress: string;\n  socialFacebook: string;\n  socialTwitter: string;\n  socialInstagram: string;\n  socialLinkedin: string;\n  socialGithub: string;\n  socialYoutube: string;\n  footerText: string;\n  footerCopyright: string;\n  metaDescription: string;\n  metaKeywords: string;\n  googleAnalyticsId: string;\n  maintenanceMode: boolean;\n}\n\nconst defaultSettings: SiteSettings = {\n  siteTitle: \"Loi Developer - Full-stack Creative\",\n  tagline: \"Building digital experiences with code.\",\n  contactEmail: \"loideveloper@example.com\",\n  heroTitle: \"NGUYEN THANH LOI\",\n  heroSubtitle: \"Full-stack Developer & Security Enthusiast\",\n  heroDescription: \"Crafting secure & performant digital experiences with code\",\n  heroStatus: \"SYSTEM ONLINE\",\n  heroCTA: \"View My Work\",\n  aboutTitle: \"About Me\",\n  aboutSubtitle: \"Full-stack Developer based in Vietnam\",\n  aboutDescription: \"I started my coding journey with a curiosity for how things work on the web. Now, I specialize in building modern, scalable, and user-friendly applications using the latest technologies.\",\n  aboutDescription2: \"My philosophy is simple: Code with passion, build with purpose. Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\",\n  aboutName: \"Nguyen Thanh Loi\",\n  aboutEmail: \"loideveloper@example.com\",\n  aboutLocation: \"Ho Chi Minh City\",\n  aboutFreelance: \"Available\",\n  aboutImage: \"\",\n  cvFileUrl: \"\",\n  contactTitle: \"Let's Talk\",\n  contactSubtitle: \"Have a project in mind or just want to say hi? I'm always open to discussing new projects, creative ideas or opportunities to be part of your visions.\",\n  contactPhone: \"+84 123 456 789\",\n  contactAddress: \"Ho Chi Minh City, Vietnam\",\n  socialFacebook: \"\",\n  socialTwitter: \"\",\n  socialInstagram: \"\",\n  socialLinkedin: \"\",\n  socialGithub: \"\",\n  socialYoutube: \"\",\n  footerText: \"Crafted with love & countless cups of coffee\",\n  footerCopyright: \"2024 Loi Developer. All rights reserved.\",\n  metaDescription: \"Portfolio of Nguyen Thanh Loi - Full-stack Developer & Creative Coder\",\n  metaKeywords: \"developer, portfolio, web development, full-stack\",\n  googleAnalyticsId: \"\",\n  maintenanceMode: false,\n};\n\nexport default function AdminSettings() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user, logoutMutation } = useAuth();\n  const [settings, setSettings] = useState<SiteSettings>(defaultSettings);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const cvInputRef = useRef<HTMLInputElement>(null);\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [passwordForm, setPasswordForm] = useState({\n    currentPassword: \"\",\n    newPassword: \"\",\n    confirmPassword: \"\",\n  });\n\n  const { data: serverSettings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n  });\n\n  useEffect(() => {\n    if (serverSettings) {\n      setSettings({\n        ...defaultSettings,\n        ...serverSettings,\n      });\n    }\n  }, [serverSettings]);\n\n  const updateMutation = useMutation({\n    mutationFn: (newSettings: Partial<SiteSettings>) => api.updateSettings(newSettings),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/settings\"] });\n      toast({ title: \"Success\", description: \"Settings saved successfully\" });\n      setHasChanges(false);\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to save settings\", variant: \"destructive\" });\n    },\n  });\n\n  const changePasswordMutation = useMutation({\n    mutationFn: async (data: { currentPassword: string; newPassword: string }) => {\n      const res = await fetch(\"/api/auth/password\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.message || \"Failed to change password\");\n      }\n      return res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Success\", description: \"Password changed successfully\" });\n      setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleChange = (key: keyof SiteSettings, value: string | boolean) => {\n    setSettings(prev => ({ ...prev, [key]: value }));\n    setHasChanges(true);\n  };\n\n  const handleFileUpload = async (file: File, field: \"aboutImage\" | \"cvFileUrl\") => {\n    if (!file) return;\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      handleChange(field, data.url);\n      toast({ title: \"Success\", description: \"File uploaded\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      await updateMutation.mutateAsync(settings);\n      toast({ \n        title: \"ThÃ nh cÃ´ng\", \n        description: \"CÃ i Ä‘áº·t Ä‘Ã£ Ä‘Æ°á»£c lÆ°u thÃ nh cÃ´ng\" \n      });\n      setHasChanges(false);\n    } catch (error: any) {\n      toast({\n        title: \"Lá»—i\",\n        description: error.message || \"KhÃ´ng thá»ƒ lÆ°u cÃ i Ä‘áº·t\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handlePasswordChange = () => {\n    if (passwordForm.newPassword !== passwordForm.confirmPassword) {\n      toast({ title: \"Error\", description: \"Passwords do not match\", variant: \"destructive\" });\n      return;\n    }\n    if (passwordForm.newPassword.length < 6) {\n      toast({ title: \"Error\", description: \"Password must be at least 6 characters\", variant: \"destructive\" });\n      return;\n    }\n    changePasswordMutation.mutate({\n      currentPassword: passwordForm.currentPassword,\n      newPassword: passwordForm.newPassword,\n    });\n  };\n\n  const handleLogout = () => {\n    logoutMutation.mutate();\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Settings</h1>\n            <p className=\"text-muted-foreground\">Manage your website configuration and content</p>\n          </div>\n          <Button \n            onClick={handleSave} \n            disabled={!hasChanges || updateMutation.isPending}\n            data-testid=\"button-save-settings\"\n          >\n            {updateMutation.isPending ? (\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n            ) : (\n              <Save className=\"w-4 h-4 mr-2\" />\n            )}\n            Save Changes\n          </Button>\n        </div>\n\n        <Tabs defaultValue=\"general\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-4xl grid-cols-7 gap-2\">\n            <TabsTrigger value=\"general\" className=\"gap-2\">\n              <Globe className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">General</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"hero\" className=\"gap-2\">\n              <LayoutDashboard className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Hero</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"about\" className=\"gap-2\">\n              <User className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">About</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"contact\" className=\"gap-2\">\n              <Mail className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Contact</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"social\" className=\"gap-2\">\n              <Share2 className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Social</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"seo\" className=\"gap-2\">\n              <FileText className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">SEO</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"security\" className=\"gap-2\">\n              <Shield className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Security</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"general\">\n            <div className=\"space-y-6\">\n              <Card className=\"border-l-4 border-l-primary\">\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <Globe className=\"w-5 h-5 text-primary\" />\n                        Website Branding\n                      </CardTitle>\n                      <CardDescription>\n                        Customize the main identity of your website\n                      </CardDescription>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"siteTitle\" className=\"font-semibold\">\n                      Site Title (Browser Tab & Header)\n                    </Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">\n                      Displayed in browser tab and as the main site heading throughout your portfolio\n                    </p>\n                    <Input \n                      id=\"siteTitle\"\n                      value={settings.siteTitle}\n                      onChange={(e) => handleChange(\"siteTitle\", e.target.value)}\n                      placeholder=\"Your site title\"\n                      data-testid=\"input-site-title\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"tagline\" className=\"font-semibold\">\n                      Tagline (Subheading)\n                    </Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">\n                      A short, catchy description that complements your site title\n                    </p>\n                    <Input \n                      id=\"tagline\"\n                      value={settings.tagline}\n                      onChange={(e) => handleChange(\"tagline\", e.target.value)}\n                      placeholder=\"A short description of your site\"\n                      data-testid=\"input-tagline\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Mail className=\"w-5 h-5 text-primary\" />\n                    Primary Contact Email\n                  </CardTitle>\n                  <CardDescription>\n                    Used for contact forms and general inquiries\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"contactEmail\" className=\"font-semibold\">\n                      Email Address\n                    </Label>\n                    <Input \n                      id=\"contactEmail\"\n                      type=\"email\"\n                      value={settings.contactEmail}\n                      onChange={(e) => handleChange(\"contactEmail\", e.target.value)}\n                      placeholder=\"your@email.com\"\n                      data-testid=\"input-contact-email\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <FileText className=\"w-5 h-5 text-primary\" />\n                    Footer Information\n                  </CardTitle>\n                  <CardDescription>\n                    Customize the footer section displayed at the bottom of every page\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"footerText\" className=\"font-semibold\">\n                      Footer Text\n                    </Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">\n                      Brief tagline or message shown in the footer\n                    </p>\n                    <Input \n                      id=\"footerText\"\n                      value={settings.footerText}\n                      onChange={(e) => handleChange(\"footerText\", e.target.value)}\n                      placeholder=\"Crafted with love...\"\n                      data-testid=\"input-footer-text\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"footerCopyright\" className=\"font-semibold\">\n                      Copyright Text\n                    </Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">\n                      Your copyright notice and rights statement\n                    </p>\n                    <Input \n                      id=\"footerCopyright\"\n                      value={settings.footerCopyright}\n                      onChange={(e) => handleChange(\"footerCopyright\", e.target.value)}\n                      placeholder=\"2024 Your Name. All rights reserved.\"\n                      data-testid=\"input-footer-copyright\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"bg-card/50 border-yellow-500/30\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <AlertCircle className=\"w-5 h-5 text-yellow-600 dark:text-yellow-500\" />\n                    System Status\n                  </CardTitle>\n                  <CardDescription>\n                    Control site availability\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center justify-between gap-4 p-4 bg-yellow-50 dark:bg-yellow-950/20 rounded-lg border border-yellow-200 dark:border-yellow-900/30\">\n                    <div className=\"space-y-1\">\n                      <Label className=\"font-semibold\">Maintenance Mode</Label>\n                      <p className=\"text-sm text-muted-foreground\">When enabled, visitors see a \"Coming Soon\" page</p>\n                    </div>\n                    <Switch \n                      checked={settings.maintenanceMode}\n                      onCheckedChange={(checked) => handleChange(\"maintenanceMode\", checked)}\n                      data-testid=\"switch-maintenance-mode\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"hero\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Hero Section</CardTitle>\n                <CardDescription>The main banner that visitors see first on your homepage.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-5\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"heroTitle\" className=\"font-semibold\">Hero Title (Your Name)</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">Your main headline in the hero section</p>\n                  <Input \n                    id=\"heroTitle\"\n                    value={settings.heroTitle}\n                    onChange={(e) => handleChange(\"heroTitle\", e.target.value)}\n                    placeholder=\"NGUYEN THANH LOI\"\n                    data-testid=\"input-hero-title\"\n                    className=\"text-base\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"heroSubtitle\" className=\"font-semibold\">Hero Subtitle (Your Role)</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">Your profession or main role</p>\n                  <Input \n                    id=\"heroSubtitle\"\n                    value={settings.heroSubtitle}\n                    onChange={(e) => handleChange(\"heroSubtitle\", e.target.value)}\n                    placeholder=\"Full-stack Developer & Security Enthusiast\"\n                    data-testid=\"input-hero-subtitle\"\n                    className=\"text-base\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"heroDescription\" className=\"font-semibold\">Hero Description</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">Brief description about what you do</p>\n                  <Textarea \n                    id=\"heroDescription\"\n                    value={settings.heroDescription}\n                    onChange={(e) => handleChange(\"heroDescription\", e.target.value)}\n                    placeholder=\"A short description about what you do...\"\n                    className=\"min-h-[100px]\"\n                    data-testid=\"input-hero-description\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"heroStatus\" className=\"font-semibold\">Status Text</Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">Badge text displayed in hero</p>\n                    <Input \n                      id=\"heroStatus\"\n                      value={settings.heroStatus}\n                      onChange={(e) => handleChange(\"heroStatus\", e.target.value)}\n                      placeholder=\"SYSTEM ONLINE\"\n                      data-testid=\"input-hero-status\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"heroCTA\" className=\"font-semibold flex items-center gap-2\">\n                      <LinkIcon className=\"w-4 h-4\" /> CTA Button Text\n                    </Label>\n                    <p className=\"text-xs text-muted-foreground mb-2\">Call-to-action button text</p>\n                    <Input \n                      id=\"heroCTA\"\n                      value={settings.heroCTA}\n                      onChange={(e) => handleChange(\"heroCTA\", e.target.value)}\n                      placeholder=\"View My Work\"\n                      data-testid=\"input-hero-cta\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"about\">\n            <div className=\"grid gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>About Section Content</CardTitle>\n                  <CardDescription>Tell visitors about yourself and your background.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"aboutTitle\" className=\"font-semibold\">Section Title</Label>\n                    <Input \n                      id=\"aboutTitle\"\n                      value={settings.aboutTitle}\n                      onChange={(e) => handleChange(\"aboutTitle\", e.target.value)}\n                      placeholder=\"About Me\"\n                      data-testid=\"input-about-title\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"aboutSubtitle\" className=\"font-semibold\">Subtitle</Label>\n                    <Input \n                      id=\"aboutSubtitle\"\n                      value={settings.aboutSubtitle}\n                      onChange={(e) => handleChange(\"aboutSubtitle\", e.target.value)}\n                      placeholder=\"Full-stack Developer based in Vietnam\"\n                      data-testid=\"input-about-subtitle\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"aboutDescription\" className=\"font-semibold\">Description Paragraph 1</Label>\n                    <Textarea \n                      id=\"aboutDescription\"\n                      value={settings.aboutDescription}\n                      onChange={(e) => handleChange(\"aboutDescription\", e.target.value)}\n                      placeholder=\"Your story...\"\n                      className=\"min-h-[100px]\"\n                      data-testid=\"input-about-description\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"aboutDescription2\" className=\"font-semibold\">Description Paragraph 2</Label>\n                    <Textarea \n                      id=\"aboutDescription2\"\n                      value={settings.aboutDescription2}\n                      onChange={(e) => handleChange(\"aboutDescription2\", e.target.value)}\n                      placeholder=\"Your philosophy...\"\n                      className=\"min-h-[100px]\"\n                      data-testid=\"input-about-description2\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Personal Information</CardTitle>\n                  <CardDescription>Your personal details shown in the About section.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aboutName\" className=\"font-semibold\">Full Name</Label>\n                      <Input \n                        id=\"aboutName\"\n                        value={settings.aboutName}\n                        onChange={(e) => handleChange(\"aboutName\", e.target.value)}\n                        placeholder=\"Nguyen Thanh Loi\"\n                        data-testid=\"input-about-name\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aboutEmail\" className=\"font-semibold\">Email</Label>\n                      <Input \n                        id=\"aboutEmail\"\n                        type=\"email\"\n                        value={settings.aboutEmail}\n                        onChange={(e) => handleChange(\"aboutEmail\", e.target.value)}\n                        placeholder=\"your@email.com\"\n                        data-testid=\"input-about-email\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aboutLocation\" className=\"font-semibold\">Location</Label>\n                      <Input \n                        id=\"aboutLocation\"\n                        value={settings.aboutLocation}\n                        onChange={(e) => handleChange(\"aboutLocation\", e.target.value)}\n                        placeholder=\"Ho Chi Minh City\"\n                        data-testid=\"input-about-location\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aboutFreelance\" className=\"font-semibold\">Freelance Status</Label>\n                      <Input \n                        id=\"aboutFreelance\"\n                        value={settings.aboutFreelance}\n                        onChange={(e) => handleChange(\"aboutFreelance\", e.target.value)}\n                        placeholder=\"Available\"\n                        data-testid=\"input-about-freelance\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                  </div>\n                  <Separator />\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"aboutImage\" className=\"font-semibold flex items-center gap-2\">\n                        <ImageIcon className=\"w-4 h-4\" /> Profile Image\n                      </Label>\n                      <p className=\"text-xs text-muted-foreground mb-2\">Your profile picture (uploads to /uploads/images/)</p>\n                      <div className=\"flex gap-2\">\n                        <Input \n                          id=\"aboutImage\"\n                          value={settings.aboutImage}\n                          readOnly\n                          placeholder=\"No image selected\"\n                          data-testid=\"input-about-image\"\n                          className=\"text-base flex-1\"\n                        />\n                        <Button variant=\"outline\" onClick={() => imageInputRef.current?.click()} disabled={uploading}>\n                          {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                        </Button>\n                      </div>\n                      <input\n                        ref={imageInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        onChange={(e) => e.target.files?.[0] && handleFileUpload(e.target.files[0], \"aboutImage\")}\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"cvFileUrl\" className=\"font-semibold flex items-center gap-2\">\n                        <Download className=\"w-4 h-4\" /> CV/Resume File\n                      </Label>\n                      <p className=\"text-xs text-muted-foreground mb-2\">PDF or document (uploads to /uploads/documents/)</p>\n                      <div className=\"flex gap-2\">\n                        <Input \n                          id=\"cvFileUrl\"\n                          value={settings.cvFileUrl}\n                          readOnly\n                          placeholder=\"No file selected\"\n                          data-testid=\"input-cv-url\"\n                          className=\"text-base flex-1\"\n                        />\n                        <Button variant=\"outline\" onClick={() => cvInputRef.current?.click()} disabled={uploading}>\n                          {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                        </Button>\n                      </div>\n                      <input\n                        ref={cvInputRef}\n                        type=\"file\"\n                        accept=\".pdf,.doc,.docx\"\n                        className=\"hidden\"\n                        onChange={(e) => e.target.files?.[0] && handleFileUpload(e.target.files[0], \"cvFileUrl\")}\n                      />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"contact\">\n            <div className=\"grid gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Contact Section Content</CardTitle>\n                  <CardDescription>Customize your contact section text and messaging.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"contactTitle\" className=\"font-semibold\">Section Title</Label>\n                    <Input \n                      id=\"contactTitle\"\n                      value={settings.contactTitle}\n                      onChange={(e) => handleChange(\"contactTitle\", e.target.value)}\n                      placeholder=\"Let's Talk\"\n                      data-testid=\"input-contact-title\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"contactSubtitle\" className=\"font-semibold\">Section Description</Label>\n                    <Textarea \n                      id=\"contactSubtitle\"\n                      value={settings.contactSubtitle}\n                      onChange={(e) => handleChange(\"contactSubtitle\", e.target.value)}\n                      placeholder=\"Have a project in mind...\"\n                      className=\"min-h-[100px]\"\n                      data-testid=\"input-contact-subtitle\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Contact Information</CardTitle>\n                  <CardDescription>Your contact details shown on the website.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"contactPhone\" className=\"font-semibold flex items-center gap-2\">\n                        <Phone className=\"w-4 h-4\" /> Phone\n                      </Label>\n                      <Input \n                        id=\"contactPhone\"\n                        value={settings.contactPhone}\n                        onChange={(e) => handleChange(\"contactPhone\", e.target.value)}\n                        placeholder=\"+84 123 456 789\"\n                        data-testid=\"input-contact-phone\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"contactAddress\" className=\"font-semibold flex items-center gap-2\">\n                        <MapPin className=\"w-4 h-4\" /> Address\n                      </Label>\n                      <Input \n                        id=\"contactAddress\"\n                        value={settings.contactAddress}\n                        onChange={(e) => handleChange(\"contactAddress\", e.target.value)}\n                        placeholder=\"Ho Chi Minh City, Vietnam\"\n                        data-testid=\"input-contact-address\"\n                        className=\"text-base\"\n                      />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"social\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Social Media Links</CardTitle>\n                <CardDescription>Your social media profiles displayed in the Follow Me section and footer.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-5\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialFacebook\" className=\"font-semibold\">Facebook</Label>\n                    <Input \n                      id=\"socialFacebook\"\n                      value={settings.socialFacebook}\n                      onChange={(e) => handleChange(\"socialFacebook\", e.target.value)}\n                      placeholder=\"https://facebook.com/yourprofile\"\n                      data-testid=\"input-social-facebook\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialTwitter\" className=\"font-semibold\">Twitter/X</Label>\n                    <Input \n                      id=\"socialTwitter\"\n                      value={settings.socialTwitter}\n                      onChange={(e) => handleChange(\"socialTwitter\", e.target.value)}\n                      placeholder=\"https://twitter.com/yourprofile\"\n                      data-testid=\"input-social-twitter\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialInstagram\" className=\"font-semibold\">Instagram</Label>\n                    <Input \n                      id=\"socialInstagram\"\n                      value={settings.socialInstagram}\n                      onChange={(e) => handleChange(\"socialInstagram\", e.target.value)}\n                      placeholder=\"https://instagram.com/yourprofile\"\n                      data-testid=\"input-social-instagram\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialLinkedin\" className=\"font-semibold\">LinkedIn</Label>\n                    <Input \n                      id=\"socialLinkedin\"\n                      value={settings.socialLinkedin}\n                      onChange={(e) => handleChange(\"socialLinkedin\", e.target.value)}\n                      placeholder=\"https://linkedin.com/in/yourprofile\"\n                      data-testid=\"input-social-linkedin\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialGithub\" className=\"font-semibold\">GitHub</Label>\n                    <Input \n                      id=\"socialGithub\"\n                      value={settings.socialGithub}\n                      onChange={(e) => handleChange(\"socialGithub\", e.target.value)}\n                      placeholder=\"https://github.com/yourprofile\"\n                      data-testid=\"input-social-github\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"socialYoutube\" className=\"font-semibold flex items-center gap-2\">\n                      <Youtube className=\"w-4 h-4\" /> YouTube\n                    </Label>\n                    <Input \n                      id=\"socialYoutube\"\n                      value={settings.socialYoutube}\n                      onChange={(e) => handleChange(\"socialYoutube\", e.target.value)}\n                      placeholder=\"https://youtube.com/@yourchannel\"\n                      data-testid=\"input-social-youtube\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"seo\">\n            <Card>\n              <CardHeader>\n                <CardTitle>SEO Configuration</CardTitle>\n                <CardDescription>Optimize your website for search engines.</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-5\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"metaDescription\" className=\"font-semibold\">Meta Description</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">\n                    Displayed in search engine results (50-160 characters recommended)\n                  </p>\n                  <Textarea \n                    id=\"metaDescription\"\n                    value={settings.metaDescription}\n                    onChange={(e) => handleChange(\"metaDescription\", e.target.value)}\n                    placeholder=\"Portfolio of Nguyen Thanh Loi - Full-stack Developer\"\n                    maxLength={160}\n                    className=\"min-h-[80px]\"\n                    data-testid=\"input-meta-description\"\n                  />\n                  <p className=\"text-xs text-muted-foreground text-right\">\n                    {settings.metaDescription.length}/160 characters\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"metaKeywords\" className=\"font-semibold\">Meta Keywords</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">\n                    Comma-separated keywords for search engines\n                  </p>\n                  <Input \n                    id=\"metaKeywords\"\n                    value={settings.metaKeywords}\n                    onChange={(e) => handleChange(\"metaKeywords\", e.target.value)}\n                    placeholder=\"developer, portfolio, web development, full-stack\"\n                    data-testid=\"input-meta-keywords\"\n                    className=\"text-base\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"googleAnalyticsId\" className=\"font-semibold\">Google Analytics ID</Label>\n                  <p className=\"text-xs text-muted-foreground mb-2\">\n                    Your Google Analytics tracking ID (e.g., G-XXXXXXXXXX)\n                  </p>\n                  <Input \n                    id=\"googleAnalyticsId\"\n                    value={settings.googleAnalyticsId}\n                    onChange={(e) => handleChange(\"googleAnalyticsId\", e.target.value)}\n                    placeholder=\"G-XXXXXXXXXX\"\n                    data-testid=\"input-google-analytics\"\n                    className=\"text-base\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"security\">\n            <div className=\"grid gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Key className=\"w-5 h-5\" />\n                    Change Password\n                  </CardTitle>\n                  <CardDescription>Update your account password for enhanced security.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-5\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"currentPassword\" className=\"font-semibold\">Current Password</Label>\n                    <div className=\"relative\">\n                      <Input \n                        id=\"currentPassword\"\n                        type={showCurrentPassword ? \"text\" : \"password\"}\n                        value={passwordForm.currentPassword}\n                        onChange={(e) => setPasswordForm(prev => ({ ...prev, currentPassword: e.target.value }))}\n                        placeholder=\"Enter current password\"\n                        data-testid=\"input-current-password\"\n                        className=\"text-base pr-10\"\n                      />\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        className=\"absolute right-0 top-0 h-full\"\n                        onClick={() => setShowCurrentPassword(!showCurrentPassword)}\n                      >\n                        {showCurrentPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"newPassword\" className=\"font-semibold\">New Password</Label>\n                    <div className=\"relative\">\n                      <Input \n                        id=\"newPassword\"\n                        type={showNewPassword ? \"text\" : \"password\"}\n                        value={passwordForm.newPassword}\n                        onChange={(e) => setPasswordForm(prev => ({ ...prev, newPassword: e.target.value }))}\n                        placeholder=\"Enter new password\"\n                        data-testid=\"input-new-password\"\n                        className=\"text-base pr-10\"\n                      />\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        className=\"absolute right-0 top-0 h-full\"\n                        onClick={() => setShowNewPassword(!showNewPassword)}\n                      >\n                        {showNewPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"confirmPassword\" className=\"font-semibold\">Confirm New Password</Label>\n                    <Input \n                      id=\"confirmPassword\"\n                      type=\"password\"\n                      value={passwordForm.confirmPassword}\n                      onChange={(e) => setPasswordForm(prev => ({ ...prev, confirmPassword: e.target.value }))}\n                      placeholder=\"Confirm new password\"\n                      data-testid=\"input-confirm-password\"\n                      className=\"text-base\"\n                    />\n                  </div>\n                  <Button \n                    onClick={handlePasswordChange}\n                    disabled={changePasswordMutation.isPending || !passwordForm.currentPassword || !passwordForm.newPassword || !passwordForm.confirmPassword}\n                    data-testid=\"button-change-password\"\n                  >\n                    {changePasswordMutation.isPending ? (\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    ) : (\n                      <Key className=\"w-4 h-4 mr-2\" />\n                    )}\n                    Change Password\n                  </Button>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <User className=\"w-5 h-5\" />\n                    Current Session\n                  </CardTitle>\n                  <CardDescription>Manage your active session.</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between p-4 bg-muted/50 rounded-lg\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-2 rounded-full bg-green-500/10\">\n                        <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium\">{user?.username || \"Unknown\"}</p>\n                        <p className=\"text-sm text-muted-foreground flex items-center gap-1\">\n                          <Badge variant=\"outline\" className=\"text-xs\">{user?.role || \"User\"}</Badge>\n                          <span className=\"mx-1\">Active session</span>\n                        </p>\n                      </div>\n                    </div>\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button variant=\"outline\" className=\"text-destructive\" data-testid=\"button-logout\">\n                          <LogOut className=\"w-4 h-4 mr-2\" />\n                          Logout\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>Are you sure you want to logout?</AlertDialogTitle>\n                          <AlertDialogDescription>\n                            You will be redirected to the login page and will need to sign in again.\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel>Cancel</AlertDialogCancel>\n                          <AlertDialogAction onClick={handleLogout}>Logout</AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"bg-card/50 border-blue-500/30\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Smartphone className=\"w-5 h-5 text-blue-500\" />\n                    Two-Factor Authentication\n                  </CardTitle>\n                  <CardDescription>Add an extra layer of security to your account.</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-900/30\">\n                    <div className=\"space-y-1\">\n                      <p className=\"font-semibold\">2FA Status</p>\n                      <p className=\"text-sm text-muted-foreground\">Two-factor authentication is not yet enabled</p>\n                    </div>\n                    <Badge variant=\"secondary\">Coming Soon</Badge>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Clock className=\"w-5 h-5\" />\n                    Security Tips\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <ul className=\"space-y-3 text-sm text-muted-foreground\">\n                    <li className=\"flex items-start gap-2\">\n                      <Shield className=\"w-4 h-4 mt-0.5 text-primary\" />\n                      Use a strong password with at least 8 characters, including uppercase, lowercase, numbers, and symbols\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <Shield className=\"w-4 h-4 mt-0.5 text-primary\" />\n                      Never share your password with anyone\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <Shield className=\"w-4 h-4 mt-0.5 text-primary\" />\n                      Log out when using shared or public computers\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <Shield className=\"w-4 h-4 mt-0.5 text-primary\" />\n                      Regularly update your password for enhanced security\n                    </li>\n                  </ul>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":49539,"size_tokens":null},"server/routes.ts":{"content":"import type { Express, Request, Response, NextFunction } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { rateLimitMiddleware } from \"./middleware/security\";\nimport { registerApiRoutes } from \"./api\";\n\nasync function checkIpBlocking(req: Request, res: Response, next: NextFunction) {\n  const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n\n  try {\n    const ipRules = await storage.getAllIpRules();\n    const blacklisted = ipRules.find(rule => rule.type === 'blacklist' && rule.ipAddress === clientIp);\n\n    if (blacklisted) {\n      await storage.createSecurityLog({\n        action: `Blocked request from blacklisted IP`,\n        userId: null,\n        userName: 'System',\n        ipAddress: clientIp,\n        userAgent: req.get('User-Agent') || 'unknown',\n        eventType: \"ip_blocked\",\n        blocked: true\n      });\n      return res.status(403).json({ error: \"Access denied\" });\n    }\n\n    const whitelisted = ipRules.filter(rule => rule.type === 'whitelist');\n    if (whitelisted.length > 0) {\n      const isWhitelisted = whitelisted.some(rule => rule.ipAddress === clientIp);\n      if (!isWhitelisted) {\n        return res.status(403).json({ error: \"Access denied - IP not whitelisted\" });\n      }\n    }\n\n    next();\n  } catch (error) {\n    next();\n  }\n}\n\nasync function seedInitialData() {\n  try {\n    const projectCategories = [\n      { name: \"Web Development\", slug: \"web-development\", description: \"Web application projects\", type: \"project\" as const },\n      { name: \"Mobile Apps\", slug: \"mobile-apps\", description: \"Mobile application projects\", type: \"project\" as const },\n      { name: \"UI/UX Design\", slug: \"ui-ux-design\", description: \"Design projects\", type: \"project\" as const },\n      { name: \"E-commerce\", slug: \"e-commerce\", description: \"Online store projects\", type: \"project\" as const },\n    ];\n\n    const postCategories = [\n      { name: \"Technology\", slug: \"technology\", description: \"Tech articles\", type: \"post\" as const },\n      { name: \"Tutorial\", slug: \"tutorial\", description: \"How-to guides\", type: \"post\" as const },\n      { name: \"News\", slug: \"news\", description: \"Industry news\", type: \"post\" as const },\n    ];\n\n    for (const cat of projectCategories) {\n      const existing = await storage.getCategoriesByType(\"project\");\n      if (!existing.find(c => c.slug === cat.slug)) {\n        await storage.createCategory(cat);\n      }\n    }\n\n    for (const cat of postCategories) {\n      const existing = await storage.getCategoriesByType(\"post\");\n      if (!existing.find(c => c.slug === cat.slug)) {\n        await storage.createCategory(cat);\n      }\n    }\n  } catch (error) {\n    console.log(\"Seed data already exists or error:\", error);\n  }\n}\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  await seedInitialData();\n\n  app.use('/api/auth/login', checkIpBlocking);\n  app.use('/admin/*', checkIpBlocking);\n\n  app.use('/api/*', rateLimitMiddleware);\n\n  registerApiRoutes(app);\n\n  return httpServer;\n}","path":null,"size_bytes":3061,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    hmr: false,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1346,"size_tokens":null},"client/src/components/layout/Navbar.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Menu, X, Moon, Sun, Download } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/hooks/use-theme\";\nimport { LanguageSwitcher } from \"@/components/layout/LanguageSwitcher\";\nimport { GlobalSearch } from \"@/components/layout/GlobalSearch\";\nimport { useLanguage } from \"@/context/LanguageContext\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\n\nexport function Navbar() {\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [activeSection, setActiveSection] = useState(\"home\");\n  const { theme, toggleTheme } = useTheme();\n  const { t } = useLanguage();\n  const [location, setLocation] = useLocation();\n  const { settings } = useSiteSettings();\n\n  useEffect(() => {\n    const handleScroll = () => {\n      setIsScrolled(window.scrollY > 50);\n\n      if (location === \"/\") {\n        const sections = [\"home\", \"about\", \"skills\", \"projects\", \"contact\"];\n        const current = sections.find((section) => {\n          const element = document.getElementById(section);\n          if (element) {\n            const rect = element.getBoundingClientRect();\n            return rect.top <= 100 && rect.bottom >= 100;\n          }\n          return false;\n        });\n        if (current) setActiveSection(current);\n      }\n    };\n\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, [location]);\n\n  const navLinks = [\n    { name: t(\"nav.home\"), href: \"#home\" },\n    { name: t(\"nav.about\"), href: \"#about\" },\n    { name: t(\"nav.skills\"), href: \"#skills\" },\n    { name: t(\"nav.projects\"), href: \"#projects\" },\n    { name: t(\"nav.blog\"), href: \"#blog\" },\n    { name: t(\"nav.contact\"), href: \"#contact\" },\n  ];\n\n  const extraLinks = [\n    { name: t(\"nav.faqs\") || \"FAQs\", href: \"/faqs\" },\n  ];\n\n  const scrollToSection = (id: string) => {\n    const sectionId = id.replace(\"#\", \"\");\n\n    if (location !== \"/\") {\n      setLocation(\"/\");\n      setTimeout(() => {\n        const element = document.getElementById(sectionId);\n        if (element) {\n          element.scrollIntoView({ behavior: \"smooth\" });\n        }\n      }, 100);\n    } else {\n      const element = document.getElementById(sectionId);\n      if (element) {\n        element.scrollIntoView({ behavior: \"smooth\" });\n      }\n    }\n    setMobileMenuOpen(false);\n  };\n\n  const handleLogoClick = () => {\n    if (location !== \"/\") {\n      setLocation(\"/\");\n    } else {\n      scrollToSection(\"home\");\n    }\n  };\n\n  return (\n    <header\n      className={`fixed top-0 left-0 right-0 z-40 transition-all duration-300 ${\n        isScrolled\n          ? \"bg-background/80 backdrop-blur-md shadow-md h-16\"\n          : \"bg-transparent h-20\"\n      }`}\n    >\n      <div className=\"container mx-auto h-full flex items-center justify-between px-4 md:px-8\">\n        <div className=\"group cursor-pointer\" onClick={handleLogoClick}>\n          {settings.logoUrl ? (\n            <img\n              src={settings.logoUrl}\n              alt=\"Logo\"\n              className=\"h-10 w-auto\"\n              data-testid=\"img-logo\"\n            />\n          ) : (\n            <div className=\"relative w-10 h-10 flex items-center justify-center border-2 border-foreground rounded hover:bg-primary hover:border-primary transition-all duration-500 group-hover:rotate-90\">\n              <span className=\"font-heading font-bold text-xl group-hover:text-white transition-colors\">\n                L\n              </span>\n            </div>\n          )}\n        </div>\n\n        <nav className=\"hidden md:flex items-center gap-6\">\n          {navLinks.map((link) => (\n            <button\n              key={link.name}\n              onClick={() => scrollToSection(link.href)}\n              className={`group relative text-sm font-medium transition-colors ${\n                location === \"/\" && activeSection === link.href.replace(\"#\", \"\")\n                  ? \"text-primary\"\n                  : \"text-foreground/80 hover:text-transparent hover:bg-clip-text hover:bg-gradient-to-r hover:from-primary hover:to-secondary\"\n              }`}\n              data-testid={`nav-${link.href.replace(\"#\", \"\")}`}\n            >\n              {link.name}\n              <span className=\"absolute left-0 bottom-0 w-0 h-0.5 bg-gradient-to-r from-primary to-secondary transition-all duration-300 group-hover:w-full\" />\n              {location === \"/\" &&\n                activeSection === link.href.replace(\"#\", \"\") && (\n                  <motion.div\n                    layoutId=\"activeSection\"\n                    className=\"absolute -bottom-1 left-0 right-0 h-0.5 bg-primary\"\n                  />\n                )}\n            </button>\n          ))}\n          <span className=\"w-px h-4 bg-border\" />\n          {extraLinks.map((link) => (\n            <Link\n              key={link.name}\n              href={link.href}\n            >\n              <button\n                className={`group relative text-sm font-medium transition-colors ${\n                  location === link.href\n                    ? \"text-primary\"\n                    : \"text-foreground/80 hover:text-transparent hover:bg-clip-text hover:bg-gradient-to-r hover:from-primary hover:to-secondary\"\n                }`}\n                data-testid={`nav-${link.href.replace(\"/\", \"\")}`}\n              >\n                {link.name}\n                <span className=\"absolute left-0 bottom-0 w-0 h-0.5 bg-gradient-to-r from-primary to-secondary transition-all duration-300 group-hover:w-full\" />\n                {location === link.href && (\n                  <motion.div\n                    layoutId=\"activeSection\"\n                    className=\"absolute -bottom-1 left-0 right-0 h-0.5 bg-primary\"\n                  />\n                )}\n              </button>\n            </Link>\n          ))}\n        </nav>\n\n        <div className=\"hidden md:flex items-center gap-4\">\n          <GlobalSearch />\n          <LanguageSwitcher />\n          <button\n            onClick={toggleTheme}\n            className=\"p-2 rounded-full hover:bg-secondary/10 transition-colors\"\n            data-testid=\"button-theme-toggle\"\n          >\n            {theme === \"dark\" ? <Moon size={20} /> : <Sun size={20} />}\n          </button>\n          <Button\n            variant=\"outline\"\n            className=\"hidden lg:flex gap-2 border-primary text-primary relative overflow-hidden group transition-all hover:text-white hover:border-transparent\"\n            data-testid=\"button-download-cv\"\n            onClick={() => {\n              if (settings.cvFileUrl) {\n                const link = document.createElement(\"a\");\n                link.href = settings.cvFileUrl;\n                link.download = settings.cvFileUrl.split(\"/\").pop() || \"CV.pdf\";\n                document.body.appendChild(link);\n                link.click();\n                document.body.removeChild(link);\n              } else {\n                alert(\"CV file not available. Please contact the site owner.\");\n              }\n            }}\n          >\n            <span className=\"absolute inset-0 bg-gradient-to-r from-primary to-secondary translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300 ease-out\" />\n            <span className=\"relative z-10 flex items-center gap-2\">\n              <Download size={16} /> {t(\"Download CV\") || \"Download CV\"}\n            </span>\n          </Button>\n        </div>\n\n        <button\n          className=\"md:hidden p-2 text-foreground\"\n          onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n          data-testid=\"button-mobile-menu\"\n        >\n          {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}\n        </button>\n      </div>\n\n      <AnimatePresence>\n        {mobileMenuOpen && (\n          <motion.div\n            initial={{ x: \"100%\" }}\n            animate={{ x: 0 }}\n            exit={{ x: \"100%\" }}\n            transition={{ type: \"tween\", duration: 0.3 }}\n            className=\"fixed inset-0 top-16 z-30 bg-background flex flex-col items-center justify-center gap-8 md:hidden\"\n          >\n            {navLinks.map((link) => (\n              <button\n                key={link.name}\n                onClick={() => scrollToSection(link.href)}\n                className=\"text-2xl font-heading font-bold text-foreground hover:text-primary transition-colors\"\n              >\n                {link.name}\n              </button>\n            ))}\n            <div className=\"w-16 h-px bg-border my-4\" />\n            {extraLinks.map((link) => (\n              <Link key={link.name} href={link.href}>\n                <button\n                  onClick={() => setMobileMenuOpen(false)}\n                  className={`text-xl font-heading font-bold transition-colors ${\n                    location === link.href ? \"text-primary\" : \"text-foreground hover:text-primary\"\n                  }`}\n                >\n                  {link.name}\n                </button>\n              </Link>\n            ))}\n            <div className=\"flex gap-6 mt-8 items-center\">\n              <LanguageSwitcher />\n              <button\n                onClick={toggleTheme}\n                className=\"p-4 bg-muted rounded-full\"\n              >\n                {theme === \"dark\" ? <Moon size={24} /> : <Sun size={24} />}\n              </button>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </header>\n  );\n}\n","path":null,"size_bytes":9540,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":1929,"size_tokens":null},"client/src/components/ui/confirmation-dialog.tsx":{"content":"import { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\n\ninterface ConfirmationDialogProps {\n  isOpen: boolean;\n  title: string;\n  description: string;\n  actionLabel?: string;\n  cancelLabel?: string;\n  isDestructive?: boolean;\n  onConfirm: () => void;\n  onCancel: () => void;\n  isLoading?: boolean;\n}\n\nexport function ConfirmationDialog({\n  isOpen,\n  title,\n  description,\n  actionLabel = \"Confirm\",\n  cancelLabel = \"Cancel\",\n  isDestructive = false,\n  onConfirm,\n  onCancel,\n  isLoading = false,\n}: ConfirmationDialogProps) {\n  return (\n    <AlertDialog open={isOpen} onOpenChange={(open) => !open && onCancel()}>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{title}</AlertDialogTitle>\n          <AlertDialogDescription>{description}</AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel disabled={isLoading}>{cancelLabel}</AlertDialogCancel>\n          <AlertDialogAction\n            onClick={onConfirm}\n            disabled={isLoading}\n            className={isDestructive ? \"bg-destructive text-destructive-foreground hover:bg-destructive/90\" : \"\"}\n          >\n            {isLoading ? \"Loading...\" : actionLabel}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n","path":null,"size_bytes":1468,"size_tokens":null},"client/src/pages/admin/Webhooks.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Webhook, \n  Plus, \n  Trash2, \n  Edit,\n  TestTube,\n  Activity,\n  CheckCircle,\n  XCircle,\n  Clock\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface WebhookItem {\n  id: number;\n  name: string;\n  url: string;\n  events: string[];\n  status: \"active\" | \"inactive\";\n  lastTriggered: string;\n  successRate: number;\n}\n\nexport default function AdminWebhooks() {\n  const [webhooks, setWebhooks] = useState<WebhookItem[]>([\n    {\n      id: 1,\n      name: \"Slack Notifications\",\n      url: \"https://hooks.slack.com/services/xxx\",\n      events: [\"post.published\", \"comment.new\"],\n      status: \"active\",\n      lastTriggered: \"2 hours ago\",\n      successRate: 98.5\n    },\n    {\n      id: 2,\n      name: \"Discord Updates\",\n      url: \"https://discord.com/api/webhooks/xxx\",\n      events: [\"project.created\", \"message.received\"],\n      status: \"active\",\n      lastTriggered: \"1 day ago\",\n      successRate: 100\n    },\n  ]);\n\n  const availableEvents = [\n    \"post.published\",\n    \"post.updated\",\n    \"post.deleted\",\n    \"comment.new\",\n    \"project.created\",\n    \"message.received\",\n    \"user.registered\",\n    \"newsletter.subscribed\"\n  ];\n\n  const handleTest = (id: number) => {\n    alert(`Testing webhook #${id}...`);\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this webhook?\")) {\n      setWebhooks(webhooks.filter(w => w.id !== id));\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Webhooks</h1>\n            <p className=\"text-muted-foreground\">Integrate external services with real-time events</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Create Webhook\n          </Button>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Webhook className=\"w-5 h-5 text-primary\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Total Webhooks</p>\n                  <p className=\"font-bold text-xl\">{webhooks.length}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Activity className=\"w-5 h-5 text-green-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Active</p>\n                  <p className=\"font-bold text-xl\">{webhooks.filter(w => w.status === \"active\").length}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <CheckCircle className=\"w-5 h-5 text-blue-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Avg Success Rate</p>\n                  <p className=\"font-bold text-xl\">99.2%</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Clock className=\"w-5 h-5 text-yellow-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Events Today</p>\n                  <p className=\"font-bold text-xl\">127</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Webhooks List */}\n        <div className=\"space-y-4\">\n          {webhooks.map((webhook) => (\n            <Card key={webhook.id}>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start justify-between gap-4\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <h3 className=\"font-bold text-lg\">{webhook.name}</h3>\n                      <Badge variant={webhook.status === \"active\" ? \"default\" : \"secondary\"}>\n                        {webhook.status}\n                      </Badge>\n                    </div>\n                    \n                    <div className=\"text-sm text-muted-foreground mb-3\">\n                      <code className=\"bg-muted px-2 py-1 rounded\">{webhook.url}</code>\n                    </div>\n\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {webhook.events.map(event => (\n                        <Badge key={event} variant=\"outline\" className=\"text-xs\">\n                          {event}\n                        </Badge>\n                      ))}\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <span className=\"text-muted-foreground\">Last triggered:</span>\n                        <span className=\"ml-2 font-medium\">{webhook.lastTriggered}</span>\n                      </div>\n                      <div>\n                        <span className=\"text-muted-foreground\">Success rate:</span>\n                        <span className=\"ml-2 font-medium text-green-600\">{webhook.successRate}%</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex flex-col gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => handleTest(webhook.id)}>\n                      <TestTube className=\"w-3 h-3 mr-1\" /> Test\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\">\n                      <Edit className=\"w-3 h-3 mr-1\" /> Edit\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      className=\"text-destructive\"\n                      onClick={() => handleDelete(webhook.id)}\n                    >\n                      <Trash2 className=\"w-3 h-3 mr-1\" /> Delete\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Create Form */}\n        <Card className=\"border-primary/20 bg-primary/5\">\n          <CardHeader>\n            <CardTitle>Create New Webhook</CardTitle>\n            <CardDescription>Configure a webhook to receive events</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Webhook Name</label>\n              <Input placeholder=\"e.g., Slack Notifications\" />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Endpoint URL</label>\n              <Input placeholder=\"https://your-service.com/webhook\" />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Events to Subscribe</label>\n              <div className=\"grid grid-cols-2 gap-2 mt-2\">\n                {availableEvents.map(event => (\n                  <div key={event} className=\"flex items-center gap-2\">\n                    <input type=\"checkbox\" id={event} className=\"rounded\" />\n                    <label htmlFor={event} className=\"text-sm\">{event}</label>\n                  </div>\n                ))}\n              </div>\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <label className=\"text-sm font-medium\">Enable immediately</label>\n              <Switch defaultChecked />\n            </div>\n            <Button className=\"w-full\">Create Webhook</Button>\n          </CardContent>\n        </Card>\n\n        {/* Recent Activity */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Recent Webhook Activity</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {[\n                { event: \"post.published\", webhook: \"Slack Notifications\", status: \"success\", time: \"2 min ago\" },\n                { event: \"comment.new\", webhook: \"Discord Updates\", status: \"success\", time: \"15 min ago\" },\n                { event: \"project.created\", webhook: \"Discord Updates\", status: \"failed\", time: \"1 hour ago\" },\n              ].map((log, i) => (\n                <div key={i} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div className=\"flex items-center gap-3\">\n                    {log.status === \"success\" ? (\n                      <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                    ) : (\n                      <XCircle className=\"w-4 h-4 text-red-500\" />\n                    )}\n                    <div>\n                      <p className=\"font-medium text-sm\">{log.event}</p>\n                      <p className=\"text-xs text-muted-foreground\">{log.webhook}</p>\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-muted-foreground\">{log.time}</span>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9708,"size_tokens":null},"client/src/components/sections/Hero.tsx":{"content":"import { motion, useMotionValue, useTransform, useSpring } from \"framer-motion\";\nimport { useState, useEffect, useRef, useCallback } from \"react\";\nimport { ArrowRight, Download, Terminal, Code2, Shield, Cpu, Database, Wifi, Lock, Server, Zap, Globe } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\n\nconst avatarImage = \"/uploads/images/futuristic_3d_developer_avatar.png\";\n\nfunction HexagonParticles() {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n\n    const particles: Array<{\n      x: number;\n      y: number;\n      size: number;\n      speedX: number;\n      speedY: number;\n      opacity: number;\n      hue: number;\n    }> = [];\n\n    for (let i = 0; i < 60; i++) {\n      particles.push({\n        x: Math.random() * canvas.width,\n        y: Math.random() * canvas.height,\n        size: Math.random() * 3 + 1,\n        speedX: (Math.random() - 0.5) * 0.5,\n        speedY: (Math.random() - 0.5) * 0.5,\n        opacity: Math.random() * 0.5 + 0.1,\n        hue: Math.random() > 0.5 ? 120 : 180,\n      });\n    }\n\n    const drawHexagon = (x: number, y: number, size: number, opacity: number, hue: number) => {\n      ctx.beginPath();\n      for (let i = 0; i < 6; i++) {\n        const angle = (Math.PI / 3) * i - Math.PI / 6;\n        const px = x + size * Math.cos(angle);\n        const py = y + size * Math.sin(angle);\n        if (i === 0) ctx.moveTo(px, py);\n        else ctx.lineTo(px, py);\n      }\n      ctx.closePath();\n      ctx.strokeStyle = `hsla(${hue}, 100%, 50%, ${opacity})`;\n      ctx.lineWidth = 1;\n      ctx.stroke();\n    };\n\n    const connectParticles = () => {\n      for (let i = 0; i < particles.length; i++) {\n        for (let j = i + 1; j < particles.length; j++) {\n          const dx = particles[i].x - particles[j].x;\n          const dy = particles[i].y - particles[j].y;\n          const distance = Math.sqrt(dx * dx + dy * dy);\n\n          if (distance < 150) {\n            ctx.beginPath();\n            ctx.moveTo(particles[i].x, particles[i].y);\n            ctx.lineTo(particles[j].x, particles[j].y);\n            ctx.strokeStyle = `rgba(0, 255, 65, ${0.1 * (1 - distance / 150)})`;\n            ctx.lineWidth = 0.5;\n            ctx.stroke();\n          }\n        }\n      }\n    };\n\n    const animate = () => {\n      ctx.fillStyle = \"rgba(15, 23, 42, 0.1)\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      particles.forEach((p) => {\n        p.x += p.speedX;\n        p.y += p.speedY;\n\n        if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;\n        if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;\n\n        drawHexagon(p.x, p.y, p.size * 4, p.opacity, p.hue);\n      });\n\n      connectParticles();\n      requestAnimationFrame(animate);\n    };\n\n    const animationId = requestAnimationFrame(animate);\n\n    const handleResize = () => {\n      canvas.width = window.innerWidth;\n      canvas.height = window.innerHeight;\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n\n    return () => {\n      cancelAnimationFrame(animationId);\n      window.removeEventListener(\"resize\", handleResize);\n    };\n  }, []);\n\n  return <canvas ref={canvasRef} className=\"absolute inset-0 z-0\" />;\n}\n\nfunction MatrixRain() {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n\n    const chars = \"01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒŽãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒžãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ²ãƒ³<>{}[]()#@$%^&*\";\n    const charArray = chars.split(\"\");\n    const fontSize = 14;\n    const columns = Math.floor(canvas.width / fontSize);\n    const drops: number[] = [];\n\n    for (let i = 0; i < columns; i++) {\n      drops[i] = Math.random() * -100;\n    }\n\n    const draw = () => {\n      ctx.fillStyle = \"rgba(15, 23, 42, 0.05)\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      ctx.font = `${fontSize}px monospace`;\n\n      for (let i = 0; i < drops.length; i++) {\n        const text = charArray[Math.floor(Math.random() * charArray.length)];\n        const brightness = Math.random();\n        \n        if (brightness > 0.98) {\n          ctx.fillStyle = \"#fff\";\n          ctx.shadowColor = \"#00ff41\";\n          ctx.shadowBlur = 10;\n        } else if (brightness > 0.9) {\n          ctx.fillStyle = \"#00ff41\";\n          ctx.shadowBlur = 0;\n        } else {\n          ctx.fillStyle = `rgba(0, 255, 65, ${0.3 + brightness * 0.4})`;\n          ctx.shadowBlur = 0;\n        }\n        \n        ctx.fillText(text, i * fontSize, drops[i] * fontSize);\n\n        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {\n          drops[i] = 0;\n        }\n        drops[i]++;\n      }\n    };\n\n    const interval = setInterval(draw, 50);\n\n    const handleResize = () => {\n      canvas.width = window.innerWidth;\n      canvas.height = window.innerHeight;\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n\n    return () => {\n      clearInterval(interval);\n      window.removeEventListener(\"resize\", handleResize);\n    };\n  }, []);\n\n  return <canvas ref={canvasRef} className=\"absolute inset-0 z-0 opacity-30\" />;\n}\n\nfunction NeonCircuit() {\n  return (\n    <svg className=\"absolute inset-0 w-full h-full z-0 opacity-20\" xmlns=\"http://www.w3.org/2000/svg\">\n      <defs>\n        <filter id=\"neon-glow\">\n          <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\" />\n          <feMerge>\n            <feMergeNode in=\"coloredBlur\" />\n            <feMergeNode in=\"SourceGraphic\" />\n          </feMerge>\n        </filter>\n        <linearGradient id=\"circuit-gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n          <stop offset=\"0%\" stopColor=\"#00ff41\" />\n          <stop offset=\"50%\" stopColor=\"#00d4ff\" />\n          <stop offset=\"100%\" stopColor=\"#7c3aed\" />\n        </linearGradient>\n      </defs>\n      \n      <motion.path\n        d=\"M0 100 Q 100 50, 200 100 T 400 100 T 600 100 T 800 100 T 1000 100\"\n        stroke=\"url(#circuit-gradient)\"\n        strokeWidth=\"1\"\n        fill=\"none\"\n        filter=\"url(#neon-glow)\"\n        initial={{ pathLength: 0, opacity: 0 }}\n        animate={{ pathLength: 1, opacity: 1 }}\n        transition={{ duration: 3, repeat: Infinity, repeatType: \"loop\" }}\n      />\n      \n      <motion.path\n        d=\"M0 300 L 150 300 L 200 250 L 350 250 L 400 300 L 600 300\"\n        stroke=\"#00ff41\"\n        strokeWidth=\"1\"\n        fill=\"none\"\n        filter=\"url(#neon-glow)\"\n        initial={{ pathLength: 0 }}\n        animate={{ pathLength: 1 }}\n        transition={{ duration: 2, delay: 0.5, repeat: Infinity, repeatType: \"loop\" }}\n      />\n      \n      <motion.circle cx=\"200\" cy=\"250\" r=\"5\" fill=\"#00ff41\" filter=\"url(#neon-glow)\"\n        animate={{ scale: [1, 1.5, 1], opacity: [0.5, 1, 0.5] }}\n        transition={{ duration: 2, repeat: Infinity }}\n      />\n      <motion.circle cx=\"400\" cy=\"300\" r=\"5\" fill=\"#00d4ff\" filter=\"url(#neon-glow)\"\n        animate={{ scale: [1, 1.5, 1], opacity: [0.5, 1, 0.5] }}\n        transition={{ duration: 2, delay: 0.5, repeat: Infinity }}\n      />\n    </svg>\n  );\n}\n\nfunction GlitchText({ children, className = \"\" }: { children: string; className?: string }) {\n  const [isGlitching, setIsGlitching] = useState(false);\n\n  useEffect(() => {\n    const glitchInterval = setInterval(() => {\n      setIsGlitching(true);\n      setTimeout(() => setIsGlitching(false), 200);\n    }, 3000);\n\n    return () => clearInterval(glitchInterval);\n  }, []);\n\n  return (\n    <span \n      className={`glitch-text relative inline-block ${className} ${isGlitching ? 'animate-glitch' : ''}`} \n      data-text={children}\n    >\n      {children}\n    </span>\n  );\n}\n\nfunction CyberTerminal({ heroName }: { heroName: string }) {\n  const [lines, setLines] = useState<Array<{ text: string; type: string }>>([]);\n  const [currentLine, setCurrentLine] = useState(\"\");\n  const [lineIndex, setLineIndex] = useState(0);\n  const [charIndex, setCharIndex] = useState(0);\n  const [showBlink, setShowBlink] = useState(true);\n\n  const username = heroName.toLowerCase().replace(/\\s+/g, \"_\");\n  const terminalLines = [\n    { text: `$ ssh ${username}@portfolio.dev`, type: \"command\" },\n    { text: \"> Establishing secure connection...\", type: \"info\" },\n    { text: \"> [OK] Connection established\", type: \"success\" },\n    { text: \"$ cat /etc/skills.conf\", type: \"command\" },\n    { text: \"> React | Node.js | TypeScript | Python\", type: \"data\" },\n    { text: \"> PostgreSQL | Docker | AWS | Linux\", type: \"data\" },\n    { text: \"$ ./initialize_portfolio.sh --mode=creative\", type: \"command\" },\n    { text: \"> Loading modules... [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%\", type: \"loading\" },\n    { text: \"> [SUCCESS] System ready!\", type: \"success\" },\n  ];\n\n  useEffect(() => {\n    const blinkInterval = setInterval(() => setShowBlink(prev => !prev), 530);\n    return () => clearInterval(blinkInterval);\n  }, []);\n\n  useEffect(() => {\n    if (lineIndex >= terminalLines.length) {\n      setTimeout(() => {\n        setLines([]);\n        setCurrentLine(\"\");\n        setLineIndex(0);\n        setCharIndex(0);\n      }, 4000);\n      return;\n    }\n\n    const currentText = terminalLines[lineIndex].text;\n\n    if (charIndex < currentText.length) {\n      const timeout = setTimeout(() => {\n        setCurrentLine(currentText.substring(0, charIndex + 1));\n        setCharIndex(charIndex + 1);\n      }, currentText.startsWith(\"$\") ? 60 : 30);\n      return () => clearTimeout(timeout);\n    } else {\n      const timeout = setTimeout(() => {\n        setLines([...lines, { text: currentLine, type: terminalLines[lineIndex].type }]);\n        setCurrentLine(\"\");\n        setLineIndex(lineIndex + 1);\n        setCharIndex(0);\n      }, currentText.startsWith(\"$\") ? 800 : 400);\n      return () => clearTimeout(timeout);\n    }\n  }, [lineIndex, charIndex, lines, terminalLines]);\n\n  const getLineColor = (type: string) => {\n    switch (type) {\n      case \"command\": return \"text-green-400\";\n      case \"success\": return \"text-cyan-400\";\n      case \"info\": return \"text-yellow-400\";\n      case \"loading\": return \"text-purple-400\";\n      case \"data\": return \"text-blue-400\";\n      default: return \"text-muted-foreground\";\n    }\n  };\n\n  return (\n    <div className=\"font-mono text-sm space-y-1 overflow-hidden\">\n      {lines.map((line, i) => (\n        <motion.div\n          key={i}\n          initial={{ opacity: 0, x: -10 }}\n          animate={{ opacity: 1, x: 0 }}\n          className={getLineColor(line.type)}\n        >\n          {line.text}\n        </motion.div>\n      ))}\n      {currentLine && (\n        <div className={getLineColor(terminalLines[lineIndex]?.type || \"\")}>\n          {currentLine}\n          {showBlink && <span className=\"text-green-400 ml-0.5\">â–ˆ</span>}\n        </div>\n      )}\n      {!currentLine && lineIndex < terminalLines.length && showBlink && (\n        <span className=\"text-green-400\">â–ˆ</span>\n      )}\n    </div>\n  );\n}\n\nfunction FloatingIcon({ icon: Icon, delay, x, y, color = \"primary\" }: { icon: any; delay: number; x: string; y: string; color?: string }) {\n  const colorClasses: Record<string, string> = {\n    primary: \"text-green-400 border-green-500/30 bg-green-500/10\",\n    secondary: \"text-cyan-400 border-cyan-500/30 bg-cyan-500/10\",\n    accent: \"text-purple-400 border-purple-500/30 bg-purple-500/10\",\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0, rotate: -180 }}\n      animate={{ opacity: 1, scale: 1, rotate: 0 }}\n      transition={{ delay, duration: 0.8, type: \"spring\" }}\n      className={`absolute ${x} ${y} hidden lg:block`}\n    >\n      <motion.div\n        animate={{ \n          y: [0, -15, 0],\n          rotate: [0, 5, -5, 0],\n          scale: [1, 1.05, 1]\n        }}\n        transition={{ duration: 5, repeat: Infinity, delay }}\n        className={`p-4 rounded-xl border backdrop-blur-md shadow-lg ${colorClasses[color]}`}\n      >\n        <Icon className=\"w-6 h-6\" />\n      </motion.div>\n    </motion.div>\n  );\n}\n\nfunction CyberGrid() {\n  return (\n    <div className=\"absolute inset-0 z-0 overflow-hidden\">\n      <div className=\"cyber-grid absolute inset-0 opacity-30\" />\n      <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-background\" />\n      <div className=\"absolute inset-0 bg-gradient-to-r from-background via-transparent to-background opacity-50\" />\n    </div>\n  );\n}\n\nfunction ScanLine() {\n  return (\n    <div className=\"absolute inset-0 z-10 pointer-events-none overflow-hidden\">\n      <motion.div\n        className=\"absolute left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-green-500/70 to-transparent\"\n        style={{ boxShadow: \"0 0 20px 5px rgba(0, 255, 65, 0.3)\" }}\n        animate={{ top: [\"-2px\", \"100%\"] }}\n        transition={{ duration: 6, repeat: Infinity, ease: \"linear\" }}\n      />\n    </div>\n  );\n}\n\nfunction HolographicBorder() {\n  return (\n    <motion.div\n      className=\"absolute -inset-1 rounded-2xl opacity-70\"\n      style={{\n        background: \"linear-gradient(90deg, #00ff41, #00d4ff, #7c3aed, #00ff41)\",\n        backgroundSize: \"300% 100%\",\n      }}\n      animate={{\n        backgroundPosition: [\"0% 50%\", \"100% 50%\", \"0% 50%\"],\n      }}\n      transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n    />\n  );\n}\n\nfunction StatsDisplay() {\n  const stats = [\n    { label: \"PROJECTS\", value: \"50+\", icon: Code2 },\n    { label: \"EXPERIENCE\", value: \"5Y+\", icon: Zap },\n    { label: \"CLIENTS\", value: \"30+\", icon: Globe },\n  ];\n\n  return (\n    <div className=\"flex gap-6 mt-8\">\n      {stats.map((stat, index) => (\n        <motion.div\n          key={stat.label}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 1 + index * 0.2 }}\n          className=\"flex items-center gap-2\"\n        >\n          <div className=\"p-2 rounded-lg bg-green-500/10 border border-green-500/20\">\n            <stat.icon className=\"w-4 h-4 text-green-400\" />\n          </div>\n          <div>\n            <p className=\"text-xl font-bold text-green-400 font-mono\">{stat.value}</p>\n            <p className=\"text-xs text-muted-foreground font-mono\">{stat.label}</p>\n          </div>\n        </motion.div>\n      ))}\n    </div>\n  );\n}\n\nexport function Hero() {\n  const [showCursor, setShowCursor] = useState(true);\n  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });\n\n  const { data: settings } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n    staleTime: 1000 * 60 * 5,\n  });\n\n  const heroTitle = settings?.heroTitle || \"NGUYEN THANH LOI\";\n  const heroSubtitle = settings?.heroSubtitle || \"Full-stack Developer & Security Enthusiast\";\n  const heroDescription = settings?.heroDescription || \"Crafting secure & performant digital experiences with code\";\n  const heroStatus = settings?.heroStatus || \"SYSTEM ONLINE\";\n  const heroCTA = settings?.heroCTA || \"View My Work\";\n  const cvFileUrl = settings?.cvFileUrl || \"\";\n\n  const handleDownloadCV = () => {\n    if (!cvFileUrl) {\n      alert(\"CV file not configured. Please upload a CV in Settings â†’ General â†’ Hero Section â†’ CV File Management\");\n      return;\n    }\n    const link = document.createElement(\"a\");\n    link.href = cvFileUrl;\n    link.download = cvFileUrl.split(\"/\").pop() || \"CV.pdf\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const nameParts = heroTitle.split(\" \");\n  const firstName = nameParts[0] || \"NGUYEN\";\n  const lastName = nameParts.slice(1).join(\" \") || \"THANH LOI\";\n\n  useEffect(() => {\n    const interval = setInterval(() => setShowCursor(prev => !prev), 530);\n    return () => clearInterval(interval);\n  }, []);\n\n  const handleMouseMove = useCallback((e: MouseEvent) => {\n    setMousePosition({ x: e.clientX, y: e.clientY });\n  }, []);\n\n  useEffect(() => {\n    window.addEventListener(\"mousemove\", handleMouseMove);\n    return () => window.removeEventListener(\"mousemove\", handleMouseMove);\n  }, [handleMouseMove]);\n\n  return (\n    <section id=\"home\" className=\"relative min-h-screen flex items-center pt-20 overflow-hidden bg-background\">\n      <MatrixRain />\n      <HexagonParticles />\n      <CyberGrid />\n      <NeonCircuit />\n      <ScanLine />\n\n      <FloatingIcon icon={Terminal} delay={0.5} x=\"left-[5%]\" y=\"top-[15%]\" color=\"primary\" />\n      <FloatingIcon icon={Code2} delay={0.7} x=\"right-[8%]\" y=\"top-[20%]\" color=\"secondary\" />\n      <FloatingIcon icon={Shield} delay={0.9} x=\"left-[8%]\" y=\"bottom-[25%]\" color=\"accent\" />\n      <FloatingIcon icon={Cpu} delay={1.1} x=\"right-[5%]\" y=\"bottom-[30%]\" color=\"primary\" />\n      <FloatingIcon icon={Database} delay={1.3} x=\"left-[15%]\" y=\"top-[40%]\" color=\"secondary\" />\n      <FloatingIcon icon={Server} delay={1.5} x=\"right-[15%]\" y=\"bottom-[45%]\" color=\"accent\" />\n\n      <div className=\"container mx-auto px-4 z-20 grid lg:grid-cols-2 gap-12 items-center\">\n        <motion.div\n          initial={{ opacity: 0, x: -100 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ duration: 1, type: \"spring\" }}\n          className=\"text-center lg:text-left\"\n        >\n          <motion.div \n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 0.2, type: \"spring\" }}\n            className=\"inline-flex items-center gap-3 px-5 py-2.5 rounded-full border border-green-500/40 bg-green-500/10 backdrop-blur-sm mb-8\"\n          >\n            <span className=\"relative flex h-3 w-3\">\n              <span className=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\"></span>\n              <span className=\"relative inline-flex rounded-full h-3 w-3 bg-green-500\"></span>\n            </span>\n            <span className=\"text-green-400 font-mono text-sm tracking-wider\">{heroStatus}</span>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.3 }}\n            className=\"mb-4\"\n          >\n            <div className=\"text-lg md:text-xl font-mono text-green-400 flex items-center justify-center lg:justify-start gap-2 mb-2\">\n              <span className=\"text-muted-foreground\">root@portfolio</span>\n              <span className=\"text-cyan-400\">:</span>\n              <span className=\"text-purple-400\">~</span>\n              <span className=\"text-muted-foreground\">$</span>\n              <span className=\"ml-2\">./introduce.sh</span>\n              {showCursor && <span className=\"text-green-400 animate-pulse\">â–ˆ</span>}\n            </div>\n          </motion.div>\n          \n          <motion.h1 \n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.4 }}\n            className=\"text-5xl md:text-6xl lg:text-7xl font-heading font-black mb-6 tracking-tighter\"\n          >\n            <GlitchText className=\"text-gradient block leading-tight\">{firstName}</GlitchText>\n            <motion.span \n              className=\"text-foreground block\"\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.6 }}\n            >\n              {lastName}\n            </motion.span>\n          </motion.h1>\n\n          <motion.div \n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 0.7 }}\n            className=\"text-xl md:text-2xl font-mono text-muted-foreground mb-8 flex items-center justify-center lg:justify-start gap-2\"\n          >\n            <span className=\"text-green-400\">&gt;</span>\n            <span className=\"text-cyan-400\">{heroSubtitle.split(\" & \")[0] || \"Full-stack\"}</span>\n            <span className=\"text-muted-foreground/50\">&</span>\n            <span className=\"text-purple-400\">{heroSubtitle.split(\" & \")[1] || \"Security Enthusiast\"}</span>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.8 }}\n            className=\"relative max-w-lg mx-auto lg:mx-0 mb-10\"\n          >\n            <div className=\"absolute -left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-green-500 via-cyan-500 to-purple-500 rounded-full\" />\n            <p className=\"text-lg text-muted-foreground leading-relaxed font-mono pl-4\">\n              <span className=\"text-green-400\">{\"/**\"}</span>\n              <br />\n              <span className=\"text-foreground/80 ml-2\">* {heroDescription}</span>\n              <br />\n              <span className=\"text-green-400\">{\" */\"}</span>\n            </p>\n          </motion.div>\n\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.9 }}\n            className=\"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start\"\n          >\n            <Button \n              size=\"lg\" \n              onClick={handleDownloadCV}\n              className=\"relative overflow-hidden bg-green-500 hover:bg-green-400 text-black font-mono font-bold gap-2 shadow-lg shadow-green-500/30 group border-2 border-green-400 px-8\"\n              data-testid=\"button-download-cv\"\n            >\n              <motion.div\n                className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent\"\n                animate={{ x: [\"-100%\", \"100%\"] }}\n                transition={{ duration: 2, repeat: Infinity, repeatDelay: 1 }}\n              />\n              <Download size={20} className=\"group-hover:-translate-y-1 transition-transform relative z-10\" /> \n              <span className=\"relative z-10\">Táº£i CV</span>\n            </Button>\n            <Button \n              size=\"lg\" \n              variant=\"outline\" \n              className=\"border-2 border-cyan-500/50 text-cyan-400 hover:bg-cyan-500/10 hover:border-cyan-400 font-mono font-bold gap-2 group px-8 backdrop-blur-sm\"\n              onClick={() => window.location.href = \"/projects\"}\n              data-testid=\"button-view-projects\"\n            >\n              {heroCTA}\n              <ArrowRight size={20} className=\"group-hover:translate-x-2 transition-transform\" />\n            </Button>\n          </motion.div>\n\n          <StatsDisplay />\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, scale: 0.8, rotateY: -30 }}\n          animate={{ opacity: 1, scale: 1, rotateY: 0 }}\n          transition={{ duration: 1, delay: 0.3, type: \"spring\" }}\n          className=\"relative flex items-center justify-center perspective-1000\"\n        >\n          <div className=\"relative\">\n            <motion.div \n              className=\"absolute -inset-6 rounded-3xl opacity-60\"\n              style={{\n                background: \"conic-gradient(from 0deg, #00ff41, #00d4ff, #7c3aed, #00ff41)\",\n                filter: \"blur(30px)\",\n              }}\n              animate={{ rotate: 360 }}\n              transition={{ duration: 10, repeat: Infinity, ease: \"linear\" }}\n            />\n            \n            <div className=\"relative\">\n              <HolographicBorder />\n              \n              <div className=\"relative bg-black/90 border border-green-500/40 rounded-2xl p-6 backdrop-blur-xl shadow-2xl\">\n                <div className=\"flex items-center gap-2 mb-4 border-b border-green-500/30 pb-4\">\n                  <div className=\"flex gap-2\">\n                    <motion.div \n                      className=\"w-3 h-3 rounded-full bg-red-500\"\n                      whileHover={{ scale: 1.2 }}\n                    />\n                    <motion.div \n                      className=\"w-3 h-3 rounded-full bg-yellow-500\"\n                      whileHover={{ scale: 1.2 }}\n                    />\n                    <motion.div \n                      className=\"w-3 h-3 rounded-full bg-green-500\"\n                      whileHover={{ scale: 1.2 }}\n                    />\n                  </div>\n                  <div className=\"flex-1 text-center\">\n                    <span className=\"text-xs font-mono text-muted-foreground\">\n                      terminal@{heroTitle.toLowerCase().replace(/\\s+/g, \"-\").slice(0, 12)}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <Lock className=\"w-3 h-3 text-green-500\" />\n                    <span className=\"text-xs text-green-500 font-mono\">SSH</span>\n                  </div>\n                </div>\n\n                <div className=\"w-72 md:w-96 h-52 md:h-64 overflow-hidden\">\n                  <CyberTerminal heroName={heroTitle} />\n                </div>\n\n                <div className=\"mt-4 pt-4 border-t border-green-500/30\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <motion.div \n                        className=\"w-14 h-14 rounded-full overflow-hidden border-2 border-green-500/60 shadow-lg shadow-green-500/20\"\n                        whileHover={{ scale: 1.1, borderColor: \"rgba(0, 255, 65, 1)\" }}\n                      >\n                        <img \n                          src={avatarImage} \n                          alt=\"Developer Avatar\" \n                          className=\"w-full h-full object-cover\"\n                        />\n                      </motion.div>\n                      <div>\n                        <p className=\"font-mono text-sm text-green-400\">\n                          @{heroTitle.toLowerCase().replace(/\\s+/g, \"_\").slice(0, 12)}\n                        </p>\n                        <div className=\"flex items-center gap-1\">\n                          <Wifi className=\"w-3 h-3 text-cyan-400\" />\n                          <p className=\"font-mono text-xs text-cyan-400\">online</p>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-mono text-xs text-green-400 mb-1\">UPTIME</p>\n                      <p className=\"font-mono text-lg text-foreground font-bold\">99.9%</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <motion.div\n                className=\"absolute -top-3 -right-3 px-4 py-2 bg-gradient-to-r from-green-500 to-cyan-500 text-black font-mono text-xs font-bold rounded-lg shadow-lg\"\n                animate={{ \n                  boxShadow: [\n                    \"0 0 20px rgba(0, 255, 65, 0.5)\",\n                    \"0 0 40px rgba(0, 255, 65, 0.8)\",\n                    \"0 0 20px rgba(0, 255, 65, 0.5)\",\n                  ]\n                }}\n                transition={{ duration: 2, repeat: Infinity }}\n              >\n                VERIFIED DEV\n              </motion.div>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n\n      <motion.div \n        animate={{ y: [0, 10, 0] }}\n        transition={{ duration: 2, repeat: Infinity }}\n        className=\"absolute bottom-8 left-1/2 -translate-x-1/2 text-green-400 font-mono text-sm\"\n      >\n        <div className=\"flex flex-col items-center gap-3\">\n          <span className=\"text-xs tracking-widest opacity-70\">SCROLL_DOWN</span>\n          <div className=\"w-6 h-10 border-2 border-green-500/50 rounded-full flex justify-center p-1.5 backdrop-blur-sm\">\n            <motion.div \n              className=\"w-1.5 h-1.5 bg-green-400 rounded-full shadow-lg shadow-green-500/50\"\n              animate={{ y: [0, 18, 0] }}\n              transition={{ duration: 1.5, repeat: Infinity }}\n            />\n          </div>\n        </div>\n      </motion.div>\n    </section>\n  );\n}\n","path":null,"size_bytes":27997,"size_tokens":null},"client/src/context/LanguageContext.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\n\nexport type LanguageCode = \"en\" | \"vi\" | string;\n\nexport interface TranslationData {\n  [key: string]: string;\n}\n\nexport interface LanguageData {\n  code: string;\n  name: string;\n  nativeName: string;\n  translations: TranslationData;\n}\n\ninterface LanguageContextType {\n  currentLanguage: LanguageCode;\n  setCurrentLanguage: (lang: LanguageCode) => void;\n  languages: LanguageData[];\n  addLanguage: (language: LanguageData) => void;\n  removeLanguage: (code: string) => void;\n  updateTranslations: (code: string, translations: TranslationData) => void;\n  t: (key: string, fallback?: string) => string;\n  exportLanguage: (code: string) => string;\n  importLanguage: (jsonData: string) => boolean;\n}\n\nconst defaultLanguages: LanguageData[] = [\n  {\n    code: \"en\",\n    name: \"English\",\n    nativeName: \"English\",\n    translations: {\n      \"site.title\": \"Loi Developer\",\n      \"site.tagline\": \"Building digital experiences with code.\",\n      \"nav.home\": \"Home\",\n      \"nav.about\": \"About\",\n      \"nav.skills\": \"Skills\",\n      \"nav.services\": \"Services\",\n      \"nav.projects\": \"Projects\",\n      \"nav.testimonials\": \"Testimonials\",\n      \"nav.blog\": \"Blog\",\n      \"nav.contact\": \"Contact\",\n      \"hero.greeting\": \"Hey there, I'm\",\n      \"hero.role\": \"Full-stack Developer\",\n      \"hero.role2\": \"Security Enthusiast\",\n      \"hero.description\": \"Crafting secure & performant digital experiences with code\",\n      \"hero.downloadCV\": \"Download CV\",\n      \"hero.viewProjects\": \"View Projects\",\n      \"hero.scrollDown\": \"Scroll Down\",\n      \"about.title\": \"About Me\",\n      \"about.subtitle\": \"Get to know me better\",\n      \"skills.title\": \"Skills\",\n      \"skills.subtitle\": \"Technologies I work with\",\n      \"services.title\": \"Services\",\n      \"services.subtitle\": \"What I can do for you\",\n      \"projects.title\": \"Projects\",\n      \"projects.subtitle\": \"Recent works\",\n      \"testimonials.title\": \"Testimonials\",\n      \"testimonials.subtitle\": \"What clients say\",\n      \"blog.title\": \"Blog\",\n      \"blog.subtitle\": \"Latest articles\",\n      \"contact.title\": \"Contact\",\n      \"contact.subtitle\": \"Get in touch\",\n      \"contact.name\": \"Name\",\n      \"contact.email\": \"Email\",\n      \"contact.message\": \"Message\",\n      \"contact.send\": \"Send Message\",\n      \"footer.copyright\": \"All rights reserved\",\n      \"admin.dashboard\": \"Dashboard\",\n      \"admin.settings\": \"Settings\",\n      \"admin.posts\": \"Posts\",\n      \"admin.projects\": \"Projects\",\n      \"admin.services\": \"Services\",\n      \"admin.media\": \"Media\",\n      \"admin.users\": \"Users\",\n      \"admin.logout\": \"Logout\",\n      \"nav.pages\": \"Pages\",\n      \"nav.faqs\": \"FAQs\",\n    },\n  },\n  {\n    code: \"vi\",\n    name: \"Vietnamese\",\n    nativeName: \"Tiáº¿ng Viá»‡t\",\n    translations: {\n      \"site.title\": \"Loi Developer\",\n      \"site.tagline\": \"XÃ¢y dá»±ng tráº£i nghiá»‡m sá»‘ vá»›i code.\",\n      \"nav.home\": \"Trang chá»§\",\n      \"nav.about\": \"Giá»›i thiá»‡u\",\n      \"nav.skills\": \"Ká»¹ nÄƒng\",\n      \"nav.services\": \"Dá»‹ch vá»¥\",\n      \"nav.projects\": \"Dá»± Ã¡n\",\n      \"nav.testimonials\": \"ÄÃ¡nh giÃ¡\",\n      \"nav.blog\": \"Blog\",\n      \"nav.contact\": \"LiÃªn há»‡\",\n      \"hero.greeting\": \"Xin chÃ o, tÃ´i lÃ \",\n      \"hero.role\": \"Láº­p trÃ¬nh viÃªn Full-stack\",\n      \"hero.role2\": \"ChuyÃªn gia Báº£o máº­t\",\n      \"hero.description\": \"Táº¡o ra nhá»¯ng tráº£i nghiá»‡m sá»‘ an toÃ n vÃ  hiá»‡u suáº¥t cao vá»›i code\",\n      \"hero.downloadCV\": \"Táº£i CV\",\n      \"hero.viewProjects\": \"Xem Dá»± Ã¡n\",\n      \"hero.scrollDown\": \"Cuá»™n xuá»‘ng\",\n      \"about.title\": \"Vá» tÃ´i\",\n      \"about.subtitle\": \"TÃ¬m hiá»ƒu thÃªm vá» tÃ´i\",\n      \"skills.title\": \"Ká»¹ nÄƒng\",\n      \"skills.subtitle\": \"CÃ´ng nghá»‡ tÃ´i sá»­ dá»¥ng\",\n      \"services.title\": \"Dá»‹ch vá»¥\",\n      \"services.subtitle\": \"Nhá»¯ng gÃ¬ tÃ´i cÃ³ thá»ƒ lÃ m cho báº¡n\",\n      \"projects.title\": \"Dá»± Ã¡n\",\n      \"projects.subtitle\": \"CÃ¡c cÃ´ng viá»‡c gáº§n Ä‘Ã¢y\",\n      \"testimonials.title\": \"ÄÃ¡nh giÃ¡\",\n      \"testimonials.subtitle\": \"KhÃ¡ch hÃ ng nÃ³i gÃ¬\",\n      \"blog.title\": \"Blog\",\n      \"blog.subtitle\": \"BÃ i viáº¿t má»›i nháº¥t\",\n      \"contact.title\": \"LiÃªn há»‡\",\n      \"contact.subtitle\": \"Káº¿t ná»‘i vá»›i tÃ´i\",\n      \"contact.name\": \"Há» tÃªn\",\n      \"contact.email\": \"Email\",\n      \"contact.message\": \"Tin nháº¯n\",\n      \"contact.send\": \"Gá»­i tin nháº¯n\",\n      \"footer.copyright\": \"ÄÃ£ Ä‘Äƒng kÃ½ báº£n quyá»n\",\n      \"admin.dashboard\": \"Báº£ng Ä‘iá»u khiá»ƒn\",\n      \"admin.settings\": \"CÃ i Ä‘áº·t\",\n      \"admin.posts\": \"BÃ i viáº¿t\",\n      \"admin.projects\": \"Dá»± Ã¡n\",\n      \"admin.services\": \"Dá»‹ch vá»¥\",\n      \"admin.media\": \"Media\",\n      \"admin.users\": \"NgÆ°á»i dÃ¹ng\",\n      \"admin.logout\": \"ÄÄƒng xuáº¥t\",\n      \"nav.pages\": \"Trang\",\n      \"nav.faqs\": \"CÃ¢u há»i thÆ°á»ng gáº·p\",\n    },\n  },\n];\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\nexport function LanguageProvider({ children }: { children: ReactNode }) {\n  const [currentLanguage, setCurrentLanguage] = useState<LanguageCode>(\"en\");\n  const [languages, setLanguages] = useState<LanguageData[]>(defaultLanguages);\n\n  useEffect(() => {\n    const storedLang = localStorage.getItem(\"currentLanguage\");\n    if (storedLang) {\n      setCurrentLanguage(storedLang);\n    }\n\n    const storedLanguages = localStorage.getItem(\"languages\");\n    if (storedLanguages) {\n      try {\n        setLanguages(JSON.parse(storedLanguages));\n      } catch (e) {\n        console.error(\"Failed to parse languages:\", e);\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem(\"currentLanguage\", currentLanguage);\n  }, [currentLanguage]);\n\n  useEffect(() => {\n    localStorage.setItem(\"languages\", JSON.stringify(languages));\n  }, [languages]);\n\n  const addLanguage = (language: LanguageData) => {\n    setLanguages((prev) => {\n      const existing = prev.findIndex((l) => l.code === language.code);\n      if (existing >= 0) {\n        const updated = [...prev];\n        updated[existing] = language;\n        return updated;\n      }\n      return [...prev, language];\n    });\n  };\n\n  const removeLanguage = (code: string) => {\n    if (code === \"en\") return;\n    setLanguages((prev) => prev.filter((l) => l.code !== code));\n    if (currentLanguage === code) {\n      setCurrentLanguage(\"en\");\n    }\n  };\n\n  const updateTranslations = (code: string, translations: TranslationData) => {\n    setLanguages((prev) =>\n      prev.map((lang) =>\n        lang.code === code\n          ? { ...lang, translations: { ...lang.translations, ...translations } }\n          : lang\n      )\n    );\n  };\n\n  const t = (key: string, fallback?: string): string => {\n    const lang = languages.find((l) => l.code === currentLanguage);\n    if (lang && lang.translations[key]) {\n      return lang.translations[key];\n    }\n    const enLang = languages.find((l) => l.code === \"en\");\n    if (enLang && enLang.translations[key]) {\n      return enLang.translations[key];\n    }\n    return fallback || key;\n  };\n\n  const exportLanguage = (code: string): string => {\n    const lang = languages.find((l) => l.code === code);\n    if (!lang) return \"\";\n    return JSON.stringify(lang, null, 2);\n  };\n\n  const importLanguage = (jsonData: string): boolean => {\n    try {\n      const data = JSON.parse(jsonData) as LanguageData;\n      if (!data.code || !data.name || !data.translations) {\n        return false;\n      }\n      addLanguage(data);\n      return true;\n    } catch (e) {\n      console.error(\"Failed to import language:\", e);\n      return false;\n    }\n  };\n\n  return (\n    <LanguageContext.Provider\n      value={{\n        currentLanguage,\n        setCurrentLanguage,\n        languages,\n        addLanguage,\n        removeLanguage,\n        updateTranslations,\n        t,\n        exportLanguage,\n        importLanguage,\n      }}\n    >\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useLanguage() {\n  const context = useContext(LanguageContext);\n  if (context === undefined) {\n    throw new Error(\"useLanguage must be used within a LanguageProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":8071,"size_tokens":null},"client/src/components/admin/image-gallery.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Upload, Trash2, Eye, ChevronLeft, ChevronRight, Link as LinkIcon } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\ninterface Image {\n  id: number;\n  url: string;\n  alt: string;\n}\n\ninterface ImageGalleryProps {\n  images: Image[];\n  onAddImage?: (url: string, alt: string) => void;\n  onDeleteImage?: (id: number) => void;\n  onReorder?: (images: Image[]) => void;\n}\n\nexport function ImageGallery({\n  images,\n  onAddImage,\n  onDeleteImage,\n  onReorder,\n}: ImageGalleryProps) {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const [draggedItem, setDraggedItem] = useState<number | null>(null);\n  const [showUploadDialog, setShowUploadDialog] = useState(false);\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [imageAlt, setImageAlt] = useState(\"\");\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleDragStart = (index: number) => {\n    setDraggedItem(index);\n  };\n\n  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setUploading(true);\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64String = reader.result as string;\n      setImageUrl(base64String);\n      setImageAlt(file.name);\n      setUploading(false);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleAddImage = () => {\n    if (imageUrl && onAddImage) {\n      onAddImage(imageUrl, imageAlt || \"Image\");\n      setImageUrl(\"\");\n      setImageAlt(\"\");\n      setShowUploadDialog(false);\n    }\n  };\n\n  const openUploadDialog = () => {\n    setShowUploadDialog(true);\n    setImageUrl(\"\");\n    setImageAlt(\"\");\n  };\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault();\n    if (draggedItem === null || draggedItem === index) return;\n\n    const newImages = [...images];\n    const [draggedImage] = newImages.splice(draggedItem, 1);\n    newImages.splice(index, 0, draggedImage);\n    onReorder?.(newImages);\n    setDraggedItem(index);\n  };\n\n  const next = () => setSelectedIndex((i) => (i + 1) % images.length);\n  const prev = () =>\n    setSelectedIndex((i) => (i - 1 + images.length) % images.length);\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Lightbox Preview */}\n      {images.length > 0 && (\n        <Card className=\"relative bg-muted aspect-video overflow-hidden flex items-center justify-center\">\n          <div className=\"w-full h-full bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center\">\n            <div className=\"text-center\">\n              <Eye className=\"w-8 h-8 text-muted-foreground mx-auto mb-2\" />\n              <p className=\"text-sm text-muted-foreground\">{images[selectedIndex]?.alt}</p>\n            </div>\n          </div>\n\n          {images.length > 1 && (\n            <>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"absolute left-2 top-1/2 -translate-y-1/2\"\n                onClick={prev}\n              >\n                <ChevronLeft className=\"w-6 h-6\" />\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"absolute right-2 top-1/2 -translate-y-1/2\"\n                onClick={next}\n              >\n                <ChevronRight className=\"w-6 h-6\" />\n              </Button>\n              <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 text-xs bg-black/50 text-white px-2 py-1 rounded\">\n                {selectedIndex + 1} / {images.length}\n              </div>\n            </>\n          )}\n        </Card>\n      )}\n\n      {/* Thumbnails & Drag-drop */}\n      <div className=\"space-y-2\">\n        <div className=\"flex justify-between items-center\">\n          <h4 className=\"font-medium text-sm\">Gallery ({images.length})</h4>\n          {onAddImage && (\n            <Button size=\"sm\" variant=\"outline\" onClick={openUploadDialog} className=\"gap-2\">\n              <Upload className=\"w-4 h-4\" /> Add Image\n            </Button>\n          )}\n        </div>\n\n        <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2\">\n          {images.map((img, idx) => (\n            <div\n              key={img.id}\n              draggable\n              onDragStart={() => handleDragStart(idx)}\n              onDragOver={(e) => handleDragOver(e, idx)}\n              onDragEnd={() => setDraggedItem(null)}\n              className={`relative group aspect-square rounded-lg overflow-hidden border-2 transition-all cursor-move ${\n                selectedIndex === idx\n                  ? \"border-primary\"\n                  : \"border-border hover:border-primary/50\"\n              } ${draggedItem === idx ? \"opacity-50\" : \"\"}`}\n              onClick={() => setSelectedIndex(idx)}\n            >\n              <div className=\"w-full h-full bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center\">\n                <span className=\"text-xs text-muted-foreground text-center px-1\">\n                  {img.alt}\n                </span>\n              </div>\n              <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100\">\n                {onDeleteImage && (\n                  <Button\n                    variant=\"destructive\"\n                    size=\"icon\"\n                    className=\"h-6 w-6\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onDeleteImage(img.id);\n                    }}\n                  >\n                    <Trash2 className=\"w-3 h-3\" />\n                  </Button>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n        <p className=\"text-xs text-muted-foreground\">Drag to reorder images</p>\n      </div>\n\n      {/* Upload Dialog */}\n      <Dialog open={showUploadDialog} onOpenChange={setShowUploadDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Add Image</DialogTitle>\n          </DialogHeader>\n          <Tabs defaultValue=\"url\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"url\">From URL</TabsTrigger>\n              <TabsTrigger value=\"upload\">Upload File</TabsTrigger>\n            </TabsList>\n            <TabsContent value=\"url\" className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"image-url\">Image URL</Label>\n                <Input\n                  id=\"image-url\"\n                  placeholder=\"https://example.com/image.jpg or /images/blog/bg-1.png\"\n                  value={imageUrl}\n                  onChange={(e) => setImageUrl(e.target.value)}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"image-alt\">Image Description</Label>\n                <Input\n                  id=\"image-alt\"\n                  placeholder=\"Description of the image\"\n                  value={imageAlt}\n                  onChange={(e) => setImageAlt(e.target.value)}\n                />\n              </div>\n              {imageUrl && (\n                <div className=\"border rounded-md overflow-hidden\">\n                  <img src={imageUrl} alt=\"Preview\" className=\"w-full h-40 object-cover\" />\n                </div>\n              )}\n            </TabsContent>\n            <TabsContent value=\"upload\" className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label>Upload Image</Label>\n                <div className=\"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer hover:border-primary/50\" onClick={() => fileInputRef.current?.click()}>\n                  <Upload className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                  <p className=\"text-sm text-muted-foreground\">Click to upload or drag and drop</p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">PNG, JPG, GIF, WebP (Max 10MB)</p>\n                </div>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleFileUpload}\n                  className=\"hidden\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"upload-alt\">Image Description</Label>\n                <Input\n                  id=\"upload-alt\"\n                  placeholder=\"Description of the image\"\n                  value={imageAlt}\n                  onChange={(e) => setImageAlt(e.target.value)}\n                />\n              </div>\n              {imageUrl && (\n                <div className=\"border rounded-md overflow-hidden\">\n                  <img src={imageUrl} alt=\"Preview\" className=\"w-full h-40 object-cover\" />\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n          <div className=\"flex gap-2 justify-end\">\n            <Button variant=\"outline\" onClick={() => setShowUploadDialog(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleAddImage} disabled={!imageUrl || uploading}>\n              {uploading ? \"Uploading...\" : \"Add Image\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":9697,"size_tokens":null},"client/src/pages/admin/ExportImport.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Download, Upload, FileJson, Loader2, CheckCircle, AlertTriangle } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Exportable {\n  id: string;\n  name: string;\n  description: string;\n  endpoint: string;\n  icon: React.ReactNode;\n}\n\nexport default function AdminExportImport() {\n  const { toast } = useToast();\n  const [exportLoading, setExportLoading] = useState<string | null>(null);\n  const [importLoading, setImportLoading] = useState(false);\n  const [recentExports, setRecentExports] = useState<any[]>([]);\n\n  const exportables: Exportable[] = [\n    {\n      id: \"posts\",\n      name: \"Posts\",\n      description: \"All blog posts and articles\",\n      endpoint: \"/api/posts\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"projects\",\n      name: \"Projects\",\n      description: \"All portfolio projects\",\n      endpoint: \"/api/projects\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"skills\",\n      name: \"Skills\",\n      description: \"All technical skills\",\n      endpoint: \"/api/skills\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"services\",\n      name: \"Services\",\n      description: \"All offered services\",\n      endpoint: \"/api/services\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"testimonials\",\n      name: \"Testimonials\",\n      description: \"All client testimonials\",\n      endpoint: \"/api/testimonials\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"settings\",\n      name: \"Settings\",\n      description: \"Site configuration and settings\",\n      endpoint: \"/api/settings\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n  ];\n\n  const handleExport = async (exportable: Exportable) => {\n    setExportLoading(exportable.id);\n    try {\n      const res = await fetch(exportable.endpoint, { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch data\");\n      const data = await res.json();\n\n      const jsonString = JSON.stringify(data, null, 2);\n      const blob = new Blob([jsonString], { type: \"application/json\" });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `${exportable.id}_export_${new Date().toISOString().split(\"T\")[0]}.json`;\n      a.click();\n      window.URL.revokeObjectURL(url);\n\n      const newExport = {\n        name: a.download,\n        size: (blob.size / 1024).toFixed(2) + \" KB\",\n        date: new Date().toLocaleDateString(),\n        timestamp: new Date(),\n      };\n\n      setRecentExports((prev) => [newExport, ...prev].slice(0, 10));\n      toast({\n        title: \"Success\",\n        description: `Exported ${exportable.name} successfully`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to export\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setExportLoading(null);\n    }\n  };\n\n  const handleImport = async (file: File) => {\n    setImportLoading(true);\n    try {\n      const fileContent = await file.text();\n      const data = JSON.parse(fileContent);\n\n      const fileName = file.name.toLowerCase();\n      let endpoint = \"/api/posts\";\n\n      if (fileName.includes(\"project\")) endpoint = \"/api/projects\";\n      else if (fileName.includes(\"skill\")) endpoint = \"/api/skills\";\n      else if (fileName.includes(\"service\")) endpoint = \"/api/services\";\n      else if (fileName.includes(\"testimonial\")) endpoint = \"/api/testimonials\";\n      else if (fileName.includes(\"setting\")) endpoint = \"/api/settings\";\n\n      if (Array.isArray(data)) {\n        let successCount = 0;\n        for (const item of data) {\n          try {\n            const res = await fetch(endpoint, {\n              method: \"POST\",\n              headers: { \"Content-Type\": \"application/json\" },\n              credentials: \"include\",\n              body: JSON.stringify(item),\n            });\n            if (res.ok) successCount++;\n          } catch (e) {\n            console.error(\"Failed to import item:\", e);\n          }\n        }\n        toast({\n          title: \"Import Complete\",\n          description: `Successfully imported ${successCount} out of ${data.length} items`,\n        });\n      } else {\n        const res = await fetch(endpoint, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          credentials: \"include\",\n          body: JSON.stringify(data),\n        });\n        if (res.ok) {\n          toast({\n            title: \"Success\",\n            description: \"Data imported successfully\",\n          });\n        }\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to import file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setImportLoading(false);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      if (!file.name.endsWith(\".json\")) {\n        toast({\n          title: \"Error\",\n          description: \"Please upload a JSON file\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n      handleImport(file);\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">Export & Import Data</h1>\n          <p className=\"text-muted-foreground\">\n            Backup and restore your content data\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          {/* Export Section */}\n          <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-semibold\">Export Data</h2>\n            <div className=\"space-y-3\">\n              {exportables.map((exportable) => (\n                <Card key={exportable.id}>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex items-start gap-3 flex-1 min-w-0\">\n                        <div className=\"p-2 bg-primary/10 rounded flex-shrink-0\">\n                          {exportable.icon}\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-semibold text-sm\">{exportable.name}</h3>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {exportable.description}\n                          </p>\n                        </div>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        disabled={exportLoading === exportable.id}\n                        onClick={() => handleExport(exportable)}\n                        data-testid={`button-export-${exportable.id}`}\n                        className=\"flex-shrink-0 gap-1\"\n                      >\n                        {exportLoading === exportable.id ? (\n                          <Loader2 className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <Download className=\"w-3 h-3\" />\n                        )}\n                        Export\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n\n          {/* Import Section */}\n          <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-semibold\">Import Data</h2>\n            <Card>\n              <CardContent className=\"p-6\">\n                <label className=\"cursor-pointer block\">\n                  <div className=\"border-2 border-dashed border-muted-foreground/20 rounded-lg p-8 flex flex-col items-center justify-center hover:border-primary/50 hover:bg-primary/5 transition-all\">\n                    {importLoading ? (\n                      <>\n                        <Loader2 className=\"w-12 h-12 text-primary mb-3 animate-spin\" />\n                        <h3 className=\"font-semibold mb-1\">Importing...</h3>\n                      </>\n                    ) : (\n                      <>\n                        <Upload className=\"w-12 h-12 text-muted-foreground mb-3\" />\n                        <h3 className=\"font-semibold mb-1\">Drop JSON file or click</h3>\n                        <p className=\"text-xs text-muted-foreground text-center\">\n                          Supported: JSON files from posts, projects, skills, services, or testimonials\n                        </p>\n                      </>\n                    )}\n                  </div>\n                  <input\n                    type=\"file\"\n                    accept=\".json\"\n                    onChange={handleFileSelect}\n                    disabled={importLoading}\n                    className=\"hidden\"\n                    data-testid=\"input-file-import\"\n                  />\n                </label>\n                <div className=\"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg\">\n                  <p className=\"text-xs text-muted-foreground\">\n                    ðŸ’¡ Export files automatically detect the data type and import to the correct location.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        {/* Recent Exports */}\n        {recentExports.length > 0 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>Recent Exports</CardTitle>\n              <CardDescription>\n                Last {recentExports.length} exported files\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2\">\n                {recentExports.map((file, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center justify-between p-3 border rounded-lg\"\n                  >\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                      <CheckCircle className=\"w-4 h-4 text-green-500 flex-shrink-0\" />\n                      <div className=\"min-w-0 flex-1\">\n                        <p className=\"font-medium text-sm truncate\">{file.name}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {file.date} â€¢ {file.size}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Info Section */}\n        <Card className=\"border-blue-500/20 bg-blue-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"w-5 h-5 text-blue-500\" />\n              Export & Import Guide\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2 text-sm text-muted-foreground\">\n            <p>\n              â€¢ Export your data as JSON format for backup or migration purposes\n            </p>\n            <p>â€¢ Import JSON files to add or update your content data</p>\n            <p>â€¢ Files are detected by name - use original export names when possible</p>\n            <p>\n              â€¢ Each export includes a timestamp for easy version control\n            </p>\n            <p>â€¢ All imports are validated before processing</p>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11855,"size_tokens":null},"client/src/pages/admin/LanguageManager.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Languages, Plus, Download, Upload, Trash2, Edit2, Check, X, Globe, Search\n} from \"lucide-react\";\nimport { useState, useRef } from \"react\";\nimport { useLanguage, LanguageData, TranslationData } from \"@/context/LanguageContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\n\nexport default function LanguageManager() {\n  const { \n    languages, \n    currentLanguage, \n    setCurrentLanguage, \n    addLanguage, \n    removeLanguage, \n    updateTranslations,\n    exportLanguage,\n    importLanguage \n  } = useLanguage();\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  const [newLangCode, setNewLangCode] = useState(\"\");\n  const [newLangName, setNewLangName] = useState(\"\");\n  const [newLangNative, setNewLangNative] = useState(\"\");\n  const [editingKey, setEditingKey] = useState<string | null>(null);\n  const [editingValue, setEditingValue] = useState(\"\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedLang, setSelectedLang] = useState<string>(languages[0]?.code || \"en\");\n  const [newKeyDialog, setNewKeyDialog] = useState(false);\n  const [newKey, setNewKey] = useState(\"\");\n  const [newTranslations, setNewTranslations] = useState<Record<string, string>>({});\n\n  const handleAddLanguage = () => {\n    if (!newLangCode || !newLangName) {\n      toast({ title: \"Error\", description: \"Please fill in all required fields\", variant: \"destructive\" });\n      return;\n    }\n\n    const baseTranslations = languages.find(l => l.code === \"en\")?.translations || {};\n    \n    addLanguage({\n      code: newLangCode.toLowerCase(),\n      name: newLangName,\n      nativeName: newLangNative || newLangName,\n      translations: { ...baseTranslations },\n    });\n\n    toast({ title: \"Success\", description: `Language \"${newLangName}\" added successfully` });\n    setNewLangCode(\"\");\n    setNewLangName(\"\");\n    setNewLangNative(\"\");\n  };\n\n  const handleExport = (code: string) => {\n    const data = exportLanguage(code);\n    const blob = new Blob([data], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `language_${code}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n    toast({ title: \"Exported\", description: `Language file exported successfully` });\n  };\n\n  const handleImport = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const content = event.target?.result as string;\n      if (importLanguage(content)) {\n        toast({ title: \"Imported\", description: \"Language imported successfully\" });\n      } else {\n        toast({ title: \"Error\", description: \"Invalid language file format\", variant: \"destructive\" });\n      }\n    };\n    reader.readAsText(file);\n    e.target.value = \"\";\n  };\n\n  const handleSaveTranslation = (langCode: string, key: string, value: string) => {\n    updateTranslations(langCode, { [key]: value });\n    setEditingKey(null);\n    setEditingValue(\"\");\n    toast({ title: \"Saved\", description: \"Translation updated\" });\n  };\n\n  const handleAddKey = () => {\n    if (!newKey) return;\n    \n    languages.forEach(lang => {\n      updateTranslations(lang.code, { [newKey]: newTranslations[lang.code] || newKey });\n    });\n    \n    setNewKeyDialog(false);\n    setNewKey(\"\");\n    setNewTranslations({});\n    toast({ title: \"Added\", description: \"New translation key added\" });\n  };\n\n  const filteredKeys = Object.keys(languages.find(l => l.code === selectedLang)?.translations || {})\n    .filter(key => \n      key.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (languages.find(l => l.code === selectedLang)?.translations[key] || \"\")\n        .toLowerCase().includes(searchQuery.toLowerCase())\n    );\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold flex items-center gap-2\">\n              <Languages className=\"w-8 h-8\" /> Language Manager\n            </h1>\n            <p className=\"text-muted-foreground\">Manage translations and language settings</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <input \n              type=\"file\" \n              ref={fileInputRef} \n              className=\"hidden\" \n              accept=\".json\"\n              onChange={handleImport}\n            />\n            <Button variant=\"outline\" onClick={() => fileInputRef.current?.click()}>\n              <Upload className=\"w-4 h-4 mr-2\" /> Import\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <Card className=\"lg:col-span-1\">\n            <CardHeader>\n              <CardTitle>Languages</CardTitle>\n              <CardDescription>Available languages in your site</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                {languages.map((lang) => (\n                  <div \n                    key={lang.code}\n                    className={`flex items-center justify-between p-3 border rounded-lg cursor-pointer transition-colors ${\n                      selectedLang === lang.code ? \"border-primary bg-primary/5\" : \"hover:border-primary/50\"\n                    }`}\n                    onClick={() => setSelectedLang(lang.code)}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Globe className=\"w-5 h-5 text-muted-foreground\" />\n                      <div>\n                        <p className=\"font-medium\">{lang.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{lang.nativeName} ({lang.code})</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {currentLanguage === lang.code && (\n                        <Badge variant=\"secondary\">Active</Badge>\n                      )}\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handleExport(lang.code);\n                        }}\n                      >\n                        <Download className=\"w-4 h-4\" />\n                      </Button>\n                      {lang.code !== \"en\" && (\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          className=\"text-destructive\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            removeLanguage(lang.code);\n                            toast({ title: \"Removed\", description: `Language \"${lang.name}\" removed` });\n                          }}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"pt-4 border-t space-y-3\">\n                <h4 className=\"font-medium text-sm\">Add New Language</h4>\n                <div className=\"space-y-2\">\n                  <Input \n                    placeholder=\"Language code (e.g. fr, de, ja)\" \n                    value={newLangCode}\n                    onChange={(e) => setNewLangCode(e.target.value)}\n                  />\n                  <Input \n                    placeholder=\"Language name (e.g. French)\" \n                    value={newLangName}\n                    onChange={(e) => setNewLangName(e.target.value)}\n                  />\n                  <Input \n                    placeholder=\"Native name (e.g. FranÃ§ais)\" \n                    value={newLangNative}\n                    onChange={(e) => setNewLangNative(e.target.value)}\n                  />\n                  <Button className=\"w-full\" onClick={handleAddLanguage}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Language\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"lg:col-span-2\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>Translations</CardTitle>\n                  <CardDescription>\n                    Edit translations for {languages.find(l => l.code === selectedLang)?.name}\n                  </CardDescription>\n                </div>\n                <Dialog open={newKeyDialog} onOpenChange={setNewKeyDialog}>\n                  <DialogTrigger asChild>\n                    <Button size=\"sm\">\n                      <Plus className=\"w-4 h-4 mr-2\" /> Add Key\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Add Translation Key</DialogTitle>\n                      <DialogDescription>\n                        Add a new translation key and its values for all languages\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-4 py-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Translation Key</Label>\n                        <Input \n                          placeholder=\"e.g. nav.newPage\"\n                          value={newKey}\n                          onChange={(e) => setNewKey(e.target.value)}\n                        />\n                      </div>\n                      {languages.map(lang => (\n                        <div key={lang.code} className=\"space-y-2\">\n                          <Label>{lang.name} ({lang.code})</Label>\n                          <Input \n                            placeholder={`Translation in ${lang.name}`}\n                            value={newTranslations[lang.code] || \"\"}\n                            onChange={(e) => setNewTranslations(prev => ({\n                              ...prev,\n                              [lang.code]: e.target.value\n                            }))}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                    <DialogFooter>\n                      <Button variant=\"outline\" onClick={() => setNewKeyDialog(false)}>\n                        Cancel\n                      </Button>\n                      <Button onClick={handleAddKey}>Add Key</Button>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"mb-4\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"Search translations...\"\n                    className=\"pl-9\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2 max-h-[500px] overflow-y-auto pr-2\">\n                {filteredKeys.map((key) => {\n                  const lang = languages.find(l => l.code === selectedLang);\n                  const value = lang?.translations[key] || \"\";\n                  const isEditing = editingKey === key;\n\n                  return (\n                    <div key={key} className=\"p-3 border rounded-lg\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <code className=\"text-xs bg-muted px-2 py-1 rounded font-mono\">{key}</code>\n                        {!isEditing && (\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\"\n                            onClick={() => {\n                              setEditingKey(key);\n                              setEditingValue(value);\n                            }}\n                          >\n                            <Edit2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                      {isEditing ? (\n                        <div className=\"flex gap-2\">\n                          <Input \n                            value={editingValue}\n                            onChange={(e) => setEditingValue(e.target.value)}\n                            className=\"flex-1\"\n                          />\n                          <Button \n                            size=\"icon\" \n                            variant=\"ghost\"\n                            onClick={() => handleSaveTranslation(selectedLang, key, editingValue)}\n                          >\n                            <Check className=\"w-4 h-4 text-green-500\" />\n                          </Button>\n                          <Button \n                            size=\"icon\" \n                            variant=\"ghost\"\n                            onClick={() => {\n                              setEditingKey(null);\n                              setEditingValue(\"\");\n                            }}\n                          >\n                            <X className=\"w-4 h-4 text-red-500\" />\n                          </Button>\n                        </div>\n                      ) : (\n                        <p className=\"text-sm\">{value}</p>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Default Language</CardTitle>\n            <CardDescription>Set the default language for your site</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {languages.map((lang) => (\n                <Button\n                  key={lang.code}\n                  variant={currentLanguage === lang.code ? \"default\" : \"outline\"}\n                  onClick={() => {\n                    setCurrentLanguage(lang.code);\n                    toast({ title: \"Default Changed\", description: `Default language set to ${lang.name}` });\n                  }}\n                >\n                  <Globe className=\"w-4 h-4 mr-2\" />\n                  {lang.name}\n                </Button>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":15424,"size_tokens":null},"server/storage.ts":{"content":"import {\n  users, type User, type InsertUser,\n  projects, type Project, type InsertProject,\n  posts, type Post, type InsertPost,\n  pages, type Page, type InsertPage,\n  skills, type Skill, type InsertSkill,\n  services, type Service, type InsertService,\n  testimonials, type Testimonial, type InsertTestimonial,\n  messages, type Message, type InsertMessage,\n  activityLogs, type ActivityLog, type InsertActivityLog,\n  notifications, type Notification, type InsertNotification,\n  siteSettings, type SiteSetting, type InsertSiteSetting,\n  categories, type Category, type InsertCategory,\n  media, type Media, type InsertMedia,\n  comments, type Comment, type InsertComment,\n  reviews, type Review, type InsertReview,\n  securitySettings, type SecuritySetting, type InsertSecuritySetting,\n  trustedDevices, type TrustedDevice, type InsertTrustedDevice,\n  userSessions, type UserSession, type InsertUserSession,\n  ipRules, type IpRule, type InsertIpRule,\n  securityLogs, type SecurityLog, type InsertSecurityLog,\n  firewallRules, type FirewallRule, type InsertFirewallRule,\n  geoBlocking, type GeoBlocking, type InsertGeoBlocking,\n  rateLimitRules, type RateLimitRule, type InsertRateLimitRule,\n  userAgentRules, type UserAgentRule, type InsertUserAgentRule,\n  blockedRequests, type BlockedRequest, type InsertBlockedRequest,\n  homepageSections, type HomepageSection, type InsertHomepageSection,\n  faqs, type FAQ, type InsertFAQ,\n  webauthnCredentials, type WebAuthnCredential, type InsertWebAuthnCredential,\n  passwordResetTokens, type PasswordResetToken, type InsertPasswordResetToken,\n  subscribers, type Subscriber, type InsertSubscriber,\n  emailTemplates, type EmailTemplate, type InsertEmailTemplate,\n  emailCampaigns, type EmailCampaign, type InsertEmailCampaign,\n  contentVersions, type ContentVersion, type InsertContentVersion,\n  contentDrafts, type ContentDraft, type InsertContentDraft,\n  scheduledContent, type ScheduledContent, type InsertScheduledContent,\n  commentLikes, type CommentLike, type InsertCommentLike,\n  commentReports, type CommentReport, type InsertCommentReport,\n  searchHistory, type SearchHistory, type InsertSearchHistory,\n  pageViews, type PageView, type InsertPageView,\n  translations, type Translation, type InsertTranslation,\n  contentTemplates, type ContentTemplate, type InsertContentTemplate,\n  mediaFolders, type MediaFolder, type InsertMediaFolder,\n  scheduledTasks, type ScheduledTask, type InsertScheduledTask,\n  webhooks, type Webhook, type InsertWebhook,\n  webhookLogs, type WebhookLog, type InsertWebhookLog\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, asc, and, or, ilike, sql, lt } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // Users\n  getUser(id: number): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByUsernameOrEmail(credential: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: number, user: Partial<InsertUser>): Promise<User | undefined>;\n  deleteUser(id: number): Promise<boolean>;\n  getAllUsers(): Promise<User[]>;\n\n  // Projects\n  getProject(id: number): Promise<Project | undefined>;\n  getAllProjects(): Promise<Project[]>;\n  getPublishedProjects(): Promise<Project[]>;\n  createProject(project: InsertProject): Promise<Project>;\n  updateProject(id: number, project: Partial<InsertProject>): Promise<Project | undefined>;\n  deleteProject(id: number): Promise<boolean>;\n  incrementProjectViews(id: number): Promise<void>;\n\n  // Posts\n  getPost(id: number): Promise<Post | undefined>;\n  getPostBySlug(slug: string): Promise<Post | undefined>;\n  getAllPosts(): Promise<Post[]>;\n  getPublishedPosts(): Promise<Post[]>;\n  createPost(post: InsertPost): Promise<Post>;\n  updatePost(id: number, post: Partial<InsertPost>): Promise<Post | undefined>;\n  deletePost(id: number): Promise<boolean>;\n  incrementPostViews(id: number): Promise<void>;\n\n  // Pages\n  getPage(id: number): Promise<Page | undefined>;\n  getPageBySlug(slug: string): Promise<Page | undefined>;\n  getAllPages(): Promise<Page[]>;\n  getPublishedPages(): Promise<Page[]>;\n  createPage(page: InsertPage): Promise<Page>;\n  updatePage(id: number, page: Partial<InsertPage>): Promise<Page | undefined>;\n  deletePage(id: number): Promise<boolean>;\n  incrementPageViews(id: number): Promise<void>;\n\n  // Skills\n  getSkill(id: number): Promise<Skill | undefined>;\n  getAllSkills(): Promise<Skill[]>;\n  createSkill(skill: InsertSkill): Promise<Skill>;\n  updateSkill(id: number, skill: Partial<InsertSkill>): Promise<Skill | undefined>;\n  deleteSkill(id: number): Promise<boolean>;\n\n  // Services\n  getService(id: number): Promise<Service | undefined>;\n  getAllServices(): Promise<Service[]>;\n  getActiveServices(): Promise<Service[]>;\n  createService(service: InsertService): Promise<Service>;\n  updateService(id: number, service: Partial<InsertService>): Promise<Service | undefined>;\n  deleteService(id: number): Promise<boolean>;\n\n  // Testimonials\n  getTestimonial(id: number): Promise<Testimonial | undefined>;\n  getAllTestimonials(): Promise<Testimonial[]>;\n  getActiveTestimonials(): Promise<Testimonial[]>;\n  createTestimonial(testimonial: InsertTestimonial): Promise<Testimonial>;\n  updateTestimonial(id: number, testimonial: Partial<InsertTestimonial>): Promise<Testimonial | undefined>;\n  deleteTestimonial(id: number): Promise<boolean>;\n\n  // Messages\n  getMessage(id: number): Promise<Message | undefined>;\n  getAllMessages(): Promise<Message[]>;\n  getUnreadMessages(): Promise<Message[]>;\n  createMessage(message: InsertMessage): Promise<Message>;\n  markMessageAsRead(id: number): Promise<boolean>;\n  archiveMessage(id: number): Promise<boolean>;\n  deleteMessage(id: number): Promise<boolean>;\n\n  // Activity Logs\n  getAllActivityLogs(limit?: number): Promise<ActivityLog[]>;\n  createActivityLog(log: InsertActivityLog): Promise<ActivityLog>;\n\n  // Notifications\n  getAllNotifications(userId?: number): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: number): Promise<boolean>;\n\n  // Homepage Sections\n  getAllHomepageSections(): Promise<HomepageSection[]>;\n  getHomepageSectionByName(name: string): Promise<HomepageSection | undefined>;\n  updateHomepageSection(name: string, section: Partial<InsertHomepageSection>): Promise<HomepageSection | undefined>;\n  upsertHomepageSection(name: string, section: Partial<InsertHomepageSection>): Promise<HomepageSection>;\n\n  // Site Settings\n  getSetting(key: string): Promise<SiteSetting | undefined>;\n  getAllSettings(): Promise<SiteSetting[]>;\n  upsertSetting(key: string, value: any): Promise<SiteSetting>;\n\n  // Categories\n  getCategory(id: number): Promise<Category | undefined>;\n  getAllCategories(): Promise<Category[]>;\n  getCategoriesByType(type: string): Promise<Category[]>;\n  createCategory(category: InsertCategory): Promise<Category>;\n  updateCategory(id: number, category: Partial<InsertCategory>): Promise<Category | undefined>;\n  deleteCategory(id: number): Promise<boolean>;\n\n  // Media\n  getMedia(id: number): Promise<Media | undefined>;\n  getAllMedia(): Promise<Media[]>;\n  createMedia(mediaItem: InsertMedia): Promise<Media>;\n  deleteMedia(id: number): Promise<boolean>;\n\n  // Comments\n  getComment(id: number): Promise<Comment | undefined>;\n  getAllComments(): Promise<Comment[]>;\n  getCommentsByPost(postId: number): Promise<Comment[]>;\n  getCommentsByProject(projectId: number): Promise<Comment[]>;\n  getApprovedCommentsByPost(postId: number): Promise<Comment[]>;\n  getApprovedCommentsByProject(projectId: number): Promise<Comment[]>;\n  getPendingComments(): Promise<Comment[]>;\n  getUnreadComments(): Promise<Comment[]>;\n  getUnarchivedComments(): Promise<Comment[]>;\n  createComment(comment: InsertComment): Promise<Comment>;\n  updateComment(id: number, comment: Partial<InsertComment>): Promise<Comment | undefined>;\n  approveComment(id: number): Promise<boolean>;\n  markCommentAsRead(id: number): Promise<boolean>;\n  archiveComment(id: number): Promise<boolean>;\n  deleteComment(id: number): Promise<boolean>;\n\n  // Reviews\n  getReview(id: number): Promise<Review | undefined>;\n  getAllReviews(): Promise<Review[]>;\n  getReviewsByProject(projectId: number): Promise<Review[]>;\n  getApprovedReviewsByProject(projectId: number): Promise<Review[]>;\n  getPendingReviews(): Promise<Review[]>;\n  getUnreadReviews(): Promise<Review[]>;\n  getUnarchivedReviews(): Promise<Review[]>;\n  createReview(review: InsertReview): Promise<Review>;\n  updateReview(id: number, review: Partial<InsertReview>): Promise<Review | undefined>;\n  approveReview(id: number): Promise<boolean>;\n  markReviewAsRead(id: number): Promise<boolean>;\n  archiveReview(id: number): Promise<boolean>;\n  deleteReview(id: number): Promise<boolean>;\n\n  // System\n  getSystemStats(): Promise<{\n    databaseSize: string;\n    tableStats: { name: string; count: number }[];\n    serverUptime: number;\n    lastCheck: Date;\n    status: \"Healthy\" | \"Warning\" | \"Error\";\n  }>;\n  getActivityLogs(limit: number, offset: number): Promise<ActivityLog[]>;\n  clearActivityLogs(): Promise<void>;\n  getSystemLogs(limit?: number): Promise<any[]>;\n  clearSystemLogs(): Promise<void>;\n  createSystemLog(log: { level: string; message: string; source: string; metadata?: any }): Promise<any>;\n\n  // Security Settings\n  getSecuritySetting(key: string): Promise<SecuritySetting | undefined>;\n  getAllSecuritySettings(): Promise<SecuritySetting[]>;\n  upsertSecuritySetting(key: string, value: any): Promise<SecuritySetting>;\n\n  // Trusted Devices\n  getTrustedDevice(id: number): Promise<TrustedDevice | undefined>;\n  getTrustedDevicesByUser(userId: number): Promise<TrustedDevice[]>;\n  createTrustedDevice(device: InsertTrustedDevice): Promise<TrustedDevice>;\n  updateTrustedDevice(id: number, device: Partial<InsertTrustedDevice>): Promise<TrustedDevice | undefined>;\n  deleteTrustedDevice(id: number): Promise<boolean>;\n\n  // User Sessions\n  getUserSession(id: number): Promise<UserSession | undefined>;\n  getUserSessionBySessionId(sessionId: string): Promise<UserSession | undefined>;\n  getActiveSessionsByUser(userId: number): Promise<UserSession[]>;\n  getAllActiveSessions(): Promise<UserSession[]>;\n  createUserSession(session: InsertUserSession): Promise<UserSession>;\n  updateUserSession(id: number, session: Partial<InsertUserSession>): Promise<UserSession | undefined>;\n  terminateSession(id: number): Promise<boolean>;\n  terminateSessionBySessionId(sessionId: string): Promise<void>;\n  terminateAllUserSessions(userId: number): Promise<boolean>;\n  terminateAllSessions(): Promise<boolean>;\n\n  // IP Rules\n  getIpRule(id: number): Promise<IpRule | undefined>;\n  getIpRulesByType(type: string): Promise<IpRule[]>;\n  getAllIpRules(): Promise<IpRule[]>;\n  createIpRule(rule: InsertIpRule): Promise<IpRule>;\n  deleteIpRule(id: number): Promise<boolean>;\n  isIpWhitelisted(ip: string): Promise<boolean>;\n  isIpBlacklisted(ip: string): Promise<boolean>;\n\n  // Security Logs\n  getSecurityLog(id: number): Promise<SecurityLog | undefined>;\n  getSecurityLogsByType(eventType: string): Promise<SecurityLog[]>;\n  getRecentSecurityLogs(limit?: number): Promise<SecurityLog[]>;\n  getLoginHistory(limit?: number): Promise<SecurityLog[]>;\n  createSecurityLog(log: InsertSecurityLog): Promise<SecurityLog>;\n  getSecurityStats(): Promise<{\n    totalBlocked: number;\n    totalAllowed: number;\n    byEventType: { type: string; count: number }[];\n  }>;\n  getSecurityLogs(limit?: number, offset?: number, type?: string): Promise<SecurityLog[]>;\n\n  // Firewall Rules\n  getFirewallRule(id: number): Promise<FirewallRule | undefined>;\n  getAllFirewallRules(): Promise<FirewallRule[]>;\n  getEnabledFirewallRules(): Promise<FirewallRule[]>;\n  createFirewallRule(rule: InsertFirewallRule): Promise<FirewallRule>;\n  updateFirewallRule(id: number, rule: Partial<InsertFirewallRule>): Promise<FirewallRule | undefined>;\n  deleteFirewallRule(id: number): Promise<boolean>;\n  incrementFirewallRuleHit(id: number): Promise<void>;\n\n  // Geo Blocking\n  getGeoBlockingRule(id: number): Promise<GeoBlocking | undefined>;\n  getGeoBlockingByCountry(countryCode: string): Promise<GeoBlocking | undefined>;\n  getAllGeoBlockingRules(): Promise<GeoBlocking[]>;\n  createGeoBlockingRule(rule: InsertGeoBlocking): Promise<GeoBlocking>;\n  updateGeoBlockingRule(id: number, rule: Partial<InsertGeoBlocking>): Promise<GeoBlocking | undefined>;\n  deleteGeoBlockingRule(id: number): Promise<boolean>;\n\n  // Rate Limit Rules\n  getRateLimitRule(id: number): Promise<RateLimitRule | undefined>;\n  getAllRateLimitRules(): Promise<RateLimitRule[]>;\n  getEnabledRateLimitRules(): Promise<RateLimitRule[]>;\n  createRateLimitRule(rule: InsertRateLimitRule): Promise<RateLimitRule>;\n  updateRateLimitRule(id: number, rule: Partial<InsertRateLimitRule>): Promise<RateLimitRule | undefined>;\n  deleteRateLimitRule(id: number): Promise<boolean>;\n\n  // User Agent Rules\n  getUserAgentRule(id: number): Promise<UserAgentRule | undefined>;\n  getAllUserAgentRules(): Promise<UserAgentRule[]>;\n  getEnabledUserAgentRules(): Promise<UserAgentRule[]>;\n  createUserAgentRule(rule: InsertUserAgentRule): Promise<UserAgentRule>;\n  updateUserAgentRule(id: number, rule: Partial<InsertUserAgentRule>): Promise<UserAgentRule | undefined>;\n  deleteUserAgentRule(id: number): Promise<boolean>;\n\n  // Blocked Requests\n  getRecentBlockedRequests(limit?: number): Promise<BlockedRequest[]>;\n  createBlockedRequest(request: InsertBlockedRequest): Promise<BlockedRequest>;\n  getBlockedRequestStats(): Promise<{\n    total: number;\n    byReason: { reason: string; count: number }[];\n    byCountry: { country: string; count: number }[];\n  }>;\n\n  // FAQs\n  getFAQ(id: number): Promise<FAQ | undefined>;\n  getAllFAQs(): Promise<FAQ[]>;\n  getVisibleFAQs(): Promise<FAQ[]>;\n  createFAQ(faq: InsertFAQ): Promise<FAQ>;\n  updateFAQ(id: number, faq: Partial<InsertFAQ>): Promise<FAQ | undefined>;\n  deleteFAQ(id: number): Promise<boolean>;\n\n  // WebAuthn Credentials\n  createWebAuthnCredential(data: InsertWebAuthnCredential): Promise<WebAuthnCredential>;\n  getWebAuthnCredentialsByUser(userId: number): Promise<WebAuthnCredential[]>;\n  getWebAuthnCredentialById(credentialId: string): Promise<WebAuthnCredential | undefined>;\n  updateWebAuthnCredentialCounter(id: number, counter: number): Promise<void>;\n  deleteWebAuthnCredential(id: number): Promise<boolean>;\n\n  // 2FA\n  enable2FA(userId: number, secret: string): Promise<User | undefined>;\n  disable2FA(userId: number): Promise<User | undefined>;\n  verify2FA(userId: number, token: string): Promise<boolean>;\n  enableBiometricLogin(userId: number, credentialId: string): Promise<User | undefined>;\n  disableBiometricLogin(userId: number): Promise<User | undefined>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  private db = db; // Alias db to this.db for consistency\n\n  // Users\n  async getUser(id: number): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(eq(users.username, username));\n    return user || undefined;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(eq(users.email, email));\n    return user || undefined;\n  }\n\n  async getUserByUsernameOrEmail(credential: string): Promise<User | undefined> {\n    const [user] = await this.db.select().from(users).where(\n      sql`${users.username} = ${credential} OR ${users.email} = ${credential}`\n    );\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await this.db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  async updateUser(id: number, userData: Partial<InsertUser>): Promise<User | undefined> {\n    const [user] = await this.db.update(users).set(userData).where(eq(users.id, id)).returning();\n    return user || undefined;\n  }\n\n  async deleteUser(id: number): Promise<boolean> {\n    const result = await this.db.delete(users).where(eq(users.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return await this.db.select().from(users).orderBy(desc(users.createdAt));\n  }\n\n  // Projects\n  async getProject(id: number): Promise<Project | undefined> {\n    const [project] = await this.db.select().from(projects).where(eq(projects.id, id));\n    return project || undefined;\n  }\n\n  async getAllProjects(): Promise<Project[]> {\n    return await this.db.select().from(projects).orderBy(desc(projects.createdAt));\n  }\n\n  async getPublishedProjects(): Promise<Project[]> {\n    return await this.db.select().from(projects).where(eq(projects.status, \"Published\")).orderBy(desc(projects.createdAt));\n  }\n\n  async createProject(insertProject: InsertProject): Promise<Project> {\n    const [project] = await this.db.insert(projects).values({\n      ...insertProject,\n      tech: insertProject.tech ? [...insertProject.tech] : []\n    }).returning();\n    return project;\n  }\n\n  async updateProject(id: number, projectData: Partial<InsertProject>): Promise<Project | undefined> {\n    const updateData: any = { ...projectData, updatedAt: new Date() };\n    if (projectData.tech) {\n      updateData.tech = [...projectData.tech];\n    }\n    const [project] = await this.db.update(projects).set(updateData).where(eq(projects.id, id)).returning();\n    return project || undefined;\n  }\n\n  async deleteProject(id: number): Promise<boolean> {\n    const result = await this.db.delete(projects).where(eq(projects.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async incrementProjectViews(id: number): Promise<void> {\n    await this.db.update(projects).set({ views: sql`${projects.views} + 1` }).where(eq(projects.id, id));\n  }\n\n  // Posts\n  async getPost(id: number): Promise<Post | undefined> {\n    const [post] = await this.db.select().from(posts).where(eq(posts.id, id));\n    return post || undefined;\n  }\n\n  async getPostBySlug(slug: string): Promise<Post | undefined> {\n    const [post] = await this.db.select().from(posts).where(eq(posts.slug, slug));\n    return post || undefined;\n  }\n\n  async getAllPosts(): Promise<Post[]> {\n    return await this.db.select().from(posts).orderBy(desc(posts.createdAt));\n  }\n\n  async getPublishedPosts(): Promise<Post[]> {\n    return await this.db.select().from(posts).where(eq(posts.status, \"Published\")).orderBy(desc(posts.publishedAt));\n  }\n\n  async createPost(insertPost: InsertPost): Promise<Post> {\n    let publishedAt = null;\n    if (insertPost.publishedAt) {\n      if (typeof insertPost.publishedAt === 'string') {\n        const date = new Date(insertPost.publishedAt);\n        publishedAt = isNaN(date.getTime()) ? null : date;\n      } else if (insertPost.publishedAt instanceof Date) {\n        publishedAt = insertPost.publishedAt;\n      }\n    }\n    const [post] = await this.db.insert(posts).values({\n      ...insertPost,\n      tags: insertPost.tags ? [...insertPost.tags] : [],\n      publishedAt\n    }).returning();\n    return post;\n  }\n\n  async updatePost(id: number, postData: Partial<InsertPost>): Promise<Post | undefined> {\n    const updateData: any = { ...postData, updatedAt: new Date() };\n    if (postData.tags) {\n      updateData.tags = [...postData.tags];\n    }\n    if ('publishedAt' in updateData) {\n      if (updateData.publishedAt === null || updateData.publishedAt === undefined) {\n        updateData.publishedAt = null;\n      } else if (typeof updateData.publishedAt === 'string') {\n        const date = new Date(updateData.publishedAt);\n        updateData.publishedAt = isNaN(date.getTime()) ? null : date;\n      } else if (!(updateData.publishedAt instanceof Date)) {\n        updateData.publishedAt = null;\n      }\n    }\n    const [post] = await this.db.update(posts).set(updateData).where(eq(posts.id, id)).returning();\n    return post || undefined;\n  }\n\n  async deletePost(id: number): Promise<boolean> {\n    const result = await this.db.delete(posts).where(eq(posts.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async incrementPostViews(id: number): Promise<void> {\n    await this.db.update(posts).set({ views: sql`${posts.views} + 1` }).where(eq(posts.id, id));\n  }\n\n  // Pages\n  async getPage(id: number): Promise<Page | undefined> {\n    const [page] = await this.db.select().from(pages).where(eq(pages.id, id));\n    return page || undefined;\n  }\n\n  async getPageBySlug(slug: string): Promise<Page | undefined> {\n    const [page] = await this.db.select().from(pages).where(eq(pages.slug, slug));\n    return page || undefined;\n  }\n\n  async getAllPages(): Promise<Page[]> {\n    return await this.db.select().from(pages).orderBy(desc(pages.createdAt));\n  }\n\n  async getPublishedPages(): Promise<Page[]> {\n    return await this.db.select().from(pages).where(eq(pages.status, \"Published\")).orderBy(desc(pages.publishedAt));\n  }\n\n  async createPage(insertPage: InsertPage): Promise<Page> {\n    let publishedAt = null;\n    if (insertPage.publishedAt) {\n      if (typeof insertPage.publishedAt === 'string') {\n        const date = new Date(insertPage.publishedAt);\n        publishedAt = isNaN(date.getTime()) ? null : date;\n      } else if (insertPage.publishedAt instanceof Date) {\n        publishedAt = insertPage.publishedAt;\n      }\n    }\n    const [page] = await this.db.insert(pages).values({\n      ...insertPage,\n      publishedAt\n    }).returning();\n    return page;\n  }\n\n  async updatePage(id: number, pageData: Partial<InsertPage>): Promise<Page | undefined> {\n    const updateData: any = { ...pageData, updatedAt: new Date() };\n    if ('publishedAt' in updateData) {\n      if (updateData.publishedAt === null || updateData.publishedAt === undefined) {\n        updateData.publishedAt = null;\n      } else if (typeof updateData.publishedAt === 'string') {\n        const date = new Date(updateData.publishedAt);\n        updateData.publishedAt = isNaN(date.getTime()) ? null : date;\n      } else if (!(updateData.publishedAt instanceof Date)) {\n        updateData.publishedAt = null;\n      }\n    }\n    const [page] = await this.db.update(pages).set(updateData).where(eq(pages.id, id)).returning();\n    return page || undefined;\n  }\n\n  async deletePage(id: number): Promise<boolean> {\n    const result = await this.db.delete(pages).where(eq(pages.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async incrementPageViews(id: number): Promise<void> {\n    await this.db.update(pages).set({ views: sql`${pages.views} + 1` }).where(eq(pages.id, id));\n  }\n\n  // Skills\n  async getSkill(id: number): Promise<Skill | undefined> {\n    const [skill] = await this.db.select().from(skills).where(eq(skills.id, id));\n    return skill || undefined;\n  }\n\n  async getAllSkills(): Promise<Skill[]> {\n    return await this.db.select().from(skills).orderBy(asc(skills.order));\n  }\n\n  async createSkill(insertSkill: InsertSkill): Promise<Skill> {\n    const [skill] = await this.db.insert(skills).values(insertSkill).returning();\n    return skill;\n  }\n\n  async updateSkill(id: number, skillData: Partial<InsertSkill>): Promise<Skill | undefined> {\n    const [skill] = await this.db.update(skills).set(skillData).where(eq(skills.id, id)).returning();\n    return skill || undefined;\n  }\n\n  async deleteSkill(id: number): Promise<boolean> {\n    const result = await this.db.delete(skills).where(eq(skills.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Services\n  async getService(id: number): Promise<Service | undefined> {\n    const [service] = await this.db.select().from(services).where(eq(services.id, id));\n    return service || undefined;\n  }\n\n  async getAllServices(): Promise<Service[]> {\n    return await this.db.select().from(services).orderBy(asc(services.order));\n  }\n\n  async getActiveServices(): Promise<Service[]> {\n    return await this.db.select().from(services).where(eq(services.active, true)).orderBy(asc(services.order));\n  }\n\n  async createService(insertService: InsertService): Promise<Service> {\n    const [service] = await this.db.insert(services).values({\n      ...insertService,\n      features: insertService.features ? [...insertService.features] : []\n    }).returning();\n    return service;\n  }\n\n  async updateService(id: number, serviceData: Partial<InsertService>): Promise<Service | undefined> {\n    const updateData: any = { ...serviceData };\n    if (serviceData.features) {\n      updateData.features = [...serviceData.features];\n    }\n    const [service] = await this.db.update(services).set(updateData).where(eq(services.id, id)).returning();\n    return service || undefined;\n  }\n\n  async deleteService(id: number): Promise<boolean> {\n    const result = await this.db.delete(services).where(eq(services.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Testimonials\n  async getTestimonial(id: number): Promise<Testimonial | undefined> {\n    const [testimonial] = await this.db.select().from(testimonials).where(eq(testimonials.id, id));\n    return testimonial || undefined;\n  }\n\n  async getAllTestimonials(): Promise<Testimonial[]> {\n    return await this.db.select().from(testimonials).orderBy(desc(testimonials.createdAt));\n  }\n\n  async getActiveTestimonials(): Promise<Testimonial[]> {\n    return await this.db.select().from(testimonials).where(eq(testimonials.active, true)).orderBy(desc(testimonials.createdAt));\n  }\n\n  async createTestimonial(insertTestimonial: InsertTestimonial): Promise<Testimonial> {\n    const [testimonial] = await this.db.insert(testimonials).values(insertTestimonial).returning();\n    return testimonial;\n  }\n\n  async updateTestimonial(id: number, testimonialData: Partial<InsertTestimonial>): Promise<Testimonial | undefined> {\n    const [testimonial] = await this.db.update(testimonials).set(testimonialData).where(eq(testimonials.id, id)).returning();\n    return testimonial || undefined;\n  }\n\n  async deleteTestimonial(id: number): Promise<boolean> {\n    const result = await this.db.delete(testimonials).where(eq(testimonials.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Messages\n  async getMessage(id: number): Promise<Message | undefined> {\n    const [message] = await this.db.select().from(messages).where(eq(messages.id, id));\n    return message || undefined;\n  }\n\n  async getAllMessages(): Promise<Message[]> {\n    return await this.db.select().from(messages).orderBy(desc(messages.createdAt));\n  }\n\n  async getUnreadMessages(): Promise<Message[]> {\n    return await this.db.select().from(messages).where(eq(messages.read, false)).orderBy(desc(messages.createdAt));\n  }\n\n  async createMessage(insertMessage: InsertMessage): Promise<Message> {\n    const [message] = await this.db.insert(messages).values(insertMessage).returning();\n    return message;\n  }\n\n  async markMessageAsRead(id: number): Promise<boolean> {\n    const result = await this.db.update(messages).set({ read: true }).where(eq(messages.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async archiveMessage(id: number): Promise<boolean> {\n    const result = await this.db.update(messages).set({ archived: true }).where(eq(messages.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async deleteMessage(id: number): Promise<boolean> {\n    const result = await this.db.delete(messages).where(eq(messages.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Activity Logs\n  async getAllActivityLogs(limit: number = 50, offset: number = 0): Promise<ActivityLog[]> {\n    const logs = await db.select()\n      .from(activityLogs)\n      .orderBy(desc(activityLogs.createdAt))\n      .limit(limit)\n      .offset(offset);\n    return logs;\n  }\n\n  async createActivityLog(insertLog: InsertActivityLog): Promise<ActivityLog> {\n    const [log] = await this.db.insert(activityLogs).values(insertLog).returning();\n    return log;\n  }\n\n  // Notifications\n  async getAllNotifications(userId?: number): Promise<Notification[]> {\n    if (userId) {\n      return await this.db.select().from(notifications).where(eq(notifications.userId, userId)).orderBy(desc(notifications.createdAt));\n    }\n    return await this.db.select().from(notifications).orderBy(desc(notifications.createdAt));\n  }\n\n  async createNotification(insertNotification: InsertNotification): Promise<Notification> {\n    const [notification] = await this.db.insert(notifications).values(insertNotification).returning();\n    return notification;\n  }\n\n  async markNotificationAsRead(id: number): Promise<boolean> {\n    const result = await this.db.update(notifications).set({ read: true }).where(eq(notifications.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Site Settings\n  async getSetting(key: string): Promise<SiteSetting | undefined> {\n    const [setting] = await this.db.select().from(siteSettings).where(eq(siteSettings.key, key));\n    return setting || undefined;\n  }\n\n  async getAllSettings(): Promise<SiteSetting[]> {\n    return await this.db.select().from(siteSettings);\n  }\n\n  async upsertSetting(key: string, value: any): Promise<SiteSetting> {\n    const existing = await this.getSetting(key);\n    if (existing) {\n      const [setting] = await this.db.update(siteSettings).set({ value, updatedAt: new Date() }).where(eq(siteSettings.key, key)).returning();\n      return setting;\n    } else {\n      const [setting] = await this.db.insert(siteSettings).values({ key, value }).returning();\n      return setting;\n    }\n  }\n\n  // Categories\n  async getCategory(id: number): Promise<Category | undefined> {\n    const [category] = await this.db.select().from(categories).where(eq(categories.id, id));\n    return category || undefined;\n  }\n\n  async getAllCategories(): Promise<Category[]> {\n    return await this.db.select().from(categories);\n  }\n\n  async getCategoriesByType(type: string): Promise<Category[]> {\n    return await this.db.select().from(categories).where(eq(categories.type, type));\n  }\n\n  async createCategory(insertCategory: InsertCategory): Promise<Category> {\n    const [category] = await this.db.insert(categories).values(insertCategory).returning();\n    return category;\n  }\n\n  async updateCategory(id: number, categoryData: Partial<InsertCategory>): Promise<Category | undefined> {\n    const [category] = await this.db.update(categories).set(categoryData).where(eq(categories.id, id)).returning();\n    return category || undefined;\n  }\n\n  async deleteCategory(id: number): Promise<boolean> {\n    const result = await this.db.delete(categories).where(eq(categories.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Media\n  async getMedia(id: number): Promise<Media | undefined> {\n    const [mediaItem] = await this.db.select().from(media).where(eq(media.id, id));\n    return mediaItem || undefined;\n  }\n\n  async getAllMedia(): Promise<Media[]> {\n    return await this.db.select().from(media).orderBy(desc(media.createdAt));\n  }\n\n  async createMedia(insertMedia: InsertMedia): Promise<Media> {\n    const [mediaItem] = await this.db.insert(media).values(insertMedia).returning();\n    return mediaItem;\n  }\n\n  async deleteMedia(id: number): Promise<boolean> {\n    const result = await this.db.delete(media).where(eq(media.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Comments\n  async getComment(id: number): Promise<Comment | undefined> {\n    const [comment] = await this.db.select().from(comments).where(eq(comments.id, id));\n    return comment || undefined;\n  }\n\n  async getAllComments(): Promise<Comment[]> {\n    return await this.db.select().from(comments).orderBy(desc(comments.createdAt));\n  }\n\n  async getCommentsByPost(postId: number): Promise<Comment[]> {\n    return await this.db.select().from(comments).where(eq(comments.postId, postId)).orderBy(desc(comments.createdAt));\n  }\n\n  async getCommentsByProject(projectId: number): Promise<Comment[]> {\n    return await this.db.select().from(comments).where(eq(comments.projectId, projectId)).orderBy(desc(comments.createdAt));\n  }\n\n  async getApprovedCommentsByPost(postId: number): Promise<Comment[]> {\n    return await this.db.select().from(comments)\n      .where(and(eq(comments.postId, postId), eq(comments.status, \"Approved\")))\n      .orderBy(desc(comments.createdAt));\n  }\n\n  async getApprovedCommentsByProject(projectId: number): Promise<Comment[]> {\n    return await this.db.select().from(comments)\n      .where(and(eq(comments.projectId, projectId), eq(comments.status, \"Approved\")))\n      .orderBy(desc(comments.createdAt));\n  }\n\n  async getPendingComments(): Promise<Comment[]> {\n    return await this.db.select().from(comments).where(eq(comments.status, \"Pending\")).orderBy(desc(comments.createdAt));\n  }\n\n  async getUnreadComments(): Promise<Comment[]> {\n    return await this.db.select().from(comments).where(eq(comments.read, false)).orderBy(desc(comments.createdAt));\n  }\n\n  async getUnarchivedComments(): Promise<Comment[]> {\n    return await this.db.select().from(comments).where(eq(comments.archived, false)).orderBy(desc(comments.createdAt));\n  }\n\n  async createComment(insertComment: InsertComment): Promise<Comment> {\n    const [comment] = await this.db.insert(comments).values(insertComment).returning();\n    return comment;\n  }\n\n  async updateComment(id: number, commentData: Partial<InsertComment>): Promise<Comment | undefined> {\n    const [comment] = await this.db.update(comments).set(commentData).where(eq(comments.id, id)).returning();\n    return comment || undefined;\n  }\n\n  async approveComment(id: number): Promise<boolean> {\n    const result = await this.db.update(comments).set({ status: \"Approved\" }).where(eq(comments.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async markCommentAsRead(id: number): Promise<boolean> {\n    const result = await this.db.update(comments).set({ read: true }).where(eq(comments.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async archiveComment(id: number): Promise<boolean> {\n    const result = await this.db.update(comments).set({ archived: true }).where(eq(comments.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async deleteComment(id: number): Promise<boolean> {\n    const result = await this.db.delete(comments).where(eq(comments.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // Reviews\n  async getReview(id: number): Promise<Review | undefined> {\n    const [review] = await this.db.select().from(reviews).where(eq(reviews.id, id));\n    return review || undefined;\n  }\n\n  async getAllReviews(): Promise<Review[]> {\n    return await this.db.select().from(reviews).orderBy(desc(reviews.createdAt));\n  }\n\n  async getReviewsByProject(projectId: number): Promise<Review[]> {\n    return await this.db.select().from(reviews).where(eq(reviews.projectId, projectId)).orderBy(desc(reviews.createdAt));\n  }\n\n  async getApprovedReviewsByProject(projectId: number): Promise<Review[]> {\n    return await this.db.select().from(reviews)\n      .where(and(eq(reviews.projectId, projectId), eq(reviews.status, \"Approved\")))\n      .orderBy(desc(reviews.createdAt));\n  }\n\n  async getPendingReviews(): Promise<Review[]> {\n    return await this.db.select().from(reviews).where(eq(reviews.status, \"Pending\")).orderBy(desc(reviews.createdAt));\n  }\n\n  async getUnreadReviews(): Promise<Review[]> {\n    return await this.db.select().from(reviews).where(eq(reviews.read, false)).orderBy(desc(reviews.createdAt));\n  }\n\n  async getUnarchivedReviews(): Promise<Review[]> {\n    return await this.db.select().from(reviews).where(eq(reviews.archived, false)).orderBy(desc(reviews.createdAt));\n  }\n\n  async createReview(insertReview: InsertReview): Promise<Review> {\n    const [review] = await this.db.insert(reviews).values(insertReview).returning();\n    return review;\n  }\n\n  async updateReview(id: number, reviewData: Partial<InsertReview>): Promise<Review | undefined> {\n    const [review] = await this.db.update(reviews).set(reviewData).where(eq(reviews.id, id)).returning();\n    return review || undefined;\n  }\n\n  async approveReview(id: number): Promise<boolean> {\n    const result = await this.db.update(reviews).set({ status: \"Approved\" }).where(eq(reviews.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async markReviewAsRead(id: number): Promise<boolean> {\n    const result = await this.db.update(reviews).set({ read: true }).where(eq(reviews.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async archiveReview(id: number): Promise<boolean> {\n    const result = await this.db.update(reviews).set({ archived: true }).where(eq(reviews.id, id)).returning();\n    return result.length > 0;\n  }\n\n  async deleteReview(id: number): Promise<boolean> {\n    const result = await this.db.delete(reviews).where(eq(reviews.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // System methods\n  async getSystemStats(): Promise<{\n    databaseSize: string;\n    tableStats: { name: string; count: number }[];\n    serverUptime: number;\n    lastCheck: Date;\n    status: \"Healthy\" | \"Warning\" | \"Error\";\n  }> {\n    try {\n      const [usersCount] = await this.db.select({ count: sql<number>`count(*)` }).from(users);\n      const [projectsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(projects);\n      const [postsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(posts);\n      const [skillsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(skills);\n      const [servicesCount] = await this.db.select({ count: sql<number>`count(*)` }).from(services);\n      const [messagesCount] = await this.db.select({ count: sql<number>`count(*)` }).from(messages);\n      const [testimonialsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(testimonials);\n      const [commentsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(comments);\n      const [reviewsCount] = await this.db.select({ count: sql<number>`count(*)` }).from(reviews);\n      const [activityCount] = await this.db.select({ count: sql<number>`count(*)` }).from(activityLogs);\n\n      const tableStats = [\n        { name: \"Users\", count: Number(usersCount.count) },\n        { name: \"Projects\", count: Number(projectsCount.count) },\n        { name: \"Posts\", count: Number(postsCount.count) },\n        { name: \"Skills\", count: Number(skillsCount.count) },\n        { name: \"Services\", count: Number(servicesCount.count) },\n        { name: \"Messages\", count: Number(messagesCount.count) },\n        { name: \"Testimonials\", count: Number(testimonialsCount.count) },\n        { name: \"Comments\", count: Number(commentsCount.count) },\n        { name: \"Reviews\", count: Number(reviewsCount.count) },\n        { name: \"Activity Logs\", count: Number(activityCount.count) },\n      ];\n\n      const totalRecords = tableStats.reduce((sum, t) => sum + t.count, 0);\n      const estimatedSize = (totalRecords * 0.5).toFixed(1);\n\n      return {\n        databaseSize: `${estimatedSize} KB`,\n        tableStats,\n        serverUptime: process.uptime(),\n        lastCheck: new Date(),\n        status: \"Healthy\",\n      };\n    } catch (error) {\n      console.error(\"Error getting system stats:\", error);\n      return {\n        databaseSize: \"Unknown\",\n        tableStats: [],\n        serverUptime: process.uptime(),\n        lastCheck: new Date(),\n        status: \"Error\",\n      };\n    }\n  }\n\n  async getActivityLogs(limit: number, offset: number): Promise<ActivityLog[]> {\n    return await this.db.select().from(activityLogs).orderBy(desc(activityLogs.createdAt)).limit(limit).offset(offset);\n  }\n\n  async clearActivityLogs(): Promise<void> {\n    await this.db.delete(activityLogs);\n  }\n\n  async getSystemLogs(limit: number = 100): Promise<any[]> {\n    return await this.db.select().from(securityLogs).orderBy(desc(securityLogs.createdAt)).limit(limit);\n  }\n\n  async clearSystemLogs(): Promise<void> {\n    await this.db.delete(securityLogs);\n  }\n\n  async createSystemLog(log: { level: string; message: string; source: string; metadata?: any }): Promise<any> {\n    const [created] = await this.db.insert(securityLogs).values({\n      eventType: log.level,\n      action: log.message,\n      ipAddress: log.source,\n    }).returning();\n    return created;\n  }\n\n  // Security Settings\n  async getSecuritySetting(key: string): Promise<SecuritySetting | undefined> {\n    const [setting] = await this.db.select().from(securitySettings).where(eq(securitySettings.key, key));\n    return setting || undefined;\n  }\n\n  async getAllSecuritySettings(): Promise<SecuritySetting[]> {\n    return await this.db.select().from(securitySettings);\n  }\n\n  async upsertSecuritySetting(key: string, value: any): Promise<SecuritySetting> {\n    const existing = await this.getSecuritySetting(key);\n    if (existing) {\n      const [updated] = await this.db\n        .update(securitySettings)\n        .set({ value, updatedAt: new Date() })\n        .where(eq(securitySettings.key, key))\n        .returning();\n      return updated;\n    }\n    const [created] = await this.db.insert(securitySettings).values({ key, value }).returning();\n    return created;\n  }\n\n  // Trusted Devices\n  async getTrustedDevice(id: number): Promise<TrustedDevice | undefined> {\n    const [device] = await this.db.select().from(trustedDevices).where(eq(trustedDevices.id, id));\n    return device || undefined;\n  }\n\n  async getTrustedDevicesByUser(userId: number): Promise<TrustedDevice[]> {\n    return this.db.select().from(trustedDevices).where(eq(trustedDevices.userId, userId)).orderBy(desc(trustedDevices.lastUsed));\n  }\n\n  async createTrustedDevice(device: InsertTrustedDevice): Promise<TrustedDevice> {\n    const [created] = await this.db.insert(trustedDevices).values(device).returning();\n    return created;\n  }\n\n  async updateTrustedDevice(id: number, device: Partial<InsertTrustedDevice>): Promise<TrustedDevice | undefined> {\n    const [updated] = await this.db.update(trustedDevices).set(device).where(eq(trustedDevices.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async deleteTrustedDevice(id: number): Promise<boolean> {\n    const result = await this.db.delete(trustedDevices).where(eq(trustedDevices.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // User Sessions\n  async getUserSession(id: number): Promise<UserSession | undefined> {\n    const [session] = await this.db.select().from(userSessions).where(eq(userSessions.id, id));\n    return session || undefined;\n  }\n\n  async getUserSessionBySessionId(sessionId: string): Promise<UserSession | undefined> {\n    const [session] = await this.db.select().from(userSessions).where(eq(userSessions.sessionId, sessionId));\n    return session || undefined;\n  }\n\n  async getActiveSessionsByUser(userId: number): Promise<UserSession[]> {\n    return await this.db.select().from(userSessions).where(and(eq(userSessions.userId, userId), eq(userSessions.active, true))).orderBy(desc(userSessions.lastActivity));\n  }\n\n  async getAllActiveSessions(): Promise<UserSession[]> {\n    return await this.db.select().from(userSessions).where(eq(userSessions.active, true)).orderBy(desc(userSessions.lastActivity));\n  }\n\n  async createUserSession(session: InsertUserSession): Promise<UserSession> {\n    const [created] = await this.db.insert(userSessions).values(session).returning();\n    return created;\n  }\n\n  async updateUserSession(id: number, session: Partial<InsertUserSession>): Promise<UserSession | undefined> {\n    const [updated] = await this.db.update(userSessions).set({ ...session, lastActivity: new Date() }).where(eq(userSessions.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async terminateSession(id: number): Promise<boolean> {\n    await this.db.update(userSessions).set({ active: false }).where(eq(userSessions.id, id));\n    return true;\n  }\n\n  async terminateSessionBySessionId(sessionId: string): Promise<void> {\n    await this.db.delete(userSessions).where(eq(userSessions.sessionId, sessionId));\n  }\n\n  async terminateAllUserSessions(userId: number): Promise<boolean> {\n    await this.db.update(userSessions).set({ active: false }).where(eq(userSessions.userId, userId));\n    return true;\n  }\n\n  async terminateAllSessions(): Promise<boolean> {\n    await this.db.update(userSessions).set({ active: false });\n    return true;\n  }\n\n  // IP Rules\n  async getIpRule(id: number): Promise<IpRule | undefined> {\n    const [rule] = await this.db.select().from(ipRules).where(eq(ipRules.id, id));\n    return rule || undefined;\n  }\n\n  async getIpRulesByType(type: string): Promise<IpRule[]> {\n    return await this.db.select().from(ipRules).where(eq(ipRules.type, type)).orderBy(desc(ipRules.createdAt));\n  }\n\n  async getAllIpRules(): Promise<IpRule[]> {\n    return await this.db.select().from(ipRules).orderBy(desc(ipRules.createdAt));\n  }\n\n  async createIpRule(rule: InsertIpRule): Promise<IpRule> {\n    const [created] = await this.db.insert(ipRules).values(rule).returning();\n    return created;\n  }\n\n  async deleteIpRule(id: number): Promise<boolean> {\n    const result = await this.db.delete(ipRules).where(eq(ipRules.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  async isIpWhitelisted(ip: string): Promise<boolean> {\n    const [rule] = await this.db.select().from(ipRules).where(and(eq(ipRules.ipAddress, ip), eq(ipRules.type, \"whitelist\")));\n    return !!rule;\n  }\n\n  async isIpBlacklisted(ip: string): Promise<boolean> {\n    const [rule] = await this.db.select().from(ipRules).where(and(eq(ipRules.ipAddress, ip), eq(ipRules.type, \"blacklist\")));\n    return !!rule;\n  }\n\n  // Security Logs\n  async getSecurityLog(id: number): Promise<SecurityLog | undefined> {\n    const [log] = await this.db.select().from(securityLogs).where(eq(securityLogs.id, id));\n    return log || undefined;\n  }\n\n  async getSecurityLogsByType(eventType: string): Promise<SecurityLog[]> {\n    return await this.db.select().from(securityLogs).where(eq(securityLogs.eventType, eventType)).orderBy(desc(securityLogs.createdAt));\n  }\n\n  async getRecentSecurityLogs(limit: number = 100): Promise<SecurityLog[]> {\n    return await this.db.select().from(securityLogs).orderBy(desc(securityLogs.createdAt)).limit(limit);\n  }\n\n  async getLoginHistory(limit: number = 50): Promise<SecurityLog[]> {\n    return await this.db.select().from(securityLogs)\n      .where(\n        or(\n          eq(securityLogs.eventType, 'login_success'),\n          eq(securityLogs.eventType, 'login_failed'),\n          eq(securityLogs.eventType, 'two_factor_failed'),\n          eq(securityLogs.eventType, 'password_expired')\n        )\n      )\n      .orderBy(desc(securityLogs.createdAt))\n      .limit(limit);\n  }\n\n  async createSecurityLog(log: InsertSecurityLog): Promise<SecurityLog> {\n    const [created] = await this.db.insert(securityLogs).values(log).returning();\n    return created;\n  }\n\n  async getSecurityStats(): Promise<{\n    totalBlocked: number;\n    totalAllowed: number;\n    byEventType: { type: string; count: number }[];\n  }> {\n    const [blockedCount] = await this.db.select({ count: sql<number>`count(*)` }).from(securityLogs).where(eq(securityLogs.blocked, true));\n    const [allowedCount] = await this.db.select({ count: sql<number>`count(*)` }).from(securityLogs).where(eq(securityLogs.blocked, false));\n\n    const byType = await this.db\n      .select({\n        type: securityLogs.eventType,\n        count: sql<number>`count(*)`\n      })\n      .from(securityLogs)\n      .groupBy(securityLogs.eventType);\n\n    return {\n      totalBlocked: Number(blockedCount.count) || 0,\n      totalAllowed: Number(allowedCount.count) || 0,\n      byEventType: byType.map(t => ({ type: t.type, count: Number(t.count) })),\n    };\n  }\n\n  async getSecurityLogs(limit: number = 100, offset: number = 0, type?: string): Promise<SecurityLog[]> {\n    const query = this.db.select().from(securityLogs);\n\n    if (type === 'login') {\n      query.where(\n        or(\n          eq(securityLogs.eventType, 'login_success'),\n          eq(securityLogs.eventType, 'login_failed'),\n          eq(securityLogs.eventType, 'login_lockout')\n        )\n      );\n    }\n\n    return await query.orderBy(desc(securityLogs.createdAt)).limit(limit).offset(offset);\n  }\n\n  // Firewall Rules\n  async getFirewallRule(id: number): Promise<FirewallRule | undefined> {\n    const [rule] = await this.db.select().from(firewallRules).where(eq(firewallRules.id, id));\n    return rule || undefined;\n  }\n\n  async getAllFirewallRules(): Promise<FirewallRule[]> {\n    return await this.db.select().from(firewallRules).orderBy(asc(firewallRules.priority));\n  }\n\n  async getEnabledFirewallRules(): Promise<FirewallRule[]> {\n    return await this.db.select().from(firewallRules)\n      .where(eq(firewallRules.enabled, true))\n      .orderBy(asc(firewallRules.priority));\n  }\n\n  async createFirewallRule(rule: InsertFirewallRule): Promise<FirewallRule> {\n    const [created] = await this.db.insert(firewallRules).values(rule).returning();\n    return created;\n  }\n\n  async updateFirewallRule(id: number, rule: Partial<InsertFirewallRule>): Promise<FirewallRule | undefined> {\n    const [updated] = await this.db.update(firewallRules)\n      .set({ ...rule, updatedAt: new Date() })\n      .where(eq(firewallRules.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteFirewallRule(id: number): Promise<boolean> {\n    const result = await this.db.delete(firewallRules).where(eq(firewallRules.id, id));\n    return true;\n  }\n\n  async incrementFirewallRuleHit(id: number): Promise<void> {\n    await this.db.update(firewallRules)\n      .set({ \n        hitCount: sql`${firewallRules.hitCount} + 1`,\n        lastHit: new Date()\n      })\n      .where(eq(firewallRules.id, id));\n  }\n\n  // Geo Blocking\n  async getGeoBlockingRule(id: number): Promise<GeoBlocking | undefined> {\n    const [rule] = await this.db.select().from(geoBlocking).where(eq(geoBlocking.id, id));\n    return rule || undefined;\n  }\n\n  async getGeoBlockingByCountry(countryCode: string): Promise<GeoBlocking | undefined> {\n    const [rule] = await this.db.select().from(geoBlocking).where(eq(geoBlocking.countryCode, countryCode));\n    return rule || undefined;\n  }\n\n  async getAllGeoBlockingRules(): Promise<GeoBlocking[]> {\n    return await this.db.select().from(geoBlocking).orderBy(asc(geoBlocking.countryName));\n  }\n\n  async createGeoBlockingRule(rule: InsertGeoBlocking): Promise<GeoBlocking> {\n    const [created] = await this.db.insert(geoBlocking).values(rule).returning();\n    return created;\n  }\n\n  async updateGeoBlockingRule(id: number, rule: Partial<InsertGeoBlocking>): Promise<GeoBlocking | undefined> {\n    const [updated] = await this.db.update(geoBlocking)\n      .set(rule)\n      .where(eq(geoBlocking.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteGeoBlockingRule(id: number): Promise<boolean> {\n    await this.db.delete(geoBlocking).where(eq(geoBlocking.id, id));\n    return true;\n  }\n\n  // Rate Limit Rules\n  async getRateLimitRule(id: number): Promise<RateLimitRule | undefined> {\n    const [rule] = await this.db.select().from(rateLimitRules).where(eq(rateLimitRules.id, id));\n    return rule || undefined;\n  }\n\n  async getAllRateLimitRules(): Promise<RateLimitRule[]> {\n    return await this.db.select().from(rateLimitRules).orderBy(asc(rateLimitRules.name));\n  }\n\n  async getEnabledRateLimitRules(): Promise<RateLimitRule[]> {\n    return await this.db.select().from(rateLimitRules)\n      .where(eq(rateLimitRules.enabled, true))\n      .orderBy(asc(rateLimitRules.name));\n  }\n\n  async createRateLimitRule(rule: InsertRateLimitRule): Promise<RateLimitRule> {\n    const [created] = await this.db.insert(rateLimitRules).values(rule).returning();\n    return created;\n  }\n\n  async updateRateLimitRule(id: number, rule: Partial<InsertRateLimitRule>): Promise<RateLimitRule | undefined> {\n    const [updated] = await this.db.update(rateLimitRules)\n      .set({ ...rule, updatedAt: new Date() })\n      .where(eq(rateLimitRules.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteRateLimitRule(id: number): Promise<boolean> {\n    await this.db.delete(rateLimitRules).where(eq(rateLimitRules.id, id));\n    return true;\n  }\n\n  // User Agent Rules\n  async getUserAgentRule(id: number): Promise<UserAgentRule | undefined> {\n    const [rule] = await this.db.select().from(userAgentRules).where(eq(userAgentRules.id, id));\n    return rule || undefined;\n  }\n\n  async getAllUserAgentRules(): Promise<UserAgentRule[]> {\n    return await this.db.select().from(userAgentRules).orderBy(asc(userAgentRules.name));\n  }\n\n  async getEnabledUserAgentRules(): Promise<UserAgentRule[]> {\n    return await this.db.select().from(userAgentRules)\n      .where(eq(userAgentRules.enabled, true))\n      .orderBy(asc(userAgentRules.name));\n  }\n\n  async createUserAgentRule(rule: InsertUserAgentRule): Promise<UserAgentRule> {\n    const [created] = await this.db.insert(userAgentRules).values(rule).returning();\n    return created;\n  }\n\n  async updateUserAgentRule(id: number, rule: Partial<InsertUserAgentRule>): Promise<UserAgentRule | undefined> {\n    const [updated] = await this.db.update(userAgentRules)\n      .set(rule)\n      .where(eq(userAgentRules.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteUserAgentRule(id: number): Promise<boolean> {\n    await this.db.delete(userAgentRules).where(eq(userAgentRules.id, id));\n    return true;\n  }\n\n  // Blocked Requests\n  async getRecentBlockedRequests(limit: number = 100): Promise<BlockedRequest[]> {\n    return await this.db.select().from(blockedRequests)\n      .orderBy(desc(blockedRequests.createdAt))\n      .limit(limit);\n  }\n\n  async createBlockedRequest(request: InsertBlockedRequest): Promise<BlockedRequest> {\n    const [created] = await this.db.insert(blockedRequests).values(request).returning();\n    return created;\n  }\n\n  async getBlockedRequestStats(): Promise<{\n    total: number;\n    byReason: { reason: string; count: number }[];\n    byCountry: { country: string; count: number }[];\n  }> {\n    const [totalCount] = await this.db.select({ count: sql<number>`count(*)` }).from(blockedRequests);\n    \n    const byReason = await this.db\n      .select({\n        reason: blockedRequests.reason,\n        count: sql<number>`count(*)`\n      })\n      .from(blockedRequests)\n      .groupBy(blockedRequests.reason);\n\n    const byCountry = await this.db\n      .select({\n        country: blockedRequests.countryCode,\n        count: sql<number>`count(*)`\n      })\n      .from(blockedRequests)\n      .where(sql`${blockedRequests.countryCode} IS NOT NULL`)\n      .groupBy(blockedRequests.countryCode);\n\n    return {\n      total: Number(totalCount.count) || 0,\n      byReason: byReason.map(r => ({ reason: r.reason, count: Number(r.count) })),\n      byCountry: byCountry.map(c => ({ country: c.country || 'Unknown', count: Number(c.count) })),\n    };\n  }\n\n  // Homepage Sections\n  async getAllHomepageSections(): Promise<HomepageSection[]> {\n    return await this.db.select().from(homepageSections).orderBy(asc(homepageSections.order));\n  }\n\n  async getHomepageSectionByName(name: string): Promise<HomepageSection | undefined> {\n    const [section] = await this.db.select().from(homepageSections).where(eq(homepageSections.name, name));\n    return section || undefined;\n  }\n\n  async updateHomepageSection(name: string, section: Partial<InsertHomepageSection>): Promise<HomepageSection | undefined> {\n    const [updated] = await this.db.update(homepageSections).set({ ...section, updatedAt: new Date() }).where(eq(homepageSections.name, name)).returning();\n    return updated || undefined;\n  }\n\n  async upsertHomepageSection(name: string, section: Partial<InsertHomepageSection>): Promise<HomepageSection> {\n    const existing = await this.getHomepageSectionByName(name);\n    if (existing) {\n      const mergedData = {\n        name: existing.name,\n        visible: section.visible !== undefined ? section.visible : existing.visible,\n        order: section.order !== undefined ? section.order : existing.order,\n        updatedAt: new Date()\n      };\n\n      const [updated] = await this.db.update(homepageSections)\n        .set(mergedData)\n        .where(eq(homepageSections.name, name))\n        .returning();\n      return updated;\n    }\n\n    const defaultOrder = await this.getAllHomepageSections().then(s => s.length);\n    const [created] = await this.db.insert(homepageSections).values({\n      name,\n      visible: section.visible ?? true,\n      order: section.order ?? defaultOrder\n    }).returning();\n    return created;\n  }\n\n  // FAQs\n  async getFAQ(id: number): Promise<FAQ | undefined> {\n    const [faq] = await this.db.select().from(faqs).where(eq(faqs.id, id));\n    return faq || undefined;\n  }\n\n  async getAllFAQs(): Promise<FAQ[]> {\n    return await this.db.select().from(faqs).orderBy(asc(faqs.order));\n  }\n\n  async getVisibleFAQs(): Promise<FAQ[]> {\n    return await this.db.select().from(faqs).where(eq(faqs.visible, true)).orderBy(asc(faqs.order));\n  }\n\n  async createFAQ(insertFAQ: InsertFAQ): Promise<FAQ> {\n    const [faq] = await this.db.insert(faqs).values(insertFAQ).returning();\n    return faq;\n  }\n\n  async updateFAQ(id: number, faqData: Partial<InsertFAQ>): Promise<FAQ | undefined> {\n    const [faq] = await this.db.update(faqs).set({ ...faqData, updatedAt: new Date() }).where(eq(faqs.id, id)).returning();\n    return faq || undefined;\n  }\n\n  async deleteFAQ(id: number): Promise<boolean> {\n    const result = await this.db.delete(faqs).where(eq(faqs.id, id)).returning();\n    return result.length > 0;\n  }\n\n  // WebAuthn Credentials\n  async createWebAuthnCredential(data: InsertWebAuthnCredential): Promise<WebAuthnCredential> {\n    const [credential] = await this.db.insert(webauthnCredentials).values(data).returning();\n    return credential;\n  }\n\n  async getWebAuthnCredentialsByUser(userId: number): Promise<WebAuthnCredential[]> {\n    return this.db.select().from(webauthnCredentials).where(eq(webauthnCredentials.userId, userId));\n  }\n\n  async getWebAuthnCredentialById(credentialId: string): Promise<WebAuthnCredential | undefined> {\n    const [credential] = await this.db.select().from(webauthnCredentials).where(eq(webauthnCredentials.credentialId, credentialId));\n    return credential;\n  }\n\n  async updateWebAuthnCredentialCounter(id: number, counter: number): Promise<void> {\n    await this.db.update(webauthnCredentials)\n      .set({ counter, lastUsed: new Date() })\n      .where(eq(webauthnCredentials.id, id));\n  }\n\n  async deleteWebAuthnCredential(id: number): Promise<boolean> {\n    const result = await this.db.delete(webauthnCredentials).where(eq(webauthnCredentials.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // 2FA Methods\n  async enable2FA(userId: number, secret: string): Promise<User | undefined> {\n    const [user] = await this.db.update(users)\n      .set({ twoFactorSecret: secret, twoFactorEnabled: true })\n      .where(eq(users.id, userId))\n      .returning();\n    return user;\n  }\n\n  async disable2FA(userId: number): Promise<User | undefined> {\n    const [user] = await this.db.update(users)\n      .set({ twoFactorSecret: null, twoFactorEnabled: false })\n      .where(eq(users.id, userId))\n      .returning();\n    return user;\n  }\n\n  async verify2FA(userId: number, token: string): Promise<boolean> {\n    const user = await this.getUser(userId);\n    if (!user || !user.twoFactorSecret) {\n      return false;\n    }\n\n    // Import speakeasy dynamically to verify the token\n    try {\n      const speakeasy = require('speakeasy');\n      return speakeasy.totp.verify({\n        secret: user.twoFactorSecret,\n        encoding: 'base32',\n        token,\n        window: 2\n      });\n    } catch (error) {\n      console.error('2FA verification error:', error);\n      return false;\n    }\n  }\n\n  async enableBiometricLogin(userId: number, credentialId: string): Promise<User | undefined> {\n    // WebAuthn credentials are stored in a separate table, not in users\n    // This method just returns the user to maintain interface compatibility\n    return await this.getUser(userId);\n  }\n\n  async disableBiometricLogin(userId: number): Promise<User | undefined> {\n    // Delete all WebAuthn credentials for this user\n    await this.db.delete(webauthnCredentials).where(eq(webauthnCredentials.userId, userId));\n    return await this.getUser(userId);\n  }\n\n  // Password Reset Tokens\n  async createPasswordResetToken(data: InsertPasswordResetToken): Promise<PasswordResetToken> {\n    const [token] = await this.db.insert(passwordResetTokens).values(data).returning();\n    return token;\n  }\n\n  async getPasswordResetToken(token: string): Promise<PasswordResetToken | undefined> {\n    const [result] = await this.db.select().from(passwordResetTokens).where(eq(passwordResetTokens.token, token));\n    return result;\n  }\n\n  async markPasswordResetTokenUsed(id: number): Promise<void> {\n    await this.db.update(passwordResetTokens).set({ used: true }).where(eq(passwordResetTokens.id, id));\n  }\n\n  async deleteExpiredPasswordResetTokens(): Promise<void> {\n    await this.db.delete(passwordResetTokens).where(lt(passwordResetTokens.expiresAt, new Date()));\n  }\n\n  // Subscribers\n  async getSubscriber(id: number): Promise<Subscriber | undefined> {\n    const [subscriber] = await this.db.select().from(subscribers).where(eq(subscribers.id, id));\n    return subscriber;\n  }\n\n  async getSubscriberByEmail(email: string): Promise<Subscriber | undefined> {\n    const [subscriber] = await this.db.select().from(subscribers).where(eq(subscribers.email, email));\n    return subscriber;\n  }\n\n  async getAllSubscribers(): Promise<Subscriber[]> {\n    return this.db.select().from(subscribers).orderBy(desc(subscribers.createdAt));\n  }\n\n  async getActiveSubscribers(): Promise<Subscriber[]> {\n    return this.db.select().from(subscribers).where(eq(subscribers.status, 'active')).orderBy(desc(subscribers.createdAt));\n  }\n\n  async createSubscriber(data: InsertSubscriber): Promise<Subscriber> {\n    const [subscriber] = await this.db.insert(subscribers).values(data).returning();\n    return subscriber;\n  }\n\n  async updateSubscriber(id: number, data: Partial<InsertSubscriber>): Promise<Subscriber | undefined> {\n    const [subscriber] = await this.db.update(subscribers).set(data).where(eq(subscribers.id, id)).returning();\n    return subscriber;\n  }\n\n  async deleteSubscriber(id: number): Promise<boolean> {\n    const result = await this.db.delete(subscribers).where(eq(subscribers.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Email Templates\n  async getEmailTemplate(id: number): Promise<EmailTemplate | undefined> {\n    const [template] = await this.db.select().from(emailTemplates).where(eq(emailTemplates.id, id));\n    return template;\n  }\n\n  async getAllEmailTemplates(): Promise<EmailTemplate[]> {\n    return this.db.select().from(emailTemplates).orderBy(desc(emailTemplates.createdAt));\n  }\n\n  async createEmailTemplate(data: InsertEmailTemplate): Promise<EmailTemplate> {\n    const [template] = await this.db.insert(emailTemplates).values(data).returning();\n    return template;\n  }\n\n  async updateEmailTemplate(id: number, data: Partial<InsertEmailTemplate>): Promise<EmailTemplate | undefined> {\n    const [template] = await this.db.update(emailTemplates).set({ ...data, updatedAt: new Date() }).where(eq(emailTemplates.id, id)).returning();\n    return template;\n  }\n\n  async deleteEmailTemplate(id: number): Promise<boolean> {\n    const result = await this.db.delete(emailTemplates).where(eq(emailTemplates.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Email Campaigns\n  async getEmailCampaign(id: number): Promise<EmailCampaign | undefined> {\n    const [campaign] = await this.db.select().from(emailCampaigns).where(eq(emailCampaigns.id, id));\n    return campaign;\n  }\n\n  async getAllEmailCampaigns(): Promise<EmailCampaign[]> {\n    return this.db.select().from(emailCampaigns).orderBy(desc(emailCampaigns.createdAt));\n  }\n\n  async createEmailCampaign(data: InsertEmailCampaign): Promise<EmailCampaign> {\n    const [campaign] = await this.db.insert(emailCampaigns).values(data).returning();\n    return campaign;\n  }\n\n  async updateEmailCampaign(id: number, data: Partial<InsertEmailCampaign>): Promise<EmailCampaign | undefined> {\n    const [campaign] = await this.db.update(emailCampaigns).set({ ...data, updatedAt: new Date() }).where(eq(emailCampaigns.id, id)).returning();\n    return campaign;\n  }\n\n  async deleteEmailCampaign(id: number): Promise<boolean> {\n    const result = await this.db.delete(emailCampaigns).where(eq(emailCampaigns.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Content Versions\n  async getContentVersions(contentType: string, contentId: number): Promise<ContentVersion[]> {\n    return this.db.select().from(contentVersions)\n      .where(and(eq(contentVersions.contentType, contentType), eq(contentVersions.contentId, contentId)))\n      .orderBy(desc(contentVersions.version));\n  }\n\n  async createContentVersion(data: InsertContentVersion): Promise<ContentVersion> {\n    const [version] = await this.db.insert(contentVersions).values(data).returning();\n    return version;\n  }\n\n  async getLatestVersionNumber(contentType: string, contentId: number): Promise<number> {\n    const [latest] = await this.db.select({ version: contentVersions.version }).from(contentVersions)\n      .where(and(eq(contentVersions.contentType, contentType), eq(contentVersions.contentId, contentId)))\n      .orderBy(desc(contentVersions.version)).limit(1);\n    return latest?.version ?? 0;\n  }\n\n  // Content Drafts\n  async getContentDraft(userId: number, contentType: string, contentId?: number): Promise<ContentDraft | undefined> {\n    const conditions = [eq(contentDrafts.userId, userId), eq(contentDrafts.contentType, contentType)];\n    if (contentId !== undefined) {\n      conditions.push(eq(contentDrafts.contentId, contentId));\n    }\n    const [draft] = await this.db.select().from(contentDrafts).where(and(...conditions));\n    return draft;\n  }\n\n  async upsertContentDraft(data: InsertContentDraft): Promise<ContentDraft> {\n    const existing = await this.getContentDraft(data.userId, data.contentType, data.contentId ?? undefined);\n    if (existing) {\n      const [updated] = await this.db.update(contentDrafts)\n        .set({ ...data, updatedAt: new Date() })\n        .where(eq(contentDrafts.id, existing.id))\n        .returning();\n      return updated;\n    }\n    const [draft] = await this.db.insert(contentDrafts).values(data).returning();\n    return draft;\n  }\n\n  async deleteContentDraft(id: number): Promise<boolean> {\n    const result = await this.db.delete(contentDrafts).where(eq(contentDrafts.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Scheduled Content\n  async getScheduledContent(id: number): Promise<ScheduledContent | undefined> {\n    const [scheduled] = await this.db.select().from(scheduledContent).where(eq(scheduledContent.id, id));\n    return scheduled;\n  }\n\n  async getAllScheduledContent(): Promise<ScheduledContent[]> {\n    return this.db.select().from(scheduledContent).where(eq(scheduledContent.executed, false)).orderBy(asc(scheduledContent.scheduledAt));\n  }\n\n  async getPendingScheduledContent(): Promise<ScheduledContent[]> {\n    return this.db.select().from(scheduledContent)\n      .where(and(eq(scheduledContent.executed, false), lt(scheduledContent.scheduledAt, new Date())))\n      .orderBy(asc(scheduledContent.scheduledAt));\n  }\n\n  async createScheduledContent(data: InsertScheduledContent): Promise<ScheduledContent> {\n    const [scheduled] = await this.db.insert(scheduledContent).values(data).returning();\n    return scheduled;\n  }\n\n  async markScheduledContentExecuted(id: number): Promise<void> {\n    await this.db.update(scheduledContent).set({ executed: true, executedAt: new Date() }).where(eq(scheduledContent.id, id));\n  }\n\n  async deleteScheduledContent(id: number): Promise<boolean> {\n    const result = await this.db.delete(scheduledContent).where(eq(scheduledContent.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Comment Likes\n  async getCommentLikes(commentId: number): Promise<{ likes: number; dislikes: number }> {\n    const likes = await this.db.select().from(commentLikes).where(and(eq(commentLikes.commentId, commentId), eq(commentLikes.isLike, true)));\n    const dislikes = await this.db.select().from(commentLikes).where(and(eq(commentLikes.commentId, commentId), eq(commentLikes.isLike, false)));\n    return { likes: likes.length, dislikes: dislikes.length };\n  }\n\n  async getVisitorCommentLike(commentId: number, visitorId: string): Promise<CommentLike | undefined> {\n    const [like] = await this.db.select().from(commentLikes).where(and(eq(commentLikes.commentId, commentId), eq(commentLikes.visitorId, visitorId)));\n    return like;\n  }\n\n  async upsertCommentLike(data: InsertCommentLike): Promise<CommentLike> {\n    const existing = await this.getVisitorCommentLike(data.commentId, data.visitorId);\n    if (existing) {\n      const [updated] = await this.db.update(commentLikes).set({ isLike: data.isLike }).where(eq(commentLikes.id, existing.id)).returning();\n      return updated;\n    }\n    const [like] = await this.db.insert(commentLikes).values(data).returning();\n    return like;\n  }\n\n  async deleteCommentLike(commentId: number, visitorId: string): Promise<boolean> {\n    const result = await this.db.delete(commentLikes).where(and(eq(commentLikes.commentId, commentId), eq(commentLikes.visitorId, visitorId)));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Comment Reports\n  async getCommentReport(id: number): Promise<CommentReport | undefined> {\n    const [report] = await this.db.select().from(commentReports).where(eq(commentReports.id, id));\n    return report;\n  }\n\n  async getAllCommentReports(): Promise<CommentReport[]> {\n    return this.db.select().from(commentReports).orderBy(desc(commentReports.createdAt));\n  }\n\n  async getPendingCommentReports(): Promise<CommentReport[]> {\n    return this.db.select().from(commentReports).where(eq(commentReports.status, 'pending')).orderBy(desc(commentReports.createdAt));\n  }\n\n  async createCommentReport(data: InsertCommentReport): Promise<CommentReport> {\n    const [report] = await this.db.insert(commentReports).values(data).returning();\n    return report;\n  }\n\n  async updateCommentReportStatus(id: number, status: string, reviewedBy: number): Promise<CommentReport | undefined> {\n    const [report] = await this.db.update(commentReports).set({ status, reviewedBy, reviewedAt: new Date() }).where(eq(commentReports.id, id)).returning();\n    return report;\n  }\n\n  // Search History\n  async createSearchHistory(data: InsertSearchHistory): Promise<SearchHistory> {\n    const [history] = await this.db.insert(searchHistory).values(data).returning();\n    return history;\n  }\n\n  async getPopularSearches(limit: number = 10): Promise<{ query: string; count: number }[]> {\n    const results = await this.db.select({\n      query: searchHistory.query,\n      count: sql<number>`count(*)`\n    }).from(searchHistory)\n      .groupBy(searchHistory.query)\n      .orderBy(desc(sql`count(*)`))\n      .limit(limit);\n    return results;\n  }\n\n  async getUserSearchHistory(userId: number, limit: number = 10): Promise<SearchHistory[]> {\n    return this.db.select().from(searchHistory)\n      .where(eq(searchHistory.userId, userId))\n      .orderBy(desc(searchHistory.createdAt))\n      .limit(limit);\n  }\n\n  // Page Views / Analytics\n  async createPageView(data: InsertPageView): Promise<PageView> {\n    const [view] = await this.db.insert(pageViews).values(data).returning();\n    return view;\n  }\n\n  async getPageViewStats(startDate?: Date, endDate?: Date): Promise<{ path: string; views: number }[]> {\n    let query = this.db.select({\n      path: pageViews.path,\n      views: sql<number>`count(*)`\n    }).from(pageViews);\n\n    const conditions = [];\n    if (startDate) conditions.push(sql`${pageViews.createdAt} >= ${startDate}`);\n    if (endDate) conditions.push(sql`${pageViews.createdAt} <= ${endDate}`);\n\n    if (conditions.length > 0) {\n      query = query.where(and(...conditions)) as any;\n    }\n\n    return query.groupBy(pageViews.path).orderBy(desc(sql`count(*)`));\n  }\n\n  async getPopularContent(contentType?: string, limit: number = 10): Promise<{ contentId: number; contentType: string; views: number }[]> {\n    let query = this.db.select({\n      contentId: pageViews.contentId,\n      contentType: pageViews.contentType,\n      views: sql<number>`count(*)`\n    }).from(pageViews).where(sql`${pageViews.contentId} IS NOT NULL`);\n\n    if (contentType) {\n      query = query.where(eq(pageViews.contentType, contentType)) as any;\n    }\n\n    return query.groupBy(pageViews.contentId, pageViews.contentType).orderBy(desc(sql`count(*)`)).limit(limit) as any;\n  }\n\n  async getReferrerStats(limit: number = 10): Promise<{ referrer: string; count: number }[]> {\n    return this.db.select({\n      referrer: pageViews.referrer,\n      count: sql<number>`count(*)`\n    }).from(pageViews)\n      .where(sql`${pageViews.referrer} IS NOT NULL AND ${pageViews.referrer} != ''`)\n      .groupBy(pageViews.referrer)\n      .orderBy(desc(sql`count(*)`))\n      .limit(limit) as any;\n  }\n\n  async getDeviceStats(): Promise<{ device: string; count: number }[]> {\n    return this.db.select({\n      device: pageViews.device,\n      count: sql<number>`count(*)`\n    }).from(pageViews)\n      .where(sql`${pageViews.device} IS NOT NULL`)\n      .groupBy(pageViews.device)\n      .orderBy(desc(sql`count(*)`)) as any;\n  }\n\n  async getBrowserStats(): Promise<{ browser: string; count: number }[]> {\n    return this.db.select({\n      browser: pageViews.browser,\n      count: sql<number>`count(*)`\n    }).from(pageViews)\n      .where(sql`${pageViews.browser} IS NOT NULL`)\n      .groupBy(pageViews.browser)\n      .orderBy(desc(sql`count(*)`)) as any;\n  }\n\n  async getCountryStats(): Promise<{ country: string; count: number }[]> {\n    return this.db.select({\n      country: pageViews.country,\n      count: sql<number>`count(*)`\n    }).from(pageViews)\n      .where(sql`${pageViews.country} IS NOT NULL`)\n      .groupBy(pageViews.country)\n      .orderBy(desc(sql`count(*)`)) as any;\n  }\n\n  // Translations\n  async getTranslation(key: string, locale: string): Promise<Translation | undefined> {\n    const [translation] = await this.db.select().from(translations).where(and(eq(translations.key, key), eq(translations.locale, locale)));\n    return translation;\n  }\n\n  async getTranslationsByLocale(locale: string, namespace?: string): Promise<Translation[]> {\n    const conditions = [eq(translations.locale, locale)];\n    if (namespace) conditions.push(eq(translations.namespace, namespace));\n    return this.db.select().from(translations).where(and(...conditions));\n  }\n\n  async upsertTranslation(data: InsertTranslation): Promise<Translation> {\n    const existing = await this.getTranslation(data.key, data.locale);\n    if (existing) {\n      const [updated] = await this.db.update(translations).set({ ...data, updatedAt: new Date() }).where(eq(translations.id, existing.id)).returning();\n      return updated;\n    }\n    const [translation] = await this.db.insert(translations).values(data).returning();\n    return translation;\n  }\n\n  async deleteTranslation(id: number): Promise<boolean> {\n    const result = await this.db.delete(translations).where(eq(translations.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Content Templates\n  async getContentTemplate(id: number): Promise<ContentTemplate | undefined> {\n    const [template] = await this.db.select().from(contentTemplates).where(eq(contentTemplates.id, id));\n    return template;\n  }\n\n  async getAllContentTemplates(): Promise<ContentTemplate[]> {\n    return this.db.select().from(contentTemplates).orderBy(desc(contentTemplates.createdAt));\n  }\n\n  async getContentTemplatesByType(type: string): Promise<ContentTemplate[]> {\n    return this.db.select().from(contentTemplates).where(eq(contentTemplates.type, type)).orderBy(desc(contentTemplates.createdAt));\n  }\n\n  async createContentTemplate(data: InsertContentTemplate): Promise<ContentTemplate> {\n    const [template] = await this.db.insert(contentTemplates).values(data).returning();\n    return template;\n  }\n\n  async updateContentTemplate(id: number, data: Partial<InsertContentTemplate>): Promise<ContentTemplate | undefined> {\n    const [template] = await this.db.update(contentTemplates).set({ ...data, updatedAt: new Date() }).where(eq(contentTemplates.id, id)).returning();\n    return template;\n  }\n\n  async deleteContentTemplate(id: number): Promise<boolean> {\n    const result = await this.db.delete(contentTemplates).where(eq(contentTemplates.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Media Folders\n  async getMediaFolder(id: number): Promise<MediaFolder | undefined> {\n    const [folder] = await this.db.select().from(mediaFolders).where(eq(mediaFolders.id, id));\n    return folder;\n  }\n\n  async getAllMediaFolders(): Promise<MediaFolder[]> {\n    return this.db.select().from(mediaFolders).orderBy(asc(mediaFolders.path));\n  }\n\n  async getChildMediaFolders(parentId: number | null): Promise<MediaFolder[]> {\n    if (parentId === null) {\n      return this.db.select().from(mediaFolders).where(sql`${mediaFolders.parentId} IS NULL`).orderBy(asc(mediaFolders.name));\n    }\n    return this.db.select().from(mediaFolders).where(eq(mediaFolders.parentId, parentId)).orderBy(asc(mediaFolders.name));\n  }\n\n  async createMediaFolder(data: InsertMediaFolder): Promise<MediaFolder> {\n    const [folder] = await this.db.insert(mediaFolders).values(data).returning();\n    return folder;\n  }\n\n  async deleteMediaFolder(id: number): Promise<boolean> {\n    const result = await this.db.delete(mediaFolders).where(eq(mediaFolders.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Media search\n  async searchMedia(query: string): Promise<Media[]> {\n    return this.db.select().from(media)\n      .where(or(\n        ilike(media.filename, `%${query}%`),\n        ilike(media.originalName, `%${query}%`),\n        ilike(media.alt, `%${query}%`)\n      ))\n      .orderBy(desc(media.createdAt));\n  }\n\n  async getMediaByType(mimeTypePrefix: string): Promise<Media[]> {\n    return this.db.select().from(media)\n      .where(ilike(media.mimeType, `${mimeTypePrefix}%`))\n      .orderBy(desc(media.createdAt));\n  }\n\n  // Scheduled Tasks\n  async getScheduledTask(id: number): Promise<ScheduledTask | undefined> {\n    const [task] = await this.db.select().from(scheduledTasks).where(eq(scheduledTasks.id, id));\n    return task;\n  }\n\n  async getAllScheduledTasks(): Promise<ScheduledTask[]> {\n    return this.db.select().from(scheduledTasks).orderBy(desc(scheduledTasks.createdAt));\n  }\n\n  async getActiveScheduledTasks(): Promise<ScheduledTask[]> {\n    return this.db.select().from(scheduledTasks).where(eq(scheduledTasks.status, \"active\")).orderBy(asc(scheduledTasks.nextRun));\n  }\n\n  async createScheduledTask(data: InsertScheduledTask): Promise<ScheduledTask> {\n    const [task] = await this.db.insert(scheduledTasks).values(data).returning();\n    return task;\n  }\n\n  async updateScheduledTask(id: number, data: Partial<InsertScheduledTask>): Promise<ScheduledTask | undefined> {\n    const [task] = await this.db.update(scheduledTasks).set({ ...data, updatedAt: new Date() }).where(eq(scheduledTasks.id, id)).returning();\n    return task;\n  }\n\n  async updateScheduledTaskRun(id: number, result: 'success' | 'failed', error?: string): Promise<ScheduledTask | undefined> {\n    const [task] = await this.db.update(scheduledTasks).set({\n      lastRun: new Date(),\n      lastResult: result,\n      lastError: error || null,\n      runCount: sql`${scheduledTasks.runCount} + 1`,\n      updatedAt: new Date()\n    }).where(eq(scheduledTasks.id, id)).returning();\n    return task;\n  }\n\n  async deleteScheduledTask(id: number): Promise<boolean> {\n    const result = await this.db.delete(scheduledTasks).where(eq(scheduledTasks.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  async getScheduledTask(id: number): Promise<ScheduledTask | undefined> {\n    const [task] = await this.db.select().from(scheduledTasks).where(eq(scheduledTasks.id, id));\n    return task;\n  }\n\n  async getAllScheduledTasks(): Promise<ScheduledTask[]> {\n    return this.db.select().from(scheduledTasks).orderBy(desc(scheduledTasks.createdAt));\n  }\n\n  async getActiveScheduledTasks(): Promise<ScheduledTask[]> {\n    return this.db.select().from(scheduledTasks).where(eq(scheduledTasks.status, \"active\")).orderBy(desc(scheduledTasks.createdAt));\n  }\n\n  async createScheduledTask(data: InsertScheduledTask): Promise<ScheduledTask> {\n    const [task] = await this.db.insert(scheduledTasks).values(data).returning();\n    return task;\n  }\n\n  // Webhooks\n  async getWebhook(id: number): Promise<Webhook | undefined> {\n    const [webhook] = await this.db.select().from(webhooks).where(eq(webhooks.id, id));\n    return webhook;\n  }\n\n  async getAllWebhooks(): Promise<Webhook[]> {\n    return this.db.select().from(webhooks).orderBy(desc(webhooks.createdAt));\n  }\n\n  async getActiveWebhooks(): Promise<Webhook[]> {\n    return this.db.select().from(webhooks).where(eq(webhooks.status, \"active\"));\n  }\n\n  async getWebhooksByEvent(event: string): Promise<Webhook[]> {\n    return this.db.select().from(webhooks)\n      .where(and(\n        eq(webhooks.status, \"active\"),\n        sql`${webhooks.events}::jsonb ? ${event}`\n      ));\n  }\n\n  async createWebhook(data: InsertWebhook): Promise<Webhook> {\n    const [webhook] = await this.db.insert(webhooks).values(data).returning();\n    return webhook;\n  }\n\n  async updateWebhook(id: number, data: Partial<InsertWebhook>): Promise<Webhook | undefined> {\n    const [webhook] = await this.db.update(webhooks).set({ ...data, updatedAt: new Date() }).where(eq(webhooks.id, id)).returning();\n    return webhook;\n  }\n\n  async incrementWebhookSuccess(id: number): Promise<void> {\n    await this.db.update(webhooks).set({\n      lastTriggered: new Date(),\n      successCount: sql`${webhooks.successCount} + 1`,\n      updatedAt: new Date()\n    }).where(eq(webhooks.id, id));\n  }\n\n  async incrementWebhookFailure(id: number): Promise<void> {\n    await this.db.update(webhooks).set({\n      lastTriggered: new Date(),\n      failureCount: sql`${webhooks.failureCount} + 1`,\n      updatedAt: new Date()\n    }).where(eq(webhooks.id, id));\n  }\n\n  async deleteWebhook(id: number): Promise<boolean> {\n    await this.db.delete(webhookLogs).where(eq(webhookLogs.webhookId, id));\n    const result = await this.db.delete(webhooks).where(eq(webhooks.id, id));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Webhook Logs\n  async getWebhookLog(id: number): Promise<WebhookLog | undefined> {\n    const [log] = await this.db.select().from(webhookLogs).where(eq(webhookLogs.id, id));\n    return log;\n  }\n\n  async getWebhookLogs(webhookId: number, limit: number = 50): Promise<WebhookLog[]> {\n    return this.db.select().from(webhookLogs)\n      .where(eq(webhookLogs.webhookId, webhookId))\n      .orderBy(desc(webhookLogs.createdAt))\n      .limit(limit);\n  }\n\n  async getAllWebhookLogs(limit: number = 100): Promise<WebhookLog[]> {\n    return this.db.select().from(webhookLogs).orderBy(desc(webhookLogs.createdAt)).limit(limit);\n  }\n\n  async createWebhookLog(data: InsertWebhookLog): Promise<WebhookLog> {\n    const [log] = await this.db.insert(webhookLogs).values(data).returning();\n    return log;\n  }\n\n  async deleteWebhookLogs(webhookId: number): Promise<boolean> {\n    const result = await this.db.delete(webhookLogs).where(eq(webhookLogs.webhookId, webhookId));\n    return (result.rowCount ?? 0) > 0;\n  }\n\n  // Get daily page views for analytics\n  async getDailyPageViews(days: number = 30): Promise<{ date: string; views: number; visitors: number }[]> {\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n    \n    const result = await this.db.select({\n      date: sql<string>`DATE(${pageViews.createdAt})`,\n      views: sql<number>`COUNT(*)`,\n      visitors: sql<number>`COUNT(DISTINCT ${pageViews.visitorId})`\n    }).from(pageViews)\n      .where(sql`${pageViews.createdAt} >= ${startDate}`)\n      .groupBy(sql`DATE(${pageViews.createdAt})`)\n      .orderBy(sql`DATE(${pageViews.createdAt})`);\n    \n    return result as any;\n  }\n\n  // Get all translations\n  async getAllTranslations(): Promise<Translation[]> {\n    return this.db.select().from(translations).orderBy(translations.locale, translations.namespace, translations.key);\n  }\n\n  // Get translations by key (all locales)\n  async getTranslationsByKey(key: string): Promise<Translation[]> {\n    return this.db.select().from(translations).where(eq(translations.key, key));\n  }\n\n  // Bulk upsert translations\n  async bulkUpsertTranslations(data: InsertTranslation[]): Promise<Translation[]> {\n    const results: Translation[] = [];\n    for (const t of data) {\n      const result = await this.upsertTranslation(t);\n      results.push(result);\n    }\n    return results;\n  }\n}\n\nexport const storage = new DatabaseStorage();","path":null,"size_bytes":84821,"size_tokens":null},"shared/schema.ts":{"content":"import { sql, relations } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, boolean, timestamp, jsonb, serial } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema, createSelectSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Users table - for admin authentication\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull().unique(),\n  role: text(\"role\").notNull().default(\"Subscriber\"),\n  status: text(\"status\").notNull().default(\"Active\"),\n  avatar: text(\"avatar\"),\n  twoFactorSecret: text(\"two_factor_secret\"),\n  twoFactorEnabled: boolean(\"two_factor_enabled\").notNull().default(false),\n  passwordUpdatedAt: timestamp(\"password_updated_at\").defaultNow(),\n  passwordExpiresAt: timestamp(\"password_expires_at\"),\n  lastActive: timestamp(\"last_active\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  lastActive: true,\n});\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\n// Projects table\nexport const projects = pgTable(\"projects\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  category: text(\"category\").notNull(),\n  image: text(\"image\"),\n  shortDescription: text(\"short_description\"),\n  description: text(\"description\"),\n  tech: jsonb(\"tech\").$type<string[]>().default([]),\n  link: text(\"link\"),\n  github: text(\"github\"),\n  status: text(\"status\").notNull().default(\"Draft\"),\n  views: integer(\"views\").notNull().default(0),\n  featured: boolean(\"featured\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertProjectSchema = createInsertSchema(projects).omit({\n  id: true,\n  views: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Project = typeof projects.$inferSelect;\n\n// Posts table - blog posts\nexport const posts = pgTable(\"posts\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  content: text(\"content\"),\n  excerpt: text(\"excerpt\"),\n  category: text(\"category\").notNull(),\n  author: text(\"author\").notNull(),\n  status: text(\"status\").notNull().default(\"Draft\"),\n  views: integer(\"views\").notNull().default(0),\n  featured: boolean(\"featured\").notNull().default(false),\n  featuredImage: text(\"featured_image\"),\n  tags: jsonb(\"tags\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n  publishedAt: timestamp(\"published_at\"),\n});\n\nexport const insertPostSchema = createInsertSchema(posts).omit({\n  id: true,\n  views: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertPost = z.infer<typeof insertPostSchema>;\nexport type Post = typeof posts.$inferSelect;\n\n// Skills table\nexport const skills = pgTable(\"skills\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  category: text(\"category\").notNull(),\n  level: integer(\"level\").notNull().default(0),\n  icon: text(\"icon\"),\n  order: integer(\"order\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSkillSchema = createInsertSchema(skills).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertSkill = z.infer<typeof insertSkillSchema>;\nexport type Skill = typeof skills.$inferSelect;\n\n// Services table\nexport const services = pgTable(\"services\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\"),\n  icon: text(\"icon\"),\n  features: jsonb(\"features\").$type<string[]>().default([]),\n  price: text(\"price\"),\n  order: integer(\"order\").notNull().default(0),\n  active: boolean(\"active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertServiceSchema = createInsertSchema(services).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertService = z.infer<typeof insertServiceSchema>;\nexport type Service = typeof services.$inferSelect;\n\n// Testimonials table\nexport const testimonials = pgTable(\"testimonials\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  role: text(\"role\"),\n  company: text(\"company\"),\n  content: text(\"content\").notNull(),\n  avatar: text(\"avatar\"),\n  rating: integer(\"rating\").notNull().default(5),\n  featured: boolean(\"featured\").notNull().default(false),\n  active: boolean(\"active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTestimonialSchema = createInsertSchema(testimonials).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertTestimonial = z.infer<typeof insertTestimonialSchema>;\nexport type Testimonial = typeof testimonials.$inferSelect;\n\n// Messages table - contact form submissions\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  sender: text(\"sender\").notNull(),\n  email: text(\"email\").notNull(),\n  subject: text(\"subject\"),\n  message: text(\"message\").notNull(),\n  tag: text(\"tag\"),\n  read: boolean(\"read\").notNull().default(false),\n  archived: boolean(\"archived\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  read: true,\n  archived: true,\n  createdAt: true,\n});\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type Message = typeof messages.$inferSelect;\n\n// Activity logs table\nexport const activityLogs = pgTable(\"activity_logs\", {\n  id: serial(\"id\").primaryKey(),\n  action: text(\"action\").notNull(),\n  userId: integer(\"user_id\"),\n  userName: text(\"user_name\"),\n  type: text(\"type\").notNull().default(\"info\"),\n  metadata: jsonb(\"metadata\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertActivityLogSchema = createInsertSchema(activityLogs).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertActivityLog = z.infer<typeof insertActivityLogSchema>;\nexport type ActivityLog = typeof activityLogs.$inferSelect;\n\n// Notifications table\nexport const notifications = pgTable(\"notifications\", {\n  id: serial(\"id\").primaryKey(),\n  message: text(\"message\").notNull(),\n  type: text(\"type\").notNull().default(\"system\"),\n  read: boolean(\"read\").notNull().default(false),\n  userId: integer(\"user_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  read: true,\n  createdAt: true,\n});\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = typeof notifications.$inferSelect;\n\n// Site settings table\nexport const siteSettings = pgTable(\"site_settings\", {\n  id: serial(\"id\").primaryKey(),\n  key: text(\"key\").notNull().unique(),\n  value: jsonb(\"value\"),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertSiteSettingSchema = createInsertSchema(siteSettings).omit({\n  id: true,\n  updatedAt: true,\n});\nexport type InsertSiteSetting = z.infer<typeof insertSiteSettingSchema>;\nexport type SiteSetting = typeof siteSettings.$inferSelect;\n\n// Categories table\nexport const categories = pgTable(\"categories\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  type: text(\"type\").notNull(),\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertCategorySchema = createInsertSchema(categories).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertCategory = z.infer<typeof insertCategorySchema>;\nexport type Category = typeof categories.$inferSelect;\n\n// Media table\nexport const media = pgTable(\"media\", {\n  id: serial(\"id\").primaryKey(),\n  filename: text(\"filename\").notNull(),\n  originalName: text(\"original_name\").notNull(),\n  mimeType: text(\"mime_type\").notNull(),\n  size: integer(\"size\").notNull(),\n  url: text(\"url\").notNull(),\n  alt: text(\"alt\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertMediaSchema = createInsertSchema(media).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertMedia = z.infer<typeof insertMediaSchema>;\nexport type Media = typeof media.$inferSelect;\n\n// Comments table - for blog posts and projects\nexport const comments = pgTable(\"comments\", {\n  id: serial(\"id\").primaryKey(),\n  content: text(\"content\").notNull(),\n  authorName: text(\"author_name\").notNull(),\n  authorEmail: text(\"author_email\").notNull(),\n  authorAvatar: text(\"author_avatar\"),\n  postId: integer(\"post_id\"),\n  projectId: integer(\"project_id\"),\n  parentId: integer(\"parent_id\"),\n  status: text(\"status\").notNull().default(\"Pending\"),\n  read: boolean(\"read\").notNull().default(false),\n  archived: boolean(\"archived\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertCommentSchema = createInsertSchema(comments).omit({\n  id: true,\n  read: true,\n  archived: true,\n  createdAt: true,\n});\nexport type InsertComment = z.infer<typeof insertCommentSchema>;\nexport type Comment = typeof comments.$inferSelect;\n\n// Reviews table - for projects\nexport const reviews = pgTable(\"reviews\", {\n  id: serial(\"id\").primaryKey(),\n  content: text(\"content\").notNull(),\n  authorName: text(\"author_name\").notNull(),\n  authorEmail: text(\"author_email\").notNull(),\n  authorAvatar: text(\"author_avatar\"),\n  projectId: integer(\"project_id\").notNull(),\n  rating: integer(\"rating\").notNull().default(5),\n  status: text(\"status\").notNull().default(\"Pending\"),\n  read: boolean(\"read\").notNull().default(false),\n  archived: boolean(\"archived\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertReviewSchema = createInsertSchema(reviews).omit({\n  id: true,\n  read: true,\n  archived: true,\n  createdAt: true,\n});\nexport type InsertReview = z.infer<typeof insertReviewSchema>;\nexport type Review = typeof reviews.$inferSelect;\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  activityLogs: many(activityLogs),\n  notifications: many(notifications),\n}));\n\nexport const commentsRelations = relations(comments, ({ one, many }) => ({\n  post: one(posts, {\n    fields: [comments.postId],\n    references: [posts.id],\n  }),\n  project: one(projects, {\n    fields: [comments.projectId],\n    references: [projects.id],\n  }),\n  parent: one(comments, {\n    fields: [comments.parentId],\n    references: [comments.id],\n    relationName: \"replies\",\n  }),\n  replies: many(comments, { relationName: \"replies\" }),\n}));\n\nexport const reviewsRelations = relations(reviews, ({ one }) => ({\n  project: one(projects, {\n    fields: [reviews.projectId],\n    references: [projects.id],\n  }),\n}));\n\nexport const postsRelations = relations(posts, ({ many }) => ({\n  comments: many(comments),\n}));\n\nexport const projectsRelations = relations(projects, ({ many }) => ({\n  comments: many(comments),\n  reviews: many(reviews),\n}));\n\nexport const activityLogsRelations = relations(activityLogs, ({ one }) => ({\n  user: one(users, {\n    fields: [activityLogs.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n}));\n\n// Security Settings table\nexport const securitySettings = pgTable(\"security_settings\", {\n  id: serial(\"id\").primaryKey(),\n  key: text(\"key\").notNull().unique(),\n  value: jsonb(\"value\"),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertSecuritySettingSchema = createInsertSchema(securitySettings).omit({\n  id: true,\n  updatedAt: true,\n});\nexport type InsertSecuritySetting = z.infer<typeof insertSecuritySettingSchema>;\nexport type SecuritySetting = typeof securitySettings.$inferSelect;\n\n// Trusted Devices table\nexport const trustedDevices = pgTable(\"trusted_devices\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull(),\n  deviceName: text(\"device_name\").notNull(),\n  deviceFingerprint: text(\"device_fingerprint\"),\n  ipAddress: text(\"ip_address\"),\n  userAgent: text(\"user_agent\"),\n  trusted: boolean(\"trusted\").notNull().default(true),\n  lastUsed: timestamp(\"last_used\").defaultNow(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertTrustedDeviceSchema = createInsertSchema(trustedDevices).omit({\n  id: true,\n  createdAt: true,\n  lastUsed: true,\n});\nexport type InsertTrustedDevice = z.infer<typeof insertTrustedDeviceSchema>;\nexport type TrustedDevice = typeof trustedDevices.$inferSelect;\n\n// User Sessions table\nexport const userSessions = pgTable(\"user_sessions\", {\n  id: serial(\"id\").primaryKey(),\n  sessionId: text(\"session_id\").notNull().unique(),\n  userId: integer(\"user_id\").notNull(),\n  ipAddress: text(\"ip_address\"),\n  userAgent: text(\"user_agent\"),\n  deviceInfo: text(\"device_info\"),\n  location: text(\"location\"),\n  active: boolean(\"active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  expiresAt: timestamp(\"expires_at\"),\n  lastActivity: timestamp(\"last_activity\").defaultNow(),\n});\n\nexport const insertUserSessionSchema = createInsertSchema(userSessions).omit({\n  id: true,\n  createdAt: true,\n  lastActivity: true,\n});\nexport type InsertUserSession = z.infer<typeof insertUserSessionSchema>;\nexport type UserSession = typeof userSessions.$inferSelect;\n\n// IP Whitelist/Blacklist table\nexport const ipRules = pgTable(\"ip_rules\", {\n  id: serial(\"id\").primaryKey(),\n  ipAddress: text(\"ip_address\").notNull(),\n  type: text(\"type\").notNull(), // 'whitelist' or 'blacklist'\n  reason: text(\"reason\"),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertIpRuleSchema = createInsertSchema(ipRules).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertIpRule = z.infer<typeof insertIpRuleSchema>;\nexport type IpRule = typeof ipRules.$inferSelect;\n\n// Pages table - custom CMS pages\nexport const pages = pgTable(\"pages\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  content: text(\"content\"),\n  excerpt: text(\"excerpt\"),\n  status: text(\"status\").notNull().default(\"Draft\"),\n  views: integer(\"views\").notNull().default(0),\n  featuredImage: text(\"featured_image\"),\n  metaTitle: text(\"meta_title\"),\n  metaDescription: text(\"meta_description\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n  publishedAt: timestamp(\"published_at\"),\n});\n\nexport const insertPageSchema = createInsertSchema(pages).omit({\n  id: true,\n  views: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertPage = z.infer<typeof insertPageSchema>;\nexport type Page = typeof pages.$inferSelect;\n\n// Security Logs table (for bot detection, threat events, login history)\nexport const securityLogs = pgTable(\"security_logs\", {\n  id: serial(\"id\").primaryKey(),\n  eventType: text(\"event_type\").notNull(), // 'bot_blocked', 'ddos_attempt', 'sql_injection', 'xss_attempt', 'login_failed', 'login_success'\n  action: text(\"action\"), // Human readable description of the action\n  userId: integer(\"user_id\"),\n  userName: text(\"user_name\"),\n  ipAddress: text(\"ip_address\"),\n  userAgent: text(\"user_agent\"),\n  requestPath: text(\"request_path\"),\n  requestBody: text(\"request_body\"),\n  blocked: boolean(\"blocked\").notNull().default(false),\n  metadata: jsonb(\"metadata\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSecurityLogSchema = createInsertSchema(securityLogs).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertSecurityLog = z.infer<typeof insertSecurityLogSchema>;\nexport type SecurityLog = typeof securityLogs.$inferSelect;\n\n// Firewall Rules table - custom firewall rules engine\nexport const firewallRules = pgTable(\"firewall_rules\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  ruleType: text(\"rule_type\").notNull(), // 'ip', 'country', 'user_agent', 'path', 'header', 'rate_limit'\n  condition: text(\"condition\").notNull(), // 'equals', 'contains', 'starts_with', 'ends_with', 'regex', 'in_list'\n  value: text(\"value\").notNull(),\n  action: text(\"action\").notNull(), // 'block', 'allow', 'challenge', 'log', 'rate_limit'\n  priority: integer(\"priority\").notNull().default(100),\n  enabled: boolean(\"enabled\").notNull().default(true),\n  hitCount: integer(\"hit_count\").notNull().default(0),\n  lastHit: timestamp(\"last_hit\"),\n  expiresAt: timestamp(\"expires_at\"),\n  metadata: jsonb(\"metadata\"),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertFirewallRuleSchema = createInsertSchema(firewallRules).omit({\n  id: true,\n  hitCount: true,\n  lastHit: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertFirewallRule = z.infer<typeof insertFirewallRuleSchema>;\nexport type FirewallRule = typeof firewallRules.$inferSelect;\n\n// Geo Blocking table - country-based access control\nexport const geoBlocking = pgTable(\"geo_blocking\", {\n  id: serial(\"id\").primaryKey(),\n  countryCode: text(\"country_code\").notNull().unique(),\n  countryName: text(\"country_name\").notNull(),\n  action: text(\"action\").notNull().default(\"block\"), // 'block', 'allow', 'challenge'\n  enabled: boolean(\"enabled\").notNull().default(true),\n  hitCount: integer(\"hit_count\").notNull().default(0),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertGeoBlockingSchema = createInsertSchema(geoBlocking).omit({\n  id: true,\n  hitCount: true,\n  createdAt: true,\n});\nexport type InsertGeoBlocking = z.infer<typeof insertGeoBlockingSchema>;\nexport type GeoBlocking = typeof geoBlocking.$inferSelect;\n\n// Rate Limit Rules table - endpoint-specific rate limits\nexport const rateLimitRules = pgTable(\"rate_limit_rules\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  path: text(\"path\").notNull(), // e.g., '/api/auth/*', '/api/contact'\n  method: text(\"method\").default(\"*\"), // 'GET', 'POST', '*'\n  maxRequests: integer(\"max_requests\").notNull().default(100),\n  windowSeconds: integer(\"window_seconds\").notNull().default(60),\n  blockDuration: integer(\"block_duration\").notNull().default(300), // seconds to block after exceeding\n  enabled: boolean(\"enabled\").notNull().default(true),\n  hitCount: integer(\"hit_count\").notNull().default(0),\n  blockedCount: integer(\"blocked_count\").notNull().default(0),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertRateLimitRuleSchema = createInsertSchema(rateLimitRules).omit({\n  id: true,\n  hitCount: true,\n  blockedCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertRateLimitRule = z.infer<typeof insertRateLimitRuleSchema>;\nexport type RateLimitRule = typeof rateLimitRules.$inferSelect;\n\n// User Agent Rules table - block/allow specific user agents\nexport const userAgentRules = pgTable(\"user_agent_rules\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  pattern: text(\"pattern\").notNull(), // regex or substring to match\n  matchType: text(\"match_type\").notNull().default(\"contains\"), // 'contains', 'exact', 'regex'\n  action: text(\"action\").notNull().default(\"block\"), // 'block', 'allow', 'challenge', 'log'\n  category: text(\"category\"), // 'bot', 'crawler', 'scanner', 'custom'\n  enabled: boolean(\"enabled\").notNull().default(true),\n  hitCount: integer(\"hit_count\").notNull().default(0),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserAgentRuleSchema = createInsertSchema(userAgentRules).omit({\n  id: true,\n  hitCount: true,\n  createdAt: true,\n});\nexport type InsertUserAgentRule = z.infer<typeof insertUserAgentRuleSchema>;\nexport type UserAgentRule = typeof userAgentRules.$inferSelect;\n\n// Blocked Requests Log - log all blocked requests for analysis\nexport const blockedRequests = pgTable(\"blocked_requests\", {\n  id: serial(\"id\").primaryKey(),\n  ipAddress: text(\"ip_address\"),\n  countryCode: text(\"country_code\"),\n  userAgent: text(\"user_agent\"),\n  path: text(\"path\"),\n  method: text(\"method\"),\n  reason: text(\"reason\").notNull(), // 'ip_blocked', 'country_blocked', 'rate_limit', 'user_agent', 'firewall_rule'\n  ruleId: integer(\"rule_id\"),\n  ruleName: text(\"rule_name\"),\n  metadata: jsonb(\"metadata\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertBlockedRequestSchema = createInsertSchema(blockedRequests).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertBlockedRequest = z.infer<typeof insertBlockedRequestSchema>;\nexport type BlockedRequest = typeof blockedRequests.$inferSelect;\n\n// Homepage Sections - manage visibility of sections on homepage\nexport const homepageSections = pgTable(\"homepage_sections\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull().unique(), // 'projects', 'blog', 'testimonials', etc.\n  visible: boolean(\"visible\").notNull().default(true),\n  order: integer(\"order\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertHomepageSectionSchema = createInsertSchema(homepageSections).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertHomepageSection = z.infer<typeof insertHomepageSectionSchema>;\nexport type HomepageSection = typeof homepageSections.$inferSelect;\n\n// FAQs table\nexport const faqs = pgTable(\"faqs\", {\n  id: serial(\"id\").primaryKey(),\n  question: text(\"question\").notNull(),\n  answer: text(\"answer\").notNull(),\n  visible: boolean(\"visible\").notNull().default(true),\n  order: integer(\"order\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertFAQSchema = createInsertSchema(faqs).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertFAQ = z.infer<typeof insertFAQSchema>;\nexport type FAQ = typeof faqs.$inferSelect;\n\n// WebAuthn Credentials table (for biometric login)\nexport const webauthnCredentials = pgTable(\"webauthn_credentials\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull(),\n  credentialId: text(\"credential_id\").notNull().unique(),\n  publicKey: text(\"public_key\").notNull(),\n  counter: integer(\"counter\").notNull().default(0),\n  deviceName: text(\"device_name\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  lastUsed: timestamp(\"last_used\"),\n});\n\nexport const insertWebAuthnCredentialSchema = createInsertSchema(webauthnCredentials).omit({\n  id: true,\n  createdAt: true,\n  lastUsed: true,\n});\nexport type InsertWebAuthnCredential = z.infer<typeof insertWebAuthnCredentialSchema>;\nexport type WebAuthnCredential = typeof webauthnCredentials.$inferSelect;\n\n// Relations for security tables\nexport const trustedDevicesRelations = relations(trustedDevices, ({ one }) => ({\n  user: one(users, {\n    fields: [trustedDevices.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const webauthnCredentialsRelations = relations(webauthnCredentials, ({ one }) => ({\n  user: one(users, {\n    fields: [webauthnCredentials.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const userSessionsRelations = relations(userSessions, ({ one }) => ({\n  user: one(users, {\n    fields: [userSessions.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const ipRulesRelations = relations(ipRules, ({ one }) => ({\n  createdByUser: one(users, {\n    fields: [ipRules.createdBy],\n    references: [users.id],\n  }),\n}));\n\n// Password Reset Tokens table\nexport const passwordResetTokens = pgTable(\"password_reset_tokens\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull(),\n  token: text(\"token\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  used: boolean(\"used\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertPasswordResetTokenSchema = createInsertSchema(passwordResetTokens).omit({\n  id: true,\n  used: true,\n  createdAt: true,\n});\nexport type InsertPasswordResetToken = z.infer<typeof insertPasswordResetTokenSchema>;\nexport type PasswordResetToken = typeof passwordResetTokens.$inferSelect;\n\n// Newsletter Subscribers table\nexport const subscribers = pgTable(\"subscribers\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull().unique(),\n  name: text(\"name\"),\n  status: text(\"status\").notNull().default(\"active\"), // active, unsubscribed, bounced\n  source: text(\"source\").default(\"website\"),\n  tags: jsonb(\"tags\").$type<string[]>().default([]),\n  unsubscribeToken: text(\"unsubscribe_token\"),\n  confirmedAt: timestamp(\"confirmed_at\"),\n  unsubscribedAt: timestamp(\"unsubscribed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSubscriberSchema = createInsertSchema(subscribers).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertSubscriber = z.infer<typeof insertSubscriberSchema>;\nexport type Subscriber = typeof subscribers.$inferSelect;\n\n// Email Templates table\nexport const emailTemplates = pgTable(\"email_templates\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  subject: text(\"subject\").notNull(),\n  htmlContent: text(\"html_content\").notNull(),\n  textContent: text(\"text_content\"),\n  type: text(\"type\").notNull().default(\"newsletter\"), // newsletter, notification, transactional\n  variables: jsonb(\"variables\").$type<string[]>().default([]),\n  active: boolean(\"active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertEmailTemplateSchema = createInsertSchema(emailTemplates).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertEmailTemplate = z.infer<typeof insertEmailTemplateSchema>;\nexport type EmailTemplate = typeof emailTemplates.$inferSelect;\n\n// Email Campaigns table\nexport const emailCampaigns = pgTable(\"email_campaigns\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  subject: text(\"subject\").notNull(),\n  content: text(\"content\").notNull(),\n  templateId: integer(\"template_id\"),\n  status: text(\"status\").notNull().default(\"draft\"), // draft, scheduled, sending, sent, cancelled\n  scheduledAt: timestamp(\"scheduled_at\"),\n  sentAt: timestamp(\"sent_at\"),\n  recipientCount: integer(\"recipient_count\").default(0),\n  openCount: integer(\"open_count\").default(0),\n  clickCount: integer(\"click_count\").default(0),\n  tags: jsonb(\"tags\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertEmailCampaignSchema = createInsertSchema(emailCampaigns).omit({\n  id: true,\n  openCount: true,\n  clickCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertEmailCampaign = z.infer<typeof insertEmailCampaignSchema>;\nexport type EmailCampaign = typeof emailCampaigns.$inferSelect;\n\n// Content Versions table (for version control)\nexport const contentVersions = pgTable(\"content_versions\", {\n  id: serial(\"id\").primaryKey(),\n  contentType: text(\"content_type\").notNull(), // post, page, project\n  contentId: integer(\"content_id\").notNull(),\n  version: integer(\"version\").notNull().default(1),\n  title: text(\"title\").notNull(),\n  content: text(\"content\"),\n  metadata: jsonb(\"metadata\"),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertContentVersionSchema = createInsertSchema(contentVersions).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertContentVersion = z.infer<typeof insertContentVersionSchema>;\nexport type ContentVersion = typeof contentVersions.$inferSelect;\n\n// Content Drafts table (for auto-save)\nexport const contentDrafts = pgTable(\"content_drafts\", {\n  id: serial(\"id\").primaryKey(),\n  contentType: text(\"content_type\").notNull(), // post, page, project\n  contentId: integer(\"content_id\"), // null for new content\n  title: text(\"title\"),\n  content: text(\"content\"),\n  metadata: jsonb(\"metadata\"),\n  userId: integer(\"user_id\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertContentDraftSchema = createInsertSchema(contentDrafts).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertContentDraft = z.infer<typeof insertContentDraftSchema>;\nexport type ContentDraft = typeof contentDrafts.$inferSelect;\n\n// Scheduled Content table\nexport const scheduledContent = pgTable(\"scheduled_content\", {\n  id: serial(\"id\").primaryKey(),\n  contentType: text(\"content_type\").notNull(), // post, page\n  contentId: integer(\"content_id\").notNull(),\n  action: text(\"action\").notNull(), // publish, unpublish\n  scheduledAt: timestamp(\"scheduled_at\").notNull(),\n  executed: boolean(\"executed\").notNull().default(false),\n  executedAt: timestamp(\"executed_at\"),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertScheduledContentSchema = createInsertSchema(scheduledContent).omit({\n  id: true,\n  executed: true,\n  executedAt: true,\n  createdAt: true,\n});\nexport type InsertScheduledContent = z.infer<typeof insertScheduledContentSchema>;\nexport type ScheduledContent = typeof scheduledContent.$inferSelect;\n\n// Comment Likes table\nexport const commentLikes = pgTable(\"comment_likes\", {\n  id: serial(\"id\").primaryKey(),\n  commentId: integer(\"comment_id\").notNull(),\n  visitorId: text(\"visitor_id\").notNull(), // IP hash or session ID\n  isLike: boolean(\"is_like\").notNull(), // true = like, false = dislike\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertCommentLikeSchema = createInsertSchema(commentLikes).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertCommentLike = z.infer<typeof insertCommentLikeSchema>;\nexport type CommentLike = typeof commentLikes.$inferSelect;\n\n// Comment Reports table\nexport const commentReports = pgTable(\"comment_reports\", {\n  id: serial(\"id\").primaryKey(),\n  commentId: integer(\"comment_id\").notNull(),\n  reason: text(\"reason\").notNull(),\n  reporterEmail: text(\"reporter_email\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, reviewed, dismissed\n  reviewedBy: integer(\"reviewed_by\"),\n  reviewedAt: timestamp(\"reviewed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertCommentReportSchema = createInsertSchema(commentReports).omit({\n  id: true,\n  status: true,\n  reviewedBy: true,\n  reviewedAt: true,\n  createdAt: true,\n});\nexport type InsertCommentReport = z.infer<typeof insertCommentReportSchema>;\nexport type CommentReport = typeof commentReports.$inferSelect;\n\n// Search History table\nexport const searchHistory = pgTable(\"search_history\", {\n  id: serial(\"id\").primaryKey(),\n  query: text(\"query\").notNull(),\n  resultsCount: integer(\"results_count\").default(0),\n  visitorId: text(\"visitor_id\"),\n  userId: integer(\"user_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertSearchHistorySchema = createInsertSchema(searchHistory).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertSearchHistory = z.infer<typeof insertSearchHistorySchema>;\nexport type SearchHistory = typeof searchHistory.$inferSelect;\n\n// Page Views / Analytics table\nexport const pageViews = pgTable(\"page_views\", {\n  id: serial(\"id\").primaryKey(),\n  path: text(\"path\").notNull(),\n  contentType: text(\"content_type\"), // post, page, project\n  contentId: integer(\"content_id\"),\n  visitorId: text(\"visitor_id\").notNull(),\n  referrer: text(\"referrer\"),\n  userAgent: text(\"user_agent\"),\n  ipAddress: text(\"ip_address\"),\n  country: text(\"country\"),\n  city: text(\"city\"),\n  device: text(\"device\"),\n  browser: text(\"browser\"),\n  os: text(\"os\"),\n  sessionDuration: integer(\"session_duration\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertPageViewSchema = createInsertSchema(pageViews).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertPageView = z.infer<typeof insertPageViewSchema>;\nexport type PageView = typeof pageViews.$inferSelect;\n\n// Translations table (for i18n)\nexport const translations = pgTable(\"translations\", {\n  id: serial(\"id\").primaryKey(),\n  key: text(\"key\").notNull(),\n  locale: text(\"locale\").notNull(),\n  value: text(\"value\").notNull(),\n  namespace: text(\"namespace\").default(\"common\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertTranslationSchema = createInsertSchema(translations).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertTranslation = z.infer<typeof insertTranslationSchema>;\nexport type Translation = typeof translations.$inferSelect;\n\n// Content Templates table\nexport const contentTemplates = pgTable(\"content_templates\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  type: text(\"type\").notNull(), // post, page\n  content: text(\"content\"),\n  metadata: jsonb(\"metadata\"),\n  isDefault: boolean(\"is_default\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertContentTemplateSchema = createInsertSchema(contentTemplates).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertContentTemplate = z.infer<typeof insertContentTemplateSchema>;\nexport type ContentTemplate = typeof contentTemplates.$inferSelect;\n\n// Media Folders table\nexport const mediaFolders = pgTable(\"media_folders\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  parentId: integer(\"parent_id\"),\n  path: text(\"path\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertMediaFolderSchema = createInsertSchema(mediaFolders).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertMediaFolder = z.infer<typeof insertMediaFolderSchema>;\nexport type MediaFolder = typeof mediaFolders.$inferSelect;\n\n// Relations for new tables\nexport const passwordResetTokensRelations = relations(passwordResetTokens, ({ one }) => ({\n  user: one(users, {\n    fields: [passwordResetTokens.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const emailCampaignsRelations = relations(emailCampaigns, ({ one }) => ({\n  template: one(emailTemplates, {\n    fields: [emailCampaigns.templateId],\n    references: [emailTemplates.id],\n  }),\n}));\n\nexport const contentVersionsRelations = relations(contentVersions, ({ one }) => ({\n  creator: one(users, {\n    fields: [contentVersions.createdBy],\n    references: [users.id],\n  }),\n}));\n\nexport const contentDraftsRelations = relations(contentDrafts, ({ one }) => ({\n  user: one(users, {\n    fields: [contentDrafts.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const scheduledContentRelations = relations(scheduledContent, ({ one }) => ({\n  creator: one(users, {\n    fields: [scheduledContent.createdBy],\n    references: [users.id],\n  }),\n}));\n\nexport const commentLikesRelations = relations(commentLikes, ({ one }) => ({\n  comment: one(comments, {\n    fields: [commentLikes.commentId],\n    references: [comments.id],\n  }),\n}));\n\nexport const commentReportsRelations = relations(commentReports, ({ one }) => ({\n  comment: one(comments, {\n    fields: [commentReports.commentId],\n    references: [comments.id],\n  }),\n  reviewer: one(users, {\n    fields: [commentReports.reviewedBy],\n    references: [users.id],\n  }),\n}));\n\nexport const searchHistoryRelations = relations(searchHistory, ({ one }) => ({\n  user: one(users, {\n    fields: [searchHistory.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const mediaFoldersRelations = relations(mediaFolders, ({ one, many }) => ({\n  parent: one(mediaFolders, {\n    fields: [mediaFolders.parentId],\n    references: [mediaFolders.id],\n    relationName: \"children\",\n  }),\n  children: many(mediaFolders, { relationName: \"children\" }),\n}));\n\n// Scheduled Tasks table (Cron Jobs)\nexport const scheduledTasks = pgTable(\"scheduled_tasks\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  schedule: text(\"schedule\").notNull(), // Cron expression\n  type: text(\"type\").notNull().default(\"custom\"), // backup, email, maintenance, custom\n  command: text(\"command\"), // Command to execute\n  status: text(\"status\").notNull().default(\"active\"), // active, paused, completed\n  lastRun: timestamp(\"last_run\"),\n  nextRun: timestamp(\"next_run\"),\n  lastResult: text(\"last_result\"), // success, failed, null\n  lastError: text(\"last_error\"),\n  runCount: integer(\"run_count\").notNull().default(0),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertScheduledTaskSchema = createInsertSchema(scheduledTasks).omit({\n  id: true,\n  lastRun: true,\n  nextRun: true,\n  lastResult: true,\n  lastError: true,\n  runCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertScheduledTask = z.infer<typeof insertScheduledTaskSchema>;\nexport type ScheduledTask = typeof scheduledTasks.$inferSelect;\n\n// Webhooks table\nexport const webhooks = pgTable(\"webhooks\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  url: text(\"url\").notNull(),\n  events: jsonb(\"events\").$type<string[]>().default([]),\n  secret: text(\"secret\"),\n  status: text(\"status\").notNull().default(\"active\"), // active, inactive\n  lastTriggered: timestamp(\"last_triggered\"),\n  successCount: integer(\"success_count\").notNull().default(0),\n  failureCount: integer(\"failure_count\").notNull().default(0),\n  createdBy: integer(\"created_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const insertWebhookSchema = createInsertSchema(webhooks).omit({\n  id: true,\n  lastTriggered: true,\n  successCount: true,\n  failureCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\nexport type InsertWebhook = z.infer<typeof insertWebhookSchema>;\nexport type Webhook = typeof webhooks.$inferSelect;\n\n// Webhook Logs table\nexport const webhookLogs = pgTable(\"webhook_logs\", {\n  id: serial(\"id\").primaryKey(),\n  webhookId: integer(\"webhook_id\").notNull(),\n  event: text(\"event\").notNull(),\n  payload: jsonb(\"payload\"),\n  responseStatus: integer(\"response_status\"),\n  responseBody: text(\"response_body\"),\n  success: boolean(\"success\").notNull().default(false),\n  duration: integer(\"duration\"), // in milliseconds\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertWebhookLogSchema = createInsertSchema(webhookLogs).omit({\n  id: true,\n  createdAt: true,\n});\nexport type InsertWebhookLog = z.infer<typeof insertWebhookLogSchema>;\nexport type WebhookLog = typeof webhookLogs.$inferSelect;\n\n// Relations for new tables\nexport const scheduledTasksRelations = relations(scheduledTasks, ({ one }) => ({\n  creator: one(users, {\n    fields: [scheduledTasks.createdBy],\n    references: [users.id],\n  }),\n}));\n\nexport const webhooksRelations = relations(webhooks, ({ one, many }) => ({\n  creator: one(users, {\n    fields: [webhooks.createdBy],\n    references: [users.id],\n  }),\n  logs: many(webhookLogs),\n}));\n\nexport const webhookLogsRelations = relations(webhookLogs, ({ one }) => ({\n  webhook: one(webhooks, {\n    fields: [webhookLogs.webhookId],\n    references: [webhooks.id],\n  }),\n}));","path":null,"size_bytes":39773,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"client/src/pages/admin/FileManager.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { \n  Upload, \n  Search, \n  FolderPlus,\n  File,\n  Folder,\n  Image as ImageIcon,\n  FileText,\n  Download,\n  Trash2,\n  Grid3x3,\n  List,\n  ArrowLeft,\n  Loader2,\n  Copy,\n  Eye,\n  X\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface MediaItem {\n  id: number;\n  filename: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n  alt: string | null;\n  createdAt: Date | null;\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 B';\n  const k = 1024;\n  const sizes = ['B', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n}\n\nexport default function FileManager() {\n  const { toast } = useToast();\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<MediaItem | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const { data: mediaItems = [], isLoading } = useQuery<MediaItem[]>({\n    queryKey: ['/api/media'],\n  });\n\n  const createMediaMutation = useMutation({\n    mutationFn: api.createMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File uploaded successfully\" });\n      setUploadDialogOpen(false);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMediaMutation = useMutation({\n    mutationFn: api.deleteMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setUploading(true);\n\n    for (const file of Array.from(files)) {\n      try {\n        const reader = new FileReader();\n        reader.onload = async () => {\n          const base64 = reader.result as string;\n          const timestamp = Date.now();\n          const filename = `${timestamp}-${file.name.replace(/[^a-zA-Z0-9.-]/g, '_')}`;\n          \n          await createMediaMutation.mutateAsync({\n            filename,\n            originalName: file.name,\n            mimeType: file.type,\n            size: file.size,\n            url: base64,\n            alt: file.name,\n          });\n        };\n        reader.readAsDataURL(file);\n      } catch (error) {\n        console.error('Upload error:', error);\n      }\n    }\n\n    setUploading(false);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete \"${name}\"? This action cannot be undone.`)) {\n      deleteMediaMutation.mutate(id);\n    }\n  };\n\n  const copyToClipboard = (url: string) => {\n    navigator.clipboard.writeText(url);\n    toast({ title: \"Copied\", description: \"URL copied to clipboard\" });\n  };\n\n  const filteredMedia = mediaItems.filter(item => {\n    return searchQuery === \"\" || \n      item.originalName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.filename.toLowerCase().includes(searchQuery.toLowerCase());\n  });\n\n  const images = mediaItems.filter(m => m.mimeType.startsWith(\"image/\"));\n  const documents = mediaItems.filter(m => !m.mimeType.startsWith(\"image/\"));\n  const totalSize = mediaItems.reduce((sum, m) => sum + m.size, 0);\n  const maxStorage = 500 * 1024 * 1024;\n  const storagePercent = Math.round((totalSize / maxStorage) * 100);\n\n  const folders = [\n    { name: \"Images\", count: images.length, size: formatFileSize(images.reduce((s, m) => s + m.size, 0)), type: \"images\" },\n    { name: \"Documents\", count: documents.length, size: formatFileSize(documents.reduce((s, m) => s + m.size, 0)), type: \"docs\" },\n  ];\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">File Manager</h1>\n            <p className=\"text-muted-foreground\">\n              Browse and manage your files ({mediaItems.length} files)\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button onClick={() => setUploadDialogOpen(true)} data-testid=\"button-upload\">\n              <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-center justify-between\">\n              <div className=\"flex gap-2 w-full sm:w-auto\">\n                <div className=\"relative flex-1 sm:w-64\">\n                  <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"Search files...\" \n                    className=\"pl-9\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    data-testid=\"input-search-files\"\n                  />\n                </div>\n                <div className=\"flex gap-1 border rounded-md p-1\">\n                  <Button \n                    variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"grid\")}\n                    data-testid=\"button-view-grid\"\n                  >\n                    <Grid3x3 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button \n                    variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"list\")}\n                    data-testid=\"button-view-list\"\n                  >\n                    <List className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium\">Storage Used</span>\n              <span className=\"text-sm text-muted-foreground\">\n                {formatFileSize(totalSize)} / 500 MB\n              </span>\n            </div>\n            <div className=\"w-full bg-muted rounded-full h-2 overflow-hidden\">\n              <div \n                className=\"bg-primary h-full rounded-full transition-all\" \n                style={{ width: `${Math.min(storagePercent, 100)}%` }} \n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        <div>\n          <h3 className=\"text-lg font-bold mb-4\">Categories</h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            {folders.map((folder) => (\n              <Card key={folder.name} className=\"cursor-pointer hover:border-primary transition-colors group\">\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <div className=\"p-3 bg-primary/10 rounded-lg\">\n                      <Folder className=\"w-6 h-6 text-primary\" />\n                    </div>\n                  </div>\n                  <h4 className=\"font-bold mb-1\">{folder.name}</h4>\n                  <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                    <span>{folder.count} files</span>\n                    <span>-</span>\n                    <span>{folder.size}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n\n        <div>\n          <h3 className=\"text-lg font-bold mb-4\">\n            {searchQuery ? `Search Results (${filteredMedia.length})` : `All Files (${mediaItems.length})`}\n          </h3>\n          \n          {filteredMedia.length === 0 ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <File className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No files found</h3>\n                <p className=\"text-muted-foreground text-sm mb-4\">\n                  {searchQuery ? \"Try adjusting your search\" : \"Upload your first file to get started\"}\n                </p>\n                <Button onClick={() => setUploadDialogOpen(true)}>\n                  <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n                </Button>\n              </CardContent>\n            </Card>\n          ) : viewMode === \"grid\" ? (\n            <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4\">\n              {filteredMedia.map((file) => (\n                <Card key={file.id} className=\"group hover:border-primary transition-colors cursor-pointer\" data-testid={`file-card-${file.id}`}>\n                  <div className=\"aspect-square bg-muted flex items-center justify-center relative overflow-hidden\">\n                    {file.mimeType.startsWith(\"image/\") ? (\n                      <img \n                        src={file.url} \n                        alt={file.alt || file.originalName}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    ) : (\n                      <FileText className=\"w-12 h-12 text-muted-foreground\" />\n                    )}\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        onClick={() => setPreviewItem(file)}\n                        title=\"Preview\"\n                      >\n                        <Eye className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        onClick={() => copyToClipboard(file.url)}\n                        title=\"Copy URL\"\n                      >\n                        <Copy className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        className=\"text-destructive\"\n                        onClick={() => handleDelete(file.id, file.originalName)}\n                        title=\"Delete\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <CardContent className=\"p-3\">\n                    <p className=\"font-medium text-sm truncate\" title={file.originalName}>\n                      {file.originalName}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground\">{formatFileSize(file.size)}</p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-0\">\n                <div className=\"divide-y\">\n                  {filteredMedia.map((file) => (\n                    <div \n                      key={file.id} \n                      className=\"flex items-center justify-between p-4 hover:bg-muted/50 cursor-pointer group\"\n                      data-testid={`file-row-${file.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        {file.mimeType.startsWith(\"image/\") ? (\n                          <ImageIcon className=\"w-5 h-5 text-muted-foreground\" />\n                        ) : (\n                          <FileText className=\"w-5 h-5 text-muted-foreground\" />\n                        )}\n                        <div>\n                          <p className=\"font-medium text-sm\">{file.originalName}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {file.createdAt && formatDistanceToNow(new Date(file.createdAt), { addSuffix: true })}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-4\">\n                        <span className=\"text-sm text-muted-foreground\">{formatFileSize(file.size)}</span>\n                        <div className=\"flex gap-1 invisible group-hover:visible transition-all\">\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\"\n                            onClick={() => setPreviewItem(file)}\n                          >\n                            <Eye className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\"\n                            onClick={() => copyToClipboard(file.url)}\n                          >\n                            <Copy className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => handleDelete(file.id, file.originalName)}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>Upload Files</DialogTitle>\n              <DialogDescription>\n                Select files to upload to your file manager\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              <div \n                className=\"border-2 border-dashed border-muted-foreground/30 rounded-lg p-8 text-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                <Upload className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-sm font-medium mb-2\">Click to select files</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  Supports images, PDFs, and documents\n                </p>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  className=\"hidden\"\n                  multiple\n                  accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt\"\n                  onChange={handleFileSelect}\n                  data-testid=\"input-file\"\n                />\n              </div>\n\n              {uploading && (\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Uploading...</span>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setUploadDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={!!previewItem} onOpenChange={() => setPreviewItem(null)}>\n          <DialogContent className=\"sm:max-w-[700px]\">\n            <DialogHeader>\n              <DialogTitle>{previewItem?.originalName}</DialogTitle>\n              <DialogDescription>\n                {previewItem?.mimeType} - {previewItem && formatFileSize(previewItem.size)}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"py-4\">\n              {previewItem?.mimeType.startsWith(\"image/\") ? (\n                <img \n                  src={previewItem.url} \n                  alt={previewItem.alt || previewItem.originalName}\n                  className=\"max-w-full max-h-[400px] mx-auto rounded-lg\"\n                />\n              ) : (\n                <div className=\"flex flex-col items-center justify-center py-12\">\n                  <FileText className=\"w-16 h-16 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">Preview not available for this file type</p>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                onClick={() => previewItem && copyToClipboard(previewItem.url)}\n              >\n                <Copy className=\"w-4 h-4 mr-2\" /> Copy URL\n              </Button>\n              <Button variant=\"outline\" onClick={() => setPreviewItem(null)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":18492,"size_tokens":null},"client/src/pages/admin/EmailTemplates.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Mail, Plus, Edit, Trash, Eye, Send } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface EmailTemplate {\n  id: number;\n  name: string;\n  subject: string;\n  description: string;\n  category: string;\n  status: \"active\" | \"draft\";\n}\n\nexport default function AdminEmailTemplates() {\n  const [templates, setTemplates] = useState<EmailTemplate[]>([\n    {\n      id: 1,\n      name: \"Welcome Email\",\n      subject: \"Welcome to Our Portfolio!\",\n      description: \"Sent to new newsletter subscribers\",\n      category: \"Newsletter\",\n      status: \"active\"\n    },\n    {\n      id: 2,\n      name: \"Contact Form Response\",\n      subject: \"Thank you for reaching out\",\n      description: \"Auto-reply for contact form submissions\",\n      category: \"Contact\",\n      status: \"active\"\n    },\n    {\n      id: 3,\n      name: \"Project Update\",\n      subject: \"Your project update\",\n      description: \"Send project progress updates to clients\",\n      category: \"Projects\",\n      status: \"draft\"\n    },\n  ]);\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this template?\")) {\n      setTemplates(templates.filter(t => t.id !== id));\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Email Templates</h1>\n            <p className=\"text-muted-foreground\">Create and manage email templates</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> New Template\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {templates.map((template) => (\n            <Card key={template.id}>\n              <CardHeader>\n                <div className=\"flex items-start justify-between\">\n                  <Mail className=\"w-8 h-8 text-primary\" />\n                  <Badge variant={template.status === \"active\" ? \"default\" : \"secondary\"}>\n                    {template.status}\n                  </Badge>\n                </div>\n                <CardTitle className=\"mt-3\">{template.name}</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">{template.description}</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Subject:</p>\n                    <p className=\"text-sm font-medium\">{template.subject}</p>\n                  </div>\n                  <div>\n                    <Badge variant=\"outline\">{template.category}</Badge>\n                  </div>\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                      <Eye className=\"w-3 h-3 mr-1\" /> Preview\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                      <Edit className=\"w-3 h-3 mr-1\" /> Edit\n                    </Button>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\"\n                      className=\"text-destructive\"\n                      onClick={() => handleDelete(template.id)}\n                    >\n                      <Trash className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                  <Button variant=\"secondary\" size=\"sm\" className=\"w-full gap-2\">\n                    <Send className=\"w-3 h-3\" /> Send Test Email\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4078,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"replit.md":{"content":"# Loi Developer Portfolio - Full-Stack CMS Platform\n\n## Overview\n\nThis is a modern, full-stack portfolio website and content management system (CMS) built for developers. The platform features a dark-themed frontend with 3D graphics, animations, and comprehensive admin capabilities including content management, user authentication with 2FA/WebAuthn, analytics tracking, email campaigns, and advanced security features.\n\nThe application uses a monorepo structure with a React/TypeScript frontend built with Vite, an Express/TypeScript backend, and PostgreSQL database with Drizzle ORM. It includes real-time features via WebSocket, rich text editing with TipTap, and extensive API endpoints for managing all content types.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Technology Stack:**\n- React 18 with TypeScript for type safety\n- Vite as the build tool for fast development and optimized production builds\n- Tailwind CSS v4 for styling with custom theme configuration supporting dark mode by default\n- Wouter for lightweight client-side routing\n\n**UI Components:**\n- Radix UI primitives for accessible, unstyled components\n- shadcn/ui component library (New York style) integrated via `components.json`\n- Framer Motion for animations and transitions\n- React Three Fiber and Three.js for 3D graphics rendering\n\n**State Management:**\n- TanStack Query (React Query) for server state management, caching, and data fetching\n- React Context API for global UI state (Site settings, Language, Mock data)\n- Express Session for authentication state\n\n**Project Structure:**\n- `/client/src/components/` - Reusable components organized by domain (admin, common, layout, sections, ui)\n- `/client/src/pages/` - Page components split between public (home) and admin areas\n- `/client/src/hooks/` - Custom React hooks for shared logic\n- `/client/src/context/` - Context providers for global state\n- `/client/src/lib/` - Utility functions and shared configuration\n\n**Build Configuration:**\n- Path aliases configured for clean imports (`@/`, `@shared/`, `@assets/`)\n- Custom Vite plugins for meta image updates and Replit-specific features\n- PostCSS with Tailwind for CSS processing\n\n### Backend Architecture\n\n**Technology Stack:**\n- Node.js with Express framework\n- TypeScript for type safety across frontend and backend\n- Session-based authentication with PostgreSQL session store (connect-pg-simple)\n- Passport.js for authentication strategies\n\n**API Design:**\n- RESTful API endpoints organized by resource type in `/server/api/`\n- Middleware-based architecture for authentication, authorization, and security\n- Centralized error handling and validation using Zod schemas\n- Rate limiting and IP filtering for security\n\n**Authentication & Authorization:**\n- Session-based auth with secure HTTP-only cookies\n- Multi-factor authentication (2FA) using TOTP (Speakeasy)\n- WebAuthn/Passkey support via SimpleWebAuthn\n- Password reset flow with time-limited tokens\n- Role-based access control (Super Admin, Admin, Editor, Moderator, Subscriber)\n\n**Key Features:**\n- File upload handling with Multer (images, documents)\n- Email functionality via Nodemailer with template support\n- WebSocket server for real-time notifications and updates\n- CAPTCHA verification support (Google reCAPTCHA, local validation)\n- Scheduled tasks and background jobs (password expiry checks)\n- Activity logging and security audit trails\n\n**Security Middleware:**\n- IP whitelist/blacklist enforcement\n- Rate limiting per endpoint\n- Login attempt tracking with lockout\n- User agent filtering\n- Geo-blocking capabilities\n- Firewall rules\n\n### Data Storage\n\n**Database:**\n- PostgreSQL as primary database (via Neon serverless driver)\n- Drizzle ORM for type-safe database queries\n- Schema defined in `/shared/schema.ts` and shared between frontend and backend\n\n**Database Schema Design:**\n- User management (users, sessions, trusted devices, WebAuthn credentials)\n- Content management (projects, posts, pages, skills, services, testimonials)\n- Media library (media files with folders)\n- Engagement (comments, reviews, messages, notifications)\n- Organization (categories for projects/posts, tags)\n- Site configuration (settings, security settings, homepage sections)\n- Email system (subscribers, templates, campaigns)\n- Security (activity logs, security logs, IP rules, firewall rules, blocked requests)\n- Advanced features (translations, content versions/drafts, scheduled content, search history, page views)\n- Integrations (webhooks, scheduled tasks)\n\n**Storage Layer (`/server/storage.ts`):**\n- Centralized data access layer abstracting Drizzle ORM operations\n- All CRUD operations for each entity type\n- Complex queries (filtering, pagination, sorting)\n- Relationship handling and joins\n\n**Migrations:**\n- Drizzle Kit for schema migrations\n- Migration files stored in `/migrations/`\n- Configuration in `drizzle.config.ts`\n\n### External Dependencies\n\n**Database Service:**\n- Neon Serverless PostgreSQL (via `@neondatabase/serverless`)\n- WebSocket support for connection pooling\n- Environment variable `DATABASE_URL` required\n\n**Email Service:**\n- SMTP configuration stored in database settings\n- Nodemailer for sending emails\n- Support for custom templates and campaigns\n\n**Authentication Services:**\n- SimpleWebAuthn for passwordless authentication\n- Speakeasy for TOTP-based 2FA\n- QRCode generation for 2FA setup\n\n**File Storage:**\n- Local filesystem storage in `/uploads/` directory\n- Organized into subdirectories (images, documents, media)\n- Static file serving via Express\n\n**External APIs:**\n- Google reCAPTCHA for spam protection (optional)\n- CAPTCHA secret key via environment variable\n\n**Development Tools:**\n- Replit-specific plugins for development banner and cartographer\n- Runtime error overlay for better debugging\n\n**Build & Deployment:**\n- esbuild for server bundling in production\n- Vite for client bundling\n- Build script (`/script/build.ts`) bundles both client and server\n- Production server runs from `/dist/` directory\n\n**Real-time Communication:**\n- WebSocket server (ws library) for live updates\n- Broadcasts for new messages, comments, and notifications\n- Mounted on same HTTP server as Express app at `/ws` path\n\n**Content Editing:**\n- TipTap editor with extensions for rich text, code blocks, highlights, and horizontal rules\n- Syntax highlighting via Lowlight\n\n**Image Processing:**\n- Sharp library for image optimization (referenced in image-optimizer API)\n\n**Session Management:**\n- PostgreSQL-backed session store for persistence across restarts\n- Session data includes user ID, username, role, and temporary 2FA state\n\n**Environment Configuration:**\n- Required: `DATABASE_URL`, `SESSION_SECRET` (production)\n- Optional: `RECAPTCHA_SECRET_KEY`, `SITE_URL`, `RP_ID`, `ORIGIN`\n- SMTP settings stored in database rather than environment","path":null,"size_bytes":6908,"size_tokens":null},"client/src/components/ui/Preloader.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\n\nconst hackerTexts = [\n  \"Initializing system...\",\n  \"Connecting to database...\",\n  \"Loading components...\",\n  \"Access granted...\",\n];\n\nexport function Preloader({ onComplete }: { onComplete: () => void }) {\n  const [progress, setProgress] = useState(0);\n  const [textIndex, setTextIndex] = useState(0);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setProgress((prev) => {\n        const next = prev + Math.random() * 10 + 5;\n        if (next >= 100) {\n          clearInterval(interval);\n          setTimeout(onComplete, 200);\n          return 100;\n        }\n        return next;\n      });\n    }, 35);\n    return () => clearInterval(interval);\n  }, [onComplete]);\n\n  useEffect(() => {\n    const textTimer = setInterval(() => {\n      setTextIndex((i) => (i + 1) % hackerTexts.length);\n    }, 1200);\n    return () => clearInterval(textTimer);\n  }, []);\n\n  return (\n    <motion.div\n      initial={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      transition={{ duration: 0.4 }}\n      className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black\"\n    >\n      <div className=\"text-center\">\n        <motion.div\n          animate={{ scale: [1, 1.1, 1] }}\n          transition={{ duration: 1.5, repeat: Infinity }}\n          className=\"mb-8 inline-block\"\n        >\n          <div className=\"w-16 h-16 border-2 border-green-500 rounded flex items-center justify-center\" style={{ boxShadow: \"0 0 20px rgba(0,255,0,0.3)\" }}>\n            <span className=\"text-3xl font-mono text-green-500\">{\"</>\"}</span>\n          </div>\n        </motion.div>\n\n        <h1 className=\"text-2xl font-mono font-bold text-green-500 mb-4\" style={{ textShadow: \"0 0 10px rgba(0, 255, 0, 0.5)\" }}>\n          LOADING\n        </h1>\n\n        <div className=\"w-64 bg-black/70 border border-green-500/40 rounded p-4 font-mono\">\n          <div className=\"text-green-400 text-xs mb-3 min-h-[20px]\">$ {hackerTexts[textIndex]}</div>\n          <div className=\"h-1 bg-green-500/20 rounded overflow-hidden\">\n            <motion.div\n              className=\"h-full bg-green-500\"\n              style={{ width: `${Math.min(progress, 100)}%`, boxShadow: \"0 0 8px rgba(0,255,0,0.6)\" }}\n            />\n          </div>\n          <div className=\"text-xs text-green-500/60 mt-2 text-right\">{Math.round(progress)}%</div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","path":null,"size_bytes":2439,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/lib/api.ts":{"content":"const API_BASE = '/api';\n\nasync function handleResponse<T>(response: Response): Promise<T> {\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'An error occurred' }));\n    throw new Error(error.message || 'Request failed');\n  }\n\n  if (response.status === 204 || response.headers.get('content-length') === '0') {\n    return {} as T;\n  }\n\n  const contentType = response.headers.get('content-type');\n  if (contentType && contentType.includes('application/json')) {\n    return response.json();\n  }\n\n  return {} as T;\n}\n\n\nexport const api = {\n  // Upload\n  uploadImage: async (imageData: string, filename?: string) => {\n    const res = await fetch(`${API_BASE}/upload/image`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ image: imageData, filename }),\n      credentials: \"include\",\n    });\n    if (!res.ok) throw new Error(await res.text());\n    return res.json();\n  },\n\n  // Auth\n  login: async (credentials: { username: string; password: string }) => {\n    const res = await fetch(\"/api/auth/login\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(credentials),\n    });\n    if (!res.ok) {\n      const error = await res.json();\n      throw new Error(error.message || \"Login failed\");\n    }\n    return res.json();\n  },\n\n  logout: async () => {\n    const res = await fetch(`${API_BASE}/auth/logout`, {\n      method: 'POST',\n      credentials: 'include',\n    });\n    return handleResponse<{ message: string }>(res);\n  },\n\n  getCurrentUser: async () => {\n    const res = await fetch(`${API_BASE}/auth/me`, {\n      credentials: 'include',\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateProfile: async (data: any) => {\n    const res = await fetch(`${API_BASE}/auth/profile`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  changePassword: async (currentPassword: string, newPassword: string) => {\n    const res = await fetch(`${API_BASE}/auth/password`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify({ currentPassword, newPassword }),\n    });\n    return handleResponse<any>(res);\n  },\n\n  register: async (data: any) => {\n    const res = await fetch(`${API_BASE}/auth/register`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<{ user: any }>(res);\n  },\n\n  getProjects: async (published = false) => {\n    const url = published ? `${API_BASE}/projects?published=true` : `${API_BASE}/projects`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  getProject: async (id: number) => {\n    const res = await fetch(`${API_BASE}/projects/${id}`, { credentials: 'include' });\n    return handleResponse<any>(res);\n  },\n\n  createProject: async (data: any) => {\n    const res = await fetch(`${API_BASE}/projects`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateProject: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/projects/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteProject: async (id: number) => {\n    const res = await fetch(`${API_BASE}/projects/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getPosts: async (published = false) => {\n    const url = published ? `${API_BASE}/posts?published=true` : `${API_BASE}/posts`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  getPost: async (id: number | string) => {\n    const res = await fetch(`${API_BASE}/posts/${id}`, { credentials: 'include' });\n    return handleResponse<any>(res);\n  },\n\n  createPost: async (data: any) => {\n    const res = await fetch(`${API_BASE}/posts`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updatePost: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/posts/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deletePost: async (id: number) => {\n    const res = await fetch(`${API_BASE}/posts/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getMessages: async (unread = false) => {\n    const url = unread ? `${API_BASE}/messages?unread=true` : `${API_BASE}/messages`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  getMessage: async (id: number) => {\n    const res = await fetch(`${API_BASE}/messages/${id}`, { credentials: 'include' });\n    return handleResponse<any>(res);\n  },\n\n  createMessage: async (data: any) => {\n    const res = await fetch(`${API_BASE}/messages`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  markMessageAsRead: async (id: number) => {\n    const res = await fetch(`${API_BASE}/messages/${id}/read`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  archiveMessage: async (id: number) => {\n    const res = await fetch(`${API_BASE}/messages/${id}/archive`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteMessage: async (id: number) => {\n    const res = await fetch(`${API_BASE}/messages/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteComment: async (id: number) => {\n    const res = await fetch(`${API_BASE}/comments/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  markCommentAsRead: async (id: number) => {\n    const res = await fetch(`${API_BASE}/comments/${id}/read`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  archiveComment: async (id: number) => {\n    const res = await fetch(`${API_BASE}/comments/${id}/archive`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteReview: async (id: number) => {\n    const res = await fetch(`${API_BASE}/reviews/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  markReviewAsRead: async (id: number) => {\n    const res = await fetch(`${API_BASE}/reviews/${id}/read`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  archiveReview: async (id: number) => {\n    const res = await fetch(`${API_BASE}/reviews/${id}/archive`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getSkills: async () => {\n    const res = await fetch(`${API_BASE}/skills`, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  createSkill: async (data: any) => {\n    const res = await fetch(`${API_BASE}/skills`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateSkill: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/skills/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteSkill: async (id: number) => {\n    const res = await fetch(`${API_BASE}/skills/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getServices: async (active = false) => {\n    const url = active ? `${API_BASE}/services?active=true` : `${API_BASE}/services`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  createService: async (data: any) => {\n    const res = await fetch(`${API_BASE}/services`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateService: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/services/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteService: async (id: number) => {\n    const res = await fetch(`${API_BASE}/services/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getTestimonials: async (active = false) => {\n    const url = active ? `${API_BASE}/testimonials?active=true` : `${API_BASE}/testimonials`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  createTestimonial: async (data: any) => {\n    const res = await fetch(`${API_BASE}/testimonials`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateTestimonial: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/testimonials/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteTestimonial: async (id: number) => {\n    const res = await fetch(`${API_BASE}/testimonials/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getActivityLogs: async (limit = 50) => {\n    const res = await fetch(`${API_BASE}/activity-logs?limit=${limit}`, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  getNotifications: async (userId?: number) => {\n    const url = userId ? `${API_BASE}/notifications?userId=${userId}` : `${API_BASE}/notifications`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  markNotificationAsRead: async (id: number) => {\n    const res = await fetch(`${API_BASE}/notifications/${id}/read`, {\n      method: 'PUT',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  getSettings: async () => {\n    const res = await fetch(`${API_BASE}/settings`, { credentials: 'include' });\n    return handleResponse<Record<string, any>>(res);\n  },\n\n  getSetting: async (key: string) => {\n    const res = await fetch(`${API_BASE}/settings/${key}`, { credentials: 'include' });\n    return handleResponse<any>(res);\n  },\n\n  updateSettings: async (settings: Record<string, any>) => {\n    const res = await fetch(`${API_BASE}/settings`, {\n      method: \"PUT\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\",\n      body: JSON.stringify(settings),\n    });\n    if (!res.ok) {\n      const error = await res.json().catch(() => ({ message: 'Save failed' }));\n      throw new Error(error.message || `HTTP ${res.status}`);\n    }\n    return res.json();\n  },\n\n  sendTestEmail: async (data: { to: string; subject: string; body: string }) => {\n    const res = await fetch(\"/api/email/test\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(data),\n      credentials: \"include\",\n    });\n    if (!res.ok) {\n      const error = await res.json();\n      throw new Error(error.message || \"Failed to send test email\");\n    }\n    return res.json();\n  },\n\n  getEmailTemplates: async () => {\n    const res = await fetch(`${API_BASE}/email/templates`, { credentials: 'include' });\n    return handleResponse<Record<string, { subject: string; body: string }>>(res);\n  },\n\n  updateEmailTemplate: async (name: string, data: { subject: string; body: string }) => {\n    const res = await fetch(`${API_BASE}/email/templates/${name}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<{ message: string; template: { subject: string; body: string } }>(res);\n  },\n\n  // ==================== LOGGING API ====================\n\n  async getLogs(level?: string, limit?: number, source?: string) {\n    const params = new URLSearchParams();\n    if (level) params.append(\"level\", level);\n    if (limit) params.append(\"limit\", limit.toString());\n    if (source) params.append(\"source\", source);\n    const res = await fetch(`${API_BASE}/logs?${params.toString()}`, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  async getLogFiles() {\n    const res = await fetch(`${API_BASE}/logs/files`, { credentials: 'include' });\n    return handleResponse<Array<{ filename: string; size: number; sizeFormatted: string; modified: string; date: string }>>(res);\n  },\n\n  async writeLog(level: string, message: string, details?: any) {\n    const res = await fetch(`${API_BASE}/logs`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify({ level, message, details })\n    });\n    return handleResponse<{ success: boolean; message: string }>(res);\n  },\n\n  async deleteLogFile(filename: string) {\n    const res = await fetch(`${API_BASE}/logs/files/${filename}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  async clearAllLogs() {\n    const res = await fetch(`${API_BASE}/logs/clear`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  async exportLogs(source?: string) {\n    const url = source ? `${API_BASE}/logs/export?source=${source}` : `${API_BASE}/logs/export`;\n    const response = await fetch(url, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to export logs\");\n    const blob = await response.blob();\n    const downloadUrl = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = downloadUrl;\n    a.download = `logs-${Date.now()}.json`;\n    a.click();\n    window.URL.revokeObjectURL(downloadUrl);\n  },\n\n  // ==================== DATABASE API ====================\n\n  async getDatabaseStatus() {\n    const res = await fetch(`${API_BASE}/database/status`, { credentials: 'include' });\n    return handleResponse<{\n      status: string;\n      uptime: string;\n      tables: Record<string, number>;\n      totalRecords: number;\n      databaseSize: string;\n    }>(res);\n  },\n\n  async createBackup() {\n    const res = await fetch(`${API_BASE}/database/backup`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{\n      success: boolean;\n      message: string;\n      filename: string;\n      size: number;\n      sizeFormatted: string;\n      timestamp: string;\n      recordCount: number;\n    }>(res);\n  },\n\n  async getBackups() {\n    const res = await fetch(`${API_BASE}/database/backups`, { credentials: 'include' });\n    return handleResponse<Array<{ filename: string; size: number; sizeFormatted: string; created: string; modified: string }>>(res);\n  },\n\n  async downloadBackup(filename: string) {\n    const response = await fetch(`${API_BASE}/database/backup/${filename}`, {\n      credentials: \"include\",\n    });\n    if (!response.ok) throw new Error(\"Failed to download backup\");\n    const blob = await response.blob();\n    const downloadUrl = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = downloadUrl;\n    a.download = filename;\n    a.click();\n    window.URL.revokeObjectURL(downloadUrl);\n  },\n\n  async deleteBackup(filename: string) {\n    const res = await fetch(`${API_BASE}/database/backup/${filename}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  async restoreBackup(file: File) {\n    const formData = new FormData();\n    formData.append(\"backup\", file);\n    const res = await fetch(`${API_BASE}/database/restore`, {\n      method: \"POST\",\n      body: formData,\n      credentials: \"include\",\n    });\n    return handleResponse<any>(res);\n  },\n\n  // ==================== MEDIA API ====================\n\n  createMedia: async (data: { filename: string; originalName: string; mimeType: string; size: number; url: string; alt?: string }) => {\n    const res = await fetch(`${API_BASE}/media`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteMedia: async (id: number) => {\n    const res = await fetch(`${API_BASE}/media/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  syncMedia: async () => {\n    const res = await fetch(`${API_BASE}/media/sync`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{ synced: any[]; skipped: string[] }>(res);\n  },\n\n  // ==================== CATEGORIES API ====================\n\n  getCategories: async (type?: string) => {\n    const url = type ? `${API_BASE}/categories?type=${type}` : `${API_BASE}/categories`;\n    const res = await fetch(url, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  getCategory: async (id: number) => {\n    const res = await fetch(`${API_BASE}/categories/${id}`, { credentials: 'include' });\n    return handleResponse<any>(res);\n  },\n\n  createCategory: async (data: any) => {\n    const res = await fetch(`${API_BASE}/categories`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  updateCategory: async (id: number, data: any) => {\n    const res = await fetch(`${API_BASE}/categories/${id}`, {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'include',\n      body: JSON.stringify(data),\n    });\n    return handleResponse<any>(res);\n  },\n\n  deleteCategory: async (id: number) => {\n    const res = await fetch(`${API_BASE}/categories/${id}`, {\n      method: 'DELETE',\n      credentials: 'include'\n    });\n    return handleResponse<any>(res);\n  },\n\n  // ==================== PERFORMANCE API ====================\n\n  async clearCache() {\n    const res = await fetch(`${API_BASE}/performance/clear-cache`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  // ==================== SYSTEM API ====================\n\n  async getSystemStats() {\n    const res = await fetch(`${API_BASE}/system/stats`, { credentials: 'include' });\n    return handleResponse<{\n      status: string;\n      lastCheck: string;\n      databaseSize: string;\n      serverUptime: number;\n      tableStats: Array<{ name: string; count: number }>;\n    }>(res);\n  },\n\n  async getSystemActivityLogs(limit = 100, offset = 0) {\n    const res = await fetch(`${API_BASE}/system/activity-logs?limit=${limit}&offset=${offset}`, { credentials: 'include' });\n    return handleResponse<any[]>(res);\n  },\n\n  async clearActivityLogs() {\n    const res = await fetch(`${API_BASE}/system/clear-logs`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  async clearSystemLogs() {\n    const res = await fetch(`${API_BASE}/system/clear-system-logs`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n\n  async resetSystem() {\n    const res = await fetch(`${API_BASE}/system/reset`, {\n      method: 'POST',\n      credentials: 'include'\n    });\n    return handleResponse<{ message: string; success: boolean }>(res);\n  },\n};","path":null,"size_bytes":21058,"size_tokens":null},"client/src/pages/admin/APIDocs.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Code, Play, Copy, ChevronDown, ChevronRight } from \"lucide-react\";\nimport { useState } from \"react\";\n\nconst endpoints = [\n  {\n    method: \"GET\",\n    path: \"/api/posts\",\n    description: \"Get all blog posts\",\n    params: [\n      { name: \"limit\", type: \"number\", required: false },\n      { name: \"offset\", type: \"number\", required: false },\n      { name: \"category\", type: \"string\", required: false }\n    ],\n    response: `{\n  \"posts\": [\n    {\n      \"id\": 1,\n      \"title\": \"Blog Post Title\",\n      \"content\": \"...\",\n      \"author\": \"Loi Developer\",\n      \"createdAt\": \"2024-03-20T10:00:00Z\"\n    }\n  ],\n  \"total\": 10\n}`\n  },\n  {\n    method: \"POST\",\n    path: \"/api/posts\",\n    description: \"Create a new blog post\",\n    body: `{\n  \"title\": \"New Post Title\",\n  \"content\": \"Post content...\",\n  \"category\": \"Development\"\n}`,\n    response: `{\n  \"id\": 11,\n  \"title\": \"New Post Title\",\n  \"status\": \"draft\"\n}`\n  },\n  {\n    method: \"GET\",\n    path: \"/api/projects\",\n    description: \"Get all portfolio projects\",\n    params: [\n      { name: \"status\", type: \"string\", required: false },\n      { name: \"category\", type: \"string\", required: false }\n    ],\n    response: `{\n  \"projects\": [...],\n  \"total\": 15\n}`\n  }\n];\n\nexport default function AdminAPIDocs() {\n  const [expandedEndpoint, setExpandedEndpoint] = useState<number | null>(null);\n  const [testResponse, setTestResponse] = useState<string>(\"\");\n\n  const toggleEndpoint = (index: number) => {\n    setExpandedEndpoint(expandedEndpoint === index ? null : index);\n  };\n\n  const handleTest = (endpoint: typeof endpoints[0]) => {\n    setTestResponse(`Testing ${endpoint.method} ${endpoint.path}...\\n\\nResponse:\\n${endpoint.response}`);\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">API Documentation</h1>\n          <p className=\"text-muted-foreground\">Test and explore available API endpoints</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Endpoints List */}\n          <div className=\"lg:col-span-2 space-y-3\">\n            {endpoints.map((endpoint, index) => (\n              <Card key={index} className=\"overflow-hidden\">\n                <div\n                  className=\"p-4 cursor-pointer hover:bg-muted/50 transition-colors\"\n                  onClick={() => toggleEndpoint(index)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <Badge\n                        variant={endpoint.method === \"GET\" ? \"default\" : \"secondary\"}\n                        className={\n                          endpoint.method === \"GET\"\n                            ? \"bg-blue-500\"\n                            : endpoint.method === \"POST\"\n                            ? \"bg-green-500\"\n                            : \"bg-yellow-500\"\n                        }\n                      >\n                        {endpoint.method}\n                      </Badge>\n                      <code className=\"font-mono text-sm\">{endpoint.path}</code>\n                    </div>\n                    {expandedEndpoint === index ? (\n                      <ChevronDown className=\"w-4 h-4\" />\n                    ) : (\n                      <ChevronRight className=\"w-4 h-4\" />\n                    )}\n                  </div>\n                  <p className=\"text-sm text-muted-foreground mt-2\">\n                    {endpoint.description}\n                  </p>\n                </div>\n\n                {expandedEndpoint === index && (\n                  <CardContent className=\"border-t bg-muted/20\">\n                    <Tabs defaultValue=\"params\">\n                      <TabsList>\n                        <TabsTrigger value=\"params\">Parameters</TabsTrigger>\n                        {endpoint.body && <TabsTrigger value=\"body\">Body</TabsTrigger>}\n                        <TabsTrigger value=\"response\">Response</TabsTrigger>\n                      </TabsList>\n\n                      <TabsContent value=\"params\" className=\"space-y-2\">\n                        {endpoint.params && endpoint.params.length > 0 ? (\n                          endpoint.params.map((param, i) => (\n                            <div key={i} className=\"flex items-center gap-3 p-2 border rounded\">\n                              <code className=\"text-sm font-mono\">{param.name}</code>\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {param.type}\n                              </Badge>\n                              {param.required && (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  required\n                                </Badge>\n                              )}\n                            </div>\n                          ))\n                        ) : (\n                          <p className=\"text-sm text-muted-foreground\">No parameters</p>\n                        )}\n                      </TabsContent>\n\n                      {endpoint.body && (\n                        <TabsContent value=\"body\">\n                          <pre className=\"bg-background p-4 rounded border text-xs overflow-x-auto\">\n                            <code>{endpoint.body}</code>\n                          </pre>\n                        </TabsContent>\n                      )}\n\n                      <TabsContent value=\"response\">\n                        <pre className=\"bg-background p-4 rounded border text-xs overflow-x-auto\">\n                          <code>{endpoint.response}</code>\n                        </pre>\n                      </TabsContent>\n                    </Tabs>\n\n                    <div className=\"flex gap-2 mt-4\">\n                      <Button size=\"sm\" onClick={() => handleTest(endpoint)}>\n                        <Play className=\"w-3 h-3 mr-1\" /> Test Endpoint\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\">\n                        <Copy className=\"w-3 h-3 mr-1\" /> Copy cURL\n                      </Button>\n                    </div>\n                  </CardContent>\n                )}\n              </Card>\n            ))}\n          </div>\n\n          {/* Test Panel */}\n          <div>\n            <Card className=\"sticky top-4\">\n              <CardHeader>\n                <CardTitle className=\"text-sm\">API Tester</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-xs font-medium mb-2 block\">Base URL</label>\n                  <Input\n                    defaultValue=\"https://loideveloper.com/api\"\n                    className=\"text-xs font-mono\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium mb-2 block\">Auth Token</label>\n                  <Input\n                    type=\"password\"\n                    placeholder=\"Bearer token...\"\n                    className=\"text-xs font-mono\"\n                  />\n                </div>\n                {testResponse && (\n                  <div>\n                    <label className=\"text-xs font-medium mb-2 block\">Response</label>\n                    <pre className=\"bg-muted p-3 rounded text-xs overflow-x-auto max-h-96\">\n                      {testResponse}\n                    </pre>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":7979,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/pages/admin/Theme.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Palette, \n  Layout, \n  Type, \n  Monitor, \n  Smartphone, \n  Save, \n  RotateCcw,\n  Check\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminTheme() {\n  const [primaryColor, setPrimaryColor] = useState(\"#7c3aed\");\n  \n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Theme Customization</h1>\n            <p className=\"text-muted-foreground\">Customize the look and feel of your website</p>\n          </div>\n          <div className=\"flex gap-2\">\n             <Button variant=\"outline\" className=\"gap-2\">\n                <RotateCcw className=\"w-4 h-4\" /> Reset\n             </Button>\n             <Button className=\"bg-primary gap-2\">\n                <Save className=\"w-4 h-4\" /> Save Changes\n             </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n           {/* Settings Panel */}\n           <div className=\"lg:col-span-1 space-y-6\">\n              {/* Colors */}\n              <Card>\n                 <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                       <Palette className=\"w-5 h-5\" /> Color Scheme\n                    </CardTitle>\n                 </CardHeader>\n                 <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                       <label className=\"text-sm font-medium\">Primary Color</label>\n                       <div className=\"flex gap-2 flex-wrap\">\n                          {[\"#7c3aed\", \"#3b82f6\", \"#10b981\", \"#f59e0b\", \"#ef4444\", \"#ec4899\"].map((color) => (\n                             <button\n                                key={color}\n                                className={`w-8 h-8 rounded-full border-2 transition-all ${primaryColor === color ? 'border-foreground scale-110' : 'border-transparent'}`}\n                                style={{ backgroundColor: color }}\n                                onClick={() => setPrimaryColor(color)}\n                             />\n                          ))}\n                          <div className=\"relative\">\n                             <Input type=\"color\" className=\"w-8 h-8 p-0 border-0 rounded-full overflow-hidden\" value={primaryColor} onChange={(e) => setPrimaryColor(e.target.value)} />\n                          </div>\n                       </div>\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between\">\n                       <label className=\"text-sm font-medium\">Dark Mode Default</label>\n                       <Switch defaultChecked />\n                    </div>\n                 </CardContent>\n              </Card>\n\n              {/* Typography */}\n              <Card>\n                 <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                       <Type className=\"w-5 h-5\" /> Typography\n                    </CardTitle>\n                 </CardHeader>\n                 <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                       <label className=\"text-sm font-medium\">Heading Font</label>\n                       <select className=\"w-full p-2 rounded-md border border-input bg-background\">\n                          <option>Inter</option>\n                          <option>Space Grotesk</option>\n                          <option>Outfit</option>\n                          <option>Plus Jakarta Sans</option>\n                       </select>\n                    </div>\n                    <div className=\"space-y-2\">\n                       <label className=\"text-sm font-medium\">Body Font</label>\n                       <select className=\"w-full p-2 rounded-md border border-input bg-background\">\n                          <option>Inter</option>\n                          <option>Roboto</option>\n                          <option>Open Sans</option>\n                       </select>\n                    </div>\n                 </CardContent>\n              </Card>\n\n              {/* Layout */}\n              <Card>\n                 <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                       <Layout className=\"w-5 h-5\" /> Layout\n                    </CardTitle>\n                 </CardHeader>\n                 <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                       <label className=\"text-sm font-medium\">Container Width</label>\n                       <select className=\"p-1 rounded border bg-background text-sm\">\n                          <option>Boxed (1200px)</option>\n                          <option>Wide (1440px)</option>\n                          <option>Full Width</option>\n                       </select>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                       <label className=\"text-sm font-medium\">Sticky Header</label>\n                       <Switch defaultChecked />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                       <label className=\"text-sm font-medium\">Show Footer</label>\n                       <Switch defaultChecked />\n                    </div>\n                 </CardContent>\n              </Card>\n           </div>\n\n           {/* Live Preview */}\n           <div className=\"lg:col-span-2\">\n              <Card className=\"h-full flex flex-col overflow-hidden border-2 border-primary/20\">\n                 <div className=\"bg-muted border-b p-2 flex items-center justify-between\">\n                    <span className=\"text-xs font-mono text-muted-foreground\">Live Preview</span>\n                    <div className=\"flex gap-2\">\n                       <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\"><Monitor className=\"w-4 h-4\" /></Button>\n                       <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\"><Smartphone className=\"w-4 h-4\" /></Button>\n                    </div>\n                 </div>\n                 <div className=\"flex-1 bg-background p-8 relative overflow-hidden\">\n                    {/* Mockup of the site using selected settings */}\n                    <div className=\"border border-border rounded-lg shadow-lg overflow-hidden max-w-3xl mx-auto bg-card\">\n                       {/* Mock Header */}\n                       <div className=\"h-12 border-b flex items-center justify-between px-4\" style={{ borderColor: `${primaryColor}20` }}>\n                          <div className=\"font-bold\" style={{ color: primaryColor }}>LOI</div>\n                          <div className=\"flex gap-4 text-xs\">\n                             <span>Home</span>\n                             <span>About</span>\n                             <span>Contact</span>\n                          </div>\n                       </div>\n                       \n                       {/* Mock Hero */}\n                       <div className=\"p-8 text-center space-y-4\">\n                          <h1 className=\"text-2xl font-bold\">Building Digital Experiences</h1>\n                          <p className=\"text-sm text-muted-foreground\">This is how your website content will appear with the selected typography and colors.</p>\n                          <Button size=\"sm\" style={{ backgroundColor: primaryColor }}>Get Started</Button>\n                       </div>\n\n                       {/* Mock Grid */}\n                       <div className=\"grid grid-cols-3 gap-4 p-4 bg-muted/20\">\n                          {[1,2,3].map(i => (\n                             <div key={i} className=\"bg-background p-4 rounded border shadow-sm\">\n                                <div className=\"w-8 h-8 rounded mb-2\" style={{ backgroundColor: `${primaryColor}20` }} />\n                                <div className=\"h-2 w-20 bg-muted rounded mb-2\" />\n                                <div className=\"h-2 w-full bg-muted rounded\" />\n                             </div>\n                          ))}\n                       </div>\n                    </div>\n\n                    <div className=\"absolute bottom-4 right-4\">\n                       <Badge className=\"bg-background text-foreground border shadow-lg pointer-events-none\">\n                          Preview Mode\n                       </Badge>\n                    </div>\n                 </div>\n              </Card>\n           </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":8983,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { MockProvider } from \"@/context/MockContext\";\nimport { SiteProvider, useSiteSettings } from \"@/context/SiteContext\";\nimport { LanguageProvider } from \"@/context/LanguageContext\";\nimport { ThemeProvider } from \"next-themes\";\nimport { lazy, Suspense } from \"react\";\nimport { useThemeSettings } from \"@/hooks/use-theme-settings\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useLocation } from \"wouter\";\nimport { Loader2 } from \"lucide-react\";\n\n// Public pages - loaded directly for best UX (from home folder)\nimport Home from \"@/pages/home/Home\";\nimport Maintenance from \"@/pages/home/Maintenance\";\nimport BlogPost from \"@/pages/home/BlogPost\";\nimport Blog from \"@/pages/home/Blog\";\nimport Projects from \"@/pages/home/Projects\";\nimport FAQs from \"@/pages/home/FAQs\";\nimport NotFound from \"@/pages/home/not-found\";\nimport ForgotPassword from \"@/pages/admin/auth/ForgotPassword\";\nimport ResetPassword from \"@/pages/admin/auth/ResetPassword\";\n\n// Admin Login - loaded directly for fast access\nimport AdminLogin from \"@/pages/admin/auth/Login\";\n\n// Admin Dashboard\nconst AdminDashboard = lazy(() => import(\"@/pages/admin/dashboard/Dashboard\"));\nconst AdminAnalytics = lazy(() => import(\"@/pages/admin/dashboard/Analytics\"));\n\n// Admin Content - Posts (modular)\nconst AdminPosts = lazy(() => import(\"@/pages/admin/content/adminposts\"));\nconst AdminPostCategories = lazy(() => import(\"@/pages/admin/content/posts/PostCategories\"));\n\n// Admin Content - Projects (modular)\nconst AdminProjects = lazy(() => import(\"@/pages/admin/content/adminprojects\"));\nconst AdminProjectCategories = lazy(() => import(\"@/pages/admin/content/projects/ProjectCategories\"));\n\n// Admin Content - Services (modular)\nconst AdminServices = lazy(() => import(\"@/pages/admin/content/adminservices\"));\n\n// Admin Content - Skills (modular)\nconst AdminSkills = lazy(() => import(\"@/pages/admin/content/adminskills\"));\n\n// Admin Content - Testimonials (modular)\nconst AdminTestimonials = lazy(() => import(\"@/pages/admin/content/admintestimonials\"));\n\n// Admin Communications - Interactions (modular - replaces Comments)\nconst AdminInteractions = lazy(() => import(\"@/pages/admin/communications/admininteractions\"));\nconst AdminInbox = lazy(() => import(\"@/pages/admin/communications/Inbox\"));\nconst AdminNotifications = lazy(() => import(\"@/pages/admin/communications/Notifications\"));\nconst AdminNewsletter = lazy(() => import(\"@/pages/admin/communications/Newsletter\"));\nconst AdminEmailTemplates = lazy(() => import(\"@/pages/admin/communications/EmailTemplates\"));\n\n// Admin Settings\nconst AdminSettings = lazy(() => import(\"@/pages/admin/settings/Settings\"));\nconst AdminTheme = lazy(() => import(\"@/pages/admin/settings/Theme\"));\nconst AdminLanguageManager = lazy(() => import(\"@/pages/admin/settings/LanguageManager\"));\n\n// Admin Security\nconst AdminSecurity = lazy(() => import(\"@/pages/admin/security/Security\"));\n\n// Admin Users\nconst AdminProfile = lazy(() => import(\"@/pages/admin/users/Profile\"));\n\n// Admin System\nconst AdminSystem = lazy(() => import(\"@/pages/admin/system/System\"));\nconst AdminExportImport = lazy(() => import(\"@/pages/admin/system/ExportImport\"));\nconst AdminCache = lazy(() => import(\"@/pages/admin/system/Cache\"));\nconst AdminAPIDocs = lazy(() => import(\"@/pages/admin/system/APIDocs\"));\nconst AdminLogs = lazy(() => import(\"@/pages/admin/system/Logs\"));\n\n// Admin Tools\nconst AdminTools = lazy(() => import(\"@/pages/admin/tools/Tools\"));\nconst AdminMedia = lazy(() => import(\"@/pages/admin/tools/Media\"));\nconst AdminImageOptimizer = lazy(() => import(\"@/pages/admin/tools/ImageOptimizer\"));\nconst AdminScheduler = lazy(() => import(\"@/pages/admin/tools/Scheduler\"));\nconst AdminFileManager = lazy(() => import(\"@/pages/admin/tools/FileManager\"));\n\n// Admin Pages\nconst AdminPages = lazy(() => import(\"@/pages/admin/pages/Pages\"));\nconst AdminPageBuilder = lazy(() => import(\"@/pages/admin/pages/PageBuilder\"));\nconst AdminFAQs = lazy(() => import(\"@/pages/admin/pages/FAQs\"));\nconst AdminEditor = lazy(() => import(\"@/pages/admin/pages/Editor\"));\n\n// Loading fallback component\nfunction PageLoader() {\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-background\">\n      <div className=\"text-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary mx-auto mb-4\" />\n        <p className=\"text-muted-foreground text-sm\">Loading...</p>\n      </div>\n    </div>\n  );\n}\n\nfunction ThemeLoader() {\n  useThemeSettings();\n  return null;\n}\n\nfunction Router() {\n  const { settings } = useSiteSettings();\n  const { isAuthenticated } = useAuth();\n  const [location] = useLocation();\n\n  const isAdminPath = location.startsWith('/admin');\n\n  if (settings?.maintenanceMode && !isAuthenticated && !isAdminPath) {\n    return <Maintenance />;\n  }\n\n  return (\n    <Switch>\n      {/* Public Routes */}\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/blog\" component={Blog} />\n      <Route path=\"/blog/:slug\" component={BlogPost} />\n      <Route path=\"/projects\" component={Projects} />\n      <Route path=\"/faqs\" component={FAQs} />\n\n      {/* Admin Login - not lazy loaded for fast access */}\n      <Route path=\"/admin/login\" component={AdminLogin} />\n      <Route path=\"/admin/forgot-password\" component={ForgotPassword} />\n      <Route path=\"/reset-password\" component={ResetPassword} />\n\n      {/* Admin Routes - wrapped in Suspense for lazy loading */}\n      <Route path=\"/admin\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminDashboard />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/posts\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminPosts />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/posts/categories\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminPostCategories />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/pages\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminPages />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/projects\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminProjects />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/projects/categories\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminProjectCategories />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/services\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminServices />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/interactions\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminInteractions />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/comments\">\n        {() => <Redirect to=\"/admin/interactions\" />}\n      </Route>\n      <Route path=\"/admin/faqs\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminFAQs />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/skills\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminSkills />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/newsletter\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminNewsletter />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/notifications\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminNotifications />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/profile\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminProfile />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/theme\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminTheme />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/system\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminSystem />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/media\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminMedia />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/files\">\n        {() => <Redirect to=\"/admin/media\" />}\n      </Route>\n      <Route path=\"/admin/export-import\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminExportImport />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/inbox\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminInbox />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/analytics\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminAnalytics />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/editor\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminEditor />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/security\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminSecurity />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/settings\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminSettings />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/tools\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminTools />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/testimonials\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminTestimonials />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/email-templates\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminEmailTemplates />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/cache\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminCache />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/languages\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminLanguageManager />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/image-optimizer\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminImageOptimizer />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/page-builder\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminPageBuilder />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/api-docs\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminAPIDocs />\n          </Suspense>\n        )}\n      </Route>\n      <Route path=\"/admin/scheduler\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminScheduler />\n          </Suspense>\n        )}\n      </Route>\n\n      {/* Admin Fallback */}\n      <Route path=\"/admin/:any*\">\n        {() => (\n          <Suspense fallback={<PageLoader />}>\n            <AdminDashboard />\n          </Suspense>\n        )}\n      </Route>\n\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider attribute=\"class\" defaultTheme=\"dark\" enableSystem>\n        <LanguageProvider>\n          <SiteProvider>\n            <MockProvider>\n              <TooltipProvider>\n                <Toaster />\n                <ThemeLoader />\n                <Router />\n              </TooltipProvider>\n            </MockProvider>\n          </SiteProvider>\n        </LanguageProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;","path":null,"size_bytes":12281,"size_tokens":null},"client/src/pages/admin/Cache.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Zap, Trash2, RefreshCw, Database, Image, FileText } from \"lucide-react\";\n\nexport default function AdminCache() {\n  const cacheItems = [\n    { name: \"Application Cache\", size: \"24.5 MB\", items: 1247, icon: Zap, color: \"text-purple-500\" },\n    { name: \"Database Queries\", size: \"12.8 MB\", items: 856, icon: Database, color: \"text-blue-500\" },\n    { name: \"Image Cache\", size: \"156 MB\", items: 342, icon: Image, color: \"text-green-500\" },\n    { name: \"Page Cache\", size: \"8.2 MB\", items: 124, icon: FileText, color: \"text-yellow-500\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Cache Manager</h1>\n            <p className=\"text-muted-foreground\">Manage and clear application cache</p>\n          </div>\n          <Button variant=\"destructive\" className=\"gap-2\">\n            <Trash2 className=\"w-4 h-4\" /> Clear All Cache\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {cacheItems.map((item, i) => (\n            <Card key={i}>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`p-3 rounded-lg bg-muted ${item.color}`}>\n                      <item.icon className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                      <CardTitle className=\"text-lg\">{item.name}</CardTitle>\n                      <CardDescription>{item.items} items</CardDescription>\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-2xl font-bold\">{item.size}</p>\n                    <p className=\"text-xs text-muted-foreground\">Total size</p>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\">\n                      <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n                    </Button>\n                    <Button variant=\"destructive\" size=\"sm\">\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Cache Statistics</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-primary\">94%</p>\n                <p className=\"text-xs text-muted-foreground\">Hit Rate</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-green-500\">201 MB</p>\n                <p className=\"text-xs text-muted-foreground\">Total Cache</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-yellow-500\">2,569</p>\n                <p className=\"text-xs text-muted-foreground\">Cached Items</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-blue-500\">2h ago</p>\n                <p className=\"text-xs text-muted-foreground\">Last Cleared</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4039,"size_tokens":null},"client/src/layouts/AdminLayout.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useMockData } from \"@/context/MockContext\";\nimport { useTheme } from \"next-themes\";\nimport { useWebSocket } from \"@/hooks/use-websocket\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport type { Comment, Review } from \"@shared/schema\";\nimport { \n  LayoutDashboard, \n  FileText, \n  Briefcase, \n  Mail, \n  Settings, \n  Image as ImageIcon, \n  BarChart, \n  Menu, \n  LogOut, \n  Bell,\n  Search,\n  Code,\n  Shield,\n  MessageSquare,\n  HelpCircle,\n  ShoppingBag,\n  Wrench,\n  Palette,\n  Database,\n  Key,\n  Clock,\n  Download,\n  Moon,\n  Sun,\n  Inbox,\n  Code2,\n  Check,\n  X,\n  ChevronDown,\n  Folder,\n  Star\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  DropdownMenu, \n  DropdownMenuContent, \n  DropdownMenuItem, \n  DropdownMenuLabel, \n  DropdownMenuSeparator, \n  DropdownMenuTrigger \n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { formatDistanceToNow } from \"date-fns\";\n\n// Define AdminLayoutProps type\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function AdminLayout({ children }: AdminLayoutProps) {\n  const [location, setLocation] = useLocation();\n  const [isChecking, setIsChecking] = useState(true);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  const [expandedMenus, setExpandedMenus] = useState<string[]>([]);\n  const { messages, markAsRead, logout } = useMockData();\n  const { theme, setTheme } = useTheme();\n\n  const { isConnected } = useWebSocket();\n\n  const { data: comments = [], refetch: refetchComments } = useQuery<Comment[]>({\n    queryKey: ['/api/comments'],\n    enabled: isAuthenticated,\n  });\n\n  const { data: reviews = [], refetch: refetchReviews } = useQuery<Review[]>({\n    queryKey: ['/api/reviews'],\n    enabled: isAuthenticated,\n  });\n\n  const { data: apiMessages = [], refetch: refetchMessages } = useQuery<any[]>({\n    queryKey: ['/api/messages'],\n    enabled: isAuthenticated,\n  });\n\n  const markMessageAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await fetch(`/api/messages/${id}/read`, {\n        method: 'PUT',\n        credentials: 'include'\n      });\n      if (!res.ok) throw new Error('Failed to mark as read');\n      return res.json();\n    },\n    onSuccess: () => refetchMessages(),\n  });\n\n  const markCommentAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await fetch(`/api/comments/${id}/read`, {\n        method: 'PUT',\n        credentials: 'include'\n      });\n      if (!res.ok) throw new Error('Failed to mark as read');\n      return res.json();\n    },\n    onSuccess: () => refetchComments(),\n  });\n\n  const markReviewAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await fetch(`/api/reviews/${id}/read`, {\n        method: 'PUT',\n        credentials: 'include'\n      });\n      if (!res.ok) throw new Error('Failed to mark as read');\n      return res.json();\n    },\n    onSuccess: () => refetchReviews(),\n  });\n\n  // Auto-refetch all items when WebSocket connects to get real-time updates\n  useEffect(() => {\n    if (isConnected && isAuthenticated) {\n      refetchMessages();\n      refetchComments();\n      refetchReviews();\n    }\n  }, [isConnected, isAuthenticated, refetchMessages, refetchComments, refetchReviews]);\n\n  const unreadMessages = (apiMessages || []).filter(m => !m.read).length;\n  const unreadComments = comments.filter(c => !c.read).length;\n  const unreadReviews = reviews.filter(r => !r.read).length;\n  const unreadCount = unreadMessages + unreadComments + unreadReviews;\n\n  type NotificationItem = {\n    id: string;\n    type: 'message' | 'comment' | 'review';\n    sender: string;\n    content: string;\n    label: string;\n    read: boolean;\n    createdAt: Date | null;\n    originalId: number;\n    extra?: string;\n  };\n\n  const allNotifications: NotificationItem[] = [\n    ...(apiMessages || []).map(m => ({\n      id: `msg-${m.id}`,\n      type: 'message' as const,\n      sender: m.sender || 'Unknown',\n      content: m.message || 'No content',\n      label: 'Message',\n      read: m.read,\n      createdAt: m.createdAt ? new Date(m.createdAt) : null,\n      originalId: m.id,\n    })),\n    ...comments.map(c => ({\n      id: `comment-${c.id}`,\n      type: 'comment' as const,\n      sender: c.authorName,\n      content: c.content,\n      label: 'New comment',\n      read: c.read,\n      createdAt: c.createdAt ? new Date(c.createdAt) : null,\n      originalId: c.id,\n    })),\n    ...reviews.map(r => ({\n      id: `review-${r.id}`,\n      type: 'review' as const,\n      sender: r.authorName,\n      content: r.content,\n      label: `${r.rating}-star review`,\n      read: r.read,\n      createdAt: r.createdAt ? new Date(r.createdAt) : null,\n      originalId: r.id,\n    })),\n  ].sort((a, b) => {\n    const dateA = a.createdAt ? a.createdAt.getTime() : 0;\n    const dateB = b.createdAt ? b.createdAt.getTime() : 0;\n    return dateB - dateA;\n  });\n\n  const unreadNotifications = allNotifications.filter(n => !n.read);\n\n  const { data: currentUser } = useQuery({\n    queryKey: [\"currentUser\"],\n    queryFn: api.getCurrentUser,\n    staleTime: Infinity,\n    enabled: isAuthenticated, // Only fetch when authenticated\n  });\n\n  // Check authentication on mount\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        const res = await fetch(\"/api/auth/me\", {\n          credentials: \"include\"\n        });\n\n        if (res.ok) {\n          setIsAuthenticated(true);\n        } else {\n          // Redirect to login on any auth failure\n          setLocation(\"/admin/login\");\n          return;\n        }\n      } catch (error) {\n        // On network errors, redirect to login\n        console.error(\"Auth check network error:\", error);\n        setLocation(\"/admin/login\");\n        return;\n      } finally {\n        setIsChecking(false);\n      }\n    };\n\n    checkAuth();\n  }, [setLocation]);\n\n  const handleLogout = async () => {\n    try {\n      await fetch(\"/api/auth/logout\", {\n        method: \"POST\",\n        credentials: \"include\"\n      });\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n    }\n    logout();\n    setLocation(\"/admin/login\");\n  };\n\n  if (isChecking || !isAuthenticated) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-background\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">{isChecking ? 'Loading...' : 'Redirecting to login...'}</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error fallback\n  if (!children) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-background\">\n        <div className=\"text-center\">\n          <p className=\"text-muted-foreground\">Loading content...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const toggleMenu = (id: string) => {\n    setExpandedMenus(prev => \n      prev.includes(id) ? prev.filter(m => m !== id) : [...prev, id]\n    );\n  };\n\n  const navItems: any[] = [\n    // Main\n    { section: \"main\", label: \"Main\" },\n    { id: \"dashboard\", icon: LayoutDashboard, label: \"Dashboard\", href: \"/admin\" },\n\n    // Content Management\n    { section: \"content\", label: \"Content\" },\n    { icon: FileText, label: \"Pages\", href: \"/admin/pages\", badge: \"NEW\" },\n    { \n      id: \"posts\",\n      icon: FileText, \n      label: \"Blog Posts\", \n      children: [\n        { icon: FileText, label: \"Posts\", href: \"/admin/posts\" },\n        { icon: Folder, label: \"Categories\", href: \"/admin/posts/categories\" },\n      ]\n    },\n    { \n      id: \"projects\",\n      icon: Briefcase, \n      label: \"Projects\", \n      children: [\n        { icon: Briefcase, label: \"Projects\", href: \"/admin/projects\" },\n        { icon: Folder, label: \"Categories\", href: \"/admin/projects/categories\" },\n      ]\n    },\n\n    // Site Elements\n    { section: \"elements\", label: \"Site Elements\" },\n    { icon: ShoppingBag, label: \"Services\", href: \"/admin/services\" },\n    { icon: Code, label: \"Skills\", href: \"/admin/skills\" },\n    { icon: Star, label: \"Testimonials\", href: \"/admin/testimonials\" },\n\n    // Community & Engagement\n    { section: \"engagement\", label: \"Engagement\" },\n    { icon: MessageSquare, label: \"Comments\", href: \"/admin/comments\" },\n    { icon: Mail, label: \"Newsletter\", href: \"/admin/newsletter\" },\n    { icon: Inbox, label: \"Messages\", href: \"/admin/inbox\" },\n    { icon: BarChart, label: \"Analytics\", href: \"/admin/analytics\" },\n\n    // Media & Assets\n    { section: \"media\", label: \"Media & Assets\" },\n    { icon: ImageIcon, label: \"Media Library\", href: \"/admin/media\" },\n\n    // System & Tools\n    { section: \"system\", label: \"System & Tools\" },\n    { icon: Database, label: \"System Info\", href: \"/admin/system\" },\n    { icon: Download, label: \"Export/Import\", href: \"/admin/export-import\" },\n    { icon: Code2, label: \"Code Editor\", href: \"/admin/editor\" },\n\n    // Appearance & Settings\n    { section: \"settings\", label: \"Appearance & Settings\" },\n    { icon: Palette, label: \"Theme\", href: \"/admin/theme\" },\n    { icon: Shield, label: \"Security\", href: \"/admin/security\" },\n    { icon: Settings, label: \"Settings\", href: \"/admin/settings\" },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background flex\">\n      {/* Sidebar */}\n      <aside \n        className={`fixed inset-y-0 left-0 z-50 bg-card border-r border-border transition-all duration-300 ${\n          sidebarOpen ? \"w-64\" : \"w-20\"\n        } lg:relative hidden md:flex flex-col`}\n      >\n        <div className=\"h-16 flex items-center justify-center border-b border-border\">\n          <Link href=\"/\" className=\"flex items-center gap-2 font-heading font-bold text-xl text-primary cursor-pointer\">\n            {sidebarOpen ? \"LoiAdmin\" : \"LA\"}\n          </Link>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto py-4\">\n          <nav className=\"px-2 space-y-6\">\n            {navItems.map((item, idx) => {\n              if (item.section) {\n                return (\n                  <div key={`section-${item.section}`}>\n                    {idx > 0 && <div className=\"border-t border-border my-2\" />}\n                    {sidebarOpen && (\n                      <p className=\"px-3 py-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider\">\n                        {item.label}\n                      </p>\n                    )}\n                  </div>\n                );\n              }\n\n              return (\n                <div key={item.id || item.href}>\n                  {item.children ? (\n                    <div>\n                      <button\n                        onClick={() => toggleMenu(item.id)}\n                        className={`w-full flex items-center gap-3 px-3 py-2 rounded-md transition-colors ${\n                          expandedMenus.includes(item.id)\n                            ? \"bg-primary/10 text-primary\"\n                            : \"text-muted-foreground hover:bg-muted hover:text-foreground\"\n                        }`}\n                        data-testid={`button-menu-${item.id}`}\n                      >\n                        <item.icon size={20} />\n                        {sidebarOpen && (\n                          <>\n                            <span className=\"flex-1\">{item.label}</span>\n                            <ChevronDown \n                              size={16} \n                              className={`transition-transform ${expandedMenus.includes(item.id) ? \"rotate-180\" : \"\"}`}\n                            />\n                          </>\n                        )}\n                      </button>\n                      {expandedMenus.includes(item.id) && sidebarOpen && (\n                        <div className=\"ml-2 mt-1 space-y-1\">\n                          {item.children.map((child: any) => (\n                            <Link key={child.href} href={child.href}>\n                              <div\n                                className={`flex items-center gap-3 px-3 py-2 rounded-md transition-colors cursor-pointer text-sm ${\n                                  location === child.href\n                                    ? \"bg-primary/10 text-primary\"\n                                    : \"text-muted-foreground hover:bg-muted hover:text-foreground\"\n                                }`}\n                                data-testid={`menu-item-${child.href}`}\n                              >\n                                <child.icon size={16} />\n                                <span>{child.label}</span>\n                              </div>\n                            </Link>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <Link href={item.href}>\n                      <div \n                        className={`flex items-center gap-3 px-3 py-2 rounded-md transition-colors cursor-pointer ${\n                          location === item.href \n                            ? \"bg-primary/10 text-primary\" \n                            : \"text-muted-foreground hover:bg-muted hover:text-foreground\"\n                        }`}\n                        data-testid={`menu-item-${item.href}`}\n                      >\n                        <item.icon size={20} />\n                        {sidebarOpen && (\n                          <div className=\"flex-1 flex items-center justify-between\">\n                            <span>{item.label}</span>\n                            {item.badge && (\n                              <span className=\"ml-2 px-2 py-0.5 bg-blue-500/20 text-blue-400 text-xs font-semibold rounded-full\">\n                                {item.badge}\n                              </span>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    </Link>\n                  )}\n                </div>\n              );\n            })}\n          </nav>\n        </div>\n\n        <div className=\"p-4 border-t border-border\">\n          <Button variant=\"ghost\" className=\"w-full justify-start text-red-500 hover:text-red-600 hover:bg-red-500/10\" onClick={handleLogout}>\n            <LogOut size={20} className=\"mr-2\" />\n            {sidebarOpen && \"Logout\"}\n          </Button>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* Header */}\n        <header className=\"h-16 bg-card border-b border-border flex items-center justify-between px-4 lg:px-8\">\n          <div className=\"flex items-center gap-4\">\n            <Button variant=\"ghost\" size=\"icon\" onClick={() => setSidebarOpen(!sidebarOpen)} className=\"hidden md:flex\">\n              <Menu size={20} />\n            </Button>\n            <div className=\"relative hidden sm:block w-64\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input \n                type=\"search\" \n                placeholder=\"Search...\" \n                className=\"pl-9 bg-background/50 border-border focus:border-primary\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <Button variant=\"ghost\" size=\"icon\" onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}>\n              {theme === \"dark\" ? <Sun size={20} /> : <Moon size={20} />}\n            </Button>\n\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button \n                  variant=\"ghost\" \n                  size=\"icon\" \n                  className=\"relative\"\n                >\n                  <Bell size={20} />\n                  {unreadCount > 0 && (\n                    <span className=\"absolute -top-1 -right-1 min-w-5 h-5 px-1 bg-red-500 rounded-full text-xs text-white flex items-center justify-center font-medium animate-pulse\">\n                      {unreadCount > 99 ? \"99+\" : unreadCount}\n                    </span>\n                  )}\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent className=\"w-80\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal flex items-center justify-between\">\n                  <span className=\"font-semibold\">Notifications</span>\n                  {unreadCount > 0 && (\n                    <span className=\"text-xs text-muted-foreground\">{unreadCount} unread</span>\n                  )}\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <ScrollArea className=\"h-[300px]\">\n                  {unreadNotifications.length === 0 ? (\n                    <div className=\"p-4 text-center text-muted-foreground\">\n                      <Bell className=\"mx-auto h-8 w-8 mb-2 opacity-50\" />\n                      <p className=\"text-sm\">No new notifications</p>\n                    </div>\n                  ) : (\n                    <>\n                      {unreadNotifications.slice(0, 10).map((notif) => (\n                        <DropdownMenuItem \n                          key={notif.id} \n                          className={`flex flex-col items-start p-3 cursor-pointer ${!notif.read ? 'bg-primary/5' : ''}`}\n                          onClick={() => {\n                            if (notif.type === 'message') {\n                              markMessageAsReadMutation.mutate(notif.originalId);\n                              setLocation(\"/admin/inbox\");\n                            } else if (notif.type === 'comment') {\n                              markCommentAsReadMutation.mutate(notif.originalId);\n                              setLocation(\"/admin/comments\");\n                            } else {\n                              markReviewAsReadMutation.mutate(notif.originalId);\n                              setLocation(\"/admin/comments\");\n                            }\n                          }}\n                        >\n                          <div className=\"flex items-start gap-3 w-full\">\n                            <div className={`mt-1 h-2 w-2 rounded-full flex-shrink-0 ${!notif.read ? 'bg-primary' : 'bg-transparent'}`} />\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"flex items-center justify-between gap-2\">\n                                <p className=\"font-medium text-sm truncate\">{notif.sender}</p>\n                                {notif.createdAt && (\n                                  <span className=\"text-xs text-muted-foreground flex-shrink-0\">\n                                    {formatDistanceToNow(notif.createdAt, { addSuffix: true })}\n                                  </span>\n                                )}\n                              </div>\n                              <p className=\"text-xs text-muted-foreground truncate mt-0.5\">\n                                {notif.label}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground/70 truncate mt-0.5\">\n                                {notif.content.length > 50 ? `${notif.content.substring(0, 50)}...` : notif.content}\n                              </p>\n                            </div>\n                          </div>\n                        </DropdownMenuItem>\n                      ))}\n                    </>\n                  )}\n                </ScrollArea>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem \n                  className=\"text-center justify-center text-primary cursor-pointer\"\n                  onClick={() => setLocation(\"/admin/notifications\")}\n                >\n                  View all notifications\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"relative h-8 w-8 rounded-full\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={currentUser?.avatar ? String(currentUser.avatar) : \"/avatars/01.png\"} alt={currentUser?.name ? String(currentUser.name) : \"User\"} />\n                    <AvatarFallback>{currentUser?.name ? String(currentUser.name).charAt(0).toUpperCase() : \"L\"}</AvatarFallback>\n                  </Avatar>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal\">\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium leading-none\">{currentUser?.name || \"Loi Developer\"}</p>\n                    <p className=\"text-xs leading-none text-muted-foreground\">\n                      {currentUser?.email || \"admin@loideveloper.com\"}\n                    </p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={() => setLocation(\"/admin/profile\")}>Profile</DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem className=\"text-red-500\" onClick={handleLogout}>Log out</DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n        </header>\n\n        {/* Page Content */}\n        <main className=\"flex-1 overflow-y-auto p-4 lg:p-8\">\n          {children}\n        </main>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":21861,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"server/seed.ts":{"content":"\nimport { db } from \"./db\";\nimport { \n  users, projects, posts, skills, services, testimonials, \n  siteSettings, comments, reviews, categories, messages, \n  activityLogs, notifications, media, faqs, pages, subscribers,\n  emailTemplates, emailCampaigns, homepageSections, securitySettings,\n  scheduledTasks, webhooks, translations, contentTemplates, mediaFolders\n} from \"@shared/schema\";\nimport bcrypt from \"bcrypt\";\nimport crypto from \"crypto\";\n\nconst SALT_ROUNDS = 12;\n\nasync function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nasync function seed() {\n  console.log(\"Seeding database...\");\n\n  try {\n    // Delete all existing data\n    console.log(\"Deleting existing data...\");\n    await db.delete(activityLogs);\n    await db.delete(notifications);\n    await db.delete(comments);\n    await db.delete(reviews);\n    await db.delete(messages);\n    await db.delete(media);\n    await db.delete(mediaFolders);\n    await db.delete(posts);\n    await db.delete(projects);\n    await db.delete(testimonials);\n    await db.delete(services);\n    await db.delete(skills);\n    await db.delete(categories);\n    await db.delete(siteSettings);\n    await db.delete(securitySettings);\n    await db.delete(faqs);\n    await db.delete(pages);\n    await db.delete(subscribers);\n    await db.delete(emailCampaigns);\n    await db.delete(emailTemplates);\n    await db.delete(homepageSections);\n    await db.delete(scheduledTasks);\n    await db.delete(webhooks);\n    await db.delete(translations);\n    await db.delete(contentTemplates);\n    await db.delete(users);\n    console.log(\"All existing data deleted successfully!\");\n\n    // ==================== USERS ====================\n    await db.insert(users).values([\n      {\n        username: \"admin\",\n        password: await hashPassword(\"admin123\"),\n        name: \"Loi Developer\",\n        email: \"admin@loideveloper.com\",\n        role: \"Super Admin\",\n        status: \"Active\",\n        avatar: \"https://github.com/shadcn.png\"\n      },\n      {\n        username: \"editor\",\n        password: await hashPassword(\"editor123\"),\n        name: \"Sarah Editor\",\n        email: \"sarah@loideveloper.com\",\n        role: \"Editor\",\n        status: \"Active\",\n        avatar: null\n      },\n      {\n        username: \"moderator\",\n        password: await hashPassword(\"mod123\"),\n        name: \"John Moderator\",\n        email: \"john@loideveloper.com\",\n        role: \"Moderator\",\n        status: \"Active\",\n        avatar: null\n      },\n      {\n        username: \"subscriber\",\n        password: await hashPassword(\"sub123\"),\n        name: \"Alice User\",\n        email: \"alice@example.com\",\n        role: \"Subscriber\",\n        status: \"Active\",\n        avatar: null\n      }\n    ]);\n    console.log(\"Users seeded\");\n\n    // ==================== CATEGORIES ====================\n    await db.insert(categories).values([\n      // Project Categories\n      { name: \"Full-stack\", slug: \"full-stack\", type: \"project\", description: \"Full-stack web applications combining frontend and backend\" },\n      { name: \"Frontend\", slug: \"frontend\", type: \"project\", description: \"Client-side web applications and interfaces\" },\n      { name: \"Backend\", slug: \"backend\", type: \"project\", description: \"Server-side applications and APIs\" },\n      { name: \"Mobile\", slug: \"mobile\", type: \"project\", description: \"iOS and Android mobile applications\" },\n      { name: \"Design\", slug: \"design\", type: \"project\", description: \"UI/UX design and prototyping projects\" },\n      { name: \"DevOps\", slug: \"devops\", type: \"project\", description: \"Infrastructure and deployment projects\" },\n      { name: \"AI/ML\", slug: \"ai-ml\", type: \"project\", description: \"Artificial Intelligence and Machine Learning projects\" },\n      \n      // Post Categories\n      { name: \"Web Development\", slug: \"web-development\", type: \"post\", description: \"Web development tutorials and articles\" },\n      { name: \"Mobile Development\", slug: \"mobile-development\", type: \"post\", description: \"Mobile app development guides\" },\n      { name: \"Backend Development\", slug: \"backend-development\", type: \"post\", description: \"Backend and API development\" },\n      { name: \"Frontend Development\", slug: \"frontend-development\", type: \"post\", description: \"Frontend technologies and frameworks\" },\n      { name: \"DevOps & Cloud\", slug: \"devops-cloud\", type: \"post\", description: \"DevOps practices and cloud computing\" },\n      { name: \"UI/UX Design\", slug: \"ui-ux-design\", type: \"post\", description: \"Design principles and best practices\" },\n      { name: \"Career & Productivity\", slug: \"career-productivity\", type: \"post\", description: \"Career advice and productivity tips\" },\n      { name: \"Tools & Resources\", slug: \"tools-resources\", type: \"post\", description: \"Development tools and resources\" }\n    ]);\n    console.log(\"Categories seeded\");\n\n    // ==================== PROJECTS ====================\n    await db.insert(projects).values([\n      {\n        title: \"E-commerce Analytics Dashboard\",\n        category: \"full-stack\",\n        image: \"/uploads/images/project_screenshot_dashboard.png\",\n        description: \"A comprehensive data analytics platform for e-commerce businesses with real-time visualization, sales tracking, inventory management, and customer insights. Built with modern tech stack for scalability and performance.\",\n        tech: [\"React\", \"TypeScript\", \"D3.js\", \"Node.js\", \"PostgreSQL\", \"Redis\", \"Docker\"],\n        link: \"https://demo.analytics.com\",\n        github: \"https://github.com/loi/analytics-dashboard\",\n        status: \"Published\",\n        featured: true\n      },\n      {\n        title: \"Modern E-commerce Platform\",\n        category: \"frontend\",\n        image: \"/uploads/images/project_screenshot_ecommerce.png\",\n        description: \"A cutting-edge shopping experience with headless CMS architecture, featuring advanced product filtering, wishlist, cart management, and seamless checkout process with multiple payment gateways.\",\n        tech: [\"Next.js\", \"TypeScript\", \"Tailwind CSS\", \"Stripe\", \"Sanity CMS\", \"Vercel\"],\n        link: \"https://demo.shop.com\",\n        github: \"https://github.com/loi/ecommerce-platform\",\n        status: \"Published\",\n        featured: true\n      },\n      {\n        title: \"Social Connect Mobile App\",\n        category: \"mobile\",\n        image: \"/uploads/images/project_screenshot_mobile_app.png\",\n        description: \"Cross-platform social networking application for community engagement with real-time messaging, media sharing, story features, and advanced privacy controls.\",\n        tech: [\"React Native\", \"TypeScript\", \"Firebase\", \"Redux Toolkit\", \"Socket.io\"],\n        link: \"https://apps.apple.com/socialconnect\",\n        github: \"https://github.com/loi/social-connect\",\n        status: \"Published\",\n        featured: true\n      },\n      {\n        title: \"Task Management API\",\n        category: \"backend\",\n        image: \"/uploads/images/project_screenshot_dashboard.png\",\n        description: \"RESTful API for task and project management with authentication, role-based access control, real-time updates, and comprehensive documentation.\",\n        tech: [\"Node.js\", \"Express\", \"MongoDB\", \"JWT\", \"Swagger\", \"Jest\"],\n        link: \"https://api.taskmanager.com\",\n        github: \"https://github.com/loi/task-api\",\n        status: \"Published\",\n        featured: false\n      },\n      {\n        title: \"Portfolio Design System\",\n        category: \"design\",\n        image: \"/uploads/images/project_screenshot_ecommerce.png\",\n        description: \"Comprehensive design system with reusable components, design tokens, and guidelines for building consistent user interfaces across products.\",\n        tech: [\"Figma\", \"Storybook\", \"React\", \"Tailwind CSS\", \"Design Tokens\"],\n        link: \"https://design.portfolio.com\",\n        github: \"https://github.com/loi/design-system\",\n        status: \"Published\",\n        featured: false\n      },\n      {\n        title: \"AI Content Generator\",\n        category: \"ai-ml\",\n        image: \"/uploads/images/project_screenshot_mobile_app.png\",\n        description: \"AI-powered content generation tool using GPT models for creating blog posts, social media content, and marketing copy with customizable templates.\",\n        tech: [\"Python\", \"FastAPI\", \"OpenAI API\", \"React\", \"PostgreSQL\", \"Celery\"],\n        link: \"https://contentai.com\",\n        github: \"https://github.com/loi/ai-content-gen\",\n        status: \"Published\",\n        featured: true\n      },\n      {\n        title: \"DevOps Automation Suite\",\n        category: \"devops\",\n        image: \"/uploads/images/project_screenshot_dashboard.png\",\n        description: \"Automated CI/CD pipeline with infrastructure as code, monitoring, logging, and deployment automation for containerized applications.\",\n        tech: [\"Docker\", \"Kubernetes\", \"Jenkins\", \"Terraform\", \"AWS\", \"Prometheus\"],\n        link: \"https://devops.automation.com\",\n        github: \"https://github.com/loi/devops-suite\",\n        status: \"Published\",\n        featured: false\n      },\n      {\n        title: \"Real-time Chat Application\",\n        category: \"full-stack\",\n        image: \"/uploads/images/project_screenshot_ecommerce.png\",\n        description: \"Scalable real-time chat application with group chats, file sharing, voice/video calls, and end-to-end encryption.\",\n        tech: [\"React\", \"Socket.io\", \"Node.js\", \"MongoDB\", \"WebRTC\", \"Redis\"],\n        link: \"https://chat.demo.com\",\n        github: \"https://github.com/loi/realtime-chat\",\n        status: \"Published\",\n        featured: false\n      }\n    ]);\n    console.log(\"Projects seeded\");\n\n    // ==================== POSTS ====================\n    await db.insert(posts).values([\n      {\n        title: \"Getting Started with React 19: New Features and Best Practices\",\n        slug: \"getting-started-react-19\",\n        content: `# React 19: A Complete Guide\n\nReact 19 introduces revolutionary features that change how we build web applications. In this comprehensive guide, we'll explore all the new capabilities and how to leverage them effectively.\n\n## Key Features\n\n### 1. Server Components\nServer Components allow you to render components on the server, reducing client-side JavaScript and improving performance.\n\n### 2. Improved Hydration\nThe new hydration system is more efficient and handles errors gracefully.\n\n### 3. Enhanced Suspense\nBetter integration with data fetching and code splitting.\n\n## Getting Started\n\n\\`\\`\\`jsx\nimport { Suspense } from 'react';\n\nfunction App() {\n  return (\n    <Suspense fallback={<Loading />}>\n      <UserProfile />\n    </Suspense>\n  );\n}\n\\`\\`\\`\n\n## Best Practices\n\n1. Use Server Components for static content\n2. Implement proper error boundaries\n3. Optimize bundle size with code splitting\n4. Leverage concurrent features\n\n## Conclusion\n\nReact 19 represents a major step forward in web development. Start exploring these features today!`,\n        excerpt: \"Explore the latest features in React 19 and learn how to build better web applications with improved performance and developer experience.\",\n        category: \"Frontend Development\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"React\", \"JavaScript\", \"Frontend\", \"Web Development\"],\n        featuredImage: \"/uploads/images/tech_article_background_design.png\",\n        publishedAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"The Future of AI in Web Design: Trends and Predictions\",\n        slug: \"future-ai-web-design\",\n        content: `# AI in Web Design: The Next Frontier\n\nArtificial Intelligence is revolutionizing how we approach web design. Let's explore current trends and future predictions.\n\n## Current AI Applications\n\n1. **Automated Layout Generation** - AI tools can now create responsive layouts\n2. **Color Scheme Suggestions** - Smart color palettes based on brand identity\n3. **Content Optimization** - AI-powered content recommendations\n4. **Accessibility Improvements** - Automated accessibility testing and fixes\n\n## Emerging Trends\n\n- Personalized user experiences\n- Voice-driven interfaces\n- Predictive UX\n- Automated A/B testing\n\n## Tools to Watch\n\n- Figma AI plugins\n- Adobe Sensei\n- Framer AI\n- ChatGPT for copywriting\n\n## Conclusion\n\nAI is augmenting, not replacing, designers. Embrace these tools to enhance your workflow.`,\n        excerpt: \"Discover how Artificial Intelligence is transforming web design and what the future holds for designers and developers.\",\n        category: \"UI/UX Design\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"AI\", \"Design\", \"Trends\", \"UX\"],\n        featuredImage: \"/uploads/images/abstract_digital_particle_background.png\",\n        publishedAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"Optimizing Next.js Performance: Advanced Techniques\",\n        slug: \"optimizing-nextjs-performance\",\n        content: `# Next.js Performance Optimization\n\nPerformance is crucial for user experience and SEO. Here are advanced techniques for optimizing your Next.js applications.\n\n## Image Optimization\n\n\\`\\`\\`jsx\nimport Image from 'next/image';\n\n<Image\n  src=\"/hero.jpg\"\n  alt=\"Hero\"\n  width={1200}\n  height={600}\n  priority\n  placeholder=\"blur\"\n/>\n\\`\\`\\`\n\n## Code Splitting\n\nUse dynamic imports for better bundle management:\n\n\\`\\`\\`jsx\nimport dynamic from 'next/dynamic';\n\nconst DynamicComponent = dynamic(() => import('./HeavyComponent'), {\n  loading: () => <p>Loading...</p>,\n});\n\\`\\`\\`\n\n## Caching Strategies\n\nImplement ISR and SSG for optimal performance.\n\n## Monitoring\n\nUse Vercel Analytics and Lighthouse for performance tracking.`,\n        excerpt: \"Learn advanced techniques for optimizing Next.js applications including image optimization, code splitting, and caching strategies.\",\n        category: \"Web Development\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"Next.js\", \"Performance\", \"Optimization\", \"React\"],\n        featuredImage: \"/uploads/images/dev_blog_post_background.png\",\n        publishedAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"Building Scalable APIs with Node.js and PostgreSQL\",\n        slug: \"building-scalable-apis-nodejs\",\n        content: `# Scalable API Development Guide\n\nLearn how to build production-ready APIs that can handle millions of requests.\n\n## Architecture\n\n- Layered architecture (Routes â†’ Controllers â†’ Services â†’ Repository)\n- Dependency injection\n- Error handling middleware\n- Request validation\n\n## Database Optimization\n\n- Connection pooling\n- Query optimization\n- Indexing strategies\n- Caching with Redis\n\n## Security\n\n- JWT authentication\n- Rate limiting\n- Input validation\n- SQL injection prevention\n\n## Deployment\n\n- Docker containerization\n- CI/CD pipelines\n- Load balancing\n- Monitoring and logging`,\n        excerpt: \"A comprehensive guide to building production-ready, scalable APIs using Node.js and PostgreSQL with best practices.\",\n        category: \"Backend Development\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"Node.js\", \"PostgreSQL\", \"API\", \"Backend\"],\n        featuredImage: \"/uploads/images/abstract_blog_article_background.png\",\n        publishedAt: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"TypeScript Best Practices for Large-Scale Applications\",\n        slug: \"typescript-best-practices\",\n        content: `# TypeScript Best Practices\n\nMaster TypeScript for building maintainable large-scale applications.\n\n## Type Safety\n\nUse strict mode and avoid 'any' type.\n\n## Utility Types\n\nLeverage built-in utility types like Partial, Pick, Omit, etc.\n\n## Generic Types\n\nCreate reusable, type-safe components.\n\n## Module Organization\n\nStructure your codebase for scalability.`,\n        excerpt: \"Essential TypeScript best practices for building maintainable and scalable applications with proper type safety.\",\n        category: \"Web Development\",\n        author: \"Sarah Editor\",\n        status: \"Draft\",\n        tags: [\"TypeScript\", \"JavaScript\", \"Best Practices\"],\n        featuredImage: null,\n        publishedAt: null\n      },\n      {\n        title: \"Mastering Tailwind CSS: Tips and Tricks\",\n        slug: \"mastering-tailwind-css\",\n        content: `# Tailwind CSS Advanced Guide\n\nTake your Tailwind skills to the next level.\n\n## Custom Configuration\n\nExtend Tailwind with custom colors, spacing, and utilities.\n\n## Component Patterns\n\nBuild reusable component patterns.\n\n## Performance\n\nOptimize bundle size with PurgeCSS.\n\n## Dark Mode\n\nImplement elegant dark mode switching.`,\n        excerpt: \"Advanced tips and tricks for mastering Tailwind CSS including custom configurations and performance optimization.\",\n        category: \"Frontend Development\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"Tailwind CSS\", \"CSS\", \"Frontend\", \"Design\"],\n        featuredImage: \"/uploads/images/tech_article_background_design.png\",\n        publishedAt: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"DevOps Fundamentals: CI/CD Pipeline Setup\",\n        slug: \"devops-cicd-pipeline\",\n        content: `# CI/CD Pipeline Setup Guide\n\nLearn to automate your deployment process.\n\n## Continuous Integration\n\n- Automated testing\n- Code quality checks\n- Build automation\n\n## Continuous Deployment\n\n- Staging environments\n- Blue-green deployments\n- Rollback strategies\n\n## Tools\n\n- GitHub Actions\n- Jenkins\n- CircleCI\n- GitLab CI`,\n        excerpt: \"Complete guide to setting up CI/CD pipelines for automated testing and deployment with modern DevOps tools.\",\n        category: \"DevOps & Cloud\",\n        author: \"Loi Developer\",\n        status: \"Published\",\n        tags: [\"DevOps\", \"CI/CD\", \"Automation\", \"Docker\"],\n        featuredImage: \"/uploads/images/abstract_digital_particle_background.png\",\n        publishedAt: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"Career Growth for Developers: A Practical Guide\",\n        slug: \"developer-career-growth\",\n        content: `# Developer Career Growth\n\nStrategies for advancing your development career.\n\n## Skill Development\n\n- Learn new technologies\n- Build side projects\n- Contribute to open source\n\n## Networking\n\n- Attend conferences\n- Join communities\n- Build your brand\n\n## Interview Preparation\n\n- System design\n- Algorithm practice\n- Portfolio building`,\n        excerpt: \"Practical strategies for advancing your career as a developer including skill development and networking tips.\",\n        category: \"Career & Productivity\",\n        author: \"Sarah Editor\",\n        status: \"Published\",\n        tags: [\"Career\", \"Professional Development\", \"Tips\"],\n        featuredImage: null,\n        publishedAt: new Date(Date.now() - 25 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Posts seeded\");\n\n    // ==================== SKILLS ====================\n    await db.insert(skills).values([\n      // Frontend\n      { name: \"React\", category: \"Frontend\", level: 95, icon: \"react\", order: 1 },\n      { name: \"Next.js\", category: \"Frontend\", level: 92, icon: \"nextjs\", order: 2 },\n      { name: \"Vue.js\", category: \"Frontend\", level: 85, icon: \"vue\", order: 3 },\n      { name: \"Tailwind CSS\", category: \"Frontend\", level: 93, icon: \"tailwind\", order: 4 },\n      { name: \"Sass/SCSS\", category: \"Frontend\", level: 88, icon: \"sass\", order: 5 },\n      \n      // Languages\n      { name: \"TypeScript\", category: \"Languages\", level: 94, icon: \"typescript\", order: 6 },\n      { name: \"JavaScript\", category: \"Languages\", level: 96, icon: \"javascript\", order: 7 },\n      { name: \"Python\", category: \"Languages\", level: 82, icon: \"python\", order: 8 },\n      { name: \"Go\", category: \"Languages\", level: 75, icon: \"go\", order: 9 },\n      \n      // Backend\n      { name: \"Node.js\", category: \"Backend\", level: 90, icon: \"nodejs\", order: 10 },\n      { name: \"Express.js\", category: \"Backend\", level: 89, icon: \"express\", order: 11 },\n      { name: \"NestJS\", category: \"Backend\", level: 80, icon: \"nestjs\", order: 12 },\n      { name: \"GraphQL\", category: \"Backend\", level: 78, icon: \"graphql\", order: 13 },\n      \n      // Database\n      { name: \"PostgreSQL\", category: \"Database\", level: 87, icon: \"postgresql\", order: 14 },\n      { name: \"MongoDB\", category: \"Database\", level: 85, icon: \"mongodb\", order: 15 },\n      { name: \"Redis\", category: \"Database\", level: 80, icon: \"redis\", order: 16 },\n      { name: \"MySQL\", category: \"Database\", level: 82, icon: \"mysql\", order: 17 },\n      \n      // DevOps\n      { name: \"Docker\", category: \"DevOps\", level: 84, icon: \"docker\", order: 18 },\n      { name: \"Kubernetes\", category: \"DevOps\", level: 70, icon: \"kubernetes\", order: 19 },\n      { name: \"CI/CD\", category: \"DevOps\", level: 81, icon: \"cicd\", order: 20 },\n      { name: \"GitHub Actions\", category: \"DevOps\", level: 85, icon: \"github\", order: 21 },\n      \n      // Cloud\n      { name: \"AWS\", category: \"Cloud\", level: 78, icon: \"aws\", order: 22 },\n      { name: \"Vercel\", category: \"Cloud\", level: 90, icon: \"vercel\", order: 23 },\n      { name: \"Firebase\", category: \"Cloud\", level: 83, icon: \"firebase\", order: 24 },\n      \n      // Tools\n      { name: \"Git\", category: \"Tools\", level: 92, icon: \"git\", order: 25 },\n      { name: \"VS Code\", category: \"Tools\", level: 95, icon: \"vscode\", order: 26 },\n      { name: \"Figma\", category: \"Tools\", level: 80, icon: \"figma\", order: 27 }\n    ]);\n    console.log(\"Skills seeded\");\n\n    // ==================== SERVICES ====================\n    await db.insert(services).values([\n      {\n        title: \"Full-Stack Web Development\",\n        description: \"End-to-end web application development with modern technologies, from database design to deployment and maintenance.\",\n        icon: \"code\",\n        features: [\n          \"React/Next.js Frontend Development\",\n          \"Node.js/Express Backend APIs\",\n          \"Database Design & Optimization\",\n          \"RESTful & GraphQL APIs\",\n          \"Authentication & Authorization\",\n          \"Third-party Integrations\"\n        ],\n        price: \"From $3,000\",\n        order: 1,\n        active: true\n      },\n      {\n        title: \"Mobile App Development\",\n        description: \"Native and cross-platform mobile applications for iOS and Android with seamless user experience.\",\n        icon: \"smartphone\",\n        features: [\n          \"React Native Development\",\n          \"iOS & Android Native Apps\",\n          \"App Store & Play Store Publishing\",\n          \"Push Notifications\",\n          \"Offline Functionality\",\n          \"App Maintenance & Updates\"\n        ],\n        price: \"From $5,000\",\n        order: 2,\n        active: true\n      },\n      {\n        title: \"UI/UX Design Services\",\n        description: \"User-centered design solutions that combine aesthetics with functionality for optimal user experience.\",\n        icon: \"palette\",\n        features: [\n          \"User Research & Analysis\",\n          \"Wireframing & Prototyping\",\n          \"Design Systems Creation\",\n          \"Responsive Web Design\",\n          \"Usability Testing\",\n          \"Brand Identity Design\"\n        ],\n        price: \"From $1,500\",\n        order: 3,\n        active: true\n      },\n      {\n        title: \"E-commerce Solutions\",\n        description: \"Complete e-commerce platforms with payment integration, inventory management, and analytics.\",\n        icon: \"shopping-cart\",\n        features: [\n          \"Custom Online Stores\",\n          \"Payment Gateway Integration\",\n          \"Inventory Management\",\n          \"Order Processing System\",\n          \"Analytics & Reporting\",\n          \"SEO Optimization\"\n        ],\n        price: \"From $4,000\",\n        order: 4,\n        active: true\n      },\n      {\n        title: \"API Development & Integration\",\n        description: \"Robust RESTful and GraphQL APIs with comprehensive documentation and third-party integrations.\",\n        icon: \"link\",\n        features: [\n          \"RESTful API Development\",\n          \"GraphQL Implementation\",\n          \"API Documentation\",\n          \"Third-party API Integration\",\n          \"Webhook Implementation\",\n          \"API Security & Rate Limiting\"\n        ],\n        price: \"From $2,500\",\n        order: 5,\n        active: true\n      },\n      {\n        title: \"DevOps & Cloud Services\",\n        description: \"Infrastructure setup, CI/CD pipelines, and cloud deployment for scalable applications.\",\n        icon: \"cloud\",\n        features: [\n          \"Docker Containerization\",\n          \"CI/CD Pipeline Setup\",\n          \"AWS/GCP/Azure Deployment\",\n          \"Server Configuration\",\n          \"Monitoring & Logging\",\n          \"Performance Optimization\"\n        ],\n        price: \"From $2,000\",\n        order: 6,\n        active: true\n      },\n      {\n        title: \"Technical Consulting\",\n        description: \"Expert advice on technology stack, architecture decisions, and best practices for your projects.\",\n        icon: \"lightbulb\",\n        features: [\n          \"Technology Stack Selection\",\n          \"Architecture Design\",\n          \"Code Review & Audit\",\n          \"Performance Analysis\",\n          \"Security Assessment\",\n          \"Team Training\"\n        ],\n        price: \"From $150/hour\",\n        order: 7,\n        active: true\n      },\n      {\n        title: \"Maintenance & Support\",\n        description: \"Ongoing maintenance, bug fixes, and feature updates to keep your applications running smoothly.\",\n        icon: \"wrench\",\n        features: [\n          \"Bug Fixes & Updates\",\n          \"Performance Monitoring\",\n          \"Security Patches\",\n          \"Feature Enhancements\",\n          \"24/7 Technical Support\",\n          \"Monthly Reports\"\n        ],\n        price: \"From $500/month\",\n        order: 8,\n        active: true\n      }\n    ]);\n    console.log(\"Services seeded\");\n\n    // ==================== TESTIMONIALS ====================\n    await db.insert(testimonials).values([\n      {\n        name: \"John Smith\",\n        role: \"CEO\",\n        company: \"TechCorp Solutions\",\n        content: \"Loi delivered exceptional work on our enterprise web application. His attention to detail, technical expertise, and ability to understand complex business requirements exceeded our expectations. The project was delivered on time and within budget.\",\n        avatar: null,\n        rating: 5,\n        featured: true,\n        active: true\n      },\n      {\n        name: \"Sarah Johnson\",\n        role: \"Product Manager\",\n        company: \"StartupXYZ\",\n        content: \"Working with Loi was a fantastic experience from start to finish. He understood our vision perfectly and translated it into a beautiful, functional product. His communication skills and proactive approach made the entire development process smooth and enjoyable.\",\n        avatar: null,\n        rating: 5,\n        featured: true,\n        active: true\n      },\n      {\n        name: \"Michael Chen\",\n        role: \"CTO\",\n        company: \"InnovateTech\",\n        content: \"I highly recommend Loi for any development project. He's professional, responsive, and delivers high-quality code. His expertise in React and Node.js helped us build a scalable platform that handles thousands of users seamlessly.\",\n        avatar: null,\n        rating: 5,\n        featured: true,\n        active: true\n      },\n      {\n        name: \"Emily Rodriguez\",\n        role: \"Founder\",\n        company: \"DesignHub\",\n        content: \"Loi transformed our outdated website into a modern, responsive platform. His UI/UX skills are outstanding, and he provided valuable insights throughout the project. Our conversion rate increased by 40% after the redesign!\",\n        avatar: null,\n        rating: 5,\n        featured: false,\n        active: true\n      },\n      {\n        name: \"David Wilson\",\n        role: \"Marketing Director\",\n        company: \"GrowthLabs\",\n        content: \"The mobile app Loi developed for us has been a game-changer for our business. It's intuitive, fast, and our customers love it. He also provided excellent post-launch support and helped us implement new features smoothly.\",\n        avatar: null,\n        rating: 5,\n        featured: false,\n        active: true\n      },\n      {\n        name: \"Lisa Anderson\",\n        role: \"VP of Engineering\",\n        company: \"DataFlow Inc\",\n        content: \"Loi's expertise in backend development and API design is impressive. He built a robust, scalable API infrastructure that powers our entire platform. His code quality and documentation are top-notch.\",\n        avatar: null,\n        rating: 5,\n        featured: false,\n        active: true\n      }\n    ]);\n    console.log(\"Testimonials seeded\");\n\n    // ==================== SITE SETTINGS ====================\n    await db.insert(siteSettings).values([\n      // Site Information\n      { key: \"siteTitle\", value: \"Loi Developer - Full-stack Creative\" },\n      { key: \"tagline\", value: \"Building digital experiences with code.\" },\n      { key: \"contactEmail\", value: \"loideveloper@example.com\" },\n      { key: \"maintenanceMode\", value: false },\n      \n      // Hero Section\n      { key: \"heroTitle\", value: \"Hello, I'm Loi Developer\" },\n      { key: \"heroSubtitle\", value: \"Full-stack Developer | UI/UX Enthusiast | Creative Thinker\" },\n      { key: \"heroCTA\", value: \"View My Work\" },\n      { key: \"cvFileUrl\", value: \"\" },\n      \n      // About Section  \n      { key: \"aboutTitle\", value: \"About Me\" },\n      { key: \"aboutSubtitle\", value: \"Full-stack Developer based in Vietnam\" },\n      { key: \"aboutDescription\", value: \"I'm a passionate full-stack developer with expertise in building modern web applications. With years of experience in React, Node.js, and cloud technologies, I create digital experiences that combine beautiful design with robust functionality.\" },\n      { key: \"aboutDescription2\", value: \"My philosophy is simple: Code with passion, build with purpose. Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\" },\n      { key: \"aboutImage\", value: \"\" },\n      { key: \"aboutName\", value: \"Nguyen Thanh Loi\" },\n      { key: \"aboutLocation\", value: \"Ho Chi Minh City\" },\n      { key: \"aboutFreelance\", value: \"Available\" },\n      \n      // Contact Section\n      { key: \"contactTitle\", value: \"Let's Talk\" },\n      { key: \"contactSubtitle\", value: \"Have a project in mind or just want to say hi? I'm always open to discussing new projects, creative ideas or opportunities to be part of your visions.\" },\n      { key: \"contactPhone\", value: \"+84 123 456 789\" },\n      { key: \"contactAddress\", value: \"Ho Chi Minh City, Vietnam\" },\n      \n      // Social Links\n      { key: \"socialFacebook\", value: \"\" },\n      { key: \"socialTwitter\", value: \"\" },\n      { key: \"socialInstagram\", value: \"\" },\n      { key: \"socialLinkedin\", value: \"\" },\n      { key: \"socialGithub\", value: \"\" },\n      { key: \"socialYoutube\", value: \"\" },\n      \n      // Footer\n      { key: \"footerText\", value: \"Crafted with love & countless cups of coffee\" },\n      { key: \"footerCopyright\", value: \"2024 Loi Developer. All rights reserved.\" }\n    ]);\n    console.log(\"Site settings seeded\");\n\n    // ==================== COMMENTS ====================\n    await db.insert(comments).values([\n      // Comments on Post 1 (React 19)\n      {\n        authorName: \"David Miller\",\n        authorEmail: \"david@example.com\",\n        content: \"Great article! Very helpful for understanding React 19 features. The code examples are clear and well-explained.\",\n        postId: 1,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Emma Watson\",\n        authorEmail: \"emma@example.com\",\n        content: \"Thanks for this comprehensive guide! I've been waiting for a good React 19 tutorial.\",\n        postId: 1,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Tom Wilson\",\n        authorEmail: \"tom@example.com\",\n        content: \"This is exactly what I was looking for. Can you write more about Server Components?\",\n        postId: 1,\n        status: \"Pending\",\n        createdAt: new Date()\n      },\n      \n      // Comments on Post 2 (AI in Web Design)\n      {\n        authorName: \"Sophie Chen\",\n        authorEmail: \"sophie@example.com\",\n        content: \"Fascinating insights into AI's role in design. I'm excited about the future!\",\n        postId: 2,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Mark Johnson\",\n        authorEmail: \"mark@example.com\",\n        content: \"As a designer, I find this both exciting and slightly concerning. Great balanced perspective!\",\n        postId: 2,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      \n      // Comments on Projects\n      {\n        authorName: \"Lisa Chen\",\n        authorEmail: \"lisa@example.com\",\n        content: \"I love the Analytics Dashboard project! The UI is very clean and the data visualization is impressive.\",\n        projectId: 1,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Alex Turner\",\n        authorEmail: \"alex@example.com\",\n        content: \"The e-commerce platform looks amazing! How long did it take to build?\",\n        projectId: 2,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Rachel Green\",\n        authorEmail: \"rachel@example.com\",\n        content: \"Great mobile app! The UI is very intuitive and smooth.\",\n        projectId: 3,\n        status: \"Pending\",\n        createdAt: new Date()\n      }\n    ]);\n    console.log(\"Comments seeded\");\n\n    // ==================== REVIEWS ====================\n    await db.insert(reviews).values([\n      {\n        authorName: \"Alex Johnson\",\n        authorEmail: \"alex@example.com\",\n        content: \"Excellent work on the Analytics Dashboard! Very professional and well-documented code. The performance is outstanding even with large datasets.\",\n        projectId: 1,\n        rating: 5,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Maria Garcia\",\n        authorEmail: \"maria@example.com\",\n        content: \"The e-commerce platform is beautifully designed. Love the user experience and the checkout flow is seamless!\",\n        projectId: 2,\n        rating: 5,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"James Lee\",\n        authorEmail: \"james@example.com\",\n        content: \"Good project overall, but I think the mobile app could use some improvements in performance on older devices.\",\n        projectId: 3,\n        rating: 4,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Christina Park\",\n        authorEmail: \"christina@example.com\",\n        content: \"The Task Management API is exactly what we needed. Clean architecture and great documentation!\",\n        projectId: 4,\n        rating: 5,\n        status: \"Approved\",\n        createdAt: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000)\n      },\n      {\n        authorName: \"Robert Brown\",\n        authorEmail: \"robert@example.com\",\n        content: \"Impressive design system! It has significantly improved our development workflow.\",\n        projectId: 5,\n        rating: 5,\n        status: \"Pending\",\n        createdAt: new Date()\n      }\n    ]);\n    console.log(\"Reviews seeded\");\n\n    // ==================== MESSAGES ====================\n    await db.insert(messages).values([\n      {\n        sender: \"Jennifer Martinez\",\n        email: \"jennifer@techstartup.com\",\n        subject: \"Project Inquiry - E-commerce Platform\",\n        message: \"Hi Loi, I came across your portfolio and I'm very impressed with your work. We're looking to build an e-commerce platform for our startup. Would you be available for a consultation call next week?\",\n        tag: \"Project Inquiry\",\n        read: false,\n        createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)\n      },\n      {\n        sender: \"Kevin Anderson\",\n        email: \"kevin@designagency.com\",\n        subject: \"Collaboration Opportunity\",\n        message: \"Hello, our design agency is looking for a skilled full-stack developer to collaborate on client projects. Your expertise in React and Node.js would be a great fit. Let's discuss!\",\n        tag: \"Collaboration\",\n        read: true,\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      {\n        sender: \"Amanda White\",\n        email: \"amanda@nonprofit.org\",\n        subject: \"Website Development for Non-profit\",\n        message: \"We're a non-profit organization looking to rebuild our website. We have a limited budget but are interested in your services. Can we schedule a call?\",\n        tag: \"Project Inquiry\",\n        read: false,\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      },\n      {\n        sender: \"Peter Thompson\",\n        email: \"peter@example.com\",\n        subject: \"Question about React Tutorial\",\n        message: \"Hi Loi, I read your React 19 article and have a question about Server Components. Can you explain more about when to use them vs client components?\",\n        tag: \"Question\",\n        read: true,\n        createdAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)\n      },\n      {\n        sender: \"Michelle Davis\",\n        email: \"michelle@enterprise.com\",\n        subject: \"Enterprise Application Development\",\n        message: \"We're looking for a developer to build a complex enterprise application with real-time features. Your Analytics Dashboard project caught our attention. Interested in discussing this opportunity?\",\n        tag: \"Project Inquiry\",\n        read: false,\n        createdAt: new Date()\n      }\n    ]);\n    console.log(\"Messages seeded\");\n\n    // ==================== ACTIVITY LOGS ====================\n    await db.insert(activityLogs).values([\n      {\n        action: \"User Loi Developer logged in\",\n        userId: 1,\n        userName: \"Loi Developer\",\n        type: \"success\",\n        createdAt: new Date(Date.now() - 1 * 60 * 60 * 1000)\n      },\n      {\n        action: \"Published new post: Getting Started with React 19\",\n        userId: 1,\n        userName: \"Loi Developer\",\n        type: \"info\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      },\n      {\n        action: \"Updated project: Analytics Dashboard\",\n        userId: 1,\n        userName: \"Loi Developer\",\n        type: \"info\",\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      {\n        action: \"User Sarah Editor logged in\",\n        userId: 2,\n        userName: \"Sarah Editor\",\n        type: \"success\",\n        createdAt: new Date(Date.now() - 4 * 60 * 60 * 1000)\n      },\n      {\n        action: \"Created new service: Technical Consulting\",\n        userId: 1,\n        userName: \"Loi Developer\",\n        type: \"info\",\n        createdAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)\n      },\n      {\n        action: \"Approved comment from David Miller\",\n        userId: 2,\n        userName: \"Sarah Editor\",\n        type: \"success\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Activity logs seeded\");\n\n    // ==================== NOTIFICATIONS ====================\n    await db.insert(notifications).values([\n      {\n        message: \"New comment on your post 'Getting Started with React 19'\",\n        type: \"comment\",\n        read: false,\n        userId: 1,\n        createdAt: new Date(Date.now() - 2 * 60 * 60 * 1000)\n      },\n      {\n        message: \"New project inquiry from Jennifer Martinez\",\n        type: \"message\",\n        read: false,\n        userId: 1,\n        createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)\n      },\n      {\n        message: \"Your project 'Analytics Dashboard' received a 5-star review\",\n        type: \"review\",\n        read: true,\n        userId: 1,\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      },\n      {\n        message: \"System: Database backup completed successfully\",\n        type: \"system\",\n        read: true,\n        userId: 1,\n        createdAt: new Date(Date.now() - 12 * 60 * 60 * 1000)\n      },\n      {\n        message: \"New collaboration opportunity from Kevin Anderson\",\n        type: \"message\",\n        read: false,\n        userId: 1,\n        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Notifications seeded\");\n\n    // ==================== MEDIA ====================\n    await db.insert(media).values([\n      {\n        filename: \"hero-image.jpg\",\n        originalName: \"hero-image.jpg\",\n        mimeType: \"image/jpeg\",\n        size: 245678,\n        url: \"/uploads/images/futuristic_3d_developer_avatar.png\",\n        alt: \"Developer avatar\",\n        createdAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n      },\n      {\n        filename: \"project-dashboard.png\",\n        originalName: \"analytics-dashboard-screenshot.png\",\n        mimeType: \"image/png\",\n        size: 512340,\n        url: \"/uploads/images/project_screenshot_dashboard.png\",\n        alt: \"Analytics dashboard screenshot\",\n        createdAt: new Date(Date.now() - 25 * 24 * 60 * 60 * 1000)\n      },\n      {\n        filename: \"ecommerce-screenshot.png\",\n        originalName: \"ecommerce-platform.png\",\n        mimeType: \"image/png\",\n        size: 478920,\n        url: \"/uploads/images/project_screenshot_ecommerce.png\",\n        alt: \"E-commerce platform screenshot\",\n        createdAt: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000)\n      },\n      {\n        filename: \"blog-background-1.png\",\n        originalName: \"tech-article-background.png\",\n        mimeType: \"image/png\",\n        size: 156789,\n        url: \"/uploads/images/tech_article_background_design.png\",\n        alt: \"Blog post background\",\n        createdAt: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Media seeded\");\n\n    // ==================== FAQs ====================\n    await db.insert(faqs).values([\n      {\n        question: \"What technologies do you specialize in?\",\n        answer: \"I specialize in full-stack web development with React, Next.js, Node.js, and TypeScript. I also have experience with Python, PostgreSQL, MongoDB, Docker, and cloud platforms like AWS and Vercel.\",\n        visible: true,\n        order: 1\n      },\n      {\n        question: \"Do you offer ongoing maintenance and support?\",\n        answer: \"Yes! I provide ongoing maintenance and support packages for all projects. This includes bug fixes, security updates, performance optimization, and feature enhancements based on your needs.\",\n        visible: true,\n        order: 2\n      },\n      {\n        question: \"What is your typical project timeline?\",\n        answer: \"Project timelines vary based on complexity. A simple website takes 2-4 weeks, a web application 4-8 weeks, and complex platforms 8-16 weeks. I'll provide a detailed timeline during our initial consultation.\",\n        visible: true,\n        order: 3\n      },\n      {\n        question: \"How do you handle project communication?\",\n        answer: \"I believe in transparent communication. You'll receive regular updates through your preferred channel (Slack, email, or weekly calls). I also provide access to project management tools for real-time progress tracking.\",\n        visible: true,\n        order: 4\n      },\n      {\n        question: \"Do you work with international clients?\",\n        answer: \"Absolutely! I work with clients worldwide. I'm flexible with time zones and use async communication tools to ensure smooth collaboration regardless of your location.\",\n        visible: true,\n        order: 5\n      },\n      {\n        question: \"What is your payment structure?\",\n        answer: \"I typically work with a 50% upfront deposit and 50% upon completion for smaller projects. For larger projects, we can arrange milestone-based payments. I accept bank transfers, PayPal, and cryptocurrency.\",\n        visible: true,\n        order: 6\n      }\n    ]);\n    console.log(\"FAQs seeded\");\n\n    // ==================== PAGES ====================\n    await db.insert(pages).values([\n      {\n        title: \"About Me\",\n        slug: \"about\",\n        content: `# About Loi Developer\n\nI'm a passionate full-stack developer with over 8 years of experience building modern web applications. Based in Ho Chi Minh City, Vietnam, I work with clients worldwide to bring their digital ideas to life.\n\n## My Journey\n\nMy journey in tech started with curiosity and a love for problem-solving. Today, I specialize in creating performant, scalable, and user-friendly applications using cutting-edge technologies.\n\n## What I Do\n\n- **Web Development**: Building responsive, accessible websites and web applications\n- **Mobile Development**: Creating cross-platform mobile apps with React Native\n- **API Development**: Designing and implementing RESTful and GraphQL APIs\n- **DevOps**: Setting up CI/CD pipelines and cloud infrastructure\n\n## Values\n\nI believe in writing clean, maintainable code and delivering exceptional user experiences. Every project is an opportunity to learn and grow.`,\n        excerpt: \"Learn more about my background, experience, and what drives my passion for development.\",\n        status: \"Published\",\n        metaTitle: \"About Loi Developer - Full-Stack Web Developer\",\n        metaDescription: \"Learn about Loi Developer, a full-stack web developer specializing in React, Node.js, and modern web technologies.\",\n        publishedAt: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"Privacy Policy\",\n        slug: \"privacy-policy\",\n        content: `# Privacy Policy\n\nLast updated: ${new Date().toLocaleDateString()}\n\n## Information We Collect\n\nWe collect information you provide directly, such as when you contact us or subscribe to our newsletter.\n\n## How We Use Your Information\n\n- To respond to your inquiries\n- To send you updates and newsletters (with your consent)\n- To improve our services\n\n## Data Security\n\nWe implement appropriate security measures to protect your personal information.\n\n## Your Rights\n\nYou have the right to access, correct, or delete your personal data at any time.\n\n## Contact Us\n\nIf you have questions about this policy, please contact us at privacy@loideveloper.com.`,\n        excerpt: \"Our privacy policy explains how we collect, use, and protect your personal information.\",\n        status: \"Published\",\n        metaTitle: \"Privacy Policy - Loi Developer\",\n        metaDescription: \"Read our privacy policy to understand how we collect, use, and protect your personal information.\",\n        publishedAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n      },\n      {\n        title: \"Terms of Service\",\n        slug: \"terms-of-service\",\n        content: `# Terms of Service\n\nLast updated: ${new Date().toLocaleDateString()}\n\n## Agreement to Terms\n\nBy accessing our website, you agree to these terms of service.\n\n## Services\n\nWe provide web development and related consulting services as described on our website.\n\n## Intellectual Property\n\nAll content on this website is owned by Loi Developer unless otherwise stated.\n\n## Limitation of Liability\n\nWe are not liable for any indirect or consequential damages arising from the use of our services.\n\n## Changes to Terms\n\nWe may update these terms at any time. Continued use of our services constitutes acceptance of updated terms.\n\n## Contact\n\nFor questions about these terms, contact us at legal@loideveloper.com.`,\n        excerpt: \"Review our terms of service that govern your use of our website and services.\",\n        status: \"Published\",\n        metaTitle: \"Terms of Service - Loi Developer\",\n        metaDescription: \"Review the terms and conditions that govern your use of Loi Developer website and services.\",\n        publishedAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Pages seeded\");\n\n    // ==================== SUBSCRIBERS ====================\n    await db.insert(subscribers).values([\n      {\n        email: \"john.developer@gmail.com\",\n        name: \"John Developer\",\n        status: \"active\",\n        source: \"website\",\n        tags: [\"developer\", \"newsletter\"],\n        unsubscribeToken: crypto.randomBytes(32).toString('hex'),\n        confirmedAt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)\n      },\n      {\n        email: \"sarah.tech@yahoo.com\",\n        name: \"Sarah Tech\",\n        status: \"active\",\n        source: \"website\",\n        tags: [\"newsletter\"],\n        unsubscribeToken: crypto.randomBytes(32).toString('hex'),\n        confirmedAt: new Date(Date.now() - 25 * 24 * 60 * 60 * 1000)\n      },\n      {\n        email: \"mike.startup@startup.io\",\n        name: \"Mike Startup\",\n        status: \"active\",\n        source: \"blog\",\n        tags: [\"startup\", \"newsletter\"],\n        unsubscribeToken: crypto.randomBytes(32).toString('hex'),\n        confirmedAt: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000)\n      },\n      {\n        email: \"emma.designer@design.co\",\n        name: \"Emma Designer\",\n        status: \"active\",\n        source: \"website\",\n        tags: [\"design\", \"newsletter\"],\n        unsubscribeToken: crypto.randomBytes(32).toString('hex'),\n        confirmedAt: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000)\n      },\n      {\n        email: \"alex.coder@code.dev\",\n        name: \"Alex Coder\",\n        status: \"unsubscribed\",\n        source: \"website\",\n        tags: [\"developer\"],\n        unsubscribeToken: crypto.randomBytes(32).toString('hex'),\n        confirmedAt: new Date(Date.now() - 40 * 24 * 60 * 60 * 1000),\n        unsubscribedAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)\n      }\n    ]);\n    console.log(\"Subscribers seeded\");\n\n    // ==================== EMAIL TEMPLATES ====================\n    await db.insert(emailTemplates).values([\n      {\n        name: \"Welcome Email\",\n        subject: \"Welcome to {{site_name}}!\",\n        htmlContent: `<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; color: white; text-align: center;\">\n            <h1>Welcome, {{name}}!</h1>\n          </div>\n          <div style=\"padding: 30px; background: #f9fafb;\">\n            <p>Thank you for subscribing to our newsletter!</p>\n            <p>You'll receive updates on:</p>\n            <ul>\n              <li>New blog posts and tutorials</li>\n              <li>Project case studies</li>\n              <li>Industry insights and tips</li>\n            </ul>\n            <p>Best regards,<br>Loi Developer</p>\n          </div>\n        </div>`,\n        textContent: \"Welcome {{name}}! Thank you for subscribing to our newsletter.\",\n        type: \"newsletter\",\n        variables: [\"name\", \"site_name\", \"unsubscribe_url\"],\n        active: true\n      },\n      {\n        name: \"New Post Notification\",\n        subject: \"New Article: {{post_title}}\",\n        htmlContent: `<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <div style=\"background: #1a1a2e; padding: 20px; color: white; text-align: center;\">\n            <h2>New Article Published</h2>\n          </div>\n          <div style=\"padding: 30px;\">\n            <h3>{{post_title}}</h3>\n            <p>{{post_excerpt}}</p>\n            <a href=\"{{post_url}}\" style=\"background: #667eea; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">Read More</a>\n          </div>\n        </div>`,\n        textContent: \"New Article: {{post_title}}\\n\\n{{post_excerpt}}\\n\\nRead more: {{post_url}}\",\n        type: \"newsletter\",\n        variables: [\"post_title\", \"post_excerpt\", \"post_url\", \"unsubscribe_url\"],\n        active: true\n      },\n      {\n        name: \"Contact Form Response\",\n        subject: \"Thank you for reaching out!\",\n        htmlContent: `<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <div style=\"padding: 30px;\">\n            <p>Hi {{name}},</p>\n            <p>Thank you for contacting me. I've received your message and will get back to you within 24-48 hours.</p>\n            <p>Best regards,<br>Loi Developer</p>\n          </div>\n        </div>`,\n        textContent: \"Hi {{name}}, Thank you for contacting me. I've received your message and will get back to you within 24-48 hours.\",\n        type: \"transactional\",\n        variables: [\"name\"],\n        active: true\n      }\n    ]);\n    console.log(\"Email templates seeded\");\n\n    // ==================== EMAIL CAMPAIGNS ====================\n    await db.insert(emailCampaigns).values([\n      {\n        name: \"Monthly Newsletter - December 2024\",\n        subject: \"December Updates: New Features & Tutorials\",\n        content: `<div style=\"font-family: Arial, sans-serif;\">\n          <h2>Hello {{name}}!</h2>\n          <p>Here's what's new this month:</p>\n          <ul>\n            <li>New React 19 tutorial series</li>\n            <li>Portfolio redesign case study</li>\n            <li>Upcoming webinar on TypeScript best practices</li>\n          </ul>\n          <p>Stay tuned for more updates!</p>\n        </div>`,\n        status: \"sent\",\n        sentAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),\n        recipientCount: 150,\n        openCount: 68,\n        clickCount: 23,\n        tags: [\"monthly\", \"newsletter\"]\n      },\n      {\n        name: \"Year in Review 2024\",\n        subject: \"A Year of Growth: 2024 Highlights\",\n        content: `<div style=\"font-family: Arial, sans-serif;\">\n          <h2>2024 Year in Review</h2>\n          <p>What an incredible year it has been!</p>\n          <p>Key achievements:</p>\n          <ul>\n            <li>20+ projects completed</li>\n            <li>50+ blog posts published</li>\n            <li>5000+ newsletter subscribers</li>\n          </ul>\n          <p>Thank you for being part of this journey!</p>\n        </div>`,\n        status: \"draft\",\n        recipientCount: 0,\n        tags: [\"annual\", \"newsletter\"]\n      }\n    ]);\n    console.log(\"Email campaigns seeded\");\n\n    // ==================== HOMEPAGE SECTIONS ====================\n    await db.insert(homepageSections).values([\n      { name: \"hero\", visible: true, order: 1 },\n      { name: \"about\", visible: true, order: 2 },\n      { name: \"skills\", visible: true, order: 3 },\n      { name: \"services\", visible: true, order: 4 },\n      { name: \"projects\", visible: true, order: 5 },\n      { name: \"blog\", visible: true, order: 6 },\n      { name: \"testimonials\", visible: true, order: 7 },\n      { name: \"contact\", visible: true, order: 8 },\n      { name: \"newsletter\", visible: true, order: 9 }\n    ]);\n    console.log(\"Homepage sections seeded\");\n\n    // ==================== SECURITY SETTINGS ====================\n    await db.insert(securitySettings).values([\n      { key: \"maxLoginAttempts\", value: 5 },\n      { key: \"lockoutDuration\", value: 30 },\n      { key: \"passwordMinLength\", value: 8 },\n      { key: \"requireSpecialChar\", value: true },\n      { key: \"requireUppercase\", value: true },\n      { key: \"requireNumber\", value: true },\n      { key: \"sessionTimeout\", value: 60 },\n      { key: \"twoFactorEnabled\", value: false },\n      { key: \"ipWhitelistEnabled\", value: false },\n      { key: \"captchaEnabled\", value: false },\n      { key: \"rateLimitEnabled\", value: true },\n      { key: \"rateLimitRequests\", value: 100 },\n      { key: \"rateLimitWindow\", value: 60 }\n    ]);\n    console.log(\"Security settings seeded\");\n\n    // ==================== SCHEDULED TASKS ====================\n    await db.insert(scheduledTasks).values([\n      {\n        name: \"Daily Database Backup\",\n        description: \"Automatically backup the database every day at midnight\",\n        schedule: \"0 0 * * *\",\n        type: \"backup\",\n        command: \"npm run db:backup\",\n        status: \"active\",\n        createdBy: 1\n      },\n      {\n        name: \"Weekly Newsletter\",\n        description: \"Send weekly digest to all subscribers\",\n        schedule: \"0 9 * * 1\",\n        type: \"email\",\n        command: \"npm run newsletter:send\",\n        status: \"paused\",\n        createdBy: 1\n      },\n      {\n        name: \"Cache Cleanup\",\n        description: \"Clear expired cache entries\",\n        schedule: \"0 */6 * * *\",\n        type: \"maintenance\",\n        command: \"npm run cache:clear\",\n        status: \"active\",\n        createdBy: 1\n      },\n      {\n        name: \"Analytics Report\",\n        description: \"Generate and email weekly analytics report\",\n        schedule: \"0 8 * * 1\",\n        type: \"custom\",\n        command: \"npm run analytics:report\",\n        status: \"active\",\n        createdBy: 1\n      }\n    ]);\n    console.log(\"Scheduled tasks seeded\");\n\n    // ==================== WEBHOOKS ====================\n    await db.insert(webhooks).values([\n      {\n        name: \"Slack Notifications\",\n        url: \"https://hooks.slack.com/services/example\",\n        events: [\"new_message\", \"new_comment\", \"new_project\"],\n        secret: crypto.randomBytes(32).toString('hex'),\n        status: \"active\",\n        successCount: 156,\n        failureCount: 2,\n        createdBy: 1\n      },\n      {\n        name: \"Discord Bot\",\n        url: \"https://discord.com/api/webhooks/example\",\n        events: [\"new_post\", \"new_review\"],\n        secret: crypto.randomBytes(32).toString('hex'),\n        status: \"inactive\",\n        successCount: 45,\n        failureCount: 0,\n        createdBy: 1\n      },\n      {\n        name: \"Analytics Tracker\",\n        url: \"https://analytics.example.com/webhook\",\n        events: [\"page_view\", \"form_submission\"],\n        secret: crypto.randomBytes(32).toString('hex'),\n        status: \"active\",\n        successCount: 1250,\n        failureCount: 5,\n        createdBy: 1\n      }\n    ]);\n    console.log(\"Webhooks seeded\");\n\n    // ==================== TRANSLATIONS ====================\n    await db.insert(translations).values([\n      // Vietnamese translations\n      { key: \"nav.home\", locale: \"vi\", value: \"Trang chá»§\", namespace: \"common\" },\n      { key: \"nav.about\", locale: \"vi\", value: \"Giá»›i thiá»‡u\", namespace: \"common\" },\n      { key: \"nav.projects\", locale: \"vi\", value: \"Dá»± Ã¡n\", namespace: \"common\" },\n      { key: \"nav.blog\", locale: \"vi\", value: \"Blog\", namespace: \"common\" },\n      { key: \"nav.contact\", locale: \"vi\", value: \"LiÃªn há»‡\", namespace: \"common\" },\n      { key: \"hero.title\", locale: \"vi\", value: \"Láº­p trÃ¬nh viÃªn Full-stack\", namespace: \"home\" },\n      { key: \"hero.subtitle\", locale: \"vi\", value: \"XÃ¢y dá»±ng á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i\", namespace: \"home\" },\n      { key: \"contact.form.name\", locale: \"vi\", value: \"Há» vÃ  tÃªn\", namespace: \"contact\" },\n      { key: \"contact.form.email\", locale: \"vi\", value: \"Email\", namespace: \"contact\" },\n      { key: \"contact.form.message\", locale: \"vi\", value: \"Tin nháº¯n\", namespace: \"contact\" },\n      { key: \"contact.form.submit\", locale: \"vi\", value: \"Gá»­i tin nháº¯n\", namespace: \"contact\" },\n      \n      // English translations (default)\n      { key: \"nav.home\", locale: \"en\", value: \"Home\", namespace: \"common\" },\n      { key: \"nav.about\", locale: \"en\", value: \"About\", namespace: \"common\" },\n      { key: \"nav.projects\", locale: \"en\", value: \"Projects\", namespace: \"common\" },\n      { key: \"nav.blog\", locale: \"en\", value: \"Blog\", namespace: \"common\" },\n      { key: \"nav.contact\", locale: \"en\", value: \"Contact\", namespace: \"common\" },\n      { key: \"hero.title\", locale: \"en\", value: \"Full-stack Developer\", namespace: \"home\" },\n      { key: \"hero.subtitle\", locale: \"en\", value: \"Building modern web applications\", namespace: \"home\" },\n      { key: \"contact.form.name\", locale: \"en\", value: \"Full Name\", namespace: \"contact\" },\n      { key: \"contact.form.email\", locale: \"en\", value: \"Email\", namespace: \"contact\" },\n      { key: \"contact.form.message\", locale: \"en\", value: \"Message\", namespace: \"contact\" },\n      { key: \"contact.form.submit\", locale: \"en\", value: \"Send Message\", namespace: \"contact\" }\n    ]);\n    console.log(\"Translations seeded\");\n\n    // ==================== CONTENT TEMPLATES ====================\n    await db.insert(contentTemplates).values([\n      {\n        name: \"Blog Post Template\",\n        type: \"post\",\n        content: `# {{title}}\n\n## Introduction\n\nWrite your introduction here...\n\n## Main Content\n\n### Section 1\n\nContent for section 1...\n\n### Section 2\n\nContent for section 2...\n\n## Conclusion\n\nWrap up your post here...`,\n        metadata: { category: \"general\", author: \"Loi Developer\" },\n        isDefault: true\n      },\n      {\n        name: \"Tutorial Template\",\n        type: \"post\",\n        content: `# {{title}}: A Step-by-Step Guide\n\n## Prerequisites\n\n- Requirement 1\n- Requirement 2\n\n## Step 1: Getting Started\n\nInstructions...\n\n## Step 2: Implementation\n\nCode and explanation...\n\n## Step 3: Testing\n\nHow to test...\n\n## Conclusion\n\nSummary and next steps...`,\n        metadata: { category: \"tutorial\", author: \"Loi Developer\" },\n        isDefault: false\n      },\n      {\n        name: \"Landing Page Template\",\n        type: \"page\",\n        content: `# {{title}}\n\n## Hero Section\n\nMain headline and call-to-action...\n\n## Features\n\n### Feature 1\nDescription...\n\n### Feature 2\nDescription...\n\n## Call to Action\n\nFinal CTA section...`,\n        metadata: { layout: \"landing\" },\n        isDefault: false\n      }\n    ]);\n    console.log(\"Content templates seeded\");\n\n    // ==================== MEDIA FOLDERS ====================\n    await db.insert(mediaFolders).values([\n      { name: \"Images\", parentId: null, path: \"/images\" },\n      { name: \"Documents\", parentId: null, path: \"/documents\" },\n      { name: \"Videos\", parentId: null, path: \"/videos\" },\n      { name: \"Projects\", parentId: null, path: \"/images/projects\" },\n      { name: \"Blog\", parentId: null, path: \"/images/blog\" },\n      { name: \"Avatars\", parentId: null, path: \"/images/avatars\" }\n    ]);\n    console.log(\"Media folders seeded\");\n\n    console.log(\"Database seeding completed successfully!\");\n    console.log(\"\\n=== LOGIN CREDENTIALS ===\");\n    console.log(\"Super Admin:\");\n    console.log(\"  Username: admin\");\n    console.log(\"  Password: admin123\");\n    console.log(\"\\nEditor:\");\n    console.log(\"  Username: editor\");\n    console.log(\"  Password: editor123\");\n    console.log(\"\\nModerator:\");\n    console.log(\"  Username: moderator\");\n    console.log(\"  Password: mod123\");\n    console.log(\"\\nSubscriber:\");\n    console.log(\"  Username: subscriber\");\n    console.log(\"  Password: sub123\");\n    console.log(\"=========================\\n\");\n    \n  } catch (error) {\n    console.error(\"Seeding error:\", error);\n    throw error;\n  }\n}\n\nseed()\n  .then(() => process.exit(0))\n  .catch((error) => {\n    console.error(error);\n    process.exit(1);\n  });\n","path":null,"size_bytes":63012,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/admin/advanced-search.tsx":{"content":"import { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Search, X, Filter } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface SearchFilter {\n  label: string;\n  key: string;\n  options: string[];\n}\n\ninterface AdvancedSearchProps {\n  onSearch: (query: string, filters: Record<string, string>) => void;\n  filters: SearchFilter[];\n}\n\nexport function AdvancedSearch({ onSearch, filters }: AdvancedSearchProps) {\n  const [query, setQuery] = useState(\"\");\n  const [activeFilters, setActiveFilters] = useState<Record<string, string>>({});\n  const [showFilters, setShowFilters] = useState(false);\n\n  const handleSearch = () => {\n    onSearch(query, activeFilters);\n  };\n\n  const toggleFilter = (key: string, value: string) => {\n    setActiveFilters((prev) => ({\n      ...prev,\n      [key]: prev[key] === value ? \"\" : value,\n    }));\n  };\n\n  const clearAll = () => {\n    setQuery(\"\");\n    setActiveFilters({});\n    onSearch(\"\", {});\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex gap-2\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search...\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            onKeyDown={(e) => e.key === \"Enter\" && handleSearch()}\n            className=\"pl-9\"\n          />\n        </div>\n        <Button onClick={handleSearch} className=\"gap-2\">\n          <Search className=\"w-4 h-4\" /> Search\n        </Button>\n        <Button\n          variant=\"outline\"\n          onClick={() => setShowFilters(!showFilters)}\n          className=\"gap-2\"\n        >\n          <Filter className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      {showFilters && (\n        <Card className=\"p-4 space-y-3\">\n          {filters.map((filter) => (\n            <div key={filter.key}>\n              <p className=\"text-sm font-medium mb-2\">{filter.label}</p>\n              <div className=\"flex flex-wrap gap-2\">\n                {filter.options.map((option) => (\n                  <Button\n                    key={option}\n                    variant={\n                      activeFilters[filter.key] === option\n                        ? \"default\"\n                        : \"outline\"\n                    }\n                    size=\"sm\"\n                    onClick={() => toggleFilter(filter.key, option)}\n                  >\n                    {option}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          ))}\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={clearAll}\n            className=\"w-full gap-2 text-destructive hover:text-destructive\"\n          >\n            <X className=\"w-4 h-4\" /> Clear All\n          </Button>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":2943,"size_tokens":null},"client/src/components/sections/Skills.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { Badge } from \"@/components/ui/badge\";\n\nconst defaultSkills = {\n  Frontend: [\n    { name: \"React.js\", level: 95 },\n    { name: \"TypeScript\", level: 90 },\n    { name: \"Tailwind CSS\", level: 95 },\n  ],\n  Backend: [\n    { name: \"Node.js\", level: 85 },\n    { name: \"Express\", level: 85 },\n  ],\n  Database: [\n    { name: \"PostgreSQL\", level: 80 },\n  ],\n  DevOps: [\n    { name: \"Git & GitHub\", level: 95 },\n  ],\n};\n\nfunction SkillCard({ name, level, delay }: { name: string; level: number; delay: number }) {\n  const getColor = (level: number) => {\n    if (level >= 90) return \"from-emerald-500 to-emerald-600\";\n    if (level >= 80) return \"from-blue-500 to-blue-600\";\n    return \"from-purple-500 to-purple-600\";\n  };\n\n  const getProficiency = (level: number) => {\n    if (level >= 90) return \"Expert\";\n    if (level >= 80) return \"Advanced\";\n    return \"Intermediate\";\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      whileInView={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5, delay }}\n      viewport={{ once: true }}\n    >\n      <Card className=\"relative overflow-hidden hover:shadow-lg transition-shadow duration-300 h-full group\">\n        <div className={`absolute inset-0 bg-gradient-to-br ${getColor(level)} opacity-0 group-hover:opacity-10 transition-opacity duration-300`} />\n        \n        <CardContent className=\"p-6 relative z-10\">\n          <div className=\"mb-4\">\n            <h3 className=\"font-semibold text-lg text-foreground mb-2\">{name}</h3>\n            <Badge variant=\"outline\" className=\"text-xs\">\n              {getProficiency(level)}\n            </Badge>\n          </div>\n\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <span className=\"text-sm text-muted-foreground\">Proficiency</span>\n              <span className=\"text-sm font-mono font-bold text-primary\">{level}%</span>\n            </div>\n\n            <div className=\"relative h-2 bg-muted rounded-full overflow-hidden\">\n              <motion.div\n                initial={{ width: 0 }}\n                whileInView={{ width: `${level}%` }}\n                transition={{ duration: 1.5, delay: delay + 0.2, ease: [0.22, 1, 0.36, 1] }}\n                viewport={{ once: true }}\n                className={`h-full bg-gradient-to-r ${getColor(level)} rounded-full`}\n              />\n            </div>\n          </div>\n\n          {/* Decorative circles */}\n          <div className=\"absolute top-2 right-2 w-12 h-12 bg-primary/5 rounded-full blur-xl group-hover:bg-primary/10 transition-colors duration-300\" />\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}\n\nexport function Skills() {\n  const { data: skillsData = [] } = useQuery({\n    queryKey: ['skills'],\n    queryFn: () => api.getSkills(),\n    staleTime: 60000,\n  });\n\n  const groupedSkills: Record<string, Array<{name: string; level: number}>> = {};\n\n  if (Array.isArray(skillsData) && skillsData.length > 0) {\n    skillsData.forEach((skill: any) => {\n      const category = skill.category || 'Other';\n      if (!groupedSkills[category]) {\n        groupedSkills[category] = [];\n      }\n      groupedSkills[category].push({ name: skill.name, level: skill.level });\n    });\n  }\n\n  const skills: Record<string, Array<{name: string; level: number}>> = Object.keys(groupedSkills).length > 0 ? groupedSkills : defaultSkills;\n  const categories = Object.keys(skills);\n\n  return (\n    <section id=\"skills\" className=\"py-24 bg-gradient-to-b from-background via-muted/20 to-background relative overflow-hidden\">\n      {/* Background decoration */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-1/3 -left-32 w-96 h-96 bg-primary/10 rounded-full blur-3xl\" />\n        <div className=\"absolute bottom-1/3 -right-32 w-96 h-96 bg-secondary/10 rounded-full blur-3xl\" />\n      </div>\n\n      <div className=\"container mx-auto px-4 relative z-10\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          whileInView={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6 }}\n          viewport={{ once: true }}\n          className=\"flex flex-col items-center mb-16\"\n        >\n          <h2 className=\"text-3xl md:text-5xl font-heading font-bold text-center mb-4\">\n            Skills & <span className=\"bg-gradient-to-r from-primary via-purple-500 to-secondary bg-clip-text text-transparent\">Technologies</span>\n          </h2>\n          <p className=\"text-muted-foreground text-center max-w-2xl mb-6\">\n            Expertise built through years of hands-on development experience\n          </p>\n          <div className=\"w-24 h-1 bg-gradient-to-r from-primary to-secondary rounded-full\" />\n        </motion.div>\n\n        {/* Category Tabs */}\n        <div className=\"max-w-5xl mx-auto\">\n          <Tabs defaultValue={categories[0]?.toLowerCase() || \"frontend\"} className=\"w-full\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              whileInView={{ opacity: 1 }}\n              transition={{ duration: 0.6, delay: 0.1 }}\n              viewport={{ once: true }}\n            >\n              <TabsList className=\"grid w-full grid-cols-2 md:grid-cols-4 gap-2 mb-12 h-auto p-2 bg-muted/30 backdrop-blur border border-border/50 rounded-xl\">\n                {categories.map((cat) => (\n                  <TabsTrigger \n                    key={cat} \n                    value={cat.toLowerCase()} \n                    className=\"py-3 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-300\"\n                    data-testid={`skill-tab-${cat.toLowerCase()}`}\n                  >\n                    {cat}\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n            </motion.div>\n\n            {/* Skills Grid */}\n            <div className=\"min-h-[350px]\">\n              {Object.entries(skills).map(([category, items]) => (\n                <TabsContent key={category} value={category.toLowerCase()} className=\"mt-0 space-y-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {items.map((skill, index) => (\n                      <SkillCard \n                        key={skill.name} \n                        name={skill.name} \n                        level={skill.level} \n                        delay={index * 0.1} \n                      />\n                    ))}\n                  </div>\n\n                  {/* Stats Summary */}\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    whileInView={{ opacity: 1 }}\n                    transition={{ duration: 0.6, delay: 0.3 }}\n                    viewport={{ once: true }}\n                    className=\"mt-8 p-4 rounded-lg bg-muted/20 border border-border/50\"\n                  >\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-center\">\n                      <div>\n                        <p className=\"text-2xl font-bold text-primary\">{items.length}</p>\n                        <p className=\"text-sm text-muted-foreground\">Total Skills</p>\n                      </div>\n                      <div>\n                        <p className=\"text-2xl font-bold text-emerald-500\">\n                          {items.filter(s => s.level >= 90).length}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground\">Expert Level</p>\n                      </div>\n                      <div>\n                        <p className=\"text-2xl font-bold text-blue-500\">\n                          {items.filter(s => s.level >= 80 && s.level < 90).length}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground\">Advanced</p>\n                      </div>\n                      <div>\n                        <p className=\"text-2xl font-bold text-purple-500\">\n                          {Math.round(items.reduce((sum, s) => sum + s.level, 0) / items.length)}%\n                        </p>\n                        <p className=\"text-sm text-muted-foreground\">Avg Proficiency</p>\n                      </div>\n                    </div>\n                  </motion.div>\n                </TabsContent>\n              ))}\n            </div>\n          </Tabs>\n        </div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":8691,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"@neondatabase/serverless\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1439,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/pages/admin/Login.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Eye, EyeOff, Lock, User, Shield, ArrowRight, ShieldCheck, Fingerprint, KeyRound } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"@/components/ui/dialog\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useRecaptcha } from \"@/hooks/use-recaptcha\";\nimport { startAuthentication } from \"@simplewebauthn/browser\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function AdminLogin() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [honeypot, setHoneypot] = useState(\"\");\n  const [show2FADialog, setShow2FADialog] = useState(false);\n  const [twoFactorCode, setTwoFactorCode] = useState(\"\");\n  const [tempSessionToken, setTempSessionToken] = useState(\"\");\n  const [hasBiometric, setHasBiometric] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const turnstileRef = useRef<HTMLDivElement>(null);\n\n  const {\n    isEnabled: captchaEnabled,\n    isLoaded: captchaLoaded,\n    captchaType,\n    executeRecaptcha,\n    renderTurnstile,\n    honeypotFieldName,\n    error: captchaError\n  } = useRecaptcha({ formType: 'login', action: 'login' });\n\n  useEffect(() => {\n    fetch(\"/api/auth/me\", {\n      credentials: \"include\"\n    })\n    .then(res => {\n      if (res.ok) {\n        setLocation(\"/admin\");\n      }\n    })\n    .catch(() => {});\n  }, [setLocation]);\n\n  useEffect(() => {\n    if (captchaType === 'cloudflare' && captchaLoaded && turnstileRef.current) {\n      renderTurnstile('login-turnstile-container');\n    }\n  }, [captchaType, captchaLoaded, renderTurnstile]);\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (honeypot) {\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      let captchaToken: string | null = null;\n      \n      if (captchaEnabled) {\n        captchaToken = await executeRecaptcha();\n        if (captchaError) {\n          toast({\n            title: \"Verification Failed\",\n            description: captchaError,\n            variant: \"destructive\",\n          });\n          setIsLoading(false);\n          return;\n        }\n      }\n\n      const response = await fetch(\"/api/auth/login\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify({ \n          username, \n          password,\n          captchaToken,\n          captchaType\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        if (data.requires2FA) {\n          setTempSessionToken(data.tempToken || \"\");\n          setHasBiometric(data.hasBiometric || false);\n          setShow2FADialog(true);\n        } else {\n          setTimeout(() => {\n            window.location.href = \"/admin\";\n          }, 100);\n        }\n      } else {\n        if (data.passwordExpired && data.userId) {\n          toast({\n            title: \"Password Expired\",\n            description: \"Your password has expired. Redirecting to reset...\",\n            variant: \"destructive\",\n          });\n          setTimeout(() => {\n            window.location.href = `/admin/force-password-reset?userId=${data.userId}`;\n          }, 1500);\n        } else {\n          toast({\n            title: \"Login Failed\",\n            description: data.message || \"Invalid credentials\",\n            variant: \"destructive\",\n          });\n        }\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to connect to server\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handle2FAVerify = async () => {\n    if (twoFactorCode.length !== 6) {\n      toast({\n        title: \"Invalid Code\",\n        description: \"Please enter a 6-digit code\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/auth/2fa/verify-login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ code: twoFactorCode }),\n      });\n\n      const data = await response.json();\n      \n      if (response.ok) {\n        setShow2FADialog(false);\n        setTimeout(() => {\n          window.location.href = \"/admin\";\n        }, 100);\n      } else {\n        toast({\n          title: \"Verification Failed\",\n          description: data.message || \"Invalid code\",\n          variant: \"destructive\",\n        });\n        setTwoFactorCode(\"\");\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to verify code\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleBiometricLogin = async () => {\n    setIsLoading(true);\n    try {\n      const optionsRes = await fetch(\"/api/auth/webauthn/login/options\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ email: username }),\n      });\n\n      if (!optionsRes.ok) {\n        throw new Error(\"Failed to get authentication options\");\n      }\n\n      const options = await optionsRes.json();\n      const credential = await startAuthentication({ optionsJSON: options });\n\n      const verifyRes = await fetch(\"/api/auth/webauthn/login/verify\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ credential }),\n      });\n\n      if (verifyRes.ok) {\n        setShow2FADialog(false);\n        setTimeout(() => {\n          window.location.href = \"/admin\";\n        }, 100);\n      } else {\n        const data = await verifyRes.json();\n        toast({\n          title: \"Biometric Login Failed\",\n          description: data.message || \"Authentication failed\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Biometric Error\",\n        description: error.message || \"Failed to authenticate\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden bg-black\">\n      <div className=\"absolute inset-0 z-0\">\n        <img \n          src={loginBg} \n          alt=\"Background\" \n          className=\"w-full h-full object-cover opacity-50\"\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent\" />\n      </div>\n\n      <div className=\"absolute inset-0 z-0 opacity-20 bg-[linear-gradient(rgba(255,255,255,0.05)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.05)_1px,transparent_1px)] bg-[size:50px_50px]\" />\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"relative z-10 w-full max-w-md px-4\"\n      >\n        <Card className=\"border-white/10 bg-black/40 backdrop-blur-xl shadow-2xl\">\n          <CardHeader className=\"text-center space-y-2 pb-6 border-b border-white/5\">\n            <div className=\"mx-auto w-12 h-12 bg-primary/20 rounded-xl flex items-center justify-center mb-2 ring-1 ring-primary/50\">\n              <Shield className=\"w-6 h-6 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl font-bold tracking-tight text-white\">Admin Access</CardTitle>\n            <CardDescription className=\"text-white/50\">\n              Enter your credentials to access the dashboard\n            </CardDescription>\n          </CardHeader>\n          \n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleLogin} className=\"space-y-4\">\n              <input\n                type=\"text\"\n                name={honeypotFieldName}\n                value={honeypot}\n                onChange={(e) => setHoneypot(e.target.value)}\n                autoComplete=\"off\"\n                tabIndex={-1}\n                style={{ position: 'absolute', left: '-9999px', opacity: 0, height: 0, width: 0 }}\n                aria-hidden=\"true\"\n              />\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Username</Label>\n                <div className=\"relative\">\n                  <User className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type=\"text\" \n                    placeholder=\"admin\" \n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    className=\"pl-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                    tabIndex={1}\n                    required \n                    data-testid=\"input-username\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n                  <Label className=\"text-white/80\">Password</Label>\n                  <a href=\"#\" className=\"text-xs text-primary hover:text-primary/80\" tabIndex={3}>Forgot password?</a>\n                </div>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showPassword ? \"text\" : \"password\"} \n                    placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                    tabIndex={2}\n                    required \n                    data-testid=\"input-password\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                    tabIndex={4}\n                    data-testid=\"button-toggle-password\"\n                  >\n                    {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              {captchaType === 'cloudflare' && (\n                <div \n                  id=\"login-turnstile-container\" \n                  ref={turnstileRef}\n                  className=\"flex justify-center\"\n                  data-testid=\"login-turnstile-container\"\n                />\n              )}\n\n              <Button \n                type=\"submit\" \n                className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2 group relative overflow-hidden\"\n                disabled={isLoading}\n                data-testid=\"button-login\"\n              >\n                <span className=\"relative z-10 flex items-center justify-center gap-2\">\n                  {isLoading ? \"Authenticating...\" : \"Sign In\"}\n                  {!isLoading && <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />}\n                </span>\n                <div className=\"absolute inset-0 bg-gradient-to-r from-primary via-purple-600 to-primary opacity-0 group-hover:opacity-100 transition-opacity duration-500\" />\n              </Button>\n            </form>\n          </CardContent>\n          \n          <CardFooter className=\"flex flex-col items-center gap-2 justify-center pt-6 border-t border-white/5\">\n            {captchaEnabled && captchaType !== 'disabled' && (\n              <div className=\"flex items-center gap-2 text-white/40\">\n                <ShieldCheck className=\"w-4 h-4\" />\n                <span className=\"text-xs\">\n                  {captchaType === 'google' && 'Protected by reCAPTCHA'}\n                  {captchaType === 'cloudflare' && 'Protected by Cloudflare'}\n                  {captchaType === 'local' && 'Spam protection enabled'}\n                </span>\n              </div>\n            )}\n            <p className=\"text-xs text-white/30 text-center\">\n              Subject to Privacy Policy and Terms of Service.\n            </p>\n          </CardFooter>\n        </Card>\n      </motion.div>\n\n      <Dialog open={show2FADialog} onOpenChange={setShow2FADialog}>\n        <DialogContent className=\"sm:max-w-md bg-black/90 border-white/10 text-white\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <KeyRound className=\"w-5 h-5 text-primary\" />\n              Two-Factor Authentication\n            </DialogTitle>\n            <DialogDescription className=\"text-white/60\">\n              Enter the 6-digit code from your authenticator app\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-6 py-4\">\n            <div className=\"flex justify-center\">\n              <InputOTP\n                maxLength={6}\n                value={twoFactorCode}\n                onChange={setTwoFactorCode}\n                data-testid=\"input-2fa-code\"\n              >\n                <InputOTPGroup>\n                  <InputOTPSlot index={0} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={1} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={2} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={3} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={4} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={5} className=\"bg-white/5 border-white/20 text-white\" />\n                </InputOTPGroup>\n              </InputOTP>\n            </div>\n\n            {hasBiometric && (\n              <div className=\"text-center\">\n                <p className=\"text-sm text-white/40 mb-3\">Or use your registered biometric</p>\n                <Button\n                  variant=\"outline\"\n                  onClick={handleBiometricLogin}\n                  disabled={isLoading}\n                  className=\"border-white/20 text-white/80\"\n                  data-testid=\"button-biometric-login\"\n                >\n                  <Fingerprint className=\"w-4 h-4 mr-2\" />\n                  Use Biometric\n                </Button>\n              </div>\n            )}\n          </div>\n\n          <DialogFooter className=\"flex gap-2\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => {\n                setShow2FADialog(false);\n                setTwoFactorCode(\"\");\n              }}\n              className=\"text-white/60\"\n              data-testid=\"button-cancel-2fa\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handle2FAVerify}\n              disabled={isLoading || twoFactorCode.length !== 6}\n              className=\"bg-primary text-white\"\n              data-testid=\"button-verify-2fa\"\n            >\n              {isLoading ? \"Verifying...\" : \"Verify\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":16003,"size_tokens":null},"client/src/pages/admin/Notifications.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Bell, Mail, MessageSquare, CheckCircle, Trash2, AlertCircle, Search, Filter, Check, Star } from \"lucide-react\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ntype NotificationItem = {\n  id: string;\n  type: 'message' | 'comment' | 'review';\n  sender: string;\n  content: string;\n  subject?: string;\n  read: boolean;\n  createdAt: Date | null;\n  originalId: number;\n  rating?: number;\n};\n\nexport default function AdminNotifications() {\n  const { toast } = useToast();\n  const [emailNotif, setEmailNotif] = useState(true);\n  const [commentAlerts, setCommentAlerts] = useState(true);\n  const [systemUpdates, setSystemUpdates] = useState(true);\n  const [newsletterStats, setNewsletterStats] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [filterRead, setFilterRead] = useState<string>(\"all\");\n\n  const { data: messages = [], refetch: refetchMessages } = useQuery<any[]>({\n    queryKey: ['/api/messages'],\n  });\n\n  const { data: comments = [], refetch: refetchComments } = useQuery<any[]>({\n    queryKey: ['/api/comments'],\n  });\n\n  const { data: reviews = [], refetch: refetchReviews } = useQuery<any[]>({\n    queryKey: ['/api/reviews'],\n  });\n\n  const markMessageReadMutation = useMutation({\n    mutationFn: (id: number) => api.markMessageAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      await refetchMessages();\n    },\n  });\n\n  const markCommentReadMutation = useMutation({\n    mutationFn: (id: number) => api.markCommentAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      await refetchComments();\n    },\n  });\n\n  const markReviewReadMutation = useMutation({\n    mutationFn: (id: number) => api.markReviewAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      await refetchReviews();\n    },\n  });\n\n  const archiveMessageMutation = useMutation({\n    mutationFn: (id: number) => api.archiveMessage(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      await refetchMessages();\n    },\n  });\n\n  const archiveCommentMutation = useMutation({\n    mutationFn: (id: number) => api.archiveComment(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      await refetchComments();\n    },\n  });\n\n  const archiveReviewMutation = useMutation({\n    mutationFn: (id: number) => api.archiveReview(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      await refetchReviews();\n    },\n  });\n\n  const allNotifications: NotificationItem[] = [\n    ...messages.filter(m => !m.archived).map(m => ({\n      id: `msg-${m.id}`,\n      type: 'message' as const,\n      sender: m.sender || 'Unknown',\n      content: m.message || '',\n      subject: m.subject || undefined,\n      read: m.read,\n      createdAt: m.createdAt ? new Date(m.createdAt) : null,\n      originalId: m.id,\n    })),\n    ...comments.filter((c: any) => !c.archived).map((c: any) => ({\n      id: `comment-${c.id}`,\n      type: 'comment' as const,\n      sender: c.authorName || 'Unknown',\n      content: c.content || '',\n      subject: 'New comment',\n      read: c.read || false,\n      createdAt: c.createdAt ? new Date(c.createdAt) : null,\n      originalId: c.id,\n    })),\n    ...reviews.filter((r: any) => !r.archived).map((r: any) => ({\n      id: `review-${r.id}`,\n      type: 'review' as const,\n      sender: r.authorName || 'Unknown',\n      content: r.content || '',\n      subject: `${r.rating || 5}-star review`,\n      read: r.read || false,\n      createdAt: r.createdAt ? new Date(r.createdAt) : null,\n      originalId: r.id,\n      rating: r.rating,\n    })),\n  ].sort((a, b) => {\n    const dateA = a.createdAt ? a.createdAt.getTime() : 0;\n    const dateB = b.createdAt ? b.createdAt.getTime() : 0;\n    return dateB - dateA;\n  });\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case \"comment\":\n        return <MessageSquare className=\"w-4 h-4\" />;\n      case \"message\":\n        return <Mail className=\"w-4 h-4\" />;\n      case \"review\":\n        return <Star className=\"w-4 h-4\" />;\n      default:\n        return <Bell className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case \"comment\":\n        return \"bg-blue-500/10 text-blue-500 border-blue-500/20\";\n      case \"message\":\n        return \"bg-green-500/10 text-green-500 border-green-500/20\";\n      case \"review\":\n        return \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\";\n      default:\n        return \"bg-muted text-muted-foreground border-border\";\n    }\n  };\n\n  const unreadCount = allNotifications.filter(n => !n.read).length;\n\n  const filteredNotifications = allNotifications.filter(notif => {\n    const matchesSearch = searchQuery === \"\" || \n      notif.sender?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      notif.subject?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      notif.content?.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesType = filterType === \"all\" || notif.type === filterType;\n    const matchesRead = filterRead === \"all\" || \n      (filterRead === \"unread\" && !notif.read) ||\n      (filterRead === \"read\" && notif.read);\n\n    return matchesSearch && matchesType && matchesRead;\n  });\n\n  const handleMarkAllAsRead = async () => {\n    const unreadMessages = messages.filter(m => !m.read);\n    const unreadComments = comments.filter((c: any) => !c.read);\n    const unreadReviews = reviews.filter((r: any) => !r.read);\n    const totalUnread = unreadMessages.length + unreadComments.length + unreadReviews.length;\n    \n    if (totalUnread === 0) {\n      toast({ title: \"Info\", description: \"All notifications are already read\" });\n      return;\n    }\n    \n    try {\n      for (const msg of unreadMessages) {\n        await markMessageReadMutation.mutateAsync(msg.id);\n      }\n      for (const comment of unreadComments) {\n        await markCommentReadMutation.mutateAsync(comment.id);\n      }\n      for (const review of unreadReviews) {\n        await markReviewReadMutation.mutateAsync(review.id);\n      }\n      \n      // Refetch all data to update UI\n      await Promise.all([\n        refetchMessages(),\n        refetchComments(),\n        refetchReviews()\n      ]);\n      \n      toast({ title: \"Success\", description: `Marked all ${totalUnread} notifications as read` });\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to mark notifications as read\", variant: \"destructive\" });\n    }\n  };\n\n  const handleClearAll = async () => {\n    const total = allNotifications.length;\n    if (total === 0) {\n      toast({ title: \"Info\", description: \"No notifications to clear\" });\n      return;\n    }\n    \n    if (confirm(`Clear all ${total} notifications?\\n\\nThis will hide all notifications from this list. The original data will be preserved.`)) {\n      try {\n        // Archive messages that are not archived\n        const messagesToArchive = messages.filter(m => !m.archived);\n        for (const msg of messagesToArchive) {\n          await archiveMessageMutation.mutateAsync(msg.id);\n        }\n        \n        // Archive all unarchived comments\n        const commentsToArchive = comments.filter((c: any) => !c.archived);\n        for (const comment of commentsToArchive) {\n          await archiveCommentMutation.mutateAsync(comment.id);\n        }\n        \n        // Archive all unarchived reviews\n        const reviewsToArchive = reviews.filter((r: any) => !r.archived);\n        for (const review of reviewsToArchive) {\n          await archiveReviewMutation.mutateAsync(review.id);\n        }\n        \n        toast({ title: \"Success\", description: `Cleared all ${total} notifications` });\n      } catch (error) {\n        toast({ title: \"Error\", description: \"Failed to clear notifications\", variant: \"destructive\" });\n      }\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Notifications</h1>\n            <p className=\"text-muted-foreground\">\n              Manage system and contact form notifications\n              {unreadCount > 0 && (\n                <span className=\"ml-2 text-primary font-medium\">\n                  ({unreadCount} unread)\n                </span>\n              )}\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={handleMarkAllAsRead}\n              disabled={unreadCount === 0}\n              title=\"Mark all notifications as read\"\n              data-testid=\"button-mark-all-read\"\n            >\n              <Check className=\"w-4 h-4 mr-2\" />\n              Mark All Read\n            </Button>\n            <Button \n              variant=\"outline\" \n              onClick={handleClearAll}\n              disabled={allNotifications.length === 0}\n              title=\"Mark all notifications as read\"\n              data-testid=\"button-clear-all\"\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" />\n              Clear All\n            </Button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  type=\"search\"\n                  placeholder=\"Search notifications...\"\n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                />\n              </div>\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" className=\"gap-2\">\n                    <Filter className=\"w-4 h-4\" />\n                    Type: {filterType === \"all\" ? \"All\" : filterType}\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuItem onClick={() => setFilterType(\"all\")}>\n                    All Types\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"message\")}>\n                    Messages\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"comment\")}>\n                    Comments\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"review\")}>\n                    Reviews\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" className=\"gap-2\">\n                    <Filter className=\"w-4 h-4\" />\n                    Status: {filterRead === \"all\" ? \"All\" : filterRead === \"unread\" ? \"Unread\" : \"Read\"}\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuItem onClick={() => setFilterRead(\"all\")}>\n                    All\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterRead(\"unread\")}>\n                    Unread Only\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterRead(\"read\")}>\n                    Read Only\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Notifications List */}\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-between\">\n                  <span>All Notifications ({filteredNotifications.length})</span>\n                  {filteredNotifications.length > 0 && (\n                    <Badge variant=\"secondary\">\n                      {filteredNotifications.filter(n => !n.read).length} unread\n                    </Badge>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n                {filteredNotifications.length === 0 ? (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Bell className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p className=\"text-lg font-medium\">No notifications found</p>\n                    <p className=\"text-sm mt-1\">\n                      {searchQuery || filterType !== \"all\" || filterRead !== \"all\"\n                        ? \"Try adjusting your filters\"\n                        : \"You're all caught up!\"}\n                    </p>\n                  </div>\n                ) : (\n                  filteredNotifications.map((notif) => (\n                    <div\n                      key={notif.id}\n                      className={`flex items-start gap-4 p-4 rounded-lg border transition-all ${\n                        !notif.read\n                          ? \"bg-primary/5 border-primary/20 shadow-sm\"\n                          : \"border-border hover:bg-muted/50\"\n                      }`}\n                    >\n                      <div className={`p-2.5 rounded-full border ${getTypeColor(notif.type)}`}>\n                        {getTypeIcon(notif.type)}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2 justify-between mb-1\">\n                          <div className=\"flex items-center gap-2\">\n                            <p className=\"font-medium text-sm truncate\">\n                              {notif.sender}\n                            </p>\n                            {!notif.read && (\n                              <Badge variant=\"default\" className=\"h-5 px-1.5 text-xs\">\n                                New\n                              </Badge>\n                            )}\n                          </div>\n                          {notif.createdAt && (\n                            <span className=\"text-xs text-muted-foreground flex-shrink-0\">\n                              {formatDistanceToNow(notif.createdAt, {\n                                addSuffix: true,\n                              })}\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm font-medium truncate mb-1\">\n                          {notif.subject || \"No subject\"}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                          {notif.content || \"No content\"}\n                        </p>\n                      </div>\n                      <div className=\"flex gap-1 flex-shrink-0\">\n                        {notif.type === 'message' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markMessageReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'comment' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markCommentReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'review' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markReviewReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'message' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveMessageMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'comment' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveCommentMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'review' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveReviewMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"space-y-4\">\n            {/* Quick Stats */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertCircle className=\"w-4 h-4\" />\n                  Quick Stats\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-primary/5 border border-primary/10\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Unread Total</p>\n                    <p className=\"text-2xl font-bold text-primary\">{unreadCount}</p>\n                  </div>\n                  <Bell className=\"w-8 h-8 text-primary/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Messages</p>\n                    <p className=\"text-2xl font-bold\">\n                      {messages.filter(m => !m.archived && !m.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {messages.filter(m => !m.archived).length}</span>\n                    </p>\n                  </div>\n                  <Mail className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Comments</p>\n                    <p className=\"text-2xl font-bold\">\n                      {comments.filter((c: any) => !c.archived && !c.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {comments.filter((c: any) => !c.archived).length}</span>\n                    </p>\n                  </div>\n                  <MessageSquare className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Reviews</p>\n                    <p className=\"text-2xl font-bold\">\n                      {reviews.filter((r: any) => !r.archived && !r.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {reviews.filter((r: any) => !r.archived).length}</span>\n                    </p>\n                  </div>\n                  <Star className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Notification Settings */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification Settings</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Email Notifications</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Receive notifications via email\n                    </p>\n                  </div>\n                  <Switch checked={emailNotif} onCheckedChange={setEmailNotif} />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Comment Alerts</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      New comments on posts\n                    </p>\n                  </div>\n                  <Switch\n                    checked={commentAlerts}\n                    onCheckedChange={setCommentAlerts}\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">System Updates</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Important system events\n                    </p>\n                  </div>\n                  <Switch\n                    checked={systemUpdates}\n                    onCheckedChange={setSystemUpdates}\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Newsletter Stats</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Weekly subscriber updates\n                    </p>\n                  </div>\n                  <Switch\n                    checked={newsletterStats}\n                    onCheckedChange={setNewsletterStats}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":26246,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/pages/admin/Editor.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Code, Play, Save, Loader2, Check, RotateCcw } from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst DEFAULT_CSS = `/* Add your custom CSS here */\n\n.custom-hero-title {\n  background: linear-gradient(to right, #ff00cc, #333399);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n\n.custom-section {\n  padding: 2rem;\n}`;\n\nconst DEFAULT_JS = `// Add your custom JS here\n\nconsole.log('Custom script loaded');\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Your code here\n});`;\n\nconst DEFAULT_HEADER = `<!-- Google Analytics -->\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-Y\"></script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'UA-XXXXX-Y');\n</script>`;\n\nexport default function AdminEditor() {\n  const { toast } = useToast();\n  const [customCSS, setCustomCSS] = useState(DEFAULT_CSS);\n  const [customJS, setCustomJS] = useState(DEFAULT_JS);\n  const [headerScripts, setHeaderScripts] = useState(DEFAULT_HEADER);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [previewOpen, setPreviewOpen] = useState(false);\n\n  const { data: settings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: ['/api/settings'],\n  });\n\n  useEffect(() => {\n    if (settings) {\n      if (settings.customCSS !== undefined) setCustomCSS(settings.customCSS || DEFAULT_CSS);\n      if (settings.customJS !== undefined) setCustomJS(settings.customJS || DEFAULT_JS);\n      if (settings.headerScripts !== undefined) setHeaderScripts(settings.headerScripts || DEFAULT_HEADER);\n    }\n  }, [settings]);\n\n  const saveMutation = useMutation({\n    mutationFn: async () => {\n      return api.updateSettings({\n        customCSS,\n        customJS,\n        headerScripts,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      setHasChanges(false);\n      toast({\n        title: \"Saved\",\n        description: \"Custom code saved successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to save custom code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCSSChange = (value: string) => {\n    setCustomCSS(value);\n    setHasChanges(true);\n  };\n\n  const handleJSChange = (value: string) => {\n    setCustomJS(value);\n    setHasChanges(true);\n  };\n\n  const handleHeaderChange = (value: string) => {\n    setHeaderScripts(value);\n    setHasChanges(true);\n  };\n\n  const handleReset = (type: 'css' | 'js' | 'header') => {\n    switch (type) {\n      case 'css':\n        setCustomCSS(DEFAULT_CSS);\n        break;\n      case 'js':\n        setCustomJS(DEFAULT_JS);\n        break;\n      case 'header':\n        setHeaderScripts(DEFAULT_HEADER);\n        break;\n    }\n    setHasChanges(true);\n  };\n\n  const handlePreview = () => {\n    const previewWindow = window.open('', '_blank');\n    if (previewWindow) {\n      previewWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Preview</title>\n          ${headerScripts}\n          <style>\n            body { font-family: system-ui, sans-serif; padding: 2rem; background: #1a1a2e; color: #fff; }\n            ${customCSS}\n          </style>\n        </head>\n        <body>\n          <h1 class=\"custom-hero-title\">Custom CSS Preview</h1>\n          <div class=\"custom-section\">\n            <p>This is a preview of your custom styles.</p>\n          </div>\n          <script>\n            ${customJS}\n          </script>\n        </body>\n        </html>\n      `);\n      previewWindow.document.close();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6 h-[calc(100vh-8rem)] flex flex-col\">\n        <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-editor-title\">Code Editor</h1>\n            <p className=\"text-muted-foreground\">Customize your site's code directly</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handlePreview} data-testid=\"button-preview\">\n              <Play className=\"w-4 h-4 mr-2\" /> Preview\n            </Button>\n            <Button \n              onClick={() => saveMutation.mutate()}\n              disabled={saveMutation.isPending || !hasChanges}\n              data-testid=\"button-save\"\n            >\n              {saveMutation.isPending ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : hasChanges ? (\n                <Save className=\"w-4 h-4 mr-2\" />\n              ) : (\n                <Check className=\"w-4 h-4 mr-2\" />\n              )}\n              {saveMutation.isPending ? \"Saving...\" : hasChanges ? \"Save Changes\" : \"Saved\"}\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"css\" className=\"flex-1 flex flex-col\">\n          <TabsList>\n            <TabsTrigger value=\"css\" data-testid=\"tab-css\">Custom CSS</TabsTrigger>\n            <TabsTrigger value=\"js\" data-testid=\"tab-js\">Custom JS</TabsTrigger>\n            <TabsTrigger value=\"header\" data-testid=\"tab-header\">Header Scripts</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"css\" className=\"flex-1 mt-4\">\n            <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <CardTitle className=\"text-sm font-mono\">style.css</CardTitle>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('css')}\n                  data-testid=\"button-reset-css\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={customCSS}\n                  onChange={(e) => handleCSSChange(e.target.value)}\n                  placeholder=\"/* Enter your custom CSS here */\"\n                  spellCheck={false}\n                  data-testid=\"textarea-css\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          <TabsContent value=\"js\" className=\"flex-1 mt-4\">\n            <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <CardTitle className=\"text-sm font-mono\">script.js</CardTitle>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('js')}\n                  data-testid=\"button-reset-js\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={customJS}\n                  onChange={(e) => handleJSChange(e.target.value)}\n                  placeholder=\"// Enter your custom JavaScript here\"\n                  spellCheck={false}\n                  data-testid=\"textarea-js\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"header\" className=\"flex-1 mt-4\">\n             <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <div>\n                  <CardTitle className=\"text-sm font-mono\">head-scripts.html</CardTitle>\n                  <CardDescription>Google Analytics, Meta Tags, etc.</CardDescription>\n                </div>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('header')}\n                  data-testid=\"button-reset-header\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={headerScripts}\n                  onChange={(e) => handleHeaderChange(e.target.value)}\n                  placeholder=\"<!-- Enter your header scripts here -->\"\n                  spellCheck={false}\n                  data-testid=\"textarea-header\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9880,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/admin/APIKeys.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Copy, Eye, EyeOff, Trash, Calendar } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminAPIKeys() {\n  const [visibility, setVisibility] = useState<Record<number, boolean>>({});\n\n  const keys = [\n    { id: 1, name: \"Production API Key\", key: \"sk_live_abcd1234efgh5678ijkl\", created: \"Mar 15, 2024\", lastUsed: \"Today at 2:30 PM\", status: \"Active\" },\n    { id: 2, name: \"Development Key\", key: \"sk_test_xyz9876543210abcd\", created: \"Mar 10, 2024\", lastUsed: \"Mar 19 at 10:45 AM\", status: \"Active\" },\n    { id: 3, name: \"Staging Environment\", key: \"sk_stage_abcdefg123456789\", created: \"Feb 28, 2024\", lastUsed: \"Never\", status: \"Inactive\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">API Keys</h1>\n            <p className=\"text-muted-foreground\">Manage API authentication tokens</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Create New Key\n          </Button>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Active API Keys</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {keys.map((key) => (\n              <div key={key.id} className=\"border border-border rounded-lg p-4 hover:bg-muted/50 transition-colors group\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-3\">\n                  <div>\n                    <h3 className=\"font-bold\">{key.name}</h3>\n                    <Badge variant={key.status === \"Active\" ? \"default\" : \"secondary\"}>{key.status}</Badge>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                      {visibility[key.id] ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                      {visibility[key.id] ? \"Hide\" : \"Show\"}\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                      <Copy className=\"w-4 h-4\" /> Copy\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2 text-destructive\">\n                      <Trash className=\"w-4 h-4\" /> Delete\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"bg-muted/50 p-3 rounded font-mono text-sm break-all mb-3\">\n                  {visibility[key.id] ? key.key : \"â€¢\".repeat(key.key.length)}\n                </div>\n                <div className=\"flex flex-col sm:flex-row gap-4 text-xs text-muted-foreground\">\n                  <div className=\"flex items-center gap-1\">\n                    <Calendar className=\"w-3 h-3\" /> Created: {key.created}\n                  </div>\n                  <div>Last Used: {key.lastUsed}</div>\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>API Key Security</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>API keys are stored securely and never displayed again after creation</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>Rotate keys regularly for enhanced security</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-yellow-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>Never commit API keys to version control</p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4272,"size_tokens":null},"client/src/pages/admin/Security.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Shield, Key, Lock, Smartphone, Globe, AlertTriangle, Shield as ShieldIcon } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminSecurity() {\n  const [recaptcha, setRecaptcha] = useState<'disabled' | 'local' | 'google' | 'cloudflare'>('google');\n  const [twoFaEnabled, setTwoFaEnabled] = useState(false);\n  const [passwordExpiration, setPasswordExpiration] = useState(true);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">Security Center</h1>\n          <p className=\"text-muted-foreground\">Monitor and configure security settings</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n           <Card className=\"border-green-500/50 bg-green-500/5\">\n             <CardContent className=\"pt-6 flex items-center gap-4\">\n               <div className=\"p-3 rounded-full bg-green-500/20 text-green-500\">\n                 <Shield className=\"w-6 h-6\" />\n               </div>\n               <div>\n                 <div className=\"font-bold text-lg\">System Secure</div>\n                 <div className=\"text-sm text-muted-foreground\">No threats detected</div>\n               </div>\n             </CardContent>\n           </Card>\n           <Card>\n             <CardContent className=\"pt-6 flex items-center gap-4\">\n               <div className=\"p-3 rounded-full bg-primary/20 text-primary\">\n                 <Lock className=\"w-6 h-6\" />\n               </div>\n               <div>\n                 <div className=\"font-bold text-lg\">SSL Certificate</div>\n                 <div className=\"text-sm text-muted-foreground\">Valid until Dec 2025</div>\n               </div>\n             </CardContent>\n           </Card>\n           <Card>\n             <CardContent className=\"pt-6 flex items-center gap-4\">\n               <div className=\"p-3 rounded-full bg-yellow-500/20 text-yellow-500\">\n                 <AlertTriangle className=\"w-6 h-6\" />\n               </div>\n               <div>\n                 <div className=\"font-bold text-lg\">2 Warnings</div>\n                 <div className=\"text-sm text-muted-foreground\">Check login attempts</div>\n               </div>\n             </CardContent>\n           </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Authentication</CardTitle>\n              <CardDescription>Manage how users log in</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <Smartphone className=\"w-5 h-5 text-muted-foreground\" />\n                  <div>\n                    <div className=\"font-medium\">Two-Factor Authentication (2FA)</div>\n                    <div className=\"text-sm text-muted-foreground\">Secure account with mobile app</div>\n                  </div>\n                </div>\n                <Switch checked={twoFaEnabled} onCheckedChange={setTwoFaEnabled} />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <Key className=\"w-5 h-5 text-muted-foreground\" />\n                  <div>\n                    <div className=\"font-medium\">Password Expiration</div>\n                    <div className=\"text-sm text-muted-foreground\">Force reset every 90 days</div>\n                  </div>\n                </div>\n                <Switch checked={passwordExpiration} onCheckedChange={setPasswordExpiration} />\n              </div>\n              <Button variant=\"outline\" className=\"w-full\">Change Master Password</Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>reCAPTCHA Protection</CardTitle>\n              <CardDescription>Bot protection for forms and login</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <label className=\"flex items-center gap-3 cursor-pointer\">\n                  <input \n                    type=\"radio\" \n                    name=\"recaptcha\" \n                    value=\"google\"\n                    checked={recaptcha === 'google'}\n                    onChange={(e) => setRecaptcha(e.target.value as any)}\n                    className=\"w-4 h-4\"\n                  />\n                  <div>\n                    <div className=\"font-medium text-sm\">Google reCAPTCHA v3</div>\n                    <div className=\"text-xs text-muted-foreground\">Invisible, no user interaction required</div>\n                  </div>\n                </label>\n                <label className=\"flex items-center gap-3 cursor-pointer\">\n                  <input \n                    type=\"radio\" \n                    name=\"recaptcha\" \n                    value=\"cloudflare\"\n                    checked={recaptcha === 'cloudflare'}\n                    onChange={(e) => setRecaptcha(e.target.value as any)}\n                    className=\"w-4 h-4\"\n                  />\n                  <div>\n                    <div className=\"font-medium text-sm\">Cloudflare Turnstile</div>\n                    <div className=\"text-xs text-muted-foreground\">Privacy-first, works with adblockers</div>\n                  </div>\n                </label>\n                <label className=\"flex items-center gap-3 cursor-pointer\">\n                  <input \n                    type=\"radio\" \n                    name=\"recaptcha\" \n                    value=\"local\"\n                    checked={recaptcha === 'local'}\n                    onChange={(e) => setRecaptcha(e.target.value as any)}\n                    className=\"w-4 h-4\"\n                  />\n                  <div>\n                    <div className=\"font-medium text-sm\">Local Verification</div>\n                    <div className=\"text-xs text-muted-foreground\">Server-side validation only</div>\n                  </div>\n                </label>\n                <label className=\"flex items-center gap-3 cursor-pointer\">\n                  <input \n                    type=\"radio\" \n                    name=\"recaptcha\" \n                    value=\"disabled\"\n                    checked={recaptcha === 'disabled'}\n                    onChange={(e) => setRecaptcha(e.target.value as any)}\n                    className=\"w-4 h-4\"\n                  />\n                  <div>\n                    <div className=\"font-medium text-sm\">Disabled</div>\n                    <div className=\"text-xs text-muted-foreground\">No protection enabled</div>\n                  </div>\n                </label>\n              </div>\n              {recaptcha !== 'disabled' && recaptcha !== 'local' && (\n                <Button variant=\"outline\" className=\"w-full\">\n                  Configure {recaptcha === 'google' ? 'Google' : 'Cloudflare'} Keys\n                </Button>\n              )}\n              <Button variant=\"outline\" className=\"w-full\">Save Settings</Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Recent Activity</CardTitle>\n              <CardDescription>Login attempts and sensitive actions</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {[\n                  { action: \"Login Success\", ip: \"192.168.1.1\", loc: \"Ho Chi Minh, VN\", time: \"Just now\", status: \"success\" },\n                  { action: \"Settings Updated\", ip: \"192.168.1.1\", loc: \"Ho Chi Minh, VN\", time: \"2 hours ago\", status: \"success\" },\n                  { action: \"Failed Login\", ip: \"14.23.55.12\", loc: \"Hanoi, VN\", time: \"5 hours ago\", status: \"failed\" },\n                  { action: \"Backup Created\", ip: \"System\", loc: \"Server\", time: \"Yesterday\", status: \"success\" },\n                ].map((log, i) => (\n                  <div key={i} className=\"flex items-center justify-between border-b border-border pb-2 last:border-0\">\n                    <div className=\"flex items-center gap-3\">\n                       <div className={`w-2 h-2 rounded-full ${log.status === \"success\" ? \"bg-green-500\" : \"bg-red-500\"}`} />\n                       <div>\n                         <div className=\"font-medium text-sm\">{log.action}</div>\n                         <div className=\"text-xs text-muted-foreground\">{log.ip} â€¢ {log.loc}</div>\n                       </div>\n                    </div>\n                    <div className=\"text-xs text-muted-foreground\">{log.time}</div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9081,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/pages/admin/Skills.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Label } from \"@/components/ui/label\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash,\n  Code,\n  Database,\n  Server,\n  Wrench,\n  Loader2,\n  Save,\n  X\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Skill {\n  id: number;\n  name: string;\n  category: string;\n  level: number;\n  icon: string | null;\n  order: number;\n  createdAt: Date | null;\n}\n\nconst skillCategories = [\"Frontend\", \"Backend\", \"Database\", \"DevOps\", \"Tools\", \"Other\"];\n\nconst getCategoryIcon = (category: string) => {\n  switch (category.toLowerCase()) {\n    case 'frontend':\n      return <Code className=\"w-6 h-6 text-blue-500\" />;\n    case 'backend':\n      return <Server className=\"w-6 h-6 text-green-500\" />;\n    case 'database':\n      return <Database className=\"w-6 h-6 text-yellow-500\" />;\n    case 'devops':\n    case 'tools':\n    default:\n      return <Wrench className=\"w-6 h-6 text-purple-500\" />;\n  }\n};\n\nconst getLevelLabel = (level: number) => {\n  if (level >= 90) return \"Expert\";\n  if (level >= 70) return \"Advanced\";\n  if (level >= 50) return \"Intermediate\";\n  if (level >= 30) return \"Beginner\";\n  return \"Learning\";\n};\n\nconst getLevelColor = (level: number) => {\n  if (level >= 90) return \"bg-green-500/10 text-green-500 border-green-500/20\";\n  if (level >= 70) return \"bg-blue-500/10 text-blue-500 border-blue-500/20\";\n  if (level >= 50) return \"bg-yellow-500/10 text-yellow-600 border-yellow-500/20\";\n  return \"bg-gray-500/10 text-gray-500 border-gray-500/20\";\n};\n\nexport default function AdminSkills() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"all\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [editingSkill, setEditingSkill] = useState<Skill | null>(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    category: \"Frontend\",\n    level: 50,\n    icon: \"\",\n    order: 0,\n  });\n\n  const { data: skills = [], isLoading, refetch } = useQuery<Skill[]>({\n    queryKey: ['/api/skills'],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createSkill(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill created successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: typeof formData }) => api.updateSkill(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill updated successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteSkill(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData({ name: \"\", category: \"Frontend\", level: 50, icon: \"\", order: 0 });\n    setEditingSkill(null);\n  };\n\n  const handleOpenCreate = () => {\n    resetForm();\n    setDialogOpen(true);\n  };\n\n  const handleOpenEdit = (skill: Skill) => {\n    setEditingSkill(skill);\n    setFormData({\n      name: skill.name,\n      category: skill.category,\n      level: skill.level,\n      icon: skill.icon || \"\",\n      order: skill.order,\n    });\n    setDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim()) {\n      toast({ title: \"Error\", description: \"Skill name is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingSkill) {\n      updateMutation.mutate({ id: editingSkill.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete skill \"${name}\"? This action cannot be undone.`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredSkills = skills.filter(skill => {\n    const matchesSearch = searchQuery === \"\" || \n      skill.name.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesCategory = activeTab === \"all\" || \n      skill.category.toLowerCase() === activeTab.toLowerCase();\n    return matchesSearch && matchesCategory;\n  });\n\n  const groupedSkills: Record<string, Skill[]> = {};\n  filteredSkills.forEach(skill => {\n    const cat = skill.category || 'Other';\n    if (!groupedSkills[cat]) groupedSkills[cat] = [];\n    groupedSkills[cat].push(skill);\n  });\n\n  const availableCategories = Array.from(new Set(skills.map(s => s.category))).filter(Boolean) as string[];\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Skills & Technologies</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your technical expertise ({skills.length} skills)\n            </p>\n          </div>\n          <Button onClick={handleOpenCreate} data-testid=\"button-add-skill\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add New Skill\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6\">\n            <TabsList className=\"flex-wrap h-auto\">\n              <TabsTrigger value=\"all\">All ({skills.length})</TabsTrigger>\n              {availableCategories.map(cat => (\n                <TabsTrigger key={cat} value={cat.toLowerCase()}>\n                  {cat} ({skills.filter(s => s.category === cat).length})\n                </TabsTrigger>\n              ))}\n            </TabsList>\n             \n            <div className=\"relative w-full sm:w-64\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input \n                placeholder=\"Search skills...\" \n                className=\"pl-9\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                data-testid=\"input-search-skills\"\n              />\n            </div>\n          </div>\n\n          <TabsContent value={activeTab} className=\"mt-0\">\n            {filteredSkills.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Wrench className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No skills found</h3>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    {searchQuery ? \"Try adjusting your search\" : \"Start by adding your first skill\"}\n                  </p>\n                  <Button onClick={handleOpenCreate}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Skill\n                  </Button>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {filteredSkills.map((skill) => (\n                  <Card key={skill.id} className=\"group hover:border-primary/50 transition-colors\" data-testid={`card-skill-${skill.id}`}>\n                    <CardContent className=\"p-4 flex items-center justify-between gap-4\">\n                      <div className=\"flex items-center gap-4 min-w-0\">\n                        <div className=\"w-12 h-12 rounded-lg bg-muted flex items-center justify-center flex-shrink-0\">\n                          {getCategoryIcon(skill.category)}\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-bold truncate\">{skill.name}</h3>\n                          <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n                            <Badge variant=\"secondary\" className={`text-[10px] ${getLevelColor(skill.level)}`}>\n                              {getLevelLabel(skill.level)}\n                            </Badge>\n                            <span className=\"text-xs text-muted-foreground\">{skill.level}%</span>\n                          </div>\n                        </div>\n                      </div>\n                       \n                      <div className=\"flex gap-1 invisible group-hover:visible transition-all flex-shrink-0\">\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          onClick={() => handleOpenEdit(skill)}\n                          data-testid={`button-edit-skill-${skill.id}`}\n                        >\n                          <Edit className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          className=\"text-destructive\"\n                          onClick={() => handleDelete(skill.id, skill.name)}\n                          data-testid={`button-delete-skill-${skill.id}`}\n                        >\n                          <Trash className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n                 \n                <div \n                  onClick={handleOpenCreate}\n                  className=\"border-2 border-dashed border-muted-foreground/20 rounded-xl flex flex-col items-center justify-center p-6 cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all h-full min-h-[88px]\"\n                  data-testid=\"button-add-skill-card\"\n                >\n                  <Plus className=\"w-6 h-6 text-muted-foreground mb-2\" />\n                  <span className=\"text-sm font-medium text-muted-foreground\">Add new skill</span>\n                </div>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n\n        <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>{editingSkill ? \"Edit Skill\" : \"Add New Skill\"}</DialogTitle>\n              <DialogDescription>\n                {editingSkill ? \"Update the skill details below\" : \"Fill in the details for your new skill\"}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-5 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-name\">Skill Name *</Label>\n                <Input\n                  id=\"skill-name\"\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., React.js, Node.js, PostgreSQL\"\n                  data-testid=\"input-skill-name\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-skill-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {skillCategories.map(cat => (\n                      <SelectItem key={cat} value={cat}>{cat}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <Label>Proficiency Level</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Badge variant=\"secondary\" className={getLevelColor(formData.level)}>\n                      {getLevelLabel(formData.level)}\n                    </Badge>\n                    <span className=\"text-sm font-mono text-muted-foreground\">{formData.level}%</span>\n                  </div>\n                </div>\n                <Slider\n                  value={[formData.level]}\n                  onValueChange={(value) => setFormData({ ...formData, level: value[0] })}\n                  min={0}\n                  max={100}\n                  step={5}\n                  className=\"w-full\"\n                  data-testid=\"slider-skill-level\"\n                />\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\n                  <span>Beginner</span>\n                  <span>Intermediate</span>\n                  <span>Expert</span>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-icon\">Icon (optional)</Label>\n                <Input\n                  id=\"skill-icon\"\n                  value={formData.icon}\n                  onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                  placeholder=\"Icon name or URL\"\n                  data-testid=\"input-skill-icon\"\n                />\n                <p className=\"text-xs text-muted-foreground\">Leave empty to use default category icon</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-order\">Display Order</Label>\n                <Input\n                  id=\"skill-order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) => setFormData({ ...formData, order: parseInt(e.target.value) || 0 })}\n                  placeholder=\"0\"\n                  data-testid=\"input-skill-order\"\n                />\n                <p className=\"text-xs text-muted-foreground\">Lower numbers appear first</p>\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button \n                onClick={handleSubmit} \n                disabled={createMutation.isPending || updateMutation.isPending}\n                data-testid=\"button-save-skill\"\n              >\n                {(createMutation.isPending || updateMutation.isPending) ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Save className=\"w-4 h-4 mr-2\" />\n                )}\n                {editingSkill ? \"Update\" : \"Create\"} Skill\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":16433,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1163,"size_tokens":null},"client/src/pages/admin/PageBuilder.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Layout, \n  Type, \n  Image as ImageIcon,\n  Square,\n  Columns,\n  Plus,\n  Trash2,\n  Eye,\n  Save,\n  GripVertical\n} from \"lucide-react\";\n\nexport default function AdminPageBuilder() {\n  const components = [\n    { icon: Type, name: \"Text Block\", color: \"text-blue-500\" },\n    { icon: ImageIcon, name: \"Image\", color: \"text-green-500\" },\n    { icon: Square, name: \"Button\", color: \"text-purple-500\" },\n    { icon: Columns, name: \"2 Columns\", color: \"text-yellow-500\" },\n    { icon: Layout, name: \"Hero Section\", color: \"text-red-500\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"h-[calc(100vh-8rem)] flex flex-col\">\n        {/* Toolbar */}\n        <div className=\"flex items-center justify-between p-4 bg-card border-b\">\n          <div className=\"flex items-center gap-4\">\n            <h1 className=\"text-xl font-bold\">Page Builder</h1>\n            <Badge>Homepage</Badge>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\">\n              <Eye className=\"w-4 h-4 mr-2\" /> Preview\n            </Button>\n            <Button size=\"sm\">\n              <Save className=\"w-4 h-4 mr-2\" /> Save Page\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"flex-1 flex overflow-hidden\">\n          {/* Components Sidebar */}\n          <div className=\"w-64 bg-card border-r p-4 overflow-y-auto\">\n            <h3 className=\"font-semibold mb-4\">Components</h3>\n            <div className=\"space-y-2\">\n              {components.map((comp, i) => (\n                <div\n                  key={i}\n                  className=\"p-3 border rounded-lg cursor-move hover:border-primary hover:bg-primary/5 transition-colors\"\n                  draggable\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <comp.icon className={`w-5 h-5 ${comp.color}`} />\n                    <span className=\"text-sm font-medium\">{comp.name}</span>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Canvas */}\n          <div className=\"flex-1 bg-muted/20 p-8 overflow-y-auto\">\n            <div className=\"max-w-5xl mx-auto bg-background rounded-lg shadow-lg min-h-full p-8\">\n              <div className=\"space-y-4\">\n                {/* Example blocks */}\n                <div className=\"group relative border-2 border-dashed border-transparent hover:border-primary p-4 rounded-lg\">\n                  <div className=\"absolute -top-3 left-2 bg-background px-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <div className=\"flex items-center gap-1\">\n                      <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\">\n                        <GripVertical className=\"w-3 h-3\" />\n                      </Button>\n                      <Badge variant=\"secondary\" className=\"text-xs\">Hero Section</Badge>\n                      <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6 text-destructive\">\n                        <Trash2 className=\"w-3 h-3\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <h1 className=\"text-4xl font-bold mb-4\">Welcome to My Portfolio</h1>\n                  <p className=\"text-muted-foreground\">This is an editable hero section.</p>\n                </div>\n\n                <div className=\"border-2 border-dashed border-muted-foreground/20 rounded-lg p-8 text-center cursor-pointer hover:border-primary hover:bg-primary/5\">\n                  <Plus className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                  <p className=\"text-sm text-muted-foreground\">Drop component here or click to add</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Properties Panel */}\n          <div className=\"w-80 bg-card border-l p-4 overflow-y-auto\">\n            <h3 className=\"font-semibold mb-4\">Properties</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Text Content</label>\n                <textarea className=\"w-full p-2 border rounded-md text-sm\" rows={3} defaultValue=\"Welcome to My Portfolio\" />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Font Size</label>\n                <select className=\"w-full p-2 border rounded-md text-sm bg-background\">\n                  <option>Large (4xl)</option>\n                  <option>Extra Large (5xl)</option>\n                  <option>Huge (6xl)</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Text Color</label>\n                <input type=\"color\" className=\"w-full h-10 rounded border\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5125,"size_tokens":null},"client/src/components/sections/Blog.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Calendar, User, ArrowRight } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useMockData } from \"@/context/MockContext\";\nimport { Link } from \"wouter\";\n\nexport function Blog() {\n  const { posts } = useMockData();\n  const publishedPosts = posts\n    .filter(p => p.status === \"Published\")\n    .sort((a, b) => {\n      if (a.featured && !b.featured) return -1;\n      if (!a.featured && b.featured) return 1;\n      const dateA = a.publishedAt ? new Date(a.publishedAt).getTime() : 0;\n      const dateB = b.publishedAt ? new Date(b.publishedAt).getTime() : 0;\n      return dateB - dateA;\n    })\n    .slice(0, 6);\n  \n  // Array of background images to rotate\n  const bgImages = [\n    '/images/blog/bg-1.png',\n    '/images/blog/bg-2.png',\n    '/images/blog/bg-3.png',\n  ];\n\n  return (\n    <section id=\"blog\" className=\"py-20 bg-muted/30\">\n      <div className=\"container mx-auto px-4\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          whileInView={{ opacity: 1, y: 0 }}\n          viewport={{ once: true }}\n          className=\"text-center mb-12\"\n        >\n          <h2 className=\"text-4xl md:text-5xl font-heading font-bold mb-4\">\n            Latest <span className=\"text-gradient\">Articles</span>\n          </h2>\n          <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n            Thoughts, tutorials, and insights about web development\n          </p>\n        </motion.div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          {publishedPosts.map((post, index) => (\n            <motion.div\n              key={post.id}\n              initial={{ opacity: 0, y: 30 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ delay: index * 0.1 }}\n            >\n              <Card className=\"group hover:border-primary/50 transition-all hover:-translate-y-2 duration-300 h-full\">\n                <div \n                  className=\"h-48 relative overflow-hidden bg-cover bg-center bg-no-repeat\"\n                  style={{ backgroundImage: `url('${bgImages[index % bgImages.length]}')` }}\n                >\n                  <div className=\"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors\" />\n                </div>\n                <CardHeader>\n                  <div className=\"flex gap-2 mb-3\">\n                    <Badge variant=\"secondary\">{post.category}</Badge>\n                  </div>\n                  <h3 className=\"text-xl font-bold group-hover:text-primary transition-colors line-clamp-2\">\n                    {post.title}\n                  </h3>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center gap-4 text-sm text-muted-foreground mb-4\">\n                    <div className=\"flex items-center gap-1\">\n                      <User size={14} />\n                      <span>{post.author}</span>\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                      <Calendar size={14} />\n                      <span>{post.publishedAt ? new Date(post.publishedAt).toLocaleDateString() : 'Draft'}</span>\n                    </div>\n                  </div>\n                  <Link href={`/blog/${post.slug}`}>\n                    <Button variant=\"ghost\" className=\"group/btn p-0 h-auto\" data-testid={`button-read-more-${post.id}`}>\n                      Read More \n                      <ArrowRight className=\"ml-2 w-4 h-4 group-hover/btn:translate-x-1 transition-transform\" />\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n      </div>\n    </section>\n  );\n}","path":null,"size_bytes":3908,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/pages/admin/PostsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Pagination } from \"@/components/admin/pagination\";\nimport { useState, useRef } from \"react\";\nimport { Plus, Eye, Edit, Trash, Calendar, Save, X, Loader2 } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport type { Post, InsertPost } from \"@shared/schema\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\ninterface PostFormData {\n  title: string;\n  slug: string;\n  content: string;\n  excerpt: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  tags: string[];\n  featuredImage: string | null;\n  publishedAt: Date | null;\n}\n\nconst getDefaultFormData = (): PostFormData => ({\n  title: \"\",\n  slug: \"\",\n  content: \"\",\n  excerpt: \"\",\n  category: \"\",\n  author: \"Loi Developer\",\n  status: \"Draft\",\n  tags: [],\n  featuredImage: null,\n  publishedAt: null,\n});\n\nfunction generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/(^-|-$)/g, \"\");\n}\n\nexport default function AdminPostsEnhanced() {\n  const queryClient = useQueryClient();\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const [uploading, setUploading] = useState(false);\n\n  const handleImageUpload = async (file: File, setFeaturedImage: (url: string) => void) => {\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      setFeaturedImage(data.url);\n    } catch (error: any) {\n      console.error(\"Upload failed:\", error);\n    } finally {\n      setUploading(false);\n    }\n  };\n  const { data: posts = [], isLoading } = useQuery({\n    queryKey: [\"admin-posts\"],\n    queryFn: () => api.getPosts(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=post\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertPost) => api.createPost(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<Post> }) => \n      api.updatePost(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deletePost(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const addPost = async (data: InsertPost) => {\n    await createMutation.mutateAsync(data);\n  };\n\n  const updatePost = async (id: number, data: Partial<Post>) => {\n    await updateMutation.mutateAsync({ id, data });\n  };\n\n  const deletePost = async (id: number) => {\n    await deleteMutation.mutateAsync(id);\n  };\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"published\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [editingPost, setEditingPost] = useState<number | null>(null);\n  const [postToDelete, setPostToDelete] = useState<number | null>(null);\n  const [formData, setFormData] = useState<PostFormData>(getDefaultFormData());\n  const [tagsInput, setTagsInput] = useState(\"\");\n\n  const postsPerPage = 5;\n\n  const filteredPosts = posts.filter((p) => {\n    if (activeTab === \"published\") return p.status === \"Published\";\n    if (activeTab === \"draft\") return p.status === \"Draft\";\n    if (activeTab === \"archived\") return p.status === \"Archived\";\n    return true;\n  });\n\n  const totalPages = Math.ceil(filteredPosts.length / postsPerPage);\n  const paginatedPosts = filteredPosts.slice(\n    (currentPage - 1) * postsPerPage,\n    currentPage * postsPerPage\n  );\n\n  const handleOpenDialog = (postId?: number) => {\n    if (postId) {\n      const post = posts.find((p) => p.id === postId);\n      if (post) {\n        setEditingPost(postId);\n        let parsedPublishedAt: Date | null = null;\n        if (post.publishedAt) {\n          const date = new Date(post.publishedAt);\n          if (!isNaN(date.getTime())) {\n            parsedPublishedAt = date;\n          }\n        }\n        setFormData({\n          title: post.title,\n          slug: post.slug,\n          content: post.content || \"\",\n          excerpt: post.excerpt || \"\",\n          category: post.category,\n          author: post.author,\n          status: post.status,\n          tags: post.tags || [],\n          featuredImage: post.featuredImage,\n          publishedAt: parsedPublishedAt,\n        });\n        setTagsInput(post.tags?.join(\", \") || \"\");\n      }\n    } else {\n      setEditingPost(null);\n      setFormData(getDefaultFormData());\n      setTagsInput(\"\");\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPost(null);\n    setFormData(getDefaultFormData());\n    setTagsInput(\"\");\n  };\n\n  const handleTitleChange = (title: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      title,\n      slug: editingPost ? prev.slug : generateSlug(title),\n    }));\n  };\n\n  const validateForm = (): string | null => {\n    if (!formData.title.trim()) return \"Title is required\";\n    if (!formData.content.trim()) return \"Content is required\";\n    if (!formData.category.trim()) return \"Category is required\";\n    if (!formData.author.trim()) return \"Author is required\";\n    return null;\n  };\n\n  const [formError, setFormError] = useState<string | null>(null);\n\n  const isSaving = createMutation.isPending || updateMutation.isPending;\n\n  const getPublishedAtForSubmit = (): string | null => {\n    if (formData.status !== \"Published\") {\n      return null;\n    }\n\n    if (formData.publishedAt instanceof Date && !isNaN(formData.publishedAt.getTime())) {\n      return formData.publishedAt.toISOString();\n    }\n\n    if (formData.publishedAt && typeof formData.publishedAt === 'string') {\n      const date = new Date(formData.publishedAt);\n      if (!isNaN(date.getTime())) {\n        return date.toISOString();\n      }\n    }\n\n    return new Date().toISOString();\n  };\n\n  const handleSubmit = async () => {\n    const error = validateForm();\n    if (error) {\n      setFormError(error);\n      return;\n    }\n    setFormError(null);\n\n    try {\n      const tags = tagsInput\n        .split(\",\")\n        .map((t) => t.trim())\n        .filter(Boolean);\n\n      const publishedAt = getPublishedAtForSubmit();\n\n      const postData = {\n        title: formData.title.trim(),\n        slug: formData.slug.trim() || generateSlug(formData.title),\n        content: formData.content.trim(),\n        excerpt: formData.excerpt.trim() || null,\n        category: formData.category,\n        author: formData.author.trim(),\n        status: formData.status,\n        tags,\n        featuredImage: formData.featuredImage,\n        publishedAt,\n      };\n\n      if (editingPost) {\n        await updatePost(editingPost, postData as any);\n      } else {\n        await addPost(postData as any);\n      }\n      handleCloseDialog();\n    } catch (error: any) {\n      console.error(\"Error saving post:\", error);\n      setFormError(error.message || \"Failed to save post\");\n    }\n  };\n\n  const handleDeleteClick = (id: number) => {\n    setPostToDelete(id);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const handleConfirmDelete = async () => {\n    if (postToDelete) {\n      await deletePost(postToDelete);\n      setPostToDelete(null);\n    }\n    setIsDeleteDialogOpen(false);\n  };\n\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const bgImages = ['/images/blog/bg-1.png', '/images/blog/bg-2.png', '/images/blog/bg-3.png'];\n\n  const renderPostCard = (post: any) => {\n    const imageUrl = post.featuredImage || bgImages[post.id % bgImages.length];\n    return (\n    <Card key={post.id} data-testid={`card-post-${post.id}`} className=\"overflow-hidden\">\n      <div \n        className=\"h-32 bg-cover bg-center bg-no-repeat\"\n        style={{ backgroundImage: `url('${imageUrl}')` }}\n      >\n        <div className=\"w-full h-full bg-black/40\" />\n      </div>\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <h3 className=\"font-bold\" data-testid={`text-post-title-${post.id}`}>{post.title}</h3>\n              <Badge variant=\"secondary\">{post.category}</Badge>\n              <Badge\n                variant={post.status === \"Published\" ? \"default\" : \"outline\"}\n                className={post.status === \"Published\" ? \"bg-green-500\" : \"\"}\n              >\n                {post.status}\n              </Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground mb-2 line-clamp-2\">\n              {post.excerpt || post.content?.substring(0, 100) || \"No excerpt available\"}\n            </p>\n            <div className=\"flex gap-4 text-xs text-muted-foreground flex-wrap\">\n              <span className=\"flex items-center gap-1\">\n                <Calendar className=\"w-3 h-3\" /> {formatDate(post.publishedAt || post.createdAt)}\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <Eye className=\"w-3 h-3\" /> {post.views || 0} views\n              </span>\n              {post.tags && post.tags.length > 0 && (\n                <span className=\"text-primary\">\n                  {post.tags.slice(0, 3).join(\", \")}\n                  {post.tags.length > 3 && \"...\"}\n                </span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleOpenDialog(post.id)}\n              data-testid={`button-edit-post-${post.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-destructive hover:text-destructive\"\n              onClick={() => handleDeleteClick(post.id)}\n              data-testid={`button-delete-post-${post.id}`}\n            >\n              <Trash className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n    );\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Blog Posts</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your blog content ({posts.length} posts)\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-new-post\"\n          >\n            <Plus className=\"w-4 h-4\" /> New Post\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={(v) => { setActiveTab(v); setCurrentPage(1); }}>\n          <TabsList>\n            <TabsTrigger value=\"published\" data-testid=\"tab-published\">\n              Published ({posts.filter((p) => p.status === \"Published\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"draft\" data-testid=\"tab-draft\">\n              Drafts ({posts.filter((p) => p.status === \"Draft\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"archived\" data-testid=\"tab-archived\">\n              Archived ({posts.filter((p) => p.status === \"Archived\").length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value={activeTab} className=\"space-y-4 mt-4\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  Loading posts...\n                </CardContent>\n              </Card>\n            ) : paginatedPosts.length === 0 ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  No posts found. Click \"New Post\" to create one.\n                </CardContent>\n              </Card>\n            ) : (\n              <>\n                {paginatedPosts.map(renderPostCard)}\n                {totalPages > 1 && (\n                  <Pagination\n                    currentPage={currentPage}\n                    totalPages={totalPages}\n                    onPageChange={setCurrentPage}\n                  />\n                )}\n              </>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingPost ? \"Edit Post\" : \"Create New Post\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingPost\n                ? \"Update the post details below.\"\n                : \"Fill in the details to create a new blog post.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"Enter post title\"\n                value={formData.title}\n                onChange={(e) => handleTitleChange(e.target.value)}\n                data-testid=\"input-post-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"slug\">Slug</Label>\n              <Input\n                id=\"slug\"\n                placeholder=\"post-url-slug\"\n                value={formData.slug}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, slug: e.target.value }))\n                }\n                data-testid=\"input-post-slug\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(v) =>\n                    setFormData((prev) => ({ ...prev, category: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(v: \"Published\" | \"Draft\" | \"Archived\") =>\n                    setFormData((prev) => ({ ...prev, status: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-status\">\n                    <SelectValue placeholder=\"Select status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                    <SelectItem value=\"Archived\">Archived</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"content\">Content *</Label>\n              <RichTextEditor\n                value={formData.content}\n                onChange={(content) =>\n                  setFormData((prev) => ({ ...prev, content }))\n                }\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"excerpt\">Excerpt</Label>\n              <Textarea\n                id=\"excerpt\"\n                placeholder=\"Brief summary of the post\"\n                value={formData.excerpt}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, excerpt: e.target.value }))\n                }\n                rows={2}\n                data-testid=\"input-post-excerpt\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"image\">Featured Image</Label>\n              <div className=\"space-y-2\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"image\"\n                    placeholder=\"Image URL (e.g., /uploads/images/... or https://...)\"\n                    value={formData.featuredImage || ''}\n                    onChange={(e) =>\n                      setFormData((prev) => ({ ...prev, featuredImage: e.target.value || null }))\n                    }\n                    data-testid=\"input-post-image\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => imageInputRef.current?.click()}\n                    disabled={uploading}\n                    data-testid=\"button-upload-image\"\n                  >\n                    {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => setFormData((prev) => ({ ...prev, featuredImage: null }))}\n                    data-testid=\"button-clear-image\"\n                  >\n                    Clear\n                  </Button>\n                </div>\n                <input\n                  ref={imageInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  onChange={(e) => {\n                    const file = e.target.files?.[0];\n                    if (file) {\n                      handleImageUpload(file, (url) => setFormData((prev) => ({ ...prev, featuredImage: url })));\n                    }\n                  }}\n                  data-testid=\"input-file-upload\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Táº£i áº£nh tá»« thiáº¿t bá»‹ (JPG, PNG, GIF, WebP) - Ä‘Æ°á»£c lÆ°u vÃ o /uploads/images/\n                </p>\n              </div>\n              {formData.featuredImage && (\n                <div className=\"mt-2 border border-border rounded-md overflow-hidden\">\n                  <img\n                    src={formData.featuredImage}\n                    alt=\"Featured preview\"\n                    className=\"w-full h-40 object-cover\"\n                    onError={(e) => {\n                      // Fallback if image fails to load\n                      (e.target as HTMLImageElement).src = '/images/blog/bg-1.png';\n                    }}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">\n                Há»— trá»£: Táº£i tá»« thiáº¿t bá»‹ hoáº·c dÃ¡n link áº£nh. áº¢nh máº·c Ä‘á»‹nh: /images/blog/bg-1.png, bg-2.png, bg-3.png\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\n              <Input\n                id=\"tags\"\n                placeholder=\"react, javascript, web development\"\n                value={tagsInput}\n                onChange={(e) => setTagsInput(e.target.value)}\n                data-testid=\"input-post-tags\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"author\">Author</Label>\n              <Input\n                id=\"author\"\n                placeholder=\"Author name\"\n                value={formData.author}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, author: e.target.value }))\n                }\n                data-testid=\"input-post-author\"\n              />\n            </div>\n          </div>\n\n          <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n            {formError && (\n              <p className=\"text-destructive text-sm w-full sm:w-auto sm:flex-1\" data-testid=\"text-form-error\">\n                {formError}\n              </p>\n            )}\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={handleCloseDialog}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button\n                onClick={handleSubmit}\n                disabled={isSaving}\n                data-testid=\"button-save-post\"\n              >\n                <Save className=\"w-4 h-4 mr-2\" />\n                {isSaving ? \"Saving...\" : editingPost ? \"Update Post\" : \"Create Post\"}\n              </Button>\n            </div>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Are you sure?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. This will permanently delete the\n              post from the database.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":23859,"size_tokens":null},"client/src/pages/Home.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Hero } from \"@/components/sections/Hero\";\nimport { About } from \"@/components/sections/About\";\nimport { Skills } from \"@/components/sections/Skills\";\nimport { Services } from \"@/components/sections/Services\";\nimport { Projects } from \"@/components/sections/Projects\";\nimport { Testimonials } from \"@/components/sections/Testimonials\";\nimport { Blog } from \"@/components/sections/Blog\";\nimport { Contact } from \"@/components/sections/Contact\";\nimport { Preloader } from \"@/components/ui/Preloader\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { X, Mail } from \"lucide-react\";\nimport type { HomepageSection } from \"@shared/schema\";\n\ninterface NewsletterSettings {\n  enabled: boolean;\n  title: string;\n  subtitle: string;\n  description: string;\n  placeholder: string;\n  buttonText: string;\n  successMessage: string;\n}\n\nexport default function Home() {\n  const [loading, setLoading] = useState(true);\n  const [showNewsletter, setShowNewsletter] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [submitted, setSubmitted] = useState(false);\n\n  const { data: newsletterSettings } = useQuery<NewsletterSettings>({\n    queryKey: ['/api/newsletter/settings'],\n    enabled: !loading,\n  });\n\n  const { data: sections = [] } = useQuery<HomepageSection[]>({\n    queryKey: ['/api/homepage/sections'],\n    enabled: !loading,\n  });\n\n  const isSectionVisible = (sectionName: string): boolean => {\n    const section = sections.find((s) => s.name === sectionName);\n    return section ? section.visible : true;\n  };\n\n  // Lock scroll during loading\n  useEffect(() => {\n    if (loading) {\n      document.body.style.overflow = \"hidden\";\n    } else {\n      document.body.style.overflow = \"auto\";\n    }\n  }, [loading]);\n\n  // Show newsletter popup on page load if enabled\n  useEffect(() => {\n    if (!loading && newsletterSettings?.enabled) {\n      const dismissed = localStorage.getItem('newsletter-dismissed');\n      if (!dismissed) {\n        setShowNewsletter(true);\n      }\n    }\n  }, [loading, newsletterSettings?.enabled]);\n\n  const handleCloseNewsletter = () => {\n    setShowNewsletter(false);\n    localStorage.setItem('newsletter-dismissed', 'true');\n  };\n\n  const handleNewsletterSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email) return;\n    \n    try {\n      await fetch('/api/newsletter/subscribe', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ email }),\n      });\n      setSubmitted(true);\n      setTimeout(() => {\n        handleCloseNewsletter();\n        setEmail(\"\");\n        setSubmitted(false);\n      }, 2000);\n    } catch (error) {\n      console.error('Newsletter subscription error:', error);\n    }\n  };\n\n  return (\n    <>\n      {loading && <Preloader onComplete={() => setLoading(false)} />}\n      \n      <div className={loading ? \"opacity-0\" : \"opacity-100 transition-opacity duration-1000\"}>\n        <Navbar />\n        <main>\n          <Hero />\n          <About />\n          <Skills />\n          <Services />\n          {isSectionVisible('projects') && <Projects />}\n          {isSectionVisible('testimonials') && <Testimonials />}\n          {isSectionVisible('blog') && <Blog />}\n          <Contact />\n        </main>\n        <Footer />\n\n        {/* Newsletter Popup */}\n        {showNewsletter && newsletterSettings?.enabled && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" data-testid=\"newsletter-popup-overlay\">\n            <div className=\"bg-background rounded-lg shadow-lg max-w-md w-full p-8 relative animate-in fade-in zoom-in-95 duration-300\" data-testid=\"newsletter-popup\">\n              {/* Close Button */}\n              <button\n                onClick={handleCloseNewsletter}\n                className=\"absolute top-4 right-4 p-1 hover:bg-muted rounded-md transition-colors\"\n                data-testid=\"button-close-newsletter\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n\n              {!submitted ? (\n                <>\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <div className=\"p-2 bg-primary/10 rounded-lg\">\n                      <Mail className=\"w-5 h-5 text-primary\" />\n                    </div>\n                    <div>\n                      <h2 className=\"font-bold text-lg\" data-testid=\"newsletter-title\">{newsletterSettings.title}</h2>\n                      <p className=\"text-sm text-muted-foreground\" data-testid=\"newsletter-subtitle\">{newsletterSettings.subtitle}</p>\n                    </div>\n                  </div>\n\n                  <p className=\"text-sm text-muted-foreground mb-6\" data-testid=\"newsletter-description\">\n                    {newsletterSettings.description}\n                  </p>\n\n                  <form onSubmit={handleNewsletterSubmit} className=\"space-y-3\">\n                    <input\n                      type=\"email\"\n                      placeholder={newsletterSettings.placeholder}\n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      className=\"w-full px-4 py-2 rounded-lg border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-primary\"\n                      required\n                      data-testid=\"input-newsletter-email\"\n                    />\n                    <Button\n                      type=\"submit\"\n                      className=\"w-full\"\n                      data-testid=\"button-newsletter-subscribe\"\n                    >\n                      {newsletterSettings.buttonText}\n                    </Button>\n                  </form>\n\n                  <p className=\"text-xs text-center text-muted-foreground mt-4\">\n                    We respect your privacy. Unsubscribe at any time.\n                  </p>\n                </>\n              ) : (\n                <div className=\"text-center py-8\">\n                  <div className=\"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                    <Mail className=\"w-6 h-6 text-green-500\" />\n                  </div>\n                  <p className=\"font-medium\" data-testid=\"newsletter-success-message\">{newsletterSettings.successMessage}</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n","path":null,"size_bytes":6628,"size_tokens":null},"client/src/pages/admin/Inbox.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  Search, \n  Star, \n  Archive, \n  Trash2, \n  Reply, \n  Paperclip,\n  Mail,\n  Loader2,\n  Eye,\n  RefreshCw\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface Message {\n  id: number;\n  sender: string;\n  email: string;\n  subject: string;\n  message: string;\n  read: boolean;\n  starred: boolean;\n  tag: string;\n  createdAt: string | null;\n  archived: boolean;\n}\n\nexport default function AdminInbox() {\n  const { toast } = useToast();\n  const [selectedMessageId, setSelectedMessageId] = useState<number | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: messages = [], isLoading, refetch } = useQuery<Message[]>({\n    queryKey: ['/api/messages'],\n  });\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/messages/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/messages/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      toast({ title: \"Message deleted\" });\n      if (selectedMessageId === deleteMutation.variables) {\n        const remainingMessages = messages.filter(m => m.id !== deleteMutation.variables);\n        if (remainingMessages.length > 0) {\n          setSelectedMessageId(remainingMessages[0].id);\n        } else {\n          setSelectedMessageId(null);\n        }\n      }\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to delete message\", variant: \"destructive\" });\n    },\n  });\n\n  const archiveMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/messages/${id}/archive`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      toast({ title: \"Message archived\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to archive message\", variant: \"destructive\" });\n    },\n  });\n\n  const filteredMessages = messages.filter(m => \n    !m.archived && (\n      m.sender.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      m.subject.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      m.message.toLowerCase().includes(searchQuery.toLowerCase())\n    )\n  );\n\n  const effectiveSelectedId = selectedMessageId ?? filteredMessages[0]?.id ?? null;\n  const selectedMessage = filteredMessages.find(m => m.id === effectiveSelectedId) || filteredMessages[0];\n\n  const handleSelectMessage = (id: number) => {\n    setSelectedMessageId(id);\n    const msg = messages.find(m => m.id === id);\n    if (msg && !msg.read) {\n      markAsReadMutation.mutate(id);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this message permanently?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const handleArchive = (id: number) => {\n    archiveMutation.mutate(id);\n  };\n\n  const unreadCount = messages.filter(m => !m.read && !m.archived).length;\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-[calc(100vh-8rem)]\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"mb-4 flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-heading font-bold flex items-center gap-2\">\n            <Mail className=\"w-6 h-6\" />\n            Inbox\n            {unreadCount > 0 && (\n              <Badge variant=\"destructive\" className=\"ml-2\">{unreadCount} unread</Badge>\n            )}\n          </h1>\n          <p className=\"text-sm text-muted-foreground\">{filteredMessages.length} messages</p>\n        </div>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          onClick={() => refetch()}\n          data-testid=\"button-refresh-inbox\"\n        >\n          <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh\n        </Button>\n      </div>\n\n      <div className=\"h-[calc(100vh-12rem)] flex flex-col md:flex-row bg-card border border-border rounded-lg overflow-hidden\">\n        <div className=\"w-full md:w-80 border-r border-border flex flex-col\">\n          <div className=\"p-4 border-b border-border\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input \n                placeholder=\"Search messages...\" \n                className=\"pl-9\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                data-testid=\"input-search-messages\"\n              />\n            </div>\n          </div>\n          <ScrollArea className=\"flex-1\">\n            <div className=\"flex flex-col\">\n              {filteredMessages.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <Mail className=\"w-12 h-12 mx-auto mb-4 opacity-20\" />\n                  <p className=\"font-medium\">No messages</p>\n                  <p className=\"text-sm\">Your inbox is empty</p>\n                </div>\n              ) : (\n                filteredMessages.map((msg) => (\n                  <button\n                    key={msg.id}\n                    onClick={() => handleSelectMessage(msg.id)}\n                    className={`flex flex-col gap-2 p-4 text-left border-b border-border hover:bg-muted/50 transition-colors ${\n                      !msg.read ? \"bg-primary/5\" : \"\"\n                    } ${effectiveSelectedId === msg.id ? \"bg-muted\" : \"\"}`}\n                    data-testid={`button-message-${msg.id}`}\n                  >\n                    <div className=\"flex justify-between items-start w-full gap-2\">\n                      <span className={`font-medium truncate ${!msg.read ? \"text-foreground\" : \"text-muted-foreground\"}`}>\n                        {msg.sender}\n                      </span>\n                      <span className=\"text-xs text-muted-foreground whitespace-nowrap\">\n                        {msg.createdAt ? formatDistanceToNow(new Date(msg.createdAt), { addSuffix: true }) : ''}\n                      </span>\n                    </div>\n                    <span className=\"text-sm font-medium truncate w-full\">\n                      {msg.subject}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground truncate w-full\">\n                      {msg.message}\n                    </span>\n                    <div className=\"flex gap-2 mt-1 flex-wrap\">\n                      {!msg.read && (\n                        <Badge variant=\"default\" className=\"text-[10px] h-5\">New</Badge>\n                      )}\n                      <Badge variant=\"secondary\" className=\"text-[10px] h-5\">\n                        {msg.tag || \"General\"}\n                      </Badge>\n                    </div>\n                  </button>\n                ))\n              )}\n            </div>\n          </ScrollArea>\n        </div>\n\n        <div className=\"flex-1 flex flex-col min-w-0\">\n          {selectedMessage ? (\n            <>\n              <div className=\"h-16 border-b border-border flex items-center justify-between px-6 gap-2\">\n                <div className=\"flex items-center gap-2\">\n                  <Button \n                    variant=\"ghost\" \n                    size=\"icon\"\n                    onClick={() => handleArchive(selectedMessage.id)}\n                    disabled={archiveMutation.isPending}\n                    title=\"Archive\"\n                    data-testid=\"button-archive-message\"\n                  >\n                    <Archive size={18} />\n                  </Button>\n                  <Button \n                    variant=\"ghost\" \n                    size=\"icon\" \n                    onClick={() => handleDelete(selectedMessage.id)}\n                    disabled={deleteMutation.isPending}\n                    title=\"Delete\"\n                    data-testid=\"button-delete-message\"\n                  >\n                    <Trash2 size={18} />\n                  </Button>\n                  <Separator orientation=\"vertical\" className=\"h-6 mx-2\" />\n                  {!selectedMessage.read && (\n                    <Button \n                      variant=\"ghost\" \n                      size=\"icon\"\n                      onClick={() => markAsReadMutation.mutate(selectedMessage.id)}\n                      disabled={markAsReadMutation.isPending}\n                      title=\"Mark as read\"\n                      data-testid=\"button-mark-read\"\n                    >\n                      <Eye size={18} />\n                    </Button>\n                  )}\n                  <Button variant=\"ghost\" size=\"icon\" title=\"Star\">\n                    <Star size={18} />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex-1 p-6 overflow-y-auto\">\n                <div className=\"mb-6\">\n                  <div className=\"flex justify-between items-start mb-4 gap-4 flex-wrap\">\n                    <h2 className=\"text-2xl font-bold\">{selectedMessage.subject}</h2>\n                    <div className=\"flex gap-2 flex-shrink-0\">\n                      <Badge variant=\"outline\">{selectedMessage.tag || \"General\"}</Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between mb-6 gap-4 flex-wrap\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center text-primary font-bold\">\n                        {selectedMessage.sender.charAt(0).toUpperCase()}\n                      </div>\n                      <div>\n                        <div className=\"font-medium\">{selectedMessage.sender}</div>\n                        <div className=\"text-sm text-muted-foreground\">{selectedMessage.email}</div>\n                      </div>\n                    </div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {selectedMessage.createdAt ? new Date(selectedMessage.createdAt).toLocaleString() : ''}\n                    </div>\n                  </div>\n                  <Separator className=\"mb-6\" />\n                  <div className=\"prose dark:prose-invert max-w-none\">\n                    <p className=\"whitespace-pre-wrap\">{selectedMessage.message}</p>\n                  </div>\n                </div>\n                \n                <div className=\"mt-8 border border-border rounded-lg p-4 bg-card\">\n                  <div className=\"text-sm text-muted-foreground mb-2\">Reply to {selectedMessage.sender}</div>\n                  <textarea \n                    className=\"w-full bg-transparent border-none focus:ring-0 resize-none min-h-[100px] text-sm outline-none\" \n                    placeholder=\"Write your reply...\"\n                    data-testid=\"textarea-reply\"\n                  />\n                  <div className=\"flex justify-between items-center mt-4 gap-2 flex-wrap\">\n                    <Button variant=\"ghost\" size=\"sm\">\n                      <Paperclip className=\"w-4 h-4 mr-2\" /> Attach\n                    </Button>\n                    <Button size=\"sm\" data-testid=\"button-send-reply\">\n                      <Reply className=\"w-4 h-4 mr-2\" /> Send Reply\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex-1 flex flex-col items-center justify-center text-muted-foreground\">\n              <Mail className=\"w-16 h-16 mb-4 opacity-20\" />\n              <p className=\"font-medium\">No message selected</p>\n              <p className=\"text-sm\">Select a message from the list to view</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":12571,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","path":null,"size_bytes":483,"size_tokens":null},"client/src/pages/admin/ServicesEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Check, Plus, Edit, Trash2, X, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Service } from \"@shared/schema\";\n\ninterface ServiceFormData {\n  title: string;\n  description: string;\n  icon: string;\n  features: string[];\n  price: string;\n  order: number;\n  active: boolean;\n}\n\nconst getEmptyService = (): ServiceFormData => ({\n  title: \"\",\n  description: \"\",\n  icon: \"code\",\n  features: [],\n  price: \"\",\n  order: 0,\n  active: true,\n});\n\nexport default function AdminServicesEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingService, setEditingService] = useState<Service | null>(null);\n  const [formData, setFormData] = useState<ServiceFormData>(getEmptyService());\n  const [featureInput, setFeatureInput] = useState(\"\");\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n\n  const { data: services = [], isLoading } = useQuery({\n    queryKey: [\"/api/services\"],\n    queryFn: () => api.getServices(),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => api.createService(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: any }) =>\n      api.updateService(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteService(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Service deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyService());\n    setEditingService(null);\n    setFeatureInput(\"\");\n  };\n\n  const handleOpenDialog = (service?: Service) => {\n    if (service) {\n      setEditingService(service);\n      setFormData({\n        title: service.title,\n        description: service.description || \"\",\n        icon: service.icon || \"code\",\n        features: service.features || [],\n        price: service.price || \"\",\n        order: service.order,\n        active: service.active,\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim() && !formData.features.includes(featureInput.trim())) {\n      setFormData({\n        ...formData,\n        features: [...formData.features, featureInput.trim()],\n      });\n      setFeatureInput(\"\");\n    }\n  };\n\n  const removeFeature = (feature: string) => {\n    setFormData({\n      ...formData,\n      features: formData.features.filter((f) => f !== feature),\n    });\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Service title is required\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (editingService) {\n      updateMutation.mutate({ id: editingService.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Services</h1>\n            <p className=\"text-muted-foreground\">Manage services and pricing</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-create-service\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n          </Button>\n        </div>\n\n        {isLoading ? (\n          <Card>\n            <CardContent className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"w-6 h-6 animate-spin\" />\n            </CardContent>\n          </Card>\n        ) : services.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No services yet</p>\n              <Button onClick={() => handleOpenDialog()}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create first service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Service Comparison Table */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Service Comparison</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full text-sm\">\n                    <thead>\n                      <tr className=\"border-b\">\n                        <th className=\"text-left py-3 px-2\">Feature</th>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <th key={service.id} className=\"text-center py-3 px-2\">\n                              {service.title}\n                            </th>\n                          ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr className=\"border-b\">\n                        <td className=\"py-3 px-2 font-medium\">Price</td>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <td key={service.id} className=\"text-center py-3 px-2\">\n                              <span className=\"font-semibold\">{service.price}</span>\n                            </td>\n                          ))}\n                      </tr>\n                      {Array.from({\n                        length: Math.max(\n                          0,\n                          Math.max(...services.map((s) => (s.features || []).length))\n                        ),\n                      }).map((_, featureIdx) => (\n                        <tr key={featureIdx} className=\"border-b\">\n                          <td className=\"py-3 px-2 font-medium text-sm\">\n                            {services[0]?.features?.[featureIdx] || \"Feature\"}\n                          </td>\n                          {services\n                            .sort((a, b) => a.order - b.order)\n                            .map((service) => (\n                              <td key={service.id} className=\"text-center py-3 px-2\">\n                                {service.features && service.features[featureIdx] ? (\n                                  <Check className=\"w-4 h-4 text-green-500 mx-auto\" />\n                                ) : (\n                                  <span className=\"text-muted-foreground\">-</span>\n                                )}\n                              </td>\n                            ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Service Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {services\n                .sort((a, b) => a.order - b.order)\n                .map((service) => (\n                  <Card\n                    key={service.id}\n                    className=\"flex flex-col\"\n                    data-testid={`card-service-${service.id}`}\n                  >\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-lg\">{service.title}</CardTitle>\n                          {!service.active && (\n                            <Badge variant=\"outline\" className=\"mt-2\">\n                              Inactive\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-baseline gap-1 mt-2\">\n                        <span className=\"text-3xl font-bold\">{service.price}</span>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        {service.description}\n                      </p>\n                    </CardHeader>\n                    <CardContent className=\"flex-1 space-y-4\">\n                      {service.features && service.features.length > 0 && (\n                        <ul className=\"space-y-2\">\n                          {service.features.map((feature: string) => (\n                            <li key={feature} className=\"flex items-center gap-2 text-sm\">\n                              <Check className=\"w-4 h-4 text-green-500\" />\n                              {feature}\n                            </li>\n                          ))}\n                        </ul>\n                      )}\n                      <div className=\"flex gap-2 pt-4\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => handleOpenDialog(service)}\n                          className=\"flex-1\"\n                          data-testid={`button-edit-service-${service.id}`}\n                        >\n                          <Edit className=\"w-4 h-4 mr-1\" /> Edit\n                        </Button>\n                        <AlertDialog>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => setDeleteId(service.id)}\n                            data-testid={`button-delete-service-${service.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-red-500\" />\n                          </Button>\n                        </AlertDialog>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Create/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingService ? \"Edit Service\" : \"Create New Service\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingService\n                ? \"Update the service details below.\"\n                : \"Fill in the details to create a new service.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Service Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"e.g., Web Development\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                placeholder=\"Brief description of the service\"\n                value={formData.description}\n                onChange={(e) =>\n                  setFormData({ ...formData, description: e.target.value })\n                }\n                data-testid=\"input-description\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"price\">Price</Label>\n                <Input\n                  id=\"price\"\n                  placeholder=\"e.g., From $2,000\"\n                  value={formData.price}\n                  onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n                  data-testid=\"input-price\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"icon\">Icon</Label>\n                <Input\n                  id=\"icon\"\n                  placeholder=\"e.g., code, smartphone, palette\"\n                  value={formData.icon}\n                  onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                  data-testid=\"input-icon\"\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"order\">Order</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) =>\n                    setFormData({ ...formData, order: parseInt(e.target.value) || 0 })\n                  }\n                  data-testid=\"input-order\"\n                />\n              </div>\n\n              <div className=\"flex items-end gap-2\">\n                <div className=\"flex-1 space-y-2\">\n                  <Label htmlFor=\"active\">Active</Label>\n                  <div className=\"flex items-center gap-2 pt-1\">\n                    <Switch\n                      id=\"active\"\n                      checked={formData.active}\n                      onCheckedChange={(checked) =>\n                        setFormData({ ...formData, active: checked })\n                      }\n                      data-testid=\"switch-active\"\n                    />\n                    <span className=\"text-sm text-muted-foreground\">\n                      {formData.active ? \"Active\" : \"Inactive\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Features</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  placeholder=\"Add feature (e.g., Responsive Design)\"\n                  value={featureInput}\n                  onChange={(e) => setFeatureInput(e.target.value)}\n                  onKeyPress={(e) =>\n                    e.key === \"Enter\" && (e.preventDefault(), addFeature())\n                  }\n                  data-testid=\"input-feature\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={addFeature}\n                  data-testid=\"button-add-feature\"\n                >\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.features.map((feature) => (\n                  <Badge key={feature} variant=\"secondary\" className=\"gap-1\">\n                    {feature}\n                    <button\n                      onClick={() => removeFeature(feature)}\n                      className=\"ml-1 hover:text-destructive\"\n                      data-testid={`button-remove-feature-${feature}`}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setIsDialogOpen(false)}\n              data-testid=\"button-cancel\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={isPending}\n              data-testid=\"button-save-service\"\n            >\n              {isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : editingService ? (\n                \"Update Service\"\n              ) : (\n                \"Create Service\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Dialog */}\n      <AlertDialog open={deleteId !== null} onOpenChange={() => setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Service</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this service? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deleteId) {\n                  deleteMutation.mutate(deleteId);\n                }\n              }}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":18891,"size_tokens":null},"client/src/pages/admin/ThemeComparison.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useState } from \"react\";\n\ninterface ThemeComparisonProps {\n  currentTheme?: {\n    primaryColor: string;\n    secondaryColor: string;\n    accentColor: string;\n    headingFont: string;\n    borderRadius: string;\n  };\n}\n\nexport function ThemeComparison({ currentTheme }: ThemeComparisonProps) {\n  const [sliderPosition, setSliderPosition] = useState(50);\n\n  const defaultTheme = {\n    primaryColor: \"#7c3aed\",\n    secondaryColor: \"#ec4899\",\n    accentColor: \"#f59e0b\",\n    headingFont: \"Inter\",\n    borderRadius: \"8\",\n  };\n\n  const theme = currentTheme || defaultTheme;\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Before/After Comparison</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"relative w-full h-96 bg-muted rounded-lg overflow-hidden\">\n          {/* Before - Default Theme */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-900 dark:to-slate-800\">\n            <div className=\"h-full flex flex-col items-center justify-center space-y-4\">\n              <p className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">Before</p>\n              <div className=\"space-y-2\">\n                <div className=\"w-40 h-10 bg-slate-300 dark:bg-slate-600 rounded\" />\n                <div className=\"w-40 h-10 bg-slate-300 dark:bg-slate-600 rounded\" />\n              </div>\n              <button className=\"px-4 py-2 mt-4 text-white rounded\" style={{ backgroundColor: defaultTheme.primaryColor }}>\n                Learn More\n              </button>\n            </div>\n          </div>\n\n          {/* After - Current Theme */}\n          <div\n            className=\"absolute inset-0 bg-gradient-to-br overflow-hidden\"\n            style={{ \n              width: `${sliderPosition}%`,\n              backgroundImage: `linear-gradient(to bottom right, ${theme.primaryColor}10, ${theme.secondaryColor}10)`\n            }}\n          >\n            <div className=\"h-full flex flex-col items-center justify-center space-y-4\">\n              <p className=\"text-sm font-medium\" style={{ color: theme.primaryColor }}>\n                After\n              </p>\n              <div className=\"space-y-2\">\n                <div \n                  className=\"w-40 h-10 rounded\" \n                  style={{ backgroundColor: `${theme.primaryColor}30` }} \n                />\n                <div \n                  className=\"w-40 h-10 rounded\" \n                  style={{ backgroundColor: `${theme.secondaryColor}30` }} \n                />\n              </div>\n              <button \n                className=\"px-4 py-2 mt-4 text-white rounded\"\n                style={{ backgroundColor: theme.primaryColor }}\n              >\n                Learn More\n              </button>\n            </div>\n          </div>\n\n          {/* Slider Handle */}\n          <div\n            className=\"absolute top-0 bottom-0 w-1 bg-white cursor-col-resize shadow-lg\"\n            style={{ left: `${sliderPosition}%` }}\n            onMouseDown={(e) => {\n              const rect = e.currentTarget.parentElement?.getBoundingClientRect();\n              if (!rect) return;\n\n              const handleMouseMove = (moveEvent: MouseEvent) => {\n                const newPosition = ((moveEvent.clientX - rect.left) / rect.width) * 100;\n                setSliderPosition(Math.max(0, Math.min(100, newPosition)));\n              };\n\n              const handleMouseUp = () => {\n                document.removeEventListener(\"mousemove\", handleMouseMove);\n                document.removeEventListener(\"mouseup\", handleMouseUp);\n              };\n\n              document.addEventListener(\"mousemove\", handleMouseMove);\n              document.addEventListener(\"mouseup\", handleMouseUp);\n            }}\n          >\n            <div className=\"absolute -left-4 top-1/2 -translate-y-1/2 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center\">\n              <div className=\"text-xs font-bold text-slate-600\">âŸ¨âŸ©</div>\n            </div>\n          </div>\n        </div>\n        <p className=\"text-xs text-muted-foreground mt-3 text-center\">Drag the slider to compare theme changes</p>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":4270,"size_tokens":null},"client/src/hooks/use-debounce.ts":{"content":"import { useState, useEffect } from \"react\";\n\nexport function useDebounce<T>(value: T, delay: number = 500): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","path":null,"size_bytes":392,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/pages/admin/Tools.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  FileText, \n  Database, \n  Mail, \n  TestTube, \n  Wrench,\n  Code,\n  Sparkles,\n  Zap,\n  Globe,\n  Image,\n  MessageSquare,\n  Star,\n  HelpCircle,\n  FolderTree,\n  Clock,\n  FileCode,\n  Webhook,\n  Bell,\n  Calculator,\n  Palette,\n  Monitor\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function AdminTools() {\n  const tools = [\n    {\n      category: \"Content Management\",\n      items: [\n        { \n          name: \"Testimonials Manager\", \n          description: \"Manage customer reviews and testimonials\",\n          icon: Star,\n          href: \"/admin/testimonials\",\n          color: \"text-yellow-500\"\n        },\n        { \n          name: \"FAQ Manager\", \n          description: \"Manage frequently asked questions\",\n          icon: HelpCircle,\n          href: \"/admin/faqs\",\n          color: \"text-blue-500\"\n        },\n        { \n          name: \"Categories\", \n          description: \"Organize content with categories and tags\",\n          icon: FolderTree,\n          href: \"/admin/categories\",\n          color: \"text-green-500\"\n        },\n      ]\n    },\n    {\n      category: \"Communication\",\n      items: [\n        { \n          name: \"Email Templates\", \n          description: \"Create and manage email templates\",\n          icon: Mail,\n          href: \"/admin/email-templates\",\n          color: \"text-purple-500\"\n        },\n        { \n          name: \"Notifications\", \n          description: \"Push notifications and alerts\",\n          icon: Bell,\n          href: \"/admin/notifications\",\n          color: \"text-orange-500\"\n        },\n        { \n          name: \"Webhooks\", \n          description: \"Configure webhook integrations\",\n          icon: Webhook,\n          href: \"/admin/webhooks\",\n          color: \"text-pink-500\"\n        },\n      ]\n    },\n    {\n      category: \"System Tools\",\n      items: [\n        { \n          name: \"Backup Manager\", \n          description: \"Database backup and restore\",\n          icon: Database,\n          href: \"/admin/system\",\n          color: \"text-cyan-500\"\n        },\n        { \n          name: \"Audit Trail\", \n          description: \"View complete system activity log\",\n          icon: Clock,\n          href: \"/admin/activity\",\n          color: \"text-indigo-500\"\n        },\n        { \n          name: \"Cache Manager\", \n          description: \"Clear and manage application cache\",\n          icon: Zap,\n          href: \"/admin/cache\",\n          color: \"text-yellow-500\"\n        },\n      ]\n    },\n    {\n      category: \"Developer Tools\",\n      items: [\n        { \n          name: \"API Documentation\", \n          description: \"Test and explore API endpoints\",\n          icon: Code,\n          href: \"/admin/api-docs\",\n          color: \"text-red-500\"\n        },\n        { \n          name: \"Scheduled Tasks\", \n          description: \"Manage cron jobs and automation\",\n          icon: Clock,\n          href: \"/admin/scheduler\",\n          color: \"text-green-500\"\n        },\n        { \n          name: \"SEO Tools\", \n          description: \"SEO optimization and meta tags\",\n          icon: Globe,\n          href: \"/admin/seo\",\n          color: \"text-blue-500\"\n        },\n      ]\n    },\n    {\n      category: \"Design & Customization\",\n      items: [\n        { \n          name: \"Theme Customizer\", \n          description: \"Advanced theme customization\",\n          icon: Palette,\n          href: \"/admin/theme\",\n          color: \"text-purple-500\"\n        },\n        { \n          name: \"Page Builder\", \n          description: \"Drag & drop page builder\",\n          icon: Monitor,\n          href: \"/admin/page-builder\",\n          color: \"text-pink-500\"\n        },\n        { \n          name: \"Image Optimizer\", \n          description: \"Optimize and compress images\",\n          icon: Image,\n          href: \"/admin/image-optimizer\",\n          color: \"text-orange-500\"\n        },\n      ]\n    },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">Admin Tools</h1>\n          <p className=\"text-muted-foreground\">Powerful tools to manage your portfolio</p>\n        </div>\n\n        {tools.map((category, idx) => (\n          <div key={idx} className=\"space-y-4\">\n            <div className=\"flex items-center gap-2\">\n              <h2 className=\"text-xl font-semibold\">{category.category}</h2>\n              <div className=\"h-px flex-1 bg-border\" />\n            </div>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {category.items.map((tool, i) => (\n                <Link key={i} href={tool.href}>\n                  <Card className=\"cursor-pointer hover:border-primary/50 transition-all hover:-translate-y-1 duration-300 group\">\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className={`p-3 rounded-lg bg-muted group-hover:bg-primary/10 transition-colors`}>\n                          <tool.icon className={`w-6 h-6 ${tool.color}`} />\n                        </div>\n                      </div>\n                      <CardTitle className=\"text-lg mt-3\">{tool.name}</CardTitle>\n                      <CardDescription>{tool.description}</CardDescription>\n                    </CardHeader>\n                  </Card>\n                </Link>\n              ))}\n            </div>\n          </div>\n        ))}\n\n        {/* Quick Actions */}\n        <Card className=\"bg-gradient-to-br from-primary/5 to-secondary/5 border-primary/20\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-5 h-5 text-primary\" />\n              Quick Actions\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Database className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Backup Now</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Zap className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Clear Cache</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Code className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Export Data</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Wrench className=\"w-5 h-5\" />\n                <span className=\"text-xs\">System Check</span>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":6965,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport session from \"express-session\";\nimport connectPgSimple from \"connect-pg-simple\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\nimport { setupWebSocket } from \"./websocket\";\nimport { pool } from \"./db\";\nimport { startPasswordExpiryCron } from \"./cron\";\nimport path from \"path\";\nimport fs from \"fs\";\n\nconst app = express();\n\n// Ensure uploads directory exists\nconst uploadsDir = path.join(process.cwd(), \"uploads\");\nif (!fs.existsSync(uploadsDir)) {\n  fs.mkdirSync(uploadsDir, { recursive: true });\n}\n\n// Serve uploaded files statically\napp.use(\"/uploads\", express.static(uploadsDir, {\n  maxAge: '7d',\n  etag: true,\n}));\nconst PgSession = connectPgSimple(session);\n\n// Create HTTP server without specifying WebSocket port - let it use the same port\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    limit: '50mb',\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false, limit: '50mb' }));\n\n// Setup session middleware BEFORE routes\nconst sessionSecret = process.env.SESSION_SECRET;\nif (!sessionSecret && process.env.NODE_ENV === 'production') {\n  throw new Error('SESSION_SECRET environment variable is required in production');\n}\n\n// Session configuration with PostgreSQL store for persistence\nconst sessionConfig: session.SessionOptions = {\n  store: new PgSession({\n    pool: pool as any,\n    tableName: 'session',\n    createTableIfMissing: true\n  }),\n  secret: sessionSecret || 'dev-secret-key-for-development-only',\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    secure: process.env.NODE_ENV === 'production',\n    httpOnly: true,\n    maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n    sameSite: (process.env.NODE_ENV === 'production' ? 'strict' : 'lax') as 'strict' | 'lax' | 'none'\n  }\n};\n\napp.use(session(sessionConfig));\n\n// Setup CORS headers for credentials\napp.use((req, res, next) => {\n  res.header('Access-Control-Allow-Credentials', 'true');\n  res.header('Access-Control-Allow-Origin', req.get('origin') || '*');\n  res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\n  res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n\n  if (req.method === 'OPTIONS') {\n    return res.sendStatus(200);\n  }\n  next();\n});\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  // Initialize WebSocket server\n  setupWebSocket(httpServer);\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  \n  // Close any existing listeners before starting\n  httpServer.closeAllConnections?.();\n  \n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: false,\n    },\n    () => {\n      log(`serving on port ${port}`);\n      log(`WebSocket server ready at ws://0.0.0.0:${port}/ws`);\n      \n      // Start password expiry cron job\n      startPasswordExpiryCron();\n    },\n  );\n})();","path":null,"size_bytes":4612,"size_tokens":null},"client/src/pages/admin/ActivityLog.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Filter, \n  Download, \n  Calendar, \n  User, \n  Activity, \n  AlertTriangle,\n  Search,\n  RefreshCw,\n  ChevronLeft,\n  ChevronRight,\n  FileText,\n  Settings,\n  MessageSquare,\n  LogIn,\n  LogOut,\n  Trash2,\n  Edit,\n  Plus,\n  Eye,\n  Shield\n} from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { formatDistanceToNow, format } from \"date-fns\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\ntype ActivityLog = {\n  id: number;\n  action: string;\n  userId: number | null;\n  userName: string | null;\n  type: string;\n  metadata: any;\n  createdAt: string;\n};\n\nconst getActionIcon = (action: string) => {\n  const lowerAction = action.toLowerCase();\n  if (lowerAction.includes('login')) return <LogIn className=\"w-4 h-4\" />;\n  if (lowerAction.includes('logout')) return <LogOut className=\"w-4 h-4\" />;\n  if (lowerAction.includes('delete')) return <Trash2 className=\"w-4 h-4\" />;\n  if (lowerAction.includes('update') || lowerAction.includes('edit')) return <Edit className=\"w-4 h-4\" />;\n  if (lowerAction.includes('create') || lowerAction.includes('add') || lowerAction.includes('publish')) return <Plus className=\"w-4 h-4\" />;\n  if (lowerAction.includes('view')) return <Eye className=\"w-4 h-4\" />;\n  if (lowerAction.includes('comment')) return <MessageSquare className=\"w-4 h-4\" />;\n  if (lowerAction.includes('setting')) return <Settings className=\"w-4 h-4\" />;\n  if (lowerAction.includes('security') || lowerAction.includes('password')) return <Shield className=\"w-4 h-4\" />;\n  return <FileText className=\"w-4 h-4\" />;\n};\n\nconst getTypeBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n  switch (type) {\n    case 'error': return 'destructive';\n    case 'warning': return 'secondary';\n    case 'success': return 'default';\n    default: return 'outline';\n  }\n};\n\nconst getTypeLabel = (type: string) => {\n  switch (type) {\n    case 'error': return 'Error';\n    case 'warning': return 'Warning';\n    case 'success': return 'Success';\n    case 'info': return 'Info';\n    default: return type;\n  }\n};\n\nexport default function AdminActivityLog() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [page, setPage] = useState(1);\n  const pageSize = 20;\n\n  const { data: logs = [], isLoading, refetch } = useQuery<ActivityLog[]>({\n    queryKey: ['/api/system/activity-logs'],\n    queryFn: async () => {\n      const res = await fetch(`/api/system/activity-logs?limit=1000&offset=0`, { credentials: 'include' });\n      if (!res.ok) throw new Error('Failed to fetch activity logs');\n      return res.json();\n    },\n  });\n\n  const filteredLogs = logs.filter(log => {\n    const matchesSearch = searchQuery === \"\" ||\n      log.action.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (log.userName && log.userName.toLowerCase().includes(searchQuery.toLowerCase())) ||\n      (log.metadata && JSON.stringify(log.metadata).toLowerCase().includes(searchQuery.toLowerCase()));\n    \n    const matchesType = filterType === \"all\" || log.type === filterType;\n    \n    return matchesSearch && matchesType;\n  });\n\n  const paginatedLogs = filteredLogs.slice((page - 1) * pageSize, page * pageSize);\n  const totalPages = Math.ceil(filteredLogs.length / pageSize);\n\n  const todayLogs = logs.filter(log => {\n    const logDate = new Date(log.createdAt);\n    const today = new Date();\n    return logDate.toDateString() === today.toDateString();\n  });\n\n  const errorLogs = logs.filter(log => log.type === 'error');\n  const uniqueUsers = new Set(logs.map(log => log.userName).filter(Boolean));\n\n  const handleExport = () => {\n    const csvContent = [\n      ['ID', 'Action', 'User', 'Type', 'Timestamp', 'Details'].join(','),\n      ...filteredLogs.map(log => [\n        log.id,\n        `\"${log.action}\"`,\n        log.userName || 'System',\n        log.type,\n        format(new Date(log.createdAt), 'yyyy-MM-dd HH:mm:ss'),\n        `\"${log.metadata ? JSON.stringify(log.metadata).replace(/\"/g, '\"\"') : ''}\"`\n      ].join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `activity-log-${format(new Date(), 'yyyy-MM-dd')}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Activity Log</h1>\n            <p className=\"text-muted-foreground\">Detailed record of all system activities</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              size=\"icon\"\n              onClick={() => refetch()}\n              disabled={isLoading}\n              data-testid=\"button-refresh\"\n            >\n              <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleExport}\n              disabled={filteredLogs.length === 0}\n              data-testid=\"button-export\"\n            >\n              <Download className=\"w-4 h-4\" /> Export Log\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 rounded-lg bg-primary/10\">\n                  <Activity className=\"w-5 h-5 text-primary\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Total Activities</p>\n                  <h3 className=\"text-2xl font-bold\" data-testid=\"text-total-activities\">{logs.length}</h3>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 rounded-lg bg-blue-500/10\">\n                  <Calendar className=\"w-5 h-5 text-blue-500\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Today</p>\n                  <h3 className=\"text-2xl font-bold\" data-testid=\"text-today-activities\">{todayLogs.length}</h3>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 rounded-lg bg-green-500/10\">\n                  <User className=\"w-5 h-5 text-green-500\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Active Users</p>\n                  <h3 className=\"text-2xl font-bold\" data-testid=\"text-active-users\">{uniqueUsers.size}</h3>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 rounded-lg bg-red-500/10\">\n                  <AlertTriangle className=\"w-5 h-5 text-red-500\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Failed Actions</p>\n                  <h3 className=\"text-2xl font-bold\" data-testid=\"text-failed-actions\">{errorLogs.length}</h3>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 space-y-0\">\n            <CardTitle>Activity Timeline</CardTitle>\n            <div className=\"flex flex-wrap gap-2\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  type=\"search\"\n                  placeholder=\"Search activities...\"\n                  className=\"pl-9 w-[200px]\"\n                  value={searchQuery}\n                  onChange={(e) => {\n                    setSearchQuery(e.target.value);\n                    setPage(1);\n                  }}\n                  data-testid=\"input-search\"\n                />\n              </div>\n              <Select value={filterType} onValueChange={(value) => { setFilterType(value); setPage(1); }}>\n                <SelectTrigger className=\"w-[130px]\" data-testid=\"select-filter-type\">\n                  <Filter className=\"w-4 h-4 mr-2\" />\n                  <SelectValue placeholder=\"Filter\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Types</SelectItem>\n                  <SelectItem value=\"info\">Info</SelectItem>\n                  <SelectItem value=\"success\">Success</SelectItem>\n                  <SelectItem value=\"warning\">Warning</SelectItem>\n                  <SelectItem value=\"error\">Error</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"space-y-4\">\n                {[1, 2, 3, 4, 5].map((i) => (\n                  <div key={i} className=\"animate-pulse border-l-4 border-l-muted pl-4 pb-4\">\n                    <div className=\"h-4 bg-muted rounded w-1/3 mb-2\" />\n                    <div className=\"h-3 bg-muted rounded w-1/2 mb-2\" />\n                    <div className=\"h-3 bg-muted rounded w-1/4\" />\n                  </div>\n                ))}\n              </div>\n            ) : paginatedLogs.length === 0 ? (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <Activity className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                <p className=\"text-lg font-medium\">No activity logs found</p>\n                <p className=\"text-sm mt-1\">\n                  {searchQuery || filterType !== \"all\" \n                    ? \"Try adjusting your filters\" \n                    : \"Activity will appear here as actions are performed\"}\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {paginatedLogs.map((log) => (\n                  <div \n                    key={log.id} \n                    className={`border-l-4 pl-4 pb-4 last:pb-0 transition-colors ${\n                      log.type === 'error' \n                        ? 'border-l-red-500/70' \n                        : log.type === 'warning'\n                        ? 'border-l-yellow-500/70'\n                        : log.type === 'success'\n                        ? 'border-l-green-500/70'\n                        : 'border-l-primary/50'\n                    }`}\n                    data-testid={`activity-log-${log.id}`}\n                  >\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n                          <div className={`p-1.5 rounded ${\n                            log.type === 'error' \n                              ? 'bg-red-500/10 text-red-500' \n                              : log.type === 'warning'\n                              ? 'bg-yellow-500/10 text-yellow-500'\n                              : log.type === 'success'\n                              ? 'bg-green-500/10 text-green-500'\n                              : 'bg-primary/10 text-primary'\n                          }`}>\n                            {getActionIcon(log.action)}\n                          </div>\n                          <h4 className=\"font-bold\">{log.action}</h4>\n                          <Badge variant={getTypeBadgeVariant(log.type)}>\n                            {getTypeLabel(log.type)}\n                          </Badge>\n                        </div>\n                        {log.metadata && (\n                          <p className=\"text-sm text-muted-foreground mb-1\">\n                            {typeof log.metadata === 'object' \n                              ? (log.metadata.details || log.metadata.description || JSON.stringify(log.metadata))\n                              : log.metadata\n                            }\n                          </p>\n                        )}\n                        <div className=\"flex gap-4 mt-2 text-xs text-muted-foreground\">\n                          <span className=\"flex items-center gap-1\">\n                            <User className=\"w-3 h-3\" />\n                            {log.userName || 'System'}\n                          </span>\n                          {log.metadata?.ip && (\n                            <span>IP: {log.metadata.ip}</span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"text-right flex-shrink-0\">\n                        <span className=\"text-xs text-muted-foreground whitespace-nowrap block\">\n                          {formatDistanceToNow(new Date(log.createdAt), { addSuffix: true })}\n                        </span>\n                        <span className=\"text-xs text-muted-foreground/70 whitespace-nowrap block mt-0.5\">\n                          {format(new Date(log.createdAt), 'MMM d, h:mm a')}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-between mt-6 pt-4 border-t\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Showing {((page - 1) * pageSize) + 1} to {Math.min(page * pageSize, filteredLogs.length)} of {filteredLogs.length} entries\n                </p>\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.max(1, p - 1))}\n                    disabled={page === 1}\n                    data-testid=\"button-prev-page\"\n                  >\n                    <ChevronLeft className=\"w-4 h-4\" />\n                  </Button>\n                  <span className=\"text-sm px-2\">\n                    Page {page} of {totalPages}\n                  </span>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.min(totalPages, p + 1))}\n                    disabled={page === totalPages}\n                    data-testid=\"button-next-page\"\n                  >\n                    <ChevronRight className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":15691,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/pages/admin/ImageOptimizer.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { \n  Upload, \n  Image as ImageIcon,\n  Zap,\n  Download,\n  Trash2,\n  Settings,\n  CheckCircle\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminImageOptimizer() {\n  const [quality, setQuality] = useState([80]);\n  const [images] = useState([\n    { id: 1, name: \"hero-bg.jpg\", original: \"2.4 MB\", optimized: \"456 KB\", saved: \"81%\", status: \"completed\" },\n    { id: 2, name: \"project-1.png\", original: \"1.8 MB\", optimized: \"340 KB\", saved: \"81%\", status: \"completed\" },\n    { id: 3, name: \"avatar.jpg\", original: \"890 KB\", optimized: \"180 KB\", saved: \"80%\", status: \"processing\" },\n  ]);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Image Optimizer</h1>\n            <p className=\"text-muted-foreground\">Compress and optimize images for better performance</p>\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Total Images</p>\n              <p className=\"font-bold text-2xl\">156</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Optimized</p>\n              <p className=\"font-bold text-2xl text-green-600\">142</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Space Saved</p>\n              <p className=\"font-bold text-2xl\">45.2 MB</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Avg Compression</p>\n              <p className=\"font-bold text-2xl\">78%</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Upload Area */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"border-2 border-dashed rounded-lg p-12 flex flex-col items-center justify-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\">\n              <Upload className=\"w-12 h-12 text-muted-foreground mb-3\" />\n              <h3 className=\"font-bold mb-1\">Drop images here or click to upload</h3>\n              <p className=\"text-sm text-muted-foreground\">JPG, PNG, WebP (Max 10MB each)</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Settings */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Settings className=\"w-5 h-5\" /> Optimization Settings\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div>\n                <div className=\"flex justify-between mb-2\">\n                  <label className=\"text-sm font-medium\">Quality</label>\n                  <span className=\"text-sm text-muted-foreground\">{quality[0]}%</span>\n                </div>\n                <Slider value={quality} onValueChange={setQuality} min={1} max={100} step={1} />\n              </div>\n              \n              <div>\n                <label className=\"text-sm font-medium block mb-2\">Output Format</label>\n                <select className=\"w-full p-2 border rounded-md bg-background\">\n                  <option>Auto (Recommended)</option>\n                  <option>WebP</option>\n                  <option>JPEG</option>\n                  <option>PNG</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-medium block mb-2\">Max Width (px)</label>\n                <input type=\"number\" defaultValue=\"1920\" className=\"w-full p-2 border rounded-md\" />\n              </div>\n\n              <Button className=\"w-full\">\n                <Zap className=\"w-4 h-4 mr-2\" /> Optimize All\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Processing Queue</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {images.map((img) => (\n                  <div key={img.id} className=\"border rounded-lg p-3\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <ImageIcon className=\"w-4 h-4 text-muted-foreground\" />\n                        <span className=\"font-medium text-sm\">{img.name}</span>\n                      </div>\n                      {img.status === \"completed\" ? (\n                        <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                      ) : (\n                        <Badge variant=\"secondary\">Processing</Badge>\n                      )}\n                    </div>\n                    \n                    {img.status === \"processing\" ? (\n                      <Progress value={65} className=\"h-1\" />\n                    ) : (\n                      <div className=\"flex justify-between text-xs text-muted-foreground\">\n                        <span>{img.original} â†’ {img.optimized}</span>\n                        <span className=\"text-green-600 font-medium\">-{img.saved}</span>\n                      </div>\n                    )}\n\n                    {img.status === \"completed\" && (\n                      <div className=\"flex gap-2 mt-2\">\n                        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                          <Download className=\"w-3 h-3 mr-1\" /> Download\n                        </Button>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          <Trash2 className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":6600,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/pages/admin/SettingsPerformance.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Zap, Globe, BarChart3, Activity, Server, HardDrive, RefreshCw } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useState } from \"react\";\n\ninterface PerformanceMetrics {\n  pageLoadTime: string;\n  coreWebVitals: string;\n  cacheHitRate: string;\n  memoryUsage: string;\n  uptime: string;\n  requestsPerMinute: number;\n}\n\nexport function SettingsPerformance() {\n  const { toast } = useToast();\n  const { settings, updateSettings, saveSettings, isSaving } = useSiteSettings();\n  const [isClearing, setIsClearing] = useState(false);\n  const [metrics, setMetrics] = useState<PerformanceMetrics>({\n    pageLoadTime: \"1.2s\",\n    coreWebVitals: \"Good\",\n    cacheHitRate: \"87%\",\n    memoryUsage: \"45%\",\n    uptime: \"99.9%\",\n    requestsPerMinute: 12\n  });\n  \n  const handleClearCache = async () => {\n    setIsClearing(true);\n    try {\n      await api.clearCache();\n      toast({ \n        title: \"Success\", \n        description: \"Cache cleared successfully\" \n      });\n    } catch (error: any) {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to clear cache\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsClearing(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BarChart3 className=\"w-5 h-5\" /> Performance Overview\n          </CardTitle>\n          <CardDescription>Real-time performance metrics for your portfolio</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Activity className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Page Load</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.pageLoadTime}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Zap className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Core Web Vitals</p>\n              </div>\n              <Badge variant={metrics.coreWebVitals === \"Good\" ? \"default\" : \"secondary\"} className=\"mt-1\">\n                {metrics.coreWebVitals}\n              </Badge>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <HardDrive className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Cache Hit Rate</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.cacheHitRate}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Server className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Memory Usage</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.memoryUsage}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Globe className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Uptime</p>\n              </div>\n              <p className=\"font-bold text-lg text-green-600\">{metrics.uptime}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <RefreshCw className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Requests/min</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.requestsPerMinute}</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Zap className=\"w-5 h-5\" /> Caching Configuration\n          </CardTitle>\n          <CardDescription>Optimize site performance with browser and server caching</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Browser Cache</Label>\n              <p className=\"text-xs text-muted-foreground\">Cache static assets on visitor's browser</p>\n            </div>\n            <Switch \n              checked={settings.enableBrowserCache !== false}\n              onCheckedChange={(checked) => updateSettings({ enableBrowserCache: checked })}\n              data-testid=\"switch-browser-cache\"\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm\">Static Assets TTL</Label>\n              <Input \n                type=\"number\" \n                value={settings.staticCacheTTL || 86400}\n                onChange={(e) => updateSettings({ staticCacheTTL: parseInt(e.target.value) || 86400 })}\n                data-testid=\"input-static-cache-ttl\"\n              />\n              <p className=\"text-xs text-muted-foreground\">Seconds (86400 = 1 day)</p>\n            </div>\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm\">API Response TTL</Label>\n              <Input \n                type=\"number\" \n                value={settings.apiCacheTTL || 300}\n                onChange={(e) => updateSettings({ apiCacheTTL: parseInt(e.target.value) || 300 })}\n                data-testid=\"input-api-cache-ttl\"\n              />\n              <p className=\"text-xs text-muted-foreground\">Seconds (300 = 5 minutes)</p>\n            </div>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Response Compression</Label>\n              <p className=\"text-xs text-muted-foreground\">Gzip compress API responses</p>\n            </div>\n            <Switch \n              checked={settings.enableCompression !== false}\n              onCheckedChange={(checked) => updateSettings({ enableCompression: checked })}\n              data-testid=\"switch-compression\"\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              className=\"flex-1\"\n              onClick={handleClearCache}\n              disabled={isClearing}\n              data-testid=\"button-clear-cache\"\n            >\n              {isClearing ? \"Clearing...\" : \"Clear All Cache\"}\n            </Button>\n          </div>\n          <p className=\"text-xs text-muted-foreground\">\n            Changes are automatically tracked and saved using the \"Save Changes\" button in the header.\n          </p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Globe className=\"w-5 h-5\" /> Asset Optimization\n          </CardTitle>\n          <CardDescription>Optimize images and static assets for faster loading</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Lazy Load Images</Label>\n              <p className=\"text-xs text-muted-foreground\">Load images only when visible</p>\n            </div>\n            <Switch \n              checked={settings.lazyLoadImages !== false}\n              onCheckedChange={(checked) => updateSettings({ lazyLoadImages: checked })}\n              data-testid=\"switch-lazy-load\"\n            />\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Auto-optimize Images</Label>\n              <p className=\"text-xs text-muted-foreground\">Automatically compress uploaded images</p>\n            </div>\n            <Switch \n              checked={settings.autoOptimizeImages === true}\n              onCheckedChange={(checked) => updateSettings({ autoOptimizeImages: checked })}\n              data-testid=\"switch-auto-optimize\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label className=\"text-sm\">Max Image Width (px)</Label>\n            <Input \n              type=\"number\" \n              value={settings.maxImageWidth || 1920}\n              onChange={(e) => updateSettings({ maxImageWidth: parseInt(e.target.value) || 1920 })}\n              data-testid=\"input-max-image-width\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Images larger than this will be resized</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":9443,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\n// staleTime configurations for different query types\nexport const STALE_TIMES = {\n  static: Infinity,           // Settings, site config - rarely changes\n  long: 1000 * 60 * 30,       // 30 min - Projects, posts, categories\n  medium: 1000 * 60 * 5,      // 5 min - Comments, reviews, skills\n  short: 1000 * 60 * 1,       // 1 min - Messages, notifications\n  realtime: 1000 * 30,        // 30 sec - Dashboard stats\n};\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: STALE_TIMES.medium,  // 5 min default staleTime\n      gcTime: 1000 * 60 * 30,         // 30 min garbage collection\n      retry: 1,                        // Retry once on failure\n      retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000),\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":2030,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/hooks/use-confirmation.ts":{"content":"import { useState } from \"react\";\n\ninterface ConfirmationState {\n  isOpen: boolean;\n  title: string;\n  description: string;\n  actionLabel?: string;\n  isDestructive?: boolean;\n  onConfirm?: () => void | Promise<void>;\n}\n\nexport function useConfirmation() {\n  const [state, setState] = useState<ConfirmationState>({\n    isOpen: false,\n    title: \"\",\n    description: \"\",\n  });\n  const [isLoading, setIsLoading] = useState(false);\n\n  const confirm = async (config: Omit<ConfirmationState, \"isOpen\">) => {\n    setState({ ...config, isOpen: true });\n    return new Promise<boolean>((resolve) => {\n      const originalOnConfirm = config.onConfirm;\n      config.onConfirm = async () => {\n        setIsLoading(true);\n        try {\n          if (originalOnConfirm) {\n            await originalOnConfirm();\n          }\n          resolve(true);\n        } finally {\n          setIsLoading(false);\n          setState((s) => ({ ...s, isOpen: false }));\n        }\n      };\n    });\n  };\n\n  const cancel = () => {\n    setState((s) => ({ ...s, isOpen: false }));\n  };\n\n  return { state, isLoading, confirm, cancel };\n}\n","path":null,"size_bytes":1101,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/pages/admin/Posts.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { api } from \"@/lib/api\";\nimport { \n  Plus, \n  Search, \n  Filter, \n  Edit,\n  Trash,\n  FileText,\n  Calendar,\n  Eye,\n  Star,\n  Loader2,\n  User\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n\ntype Post = {\n  id: number;\n  title: string;\n  slug: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\";\n  content: string | null;\n  excerpt: string | null;\n  featuredImage: string | null;\n  tags: string[];\n  featured: boolean;\n  views: number;\n  publishedAt: string | null;\n  createdAt: string;\n  updatedAt: string;\n};\n\ntype PostFormData = {\n  title: string;\n  slug: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\";\n  content: string;\n  excerpt: string;\n  featuredImage: string;\n  tags: string[];\n  featured: boolean;\n};\n\nconst getDefaultFormData = (): PostFormData => ({\n  title: \"\",\n  slug: \"\",\n  category: \"general\",\n  author: \"Admin\",\n  status: \"Draft\",\n  content: \"\",\n  excerpt: \"\",\n  featuredImage: \"\",\n  tags: [],\n  featured: false,\n});\n\nconst generateSlug = (title: string) => {\n  return title\n    .toLowerCase()\n    .trim()\n    .replace(/[^\\w\\s-]/g, \"\")\n    .replace(/[\\s_]+/g, \"-\")\n    .replace(/^-+|-+$/g, \"\");\n};\n\nexport default function AdminPosts() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingPost, setEditingPost] = useState<Post | null>(null);\n  const [formData, setFormData] = useState<PostFormData>(getDefaultFormData());\n  const [tagInput, setTagInput] = useState(\"\");\n  const [uploading, setUploading] = useState(false);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n\n  const { data: posts = [], isLoading } = useQuery<Post[]>({\n    queryKey: [\"/api/posts\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/posts\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch posts\");\n      return res.json();\n    },\n  });\n\n  const { data: categories = [] } = useQuery<Array<{ slug: string; name: string }>>({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/categories?type=post\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch categories\");\n      return res.json();\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => api.createPost(data),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/posts\"] });\n      closeDialog();\n      toast({ title: \"Success\", description: `\"${variables.title}\" has been created successfully` });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to create post\", variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: any }) => api.updatePost(id, data),\n    onSuccess: (_, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/posts\"] });\n      closeDialog();\n      toast({ title: \"Success\", description: `Post has been updated successfully` });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to update post\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deletePost(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/posts\"] });\n      toast({ title: \"Success\", description: \"Post has been deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to delete post\", variant: \"destructive\" });\n    },\n  });\n\n  const handleImageUpload = async (file: File) => {\n    if (!file) return;\n    setUploading(true);\n    try {\n      const formDataUpload = new FormData();\n      formDataUpload.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      setFormData(prev => ({ ...prev, featuredImage: data.url }));\n      toast({ title: \"Success\", description: \"Image uploaded\" });\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const filteredPosts = posts.filter(post => \n    post.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    post.category.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    post.author.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    post.tags?.some(t => t.toLowerCase().includes(searchQuery.toLowerCase()))\n  );\n\n  const handleDelete = (id: number) => {\n    const post = posts.find(p => p.id === id);\n    if (!post) return;\n\n    const confirmed = window.confirm(\n      `Are you sure you want to delete \"${post.title}\"?\\n\\nThis action cannot be undone.`\n    );\n    \n    if (confirmed) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const openAddDialog = () => {\n    setEditingPost(null);\n    setFormData(getDefaultFormData());\n    setTagInput(\"\");\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (post: Post) => {\n    setEditingPost(post);\n    setFormData({\n      title: post.title,\n      slug: post.slug,\n      category: post.category,\n      author: post.author,\n      status: post.status,\n      content: post.content || \"\",\n      excerpt: post.excerpt || \"\",\n      featuredImage: post.featuredImage || \"\",\n      tags: post.tags || [],\n      featured: post.featured,\n    });\n    setTagInput(\"\");\n    setIsDialogOpen(true);\n  };\n\n  const closeDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPost(null);\n    setFormData(getDefaultFormData());\n    setTagInput(\"\");\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Validation Error\", description: \"Post title is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (!formData.slug.trim()) {\n      toast({ title: \"Validation Error\", description: \"Post slug is required\", variant: \"destructive\" });\n      return;\n    }\n\n    const postData = {\n      title: formData.title.trim(),\n      slug: formData.slug.trim(),\n      category: formData.category || \"general\",\n      author: formData.author.trim() || \"Admin\",\n      status: formData.status,\n      content: formData.content.trim() || null,\n      excerpt: formData.excerpt.trim() || null,\n      featuredImage: formData.featuredImage.trim() || null,\n      tags: formData.tags,\n      featured: formData.featured,\n      publishedAt: formData.status === \"Published\" ? new Date().toISOString() : null,\n    };\n\n    if (editingPost) {\n      updateMutation.mutate({ id: editingPost.id, data: postData });\n    } else {\n      createMutation.mutate(postData);\n    }\n  };\n\n  const addTag = () => {\n    const tag = tagInput.trim();\n    if (!tag) {\n      toast({ title: \"Validation Error\", description: \"Please enter a tag name\", variant: \"destructive\" });\n      return;\n    }\n    \n    if (formData.tags.includes(tag)) {\n      toast({ title: \"Validation Error\", description: \"This tag is already added\", variant: \"destructive\" });\n      return;\n    }\n    \n    setFormData({ ...formData, tags: [...formData.tags, tag] });\n    setTagInput(\"\");\n  };\n\n  const removeTag = (tag: string) => {\n    setFormData({ ...formData, tags: formData.tags.filter(t => t !== tag) });\n  };\n\n  const toggleStatus = (id: number, currentStatus: string) => {\n    const post = posts.find(p => p.id === id);\n    if (!post) return;\n\n    const newStatus = currentStatus === \"Published\" ? \"Draft\" : \"Published\";\n    const updateData: any = { status: newStatus };\n    if (newStatus === \"Published\" && !post.publishedAt) {\n      updateData.publishedAt = new Date().toISOString();\n    }\n    updateMutation.mutate({ id, data: updateData });\n  };\n\n  const toggleFeatured = (id: number, currentFeatured: boolean) => {\n    updateMutation.mutate({ id, data: { featured: !currentFeatured } });\n  };\n\n  const isSaving = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Blog Posts</h1>\n            <p className=\"text-muted-foreground\">Manage your blog content</p>\n          </div>\n          <Button className=\"bg-primary hover:bg-primary/90\" onClick={openAddDialog} data-testid=\"button-new-post\">\n            <Plus className=\"w-4 h-4 mr-2\" /> New Post\n          </Button>\n        </div>\n\n        <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input \n              placeholder=\"Search posts by title, category, author, or tags...\" \n              className=\"pl-9\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              data-testid=\"input-search-posts\"\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Filter className=\"w-4 h-4\" /> Category\n            </Button>\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Calendar className=\"w-4 h-4\" /> Date\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          {isLoading ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <Loader2 className=\"h-12 w-12 animate-spin text-primary mb-4\" />\n                <p className=\"text-muted-foreground\">Loading posts...</p>\n              </CardContent>\n            </Card>\n          ) : filteredPosts.length === 0 ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <FileText className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No posts found</h3>\n                <p className=\"text-muted-foreground mb-4\">\n                  {searchQuery ? \"Try a different search term\" : \"Create your first blog post to get started\"}\n                </p>\n                {!searchQuery && (\n                  <Button onClick={openAddDialog}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> New Post\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          ) : (\n            filteredPosts.map((post) => (\n              <Card key={post.id} className=\"overflow-hidden group\" data-testid={`post-card-${post.id}`}>\n                <div className=\"flex flex-col md:flex-row\">\n                  <div className=\"w-full md:w-48 h-32 md:h-auto relative bg-muted\">\n                    {post.featuredImage ? (\n                      <img \n                        src={post.featuredImage} \n                        alt={post.title} \n                        className=\"w-full h-full object-cover\" \n                      />\n                    ) : (\n                      <div className=\"w-full h-full flex items-center justify-center\">\n                        <FileText className=\"w-12 h-12 text-muted-foreground\" />\n                      </div>\n                    )}\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity\">\n                      <Button variant=\"secondary\" size=\"sm\" onClick={() => openEditDialog(post)}>\n                        Edit Image\n                      </Button>\n                    </div>\n                    {post.featured && (\n                      <div className=\"absolute top-2 left-2\">\n                        <Badge className=\"bg-yellow-500 text-black\">\n                          <Star className=\"w-3 h-3 mr-1\" /> Featured\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n\n                  <CardContent className=\"flex-1 p-6\">\n                    <div className=\"flex flex-col md:flex-row justify-between gap-4\">\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <h3 className=\"text-xl font-bold\">{post.title}</h3>\n                          <Badge \n                            variant={post.status === \"Published\" ? \"default\" : \"outline\"}\n                            className={`cursor-pointer ${post.status === \"Published\" ? \"bg-green-500 hover:bg-green-600\" : \"hover:bg-muted\"}`}\n                            onClick={() => toggleStatus(post.id, post.status)}\n                            data-testid={`badge-status-${post.id}`}\n                          >\n                            {post.status}\n                          </Badge>\n                        </div>\n                        \n                        <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                          <div className=\"flex items-center gap-1\">\n                            <User className=\"w-4 h-4\" /> \n                            <span className=\"text-foreground font-medium\">{post.author}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <FileText className=\"w-4 h-4\" /> Category: \n                            <span className=\"text-foreground font-medium\">{post.category}</span>\n                          </div>\n                          {post.createdAt && (\n                            <div className=\"flex items-center gap-1\">\n                              <Calendar className=\"w-4 h-4\" /> Created: \n                              <span className=\"text-foreground font-medium\">\n                                {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}\n                              </span>\n                            </div>\n                          )}\n                        </div>\n\n                        {post.tags && post.tags.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2 mt-2\">\n                            {post.tags.map(t => (\n                              <Badge key={t} variant=\"secondary\" className=\"text-xs\">\n                                {t}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n\n                        {post.excerpt && (\n                          <p className=\"text-sm text-muted-foreground line-clamp-2 mt-2\">\n                            {post.excerpt}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"flex flex-col items-end gap-2\">\n                        <div className=\"flex gap-2\">\n                          <Button \n                            variant=\"outline\" \n                            size=\"icon\" \n                            title=\"Toggle Featured\"\n                            onClick={() => toggleFeatured(post.id, post.featured)}\n                            className={post.featured ? \"text-yellow-500\" : \"\"}\n                            disabled={updateMutation.isPending}\n                            data-testid={`button-featured-${post.id}`}\n                          >\n                            <Star className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"default\" \n                            size=\"icon\" \n                            title=\"Edit Post\"\n                            onClick={() => openEditDialog(post)}\n                            data-testid={`button-edit-${post.id}`}\n                          >\n                            <Edit className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"destructive\" \n                            size=\"icon\" \n                            title=\"Delete\" \n                            onClick={() => handleDelete(post.id)}\n                            disabled={deleteMutation.isPending}\n                            data-testid={`button-delete-${post.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                        <div className=\"text-xs text-muted-foreground mt-2\">\n                          <Eye className=\"w-3 h-3 inline mr-1\" />\n                          <span className=\"font-medium text-foreground\">{post.views || 0}</span> views\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </div>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={(open) => !open && closeDialog()}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{editingPost ? \"Edit Post\" : \"Create New Post\"}</DialogTitle>\n            <DialogDescription>\n              {editingPost ? \"Update the post details below.\" : \"Fill in the details for your new blog post.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"title\">Post Title *</Label>\n                <Input\n                  id=\"title\"\n                  value={formData.title}\n                  onChange={(e) => {\n                    const newTitle = e.target.value;\n                    const newSlug = generateSlug(newTitle);\n                    setFormData({ ...formData, title: newTitle, slug: newSlug });\n                  }}\n                  placeholder=\"Enter post title\"\n                  data-testid=\"input-post-title\"\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"slug\">Slug *</Label>\n                <Input\n                  id=\"slug\"\n                  value={formData.slug}\n                  onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                  placeholder=\"post-url-slug\"\n                  data-testid=\"input-post-slug\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length === 0 ? (\n                      <SelectItem value=\"general\">General</SelectItem>\n                    ) : (\n                      categories.map((cat) => (\n                        <SelectItem key={cat.slug} value={cat.slug}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value: \"Published\" | \"Draft\") => \n                    setFormData({ ...formData, status: value })\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-status\">\n                    <SelectValue placeholder=\"Select status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label htmlFor=\"author\">Author</Label>\n                <Input\n                  id=\"author\"\n                  value={formData.author}\n                  onChange={(e) => setFormData({ ...formData, author: e.target.value })}\n                  placeholder=\"Author name\"\n                  data-testid=\"input-author\"\n                />\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <Switch\n                  id=\"featured\"\n                  checked={formData.featured}\n                  onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n                  data-testid=\"switch-featured\"\n                />\n                <Label htmlFor=\"featured\">Featured Post</Label>\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"featuredImage\">Featured Image</Label>\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"featuredImage\"\n                    value={formData.featuredImage}\n                    readOnly\n                    placeholder=\"No image selected\"\n                    data-testid=\"input-featured-image\"\n                  />\n                  <Button variant=\"outline\" onClick={() => imageInputRef.current?.click()} disabled={uploading}>\n                    {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                  </Button>\n                </div>\n                <input\n                  ref={imageInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  onChange={(e) => e.target.files?.[0] && handleImageUpload(e.target.files[0])}\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"excerpt\">Excerpt</Label>\n                <Textarea\n                  id=\"excerpt\"\n                  value={formData.excerpt}\n                  onChange={(e) => setFormData({ ...formData, excerpt: e.target.value })}\n                  placeholder=\"Brief description of the post...\"\n                  rows={2}\n                  data-testid=\"textarea-excerpt\"\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label htmlFor=\"content\">Content</Label>\n                <Textarea\n                  id=\"content\"\n                  value={formData.content}\n                  onChange={(e) => setFormData({ ...formData, content: e.target.value })}\n                  placeholder=\"Write your post content here...\"\n                  rows={6}\n                  data-testid=\"textarea-content\"\n                />\n              </div>\n\n              <div className=\"col-span-2\">\n                <Label>Tags</Label>\n                <div className=\"flex gap-2 mb-2\">\n                  <Input\n                    value={tagInput}\n                    onChange={(e) => setTagInput(e.target.value)}\n                    placeholder=\"Add tag (e.g., React)\"\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault();\n                        addTag();\n                      }\n                    }}\n                    data-testid=\"input-tag\"\n                  />\n                  <Button type=\"button\" variant=\"outline\" onClick={addTag}>\n                    Add\n                  </Button>\n                </div>\n                {formData.tags.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {formData.tags.map((tag) => (\n                      <Badge key={tag} variant=\"secondary\" className=\"cursor-pointer\" onClick={() => removeTag(tag)}>\n                        {tag} &times;\n                      </Badge>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={closeDialog}>\n              Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isSaving} data-testid=\"button-save-post\">\n              {isSaving ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                editingPost ? \"Update Post\" : \"Create Post\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":25718,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/sections/About.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Code, Music, Gamepad, Camera, Plane } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\nconst avatarImage = \"/uploads/images/futuristic_3d_developer_avatar.png\";\n\nexport function About() {\n  const { data: settings } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n    staleTime: 1000 * 60 * 5,\n  });\n\n  const aboutTitle = settings?.aboutTitle || \"About Me\";\n  const aboutSubtitle = settings?.aboutSubtitle || \"Full-stack Developer based in Vietnam\";\n  const aboutDescription = settings?.aboutDescription || \"I started my coding journey with a curiosity for how things work on the web. Now, I specialize in building modern, scalable, and user-friendly applications using the latest technologies.\";\n  const aboutDescription2 = settings?.aboutDescription2 || \"My philosophy is simple: Code with passion, build with purpose. Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\";\n  const aboutName = settings?.aboutName || \"Nguyen Thanh Loi\";\n  const aboutEmail = settings?.contactEmail || \"loideveloper@example.com\";\n  const aboutLocation = settings?.aboutLocation || \"Ho Chi Minh City\";\n  const aboutFreelance = settings?.aboutFreelance || \"Available\";\n  const aboutImageUrl = settings?.aboutImage || avatarImage;\n\n  return (\n    <section id=\"about\" className=\"py-24 bg-background relative overflow-hidden\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex flex-col items-center mb-16\">\n          <h2 className=\"text-3xl md:text-4xl font-heading font-bold text-center mb-4\">\n            {aboutTitle.includes(\" \") ? (\n              <>\n                {aboutTitle.split(\" \").slice(0, -1).join(\" \")} <span className=\"text-primary\">{aboutTitle.split(\" \").slice(-1)}</span>\n              </>\n            ) : (\n              <>About <span className=\"text-primary\">Me</span></>\n            )}\n          </h2>\n          <div className=\"w-20 h-1 bg-primary rounded-full\" />\n        </div>\n\n        <div className=\"grid md:grid-cols-2 gap-16 items-center\">\n          <motion.div\n            initial={{ opacity: 0, x: -50 }}\n            whileInView={{ opacity: 1, x: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.6 }}\n            className=\"relative\"\n          >\n            <div className=\"relative w-full aspect-square max-w-md mx-auto\">\n              <div className=\"absolute inset-0 bg-gradient-to-br from-primary to-secondary rounded-2xl rotate-6 opacity-20\" />\n              <div className=\"absolute inset-0 bg-card rounded-2xl border border-white/10 shadow-2xl overflow-hidden rotate-0 hover:-rotate-2 transition-transform duration-300\">\n                <img \n                  src={aboutImageUrl} \n                  alt=\"Portrait\" \n                  className=\"w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500\" \n                />\n              </div>\n            </div>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, x: 50 }}\n            whileInView={{ opacity: 1, x: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.6, delay: 0.2 }}\n          >\n            <h3 className=\"text-2xl font-bold mb-6 text-foreground\">\n              {aboutSubtitle}\n            </h3>\n            <div className=\"space-y-4 text-muted-foreground text-lg mb-8\">\n              <p>{aboutDescription}</p>\n              <p>\n                {aboutDescription2.includes(\"Code with passion\") ? (\n                  <>\n                    My philosophy is simple: <span className=\"text-primary font-semibold\">Code with passion, build with purpose.</span>\n                    {aboutDescription2.split(\"Code with passion, build with purpose.\")[1] || \" Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\"}\n                  </>\n                ) : (\n                  aboutDescription2\n                )}\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-10\">\n              {[\n                { label: \"Name\", value: aboutName },\n                { label: \"Email\", value: aboutEmail },\n                { label: \"From\", value: aboutLocation },\n                { label: \"Freelance\", value: aboutFreelance },\n              ].map((item) => (\n                <div key={item.label} className=\"flex flex-col\">\n                  <span className=\"text-sm text-muted-foreground font-mono\">{item.label}:</span>\n                  <span className=\"text-foreground font-medium text-lg\">{item.value}</span>\n                </div>\n              ))}\n            </div>\n\n            <div>\n              <h4 className=\"font-bold mb-4 text-foreground\">My Interests</h4>\n              <div className=\"flex flex-wrap gap-4\">\n                {[\n                  { icon: Code, label: \"Coding\" },\n                  { icon: Music, label: \"Music\" },\n                  { icon: Gamepad, label: \"Gaming\" },\n                  { icon: Camera, label: \"Photo\" },\n                  { icon: Plane, label: \"Travel\" },\n                ].map((interest, i) => (\n                  <motion.div\n                    key={i}\n                    whileHover={{ y: -5 }}\n                    className=\"group relative p-3 bg-card border border-border rounded-xl hover:border-primary transition-colors cursor-default shadow-sm hover:shadow-md\"\n                  >\n                    <interest.icon className=\"w-6 h-6 text-muted-foreground group-hover:text-primary transition-colors\" />\n                    <span className=\"absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-primary text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none transform translate-y-2 group-hover:translate-y-0 duration-200\">\n                      {interest.label}\n                    </span>\n                  </motion.div>\n                ))}\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":6168,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  const uploadsPath = path.resolve(process.cwd(), \"uploads\");\n  if (!fs.existsSync(uploadsPath)) {\n    fs.mkdirSync(uploadsPath, { recursive: true });\n  }\n  app.use(\"/uploads\", express.static(uploadsPath));\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":755,"size_tokens":null},"client/src/pages/admin/SecurityEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useState, useEffect } from \"react\";\nimport { \n  Shield, Key, Lock, Smartphone, Globe, AlertTriangle, Trash2,\n  ShieldAlert, RefreshCw, Eye, EyeOff, Clock, Users,\n  Monitor, LogOut, Ban, CheckCircle, XCircle,\n  Server, AlertCircle, Plus, Loader2, FileText, BarChart3, \n  Zap, Activity, Layers, QrCode, Copy, Check\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\n\ninterface SecuritySettings {\n  twoFactorEnabled?: boolean;\n  passwordExpiration?: boolean;\n  captchaType?: 'disabled' | 'local' | 'google' | 'cloudflare';\n  captchaSettings?: {\n    honeypotEnabled?: boolean;\n    timeValidation?: boolean;\n    ipRateLimit?: boolean;\n    googleSiteKey?: string;\n    googleSecretKey?: string;\n    googleMinScore?: number;\n    cloudflareSiteKey?: string;\n    cloudflareSecretKey?: string;\n    cloudflareManagedMode?: boolean;\n  };\n  protectionCoverage?: {\n    loginForm?: boolean;\n    contactForm?: boolean;\n    newsletterForm?: boolean;\n    commentForms?: boolean;\n    registrationForm?: boolean;\n  };\n  rateLimiting?: {\n    loginAttemptsLimit?: number;\n    apiRateLimit?: number;\n    lockoutDuration?: number;\n  };\n  ddosProtection?: {\n    enabled?: boolean;\n    threshold?: number;\n    blockDuration?: number;\n  };\n  sqlInjectionProtection?: {\n    enabled?: boolean;\n    logAttempts?: boolean;\n    blockRequests?: boolean;\n  };\n  xssProtection?: {\n    enabled?: boolean;\n    sanitizeInput?: boolean;\n    blockRequests?: boolean;\n  };\n  sessionSettings?: {\n    idleTimeout?: string;\n    maxDuration?: string;\n    forceLogoutInactive?: boolean;\n    concurrentSessionLimit?: string;\n  };\n  compliance?: {\n    gdprEnabled?: boolean;\n    dataRetentionDays?: number;\n    privacyPolicyUrl?: string;\n    cookieConsentEnabled?: boolean;\n  };\n  cspSettings?: {\n    enabled?: boolean;\n    strictMode?: boolean;\n    reportUri?: string;\n  };\n  scannerSettings?: {\n    vulnerabilityScanEnabled?: boolean;\n    sslScanEnabled?: boolean;\n    malwareScanEnabled?: boolean;\n    scanFrequency?: string;\n  };\n}\n\ninterface TrustedDevice {\n  id: number;\n  userId: number;\n  deviceName: string;\n  deviceFingerprint?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  trusted: boolean;\n  lastUsed?: string;\n  createdAt?: string;\n}\n\ninterface UserSession {\n  id: number;\n  sessionId: string;\n  userId: number;\n  ipAddress?: string;\n  userAgent?: string;\n  deviceInfo?: string;\n  location?: string;\n  active: boolean;\n  createdAt?: string;\n  expiresAt?: string;\n  lastActivity?: string;\n}\n\ninterface IpRule {\n  id: number;\n  ipAddress: string;\n  type: 'whitelist' | 'blacklist';\n  reason?: string;\n  createdBy?: number;\n  createdAt?: string;\n}\n\ninterface SecurityStats {\n  totalBlocked: number;\n  totalAllowed: number;\n  byEventType: { type: string; count: number }[];\n}\n\ninterface SecurityLog {\n  id: number;\n  eventType?: string;\n  action: string;\n  userId?: number;\n  userName?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  type: string;\n  blocked?: boolean;\n  createdAt?: string;\n}\n\nconst flattenSettings = (obj: Record<string, any>, prefix = ''): Record<string, any> => {\n  const result: Record<string, any> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    const newKey = prefix ? `${prefix}.${key}` : key;\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n      Object.assign(result, flattenSettings(value, newKey));\n    } else {\n      result[newKey] = value;\n    }\n  }\n  return result;\n};\n\nexport default function AdminSecurityEnhanced() {\n  const { toast } = useToast();\n  const [newWhitelistIp, setNewWhitelistIp] = useState(\"\");\n  const [newBlacklistIp, setNewBlacklistIp] = useState(\"\");\n  const [showGoogleSecret, setShowGoogleSecret] = useState(false);\n  const [showCloudflareSecret, setShowCloudflareSecret] = useState(false);\n  const [showLoginHistory, setShowLoginHistory] = useState(false);\n  \n  // 2FA Modal\n  const [show2FASetup, setShow2FASetup] = useState(false);\n  const [show2FAVerify, setShow2FAVerify] = useState(false);\n  const [show2FADisable, setShow2FADisable] = useState(false);\n  const [qrCode, setQrCode] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const [verifyCode, setVerifyCode] = useState(\"\");\n  const [disableCode, setDisableCode] = useState(\"\");\n  const [secretCopied, setSecretCopied] = useState(false);\n  \n\n  const { data: settings = {}, isLoading: settingsLoading, refetch: refetchSettings } = useQuery<SecuritySettings>({\n    queryKey: ['/api/security/settings'],\n  });\n\n  const { data: devices = [], refetch: refetchDevices } = useQuery<TrustedDevice[]>({\n    queryKey: ['/api/security/devices'],\n  });\n\n  const { data: sessions = [], refetch: refetchSessions } = useQuery<UserSession[]>({\n    queryKey: ['/api/security/sessions'],\n    refetchInterval: 30000, // Auto refresh every 30 seconds\n  });\n\n  const { data: ipRules = [], refetch: refetchIpRules } = useQuery<IpRule[]>({\n    queryKey: ['/api/security/ip-rules'],\n  });\n\n  const { data: stats } = useQuery<SecurityStats>({\n    queryKey: ['/api/security/stats'],\n  });\n\n  const { data: loginHistory = [], refetch: refetchLoginHistory, isRefetching: isRefetchingLoginHistory } = useQuery<SecurityLog[]>({\n    queryKey: ['/api/security/login-history'],\n    refetchInterval: showLoginHistory ? 30000 : false, // Auto refresh every 30s when viewing\n  });\n\n  const { data: user = null, refetch: refetchUser } = useQuery<any>({\n    queryKey: ['/api/auth/me'],\n  });\n\n  const [localSettings, setLocalSettings] = useState<SecuritySettings>({});\n\n  useEffect(() => {\n    if (settings && Object.keys(settings).length > 0) {\n      setLocalSettings(settings);\n    }\n  }, [settings]);\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (newSettings: SecuritySettings) => {\n      const flatSettings = flattenSettings(newSettings);\n      return apiRequest('POST', '/api/security/settings/bulk', flatSettings);\n    },\n    onSuccess: () => {\n      toast({ title: \"Settings saved successfully\" });\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Failed to save settings\", variant: \"destructive\" });\n    }\n  });\n\n  const deleteDeviceMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/devices/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Device removed\" });\n      refetchDevices();\n    }\n  });\n\n  const terminateSessionMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('POST', `/api/security/sessions/terminate/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Session terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const terminateAllSessionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/terminate-all');\n    },\n    onSuccess: () => {\n      toast({ title: \"All sessions terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const logoutAllDevicesMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/logout-all-devices');\n    },\n    onSuccess: () => {\n      toast({ title: \"Logged out from all devices\" });\n      refetchSessions();\n    }\n  });\n\n  const addIpRuleMutation = useMutation({\n    mutationFn: async ({ ipAddress, type }: { ipAddress: string; type: 'whitelist' | 'blacklist' }) => {\n      return apiRequest('POST', '/api/security/ip-rules', { ipAddress, type });\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule added\" });\n      setNewWhitelistIp(\"\");\n      setNewBlacklistIp(\"\");\n      refetchIpRules();\n    }\n  });\n\n  const deleteIpRuleMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/ip-rules/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule removed\" });\n      refetchIpRules();\n    }\n  });\n\n  // 2FA Mutations\n  const generate2FAMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest('POST', '/api/auth/2fa/generate');\n      return await res.json();\n    },\n    onSuccess: (data: any) => {\n      if (data?.secret && data?.qrCode) {\n        setSecret(data.secret);\n        setQrCode(data.qrCode);\n        setShow2FASetup(true);\n      } else {\n        toast({ title: \"Failed to generate 2FA setup\", description: \"Missing secret or QR code\", variant: \"destructive\" });\n      }\n    },\n    onError: (error: any) => {\n      toast({ title: \"Failed to generate 2FA setup\", description: error.message || \"Unknown error\", variant: \"destructive\" });\n    }\n  });\n\n  const verify2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/verify', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA enabled successfully\" });\n      setShow2FASetup(false);\n      setShow2FAVerify(false);\n      setVerifyCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const disable2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/disable', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA disabled successfully\" });\n      setShow2FADisable(false);\n      setDisableCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const updateLocalSetting = (key: string, value: any) => {\n    setLocalSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const updateNestedSetting = (parentKey: string, childKey: string, value: any) => {\n    setLocalSettings(prev => ({\n      ...prev,\n      [parentKey]: {\n        ...(prev[parentKey as keyof SecuritySettings] as Record<string, any> || {}),\n        [childKey]: value\n      }\n    }));\n  };\n\n  const saveAllSettings = () => {\n    updateSettingsMutation.mutate(localSettings);\n  };\n\n  const saveAuthSettings = () => {\n    const authSettings = {\n      passwordExpiration: localSettings.passwordExpiration\n    };\n    updateSettingsMutation.mutate(authSettings);\n  };\n\n  const saveCaptchaSettings = () => {\n    const captchaSettings = {\n      captchaType: localSettings.captchaType,\n      captchaSettings: localSettings.captchaSettings,\n      protectionCoverage: localSettings.protectionCoverage\n    };\n    updateSettingsMutation.mutate(captchaSettings);\n  };\n\n  const saveFirewallSettings = () => {\n    const firewallSettings = {\n      rateLimiting: localSettings.rateLimiting\n    };\n    updateSettingsMutation.mutate(firewallSettings);\n  };\n\n  const saveThreatSettings = () => {\n    const threatSettings = {\n      ddosProtection: localSettings.ddosProtection,\n      sqlInjectionProtection: localSettings.sqlInjectionProtection,\n      xssProtection: localSettings.xssProtection\n    };\n    updateSettingsMutation.mutate(threatSettings);\n  };\n\n  const saveSessionSettings = () => {\n    const sessionSettings = {\n      sessionSettings: localSettings.sessionSettings\n    };\n    updateSettingsMutation.mutate(sessionSettings);\n  };\n\n  const saveComplianceSettings = () => {\n    const complianceSettings = {\n      compliance: localSettings.compliance\n    };\n    updateSettingsMutation.mutate(complianceSettings);\n  };\n\n  const saveCSPSettings = () => {\n    const cspSettings = {\n      cspSettings: localSettings.cspSettings\n    };\n    updateSettingsMutation.mutate(cspSettings);\n  };\n\n  const saveScannerSettings = () => {\n    const scannerSettings = {\n      scannerSettings: localSettings.scannerSettings\n    };\n    updateSettingsMutation.mutate(scannerSettings);\n  };\n\n  const handle2FAToggle = (enabled: boolean) => {\n    if (enabled) {\n      if (user?.twoFactorEnabled) {\n        toast({ title: \"2FA is already enabled\", variant: \"default\" });\n        return;\n      }\n      generate2FAMutation.mutate(undefined, {\n        onSuccess: () => {\n          // Modal sáº½ tá»± Ä‘á»™ng hiá»‡n\n        },\n        onError: () => {\n          toast({ title: \"Failed to generate 2FA setup\", variant: \"destructive\" });\n        }\n      });\n    } else {\n      if (!user?.twoFactorEnabled) {\n        toast({ title: \"2FA is not enabled\", variant: \"default\" });\n        return;\n      }\n      setShow2FADisable(true);\n    }\n  };\n\n  const copySecret = async () => {\n    try {\n      await navigator.clipboard.writeText(secret);\n      setSecretCopied(true);\n      setTimeout(() => setSecretCopied(false), 2000);\n      toast({ title: \"Secret copied to clipboard\" });\n    } catch (err) {\n      // Fallback cho trÃ¬nh duyá»‡t cÅ©\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = secret;\n      document.body.appendChild(textArea);\n      textArea.select();\n      try {\n        document.execCommand('copy');\n        setSecretCopied(true);\n        setTimeout(() => setSecretCopied(false), 2000);\n        toast({ title: \"Secret copied to clipboard\" });\n      } catch (e) {\n        toast({ title: \"Failed to copy secret\", variant: \"destructive\" });\n      }\n      document.body.removeChild(textArea);\n    }\n  };\n\n  const whitelistIps = ipRules.filter(r => r.type === 'whitelist');\n  const blacklistIps = ipRules.filter(r => r.type === 'blacklist');\n\n  if (settingsLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-security-title\">Security Center</h1>\n          <p className=\"text-muted-foreground\">Monitor and configure security settings</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n          <Card className=\"border-green-500/50 bg-green-500/5\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"w-6 h-6 text-green-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">System Status</p>\n                  <p className=\"font-bold\">Secure</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Lock className=\"w-6 h-6 text-primary\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">SSL Certificate</p>\n                  <p className=\"font-bold text-sm\">Valid (Dec 2025)</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <AlertTriangle className=\"w-6 h-6 text-yellow-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Blocked (24h)</p>\n                  <p className=\"font-bold\">{stats?.totalBlocked || 0} attempts</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Smartphone className=\"w-6 h-6 text-primary\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Active Sessions</p>\n                  <p className=\"font-bold\">{sessions.length} devices</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"border-blue-500/50 bg-blue-500/5\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"w-6 h-6 text-blue-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">IP Rules</p>\n                  <p className=\"font-bold text-sm\">{ipRules.length} active</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Tabs defaultValue=\"authentication\" className=\"space-y-6\">\n          <TabsList className=\"flex flex-wrap gap-1 h-auto p-1\">\n            <TabsTrigger value=\"authentication\" data-testid=\"tab-authentication\">Authentication</TabsTrigger>\n            <TabsTrigger value=\"recaptcha\" data-testid=\"tab-recaptcha\">Recaptcha</TabsTrigger>\n            <TabsTrigger value=\"firewall\" data-testid=\"tab-firewall\">Firewall</TabsTrigger>\n            <TabsTrigger value=\"threat\" data-testid=\"tab-threat\">Threat Protection</TabsTrigger>\n            <TabsTrigger value=\"sessions\" data-testid=\"tab-sessions\">Sessions</TabsTrigger>\n            <TabsTrigger value=\"compliance\" data-testid=\"tab-compliance\">Compliance</TabsTrigger>\n            <TabsTrigger value=\"csp\" data-testid=\"tab-csp\">CSP</TabsTrigger>\n            <TabsTrigger value=\"scanner\" data-testid=\"tab-scanner\">Scanner</TabsTrigger>\n            <TabsTrigger value=\"activity\" data-testid=\"tab-activity\">Activity</TabsTrigger>\n          </TabsList>\n\n          {/* AUTHENTICATION TAB */}\n          <TabsContent value=\"authentication\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Key className=\"w-5 h-5\" />\n                  Authentication Methods\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Smartphone className=\"w-5 h-5 text-muted-foreground\" />\n                    <div>\n                      <div className=\"font-medium\">Two-Factor Authentication (2FA)</div>\n                      <div className=\"text-sm text-muted-foreground\">Secure with authenticator app</div>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user?.twoFactorEnabled || settings.twoFactorEnabled || false}\n                    onCheckedChange={handle2FAToggle}\n                    disabled={generate2FAMutation.isPending}\n                    data-testid=\"switch-2fa\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Lock className=\"w-5 h-5 text-muted-foreground\" />\n                    <div>\n                      <div className=\"font-medium\">Password Expiration</div>\n                      <div className=\"text-sm text-muted-foreground\">Force reset every 90 days</div>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={localSettings.passwordExpiration ?? true}\n                    onCheckedChange={(v) => updateLocalSetting('passwordExpiration', v)}\n                    data-testid=\"switch-password-expiration\"\n                  />\n                </div>\n                <Button onClick={saveAuthSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-auth\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Authentication Settings\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Monitor className=\"w-5 h-5\" />\n                  Trusted Devices\n                </CardTitle>\n                <CardDescription>Manage devices that can skip 2FA</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {devices.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground\">No trusted devices registered</p>\n                ) : (\n                  devices.map((device) => (\n                    <div key={device.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">{device.deviceName}</p>\n                        <p className=\"text-xs text-muted-foreground\">{device.ipAddress} â€¢ {device.lastUsed ? new Date(device.lastUsed).toLocaleDateString() : 'Never'}</p>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        {device.trusted && <Badge variant=\"secondary\">Trusted</Badge>}\n                        <Button \n                          variant=\"ghost\" \n                          size=\"sm\" \n                          className=\"text-destructive\"\n                          onClick={() => deleteDeviceMutation.mutate(device.id)}\n                          data-testid={`button-remove-device-${device.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5\" />\n                  Login History\n                </CardTitle>\n                <CardDescription>View recent login activity and security events</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <Button \n                  variant=\"outline\" \n                  className=\"w-full\" \n                  onClick={() => setShowLoginHistory(!showLoginHistory)}\n                  data-testid=\"button-view-login-history\"\n                >\n                  <Eye className=\"w-4 h-4 mr-2\" />\n                  {showLoginHistory ? 'Hide' : 'View'} Login History\n                </Button>\n                \n                {showLoginHistory && (\n                  <div className=\"mt-4 space-y-2 max-h-96 overflow-y-auto border rounded-lg p-3\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <p className=\"text-sm font-medium\">Recent Login Activity</p>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\"\n                        onClick={() => refetchLoginHistory()}\n                        disabled={isRefetchingLoginHistory}\n                      >\n                        <RefreshCw className={`w-3 h-3 ${isRefetchingLoginHistory ? 'animate-spin' : ''}`} />\n                      </Button>\n                    </div>\n                    {loginHistory.length === 0 ? (\n                      <p className=\"text-xs text-muted-foreground text-center py-4\">No login history found</p>\n                    ) : (\n                      loginHistory.map((log) => (\n                        <div key={log.id} className=\"p-2 text-xs border rounded bg-muted/50\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <span className=\"font-medium flex items-center gap-1\">\n                              {log.type === 'success' ? (\n                                <CheckCircle className=\"w-3 h-3 text-green-500\" />\n                              ) : log.type === 'error' ? (\n                                <XCircle className=\"w-3 h-3 text-red-500\" />\n                              ) : (\n                                <AlertCircle className=\"w-3 h-3 text-yellow-500\" />\n                              )}\n                              {log.userName || 'Unknown User'}\n                            </span>\n                            <Badge variant={log.type === 'success' ? 'default' : 'destructive'} className=\"text-[10px]\">\n                              {log.type}\n                            </Badge>\n                          </div>\n                          <p className=\"text-muted-foreground mb-1\">{log.action}</p>\n                          <p className=\"text-muted-foreground/70\">\n                            {log.createdAt ? new Date(log.createdAt).toLocaleString() : 'N/A'}\n                          </p>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* RECAPTCHA TAB */}\n          <TabsContent value=\"recaptcha\" className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <ShieldAlert className=\"w-5 h-5\" />\n                    Bot Protection Settings\n                  </CardTitle>\n                  <CardDescription>Configure CAPTCHA protection for forms and login</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"space-y-4\">\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'disabled' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"disabled\"\n                          checked={localSettings.captchaType === 'disabled'}\n                          onChange={() => updateLocalSetting('captchaType', 'disabled')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-disabled\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <XCircle className=\"w-4 h-4 text-muted-foreground\" />\n                            Disabled\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">No bot protection (not recommended)</div>\n                        </div>\n                      </label>\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'local' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"local\"\n                          checked={localSettings.captchaType === 'local' || !localSettings.captchaType}\n                          onChange={() => updateLocalSetting('captchaType', 'local')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-local\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Server className=\"w-4 h-4 text-muted-foreground\" />\n                            Local Verification\n                            {(localSettings.captchaType === 'local' || !localSettings.captchaType) && <Badge variant=\"secondary\" className=\"text-[10px]\">Active</Badge>}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Server-side honeypot + rate limiting</div>\n                        </div>\n                      </label>\n                      {(localSettings.captchaType === 'local' || !localSettings.captchaType) && (\n                        <div className=\"ml-7 space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">Honeypot Fields</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.honeypotEnabled ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'honeypotEnabled', v)}\n                              data-testid=\"switch-honeypot\"\n                            />\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">Time-based Validation</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.timeValidation ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'timeValidation', v)}\n                              data-testid=\"switch-time-validation\"\n                            />\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">IP Rate Limiting</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.ipRateLimit ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'ipRateLimit', v)}\n                              data-testid=\"switch-ip-rate-limit\"\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'google' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"google\"\n                          checked={localSettings.captchaType === 'google'}\n                          onChange={() => updateLocalSetting('captchaType', 'google')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-google\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Globe className=\"w-4 h-4 text-muted-foreground\" />\n                            Google reCAPTCHA v3\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Invisible, score-based protection</div>\n                        </div>\n                      </label>\n                      {localSettings.captchaType === 'google' && (\n                        <div className=\"ml-7 space-y-3 pt-2\">\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Site Key</Label>\n                            <Input \n                              placeholder=\"Enter Google reCAPTCHA site key\" \n                              className=\"text-sm\"\n                              value={localSettings.captchaSettings?.googleSiteKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'googleSiteKey', e.target.value)}\n                              data-testid=\"input-google-site-key\"\n                            />\n                            {localSettings.captchaType === 'google' && !localSettings.captchaSettings?.googleSiteKey && (\n                              <p className=\"text-xs text-yellow-600 dark:text-yellow-500 flex items-center gap-1\">\n                                <AlertTriangle className=\"w-3 h-3\" />\n                                Site key is required for Google reCAPTCHA to work\n                              </p>\n                            )}\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Secret Key</Label>\n                            <div className=\"relative\">\n                              <Input \n                                type={showGoogleSecret ? \"text\" : \"password\"} \n                                placeholder=\"Enter secret key\" \n                                className=\"text-sm pr-10\"\n                                value={localSettings.captchaSettings?.googleSecretKey || ''}\n                                onChange={(e) => updateNestedSetting('captchaSettings', 'googleSecretKey', e.target.value)}\n                                data-testid=\"input-google-secret-key\"\n                              />\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"absolute right-0 top-0 h-full\"\n                                onClick={() => setShowGoogleSecret(!showGoogleSecret)}\n                              >\n                                {showGoogleSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                              </Button>\n                            </div>\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Minimum Score (0.0 - 1.0)</Label>\n                            <Input \n                              type=\"number\" \n                              value={localSettings.captchaSettings?.googleMinScore ?? 0.5}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'googleMinScore', parseFloat(e.target.value))}\n                              step=\"0.1\" \n                              min=\"0\" \n                              max=\"1\" \n                              className=\"text-sm\"\n                              data-testid=\"input-google-min-score\"\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'cloudflare' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"cloudflare\"\n                          checked={localSettings.captchaType === 'cloudflare'}\n                          onChange={() => updateLocalSetting('captchaType', 'cloudflare')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-cloudflare\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Shield className=\"w-4 h-4 text-muted-foreground\" />\n                            Cloudflare Turnstile\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Privacy-friendly, works with adblockers</div>\n                        </div>\n                      </label>\n                      {localSettings.captchaType === 'cloudflare' && (\n                        <div className=\"ml-7 space-y-3 pt-2\">\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Site Key</Label>\n                            <Input \n                              placeholder=\"Enter Cloudflare site key\" \n                              className=\"text-sm\"\n                              value={localSettings.captchaSettings?.cloudflareSiteKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSiteKey', e.target.value)}\n                              data-testid=\"input-cloudflare-site-key\"\n                            />\n                            {localSettings.captchaType === 'cloudflare' && !localSettings.captchaSettings?.cloudflareSiteKey && (\n                              <p className=\"text-xs text-yellow-600 dark:text-yellow-500 flex items-center gap-1\">\n                                <AlertTriangle className=\"w-3 h-3\" />\n                                Site key is required for Cloudflare Turnstile to work\n                              </p>\n                            )}\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Secret Key</Label>\n                            <div className=\"relative\">\n                              <Input \n                                type={showCloudflareSecret ? \"text\" : \"password\"} \n                                placeholder=\"Enter secret key\" \n                                className=\"text-sm pr-10\"\n                                value={localSettings.captchaSettings?.cloudflareSecretKey || ''}\n                                onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSecretKey', e.target.value)}\n                                data-testid=\"input-cloudflare-secret-key\"\n                              />\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"absolute right-0 top-0 h-full\"\n                                onClick={() => setShowCloudflareSecret(!showCloudflareSecret)}\n                              >\n                                {showCloudflareSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                              </Button>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <Switch \n                              checked={localSettings.captchaSettings?.cloudflareManagedMode || false}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'cloudflareManagedMode', v)}\n                              data-testid=\"switch-cloudflare-managed\"\n                            />\n                            <Label className=\"text-xs\">Managed Challenge Mode</Label>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  <Button className=\"w-full\" onClick={saveCaptchaSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-captcha\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save Captcha Settings\n                  </Button>\n                </CardContent>\n              </Card>\n\n              <div className=\"space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5\" />\n                      Protection Coverage\n                    </CardTitle>\n                    <CardDescription>Choose which forms to protect</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Login Form</p>\n                        <p className=\"text-xs text-muted-foreground\">Admin login page</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.loginForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'loginForm', v)}\n                        data-testid=\"switch-protect-login\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Contact Form</p>\n                        <p className=\"text-xs text-muted-foreground\">Public contact form</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.contactForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'contactForm', v)}\n                        data-testid=\"switch-protect-contact\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Newsletter Signup</p>\n                        <p className=\"text-xs text-muted-foreground\">Email subscription form</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.newsletterForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'newsletterForm', v)}\n                        data-testid=\"switch-protect-newsletter\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Comment Forms</p>\n                        <p className=\"text-xs text-muted-foreground\">Blog post comments</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.commentForms ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'commentForms', v)}\n                        data-testid=\"switch-protect-comments\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Registration Form</p>\n                        <p className=\"text-xs text-muted-foreground\">User registration (if enabled)</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.registrationForm || false}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'registrationForm', v)}\n                        data-testid=\"switch-protect-registration\"\n                      />\n                    </div>\n                    <Button className=\"w-full\" onClick={saveCaptchaSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-coverage\">\n                      Save Coverage Settings\n                    </Button>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <AlertCircle className=\"w-5 h-5\" />\n                      Bot Detection Stats\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"p-3 bg-green-500/10 border border-green-500/20 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-green-500\" data-testid=\"text-allowed-count\">{stats?.totalAllowed || 0}</p>\n                        <p className=\"text-xs text-muted-foreground\">Legitimate Submissions</p>\n                      </div>\n                      <div className=\"p-3 bg-red-500/10 border border-red-500/20 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-red-500\" data-testid=\"text-blocked-count\">{stats?.totalBlocked || 0}</p>\n                        <p className=\"text-xs text-muted-foreground\">Blocked Bots</p>\n                      </div>\n                    </div>\n                    <div className=\"p-3 bg-muted/50 rounded-lg\">\n                      <div className=\"flex justify-between items-center mb-2\">\n                        <span className=\"text-xs text-muted-foreground\">Protection Rate</span>\n                        <span className=\"text-sm font-medium\">\n                          {stats && stats.totalBlocked + stats.totalAllowed > 0 \n                            ? ((stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100).toFixed(1) \n                            : 100}%\n                        </span>\n                      </div>\n                      <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                        <div \n                          className=\"h-full bg-green-500 rounded-full\" \n                          style={{ width: `${stats && stats.totalBlocked + stats.totalAllowed > 0 ? (stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100 : 100}%` }} \n                        />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n\n          {/* FIREWALL TAB */}\n          <TabsContent value=\"firewall\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"w-5 h-5\" /> IP Whitelist / Blacklist\n                </CardTitle>\n                <CardDescription>Control which IP addresses can access admin panel</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-medium mb-2\">IP Whitelist (Allow only these IPs)</h4>\n                  <div className=\"space-y-2 mb-3\">\n                    {whitelistIps.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No whitelisted IPs</p>\n                    ) : (\n                      whitelistIps.map((rule) => (\n                        <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-green-500/5 border-green-500/20\">\n                          <span className=\"text-sm\">{rule.ipAddress}</span>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                            data-testid={`button-remove-whitelist-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex gap-2\">\n                      <Input \n                        placeholder=\"Add IP address (e.g., 192.168.1.1)\" \n                        value={newWhitelistIp}\n                        onChange={(e) => setNewWhitelistIp(e.target.value)}\n                        data-testid=\"input-whitelist-ip\"\n                        className={newWhitelistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(newWhitelistIp) ? 'border-red-500' : ''}\n                      />\n                      <Button \n                        onClick={() => {\n                          // More comprehensive IP validation\n                          const validateIP = (ip: string) => {\n                            // IPv4 with optional CIDR\n                            const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/;\n                            // IPv6 with optional CIDR\n                            const ipv6Regex = /^(?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/;\n                            \n                            if (ipv4Regex.test(ip)) {\n                              // Validate CIDR range if present\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 32;\n                              }\n                              return true;\n                            }\n                            \n                            if (ipv6Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 128;\n                              }\n                              return true;\n                            }\n                            \n                            return false;\n                          };\n                          \n                          if (newWhitelistIp && validateIP(newWhitelistIp)) {\n                            addIpRuleMutation.mutate({ ipAddress: newWhitelistIp, type: 'whitelist' });\n                          } else {\n                            toast({ title: \"Invalid IP address format. Use IPv4/IPv6 with optional CIDR notation\", variant: \"destructive\" });\n                          }\n                        }}\n                        disabled={!newWhitelistIp || addIpRuleMutation.isPending}\n                        data-testid=\"button-add-whitelist\"\n                      >\n                        <Plus className=\"w-4 h-4 mr-1\" /> Add\n                      </Button>\n                    </div>\n                    {newWhitelistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/.test(newWhitelistIp) && \n                     !/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/.test(newWhitelistIp) && (\n                      <p className=\"text-xs text-red-500\">Please enter a valid IPv4/IPv6 address (CIDR notation supported)</p>\n                    )}\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h4 className=\"font-medium mb-2\">IP Blacklist (Block these IPs)</h4>\n                  <div className=\"space-y-2 mb-3\">\n                    {blacklistIps.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No blacklisted IPs</p>\n                    ) : (\n                      blacklistIps.map((rule) => (\n                        <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-red-500/5 border-red-500/20\">\n                          <span className=\"text-sm\">{rule.ipAddress}</span>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                            data-testid={`button-remove-blacklist-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex gap-2\">\n                      <Input \n                        placeholder=\"Add IP to block...\" \n                        value={newBlacklistIp}\n                        onChange={(e) => setNewBlacklistIp(e.target.value)}\n                        data-testid=\"input-blacklist-ip\"\n                        className={newBlacklistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(newBlacklistIp) ? 'border-red-500' : ''}\n                      />\n                      <Button \n                        onClick={() => {\n                          const validateIP = (ip: string) => {\n                            const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/;\n                            const ipv6Regex = /^(?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/;\n                            \n                            if (ipv4Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 32;\n                              }\n                              return true;\n                            }\n                            \n                            if (ipv6Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 128;\n                              }\n                              return true;\n                            }\n                            \n                            return false;\n                          };\n                          \n                          if (newBlacklistIp && validateIP(newBlacklistIp)) {\n                            addIpRuleMutation.mutate({ ipAddress: newBlacklistIp, type: 'blacklist' });\n                          } else {\n                            toast({ title: \"Invalid IP address format. Use IPv4/IPv6 with optional CIDR notation\", variant: \"destructive\" });\n                          }\n                        }}\n                        disabled={!newBlacklistIp || addIpRuleMutation.isPending}\n                        data-testid=\"button-add-blacklist\"\n                      >\n                        <Ban className=\"w-4 h-4 mr-1\" /> Block\n                      </Button>\n                    </div>\n                    {newBlacklistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/.test(newBlacklistIp) && \n                     !/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/.test(newBlacklistIp) && (\n                      <p className=\"text-xs text-red-500\">Please enter a valid IPv4/IPv6 address (CIDR notation supported)</p>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Rate Limiting</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Login Attempts Limit</label>\n                  <Input \n                    value={localSettings.rateLimiting?.loginAttemptsLimit ?? 5}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'loginAttemptsLimit', parseInt(e.target.value) || 5)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-login-attempts-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Max attempts before lockout</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">API Rate Limit</label>\n                  <Input \n                    value={localSettings.rateLimiting?.apiRateLimit ?? 1000}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'apiRateLimit', parseInt(e.target.value) || 1000)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-api-rate-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Requests per hour per IP</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Lockout Duration (minutes)</label>\n                  <Input \n                    value={localSettings.rateLimiting?.lockoutDuration ?? 15}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'lockoutDuration', parseInt(e.target.value) || 15)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-lockout-duration\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Time before locked out user can try again</p>\n                </div>\n                <Button onClick={saveFirewallSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-rate-limiting\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Rate Limiting Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* THREAT PROTECTION TAB */}\n          <TabsContent value=\"threat\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <ShieldAlert className=\"w-5 h-5\" /> DDoS Protection\n                </CardTitle>\n                <CardDescription>Protect against distributed denial-of-service attacks</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.ddosProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">DDoS Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Automatically detect and mitigate attacks</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.ddosProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('ddosProtection', 'enabled', v)}\n                    data-testid=\"switch-ddos-protection\"\n                  />\n                </div>\n                {localSettings.ddosProtection?.enabled !== false && (\n                  <>\n                    <div>\n                      <label className=\"text-sm font-medium\">Request Threshold (per minute)</label>\n                      <Input \n                        value={localSettings.ddosProtection?.threshold ?? 100}\n                        onChange={(e) => updateNestedSetting('ddosProtection', 'threshold', parseInt(e.target.value) || 100)}\n                        type=\"number\" \n                        className=\"mt-1\"\n                        data-testid=\"input-ddos-threshold\"\n                      />\n                      <p className=\"text-xs text-muted-foreground mt-1\">Trigger protection when requests exceed this limit</p>\n                    </div>\n                    <div>\n                      <label className=\"text-sm font-medium\">Block Duration (minutes)</label>\n                      <Input \n                        value={localSettings.ddosProtection?.blockDuration ?? 30}\n                        onChange={(e) => updateNestedSetting('ddosProtection', 'blockDuration', parseInt(e.target.value) || 30)}\n                        type=\"number\" \n                        className=\"mt-1\"\n                        data-testid=\"input-ddos-block-duration\"\n                      />\n                      <p className=\"text-xs text-muted-foreground mt-1\">How long to block suspicious IPs</p>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5\" /> SQL Injection Detection\n                </CardTitle>\n                <CardDescription>Detect and block SQL injection attempts</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.sqlInjectionProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">SQL Injection Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan requests for malicious SQL patterns</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.sqlInjectionProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'enabled', v)}\n                    data-testid=\"switch-sql-injection\"\n                  />\n                </div>\n                {localSettings.sqlInjectionProtection?.enabled !== false && (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Log Attempts</p>\n                        <p className=\"text-xs text-muted-foreground\">Record all detected injection attempts</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.sqlInjectionProtection?.logAttempts ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'logAttempts', v)}\n                        data-testid=\"switch-sql-log\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Block Requests</p>\n                        <p className=\"text-xs text-muted-foreground\">Automatically block suspicious requests</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.sqlInjectionProtection?.blockRequests ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'blockRequests', v)}\n                        data-testid=\"switch-sql-block\"\n                      />\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Shield className=\"w-5 h-5\" /> XSS Protection\n                </CardTitle>\n                <CardDescription>Protect against cross-site scripting attacks</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.xssProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">XSS Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Detect and sanitize malicious scripts</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.xssProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('xssProtection', 'enabled', v)}\n                    data-testid=\"switch-xss-protection\"\n                  />\n                </div>\n                {localSettings.xssProtection?.enabled !== false && (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Sanitize Input</p>\n                        <p className=\"text-xs text-muted-foreground\">Automatically clean user input</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.xssProtection?.sanitizeInput ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('xssProtection', 'sanitizeInput', v)}\n                        data-testid=\"switch-xss-sanitize\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Block Requests</p>\n                        <p className=\"text-xs text-muted-foreground\">Block requests with malicious content</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.xssProtection?.blockRequests ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('xssProtection', 'blockRequests', v)}\n                        data-testid=\"switch-xss-block\"\n                      />\n                    </div>\n                  </>\n                )}\n                <Button onClick={saveThreatSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-threat\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Threat Protection Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SESSIONS TAB */}\n          <TabsContent value=\"sessions\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Users className=\"w-5 h-5\" /> Active Sessions\n                </CardTitle>\n                <CardDescription>Manage active user sessions</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {sessions.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground\">No active sessions</p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {sessions.map((session) => (\n                      <div key={session.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n                          <div>\n                            <p className=\"font-medium text-sm\">{session.deviceInfo || 'Unknown Device'}</p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {session.ipAddress || 'Unknown IP'} â€¢ {session.location || 'Unknown Location'}\n                              {session.lastActivity && ` â€¢ ${new Date(session.lastActivity).toLocaleString()}`}\n                            </p>\n                          </div>\n                        </div>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"sm\"\n                          onClick={() => terminateSessionMutation.mutate(session.id)}\n                          disabled={terminateSessionMutation.isPending}\n                          data-testid={`button-terminate-session-${session.id}`}\n                        >\n                          <LogOut className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                <div className=\"flex gap-2\">\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      logoutAllDevicesMutation.mutate();\n                    }}\n                    disabled={logoutAllDevicesMutation.isPending}\n                    data-testid=\"button-logout-all-devices\"\n                  >\n                    {logoutAllDevicesMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    <LogOut className=\"w-4 h-4 mr-2\" /> Logout All Devices\n                  </Button>\n                  <Button \n                    variant=\"destructive\" \n                    className=\"flex-1\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      terminateAllSessionsMutation.mutate();\n                    }}\n                    disabled={terminateAllSessionsMutation.isPending}\n                    data-testid=\"button-force-logout-all\"\n                  >\n                    {terminateAllSessionsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    <LogOut className=\"w-4 h-4 mr-2\" /> Force Logout All Users\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5\" /> Session Policies\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Session Timeout (Idle)</Label>\n                    <select \n                      className=\"w-full p-2 rounded-md border border-input bg-background\"\n                      value={localSettings.sessionSettings?.idleTimeout || '30 minutes'}\n                      onChange={(e) => updateNestedSetting('sessionSettings', 'idleTimeout', e.target.value)}\n                      data-testid=\"select-idle-timeout\"\n                    >\n                      <option value=\"15 minutes\">15 minutes</option>\n                      <option value=\"30 minutes\">30 minutes</option>\n                      <option value=\"1 hour\">1 hour</option>\n                      <option value=\"4 hours\">4 hours</option>\n                      <option value=\"Never\">Never</option>\n                    </select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Max Session Duration</Label>\n                    <select \n                      className=\"w-full p-2 rounded-md border border-input bg-background\"\n                      value={localSettings.sessionSettings?.maxDuration || '24 hours'}\n                      onChange={(e) => updateNestedSetting('sessionSettings', 'maxDuration', e.target.value)}\n                      data-testid=\"select-max-duration\"\n                    >\n                      <option value=\"8 hours\">8 hours</option>\n                      <option value=\"24 hours\">24 hours</option>\n                      <option value=\"7 days\">7 days</option>\n                      <option value=\"30 days\">30 days</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Force Logout Inactive Users</p>\n                    <p className=\"text-xs text-muted-foreground\">Auto-logout users after idle timeout</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.sessionSettings?.forceLogoutInactive ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('sessionSettings', 'forceLogoutInactive', v)}\n                    data-testid=\"switch-force-logout-inactive\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Concurrent Session Limit</Label>\n                  <select \n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={localSettings.sessionSettings?.concurrentSessionLimit || 'Unlimited'}\n                    onChange={(e) => updateNestedSetting('sessionSettings', 'concurrentSessionLimit', e.target.value)}\n                    data-testid=\"select-concurrent-sessions\"\n                  >\n                    <option value=\"Unlimited\">Unlimited</option>\n                    <option value=\"1 session per user\">1 session per user</option>\n                    <option value=\"3 sessions per user\">3 sessions per user</option>\n                    <option value=\"5 sessions per user\">5 sessions per user</option>\n                  </select>\n                </div>\n\n                <Button onClick={saveSessionSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-session-policies\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Session Policies\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* COMPLIANCE TAB */}\n          <TabsContent value=\"compliance\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <FileText className=\"w-5 h-5\" /> GDPR Compliance\n                </CardTitle>\n                <CardDescription>Manage data protection and privacy regulations</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">GDPR Enabled</p>\n                    <p className=\"text-xs text-muted-foreground\">Enable GDPR compliance features</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.compliance?.gdprEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('compliance', 'gdprEnabled', v)}\n                    data-testid=\"switch-gdpr\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Data Retention Period (days)</label>\n                  <Input \n                    value={localSettings.compliance?.dataRetentionDays ?? 365}\n                    onChange={(e) => updateNestedSetting('compliance', 'dataRetentionDays', parseInt(e.target.value) || 365)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-retention-days\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Automatically delete user data after this period</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Privacy Policy URL</label>\n                  <Input \n                    value={localSettings.compliance?.privacyPolicyUrl || ''}\n                    onChange={(e) => updateNestedSetting('compliance', 'privacyPolicyUrl', e.target.value)}\n                    placeholder=\"https://example.com/privacy\"\n                    className=\"mt-1\"\n                    data-testid=\"input-privacy-url\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Cookie Consent</p>\n                    <p className=\"text-xs text-muted-foreground\">Require explicit cookie consent from users</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.compliance?.cookieConsentEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('compliance', 'cookieConsentEnabled', v)}\n                    data-testid=\"switch-cookie-consent\"\n                  />\n                </div>\n                <Button onClick={saveComplianceSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-compliance\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Compliance Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* CSP TAB */}\n          <TabsContent value=\"csp\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Layers className=\"w-5 h-5\" /> Content Security Policy\n                </CardTitle>\n                <CardDescription>Control resource loading and execution</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">CSP Enabled</p>\n                    <p className=\"text-xs text-muted-foreground\">Apply content security policy headers</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.cspSettings?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('cspSettings', 'enabled', v)}\n                    data-testid=\"switch-csp-enabled\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Strict Mode</p>\n                    <p className=\"text-xs text-muted-foreground\">Enforce strict CSP violations</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.cspSettings?.strictMode ?? false}\n                    onCheckedChange={(v) => updateNestedSetting('cspSettings', 'strictMode', v)}\n                    data-testid=\"switch-csp-strict\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Report URI</label>\n                  <Input \n                    value={localSettings.cspSettings?.reportUri || ''}\n                    onChange={(e) => updateNestedSetting('cspSettings', 'reportUri', e.target.value)}\n                    placeholder=\"https://example.com/csp-report\"\n                    className=\"mt-1\"\n                    data-testid=\"input-csp-report-uri\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Endpoint to receive CSP violation reports</p>\n                </div>\n                <Button onClick={saveCSPSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-csp\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save CSP Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SCANNER TAB */}\n          <TabsContent value=\"scanner\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Zap className=\"w-5 h-5\" /> Security Scanning\n                </CardTitle>\n                <CardDescription>Automated security vulnerability scanning</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Vulnerability Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan for known vulnerabilities</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.vulnerabilityScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'vulnerabilityScanEnabled', v)}\n                    data-testid=\"switch-vuln-scan\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">SSL Certificate Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Monitor SSL certificate validity</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.sslScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'sslScanEnabled', v)}\n                    data-testid=\"switch-ssl-scan\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Malware Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan uploaded files for malware</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.malwareScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'malwareScanEnabled', v)}\n                    data-testid=\"switch-malware-scan\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Scan Frequency</label>\n                  <select \n                    className=\"w-full p-2 rounded-md border border-input bg-background mt-1\"\n                    value={localSettings.scannerSettings?.scanFrequency || 'weekly'}\n                    onChange={(e) => updateNestedSetting('scannerSettings', 'scanFrequency', e.target.value)}\n                    data-testid=\"select-scan-frequency\"\n                  >\n                    <option value=\"daily\">Daily</option>\n                    <option value=\"weekly\">Weekly</option>\n                    <option value=\"monthly\">Monthly</option>\n                  </select>\n                </div>\n                <Button onClick={saveScannerSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-scanner\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Scanner Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* ACTIVITY TAB */}\n          <TabsContent value=\"activity\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Activity className=\"w-5 h-5\" /> Security Activity\n                </CardTitle>\n                <CardDescription>Monitor user actions and security events</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <select className=\"text-sm border rounded px-3 py-2\" defaultValue=\"all\">\n                    <option value=\"all\">All Events</option>\n                    <option value=\"login_success\">Successful Logins</option>\n                    <option value=\"login_failed\">Failed Logins</option>\n                    <option value=\"two_factor\">2FA Events</option>\n                  </select>\n                  <select className=\"text-sm border rounded px-3 py-2\" defaultValue=\"24h\">\n                    <option value=\"24h\">Last 24 Hours</option>\n                    <option value=\"7d\">Last 7 Days</option>\n                    <option value=\"30d\">Last 30 Days</option>\n                  </select>\n                </div>\n                <div className=\"space-y-3\">\n                  <div className=\"p-3 border rounded-lg bg-blue-500/5\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Last Login Activity</p>\n                        <p className=\"text-xs text-muted-foreground\">Security events from last 24 hours</p>\n                      </div>\n                      <Badge variant=\"secondary\">Active</Badge>\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Successful Logins</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.filter(l => l.eventType === 'login_success').length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-green-500 rounded-full transition-all\" \n                        style={{ width: `${loginHistory.length > 0 ? (loginHistory.filter(l => l.eventType === 'login_success').length / loginHistory.length * 100) : 0}%` }} \n                      />\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Failed Login Attempts</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.filter(l => l.eventType === 'login_failed' || l.blocked).length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-red-500 rounded-full transition-all\" \n                        style={{ width: `${loginHistory.length > 0 ? (loginHistory.filter(l => l.eventType === 'login_failed' || l.blocked).length / loginHistory.length * 100) : 0}%` }} \n                      />\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Total Events (Last 24h)</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-blue-500 rounded-full transition-all\" \n                        style={{ width: `${Math.min(100, loginHistory.length * 10)}%` }} \n                      />\n                    </div>\n                  </div>\n                </div>\n                <Button \n                  onClick={() => setShowLoginHistory(!showLoginHistory)} \n                  className=\"w-full\" \n                  data-testid=\"button-view-login-history\"\n                >\n                  <FileText className=\"w-4 h-4 mr-2\" /> {showLoginHistory ? 'Hide' : 'View'} Login History\n                </Button>\n                {showLoginHistory && (\n                  <div className=\"mt-4 space-y-2 max-h-96 overflow-y-auto\">\n                    <p className=\"text-sm font-medium\">Recent Login Activity</p>\n                    {loginHistory.length === 0 ? (\n                      <p className=\"text-xs text-muted-foreground\">No login history found</p>\n                    ) : (\n                      loginHistory.map((log) => (\n                        <div key={log.id} className={`p-3 text-xs border rounded ${log.blocked ? 'bg-red-500/5 border-red-500/30' : log.eventType === 'login_success' ? 'bg-green-500/5 border-green-500/30' : 'bg-muted/50'}`}>\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <div className=\"flex items-center gap-2\">\n                              {log.eventType === 'login_success' ? (\n                                <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                              ) : log.blocked ? (\n                                <Ban className=\"w-4 h-4 text-red-500\" />\n                              ) : (\n                                <AlertCircle className=\"w-4 h-4 text-yellow-500\" />\n                              )}\n                              <span className=\"font-medium\">{log.userName || 'Unknown User'}</span>\n                              <Badge variant={log.eventType === 'login_success' ? 'secondary' : 'destructive'} className=\"text-[10px]\">\n                                {log.eventType === 'login_success' ? 'Success' : log.eventType === 'login_failed' ? 'Failed' : log.eventType || 'Unknown'}\n                              </Badge>\n                            </div>\n                            <span className=\"text-muted-foreground\">{log.createdAt ? new Date(log.createdAt).toLocaleString() : 'N/A'}</span>\n                          </div>\n                          <p className=\"text-muted-foreground mb-1\">{log.action}</p>\n                          <div className=\"flex items-center gap-3 text-muted-foreground\">\n                            {log.ipAddress && (\n                              <span className=\"flex items-center gap-1\">\n                                <Globe className=\"w-3 h-3\" /> {log.ipAddress}\n                              </span>\n                            )}\n                            {log.userAgent && (\n                              <span className=\"flex items-center gap-1 truncate max-w-[200px]\" title={log.userAgent}>\n                                <Monitor className=\"w-3 h-3\" /> {log.userAgent.split(' ')[0]}\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                )}\n                <Button \n                  onClick={() => {\n                    refetchLoginHistory();\n                    refetchSessions();\n                  }} \n                  disabled={false} \n                  className=\"w-full\" \n                  data-testid=\"button-refresh-activity\"\n                >\n                  <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh Activity Log\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* 2FA Setup Modal */}\n      <Dialog open={show2FASetup} onOpenChange={setShow2FASetup}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Set up Two-Factor Authentication</DialogTitle>\n            <DialogDescription>\n              Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            {qrCode && (\n              <div className=\"flex justify-center p-4 bg-white rounded-lg\">\n                <img src={qrCode} alt=\"2FA QR Code\" className=\"w-48 h-48\" />\n              </div>\n            )}\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm font-medium\">Or enter this code manually:</Label>\n              <div className=\"flex gap-2\">\n                <Input value={secret} readOnly className=\"font-mono text-sm\" />\n                <Button \n                  variant=\"outline\" \n                  size=\"icon\"\n                  onClick={copySecret}\n                >\n                  {secretCopied ? <Check className=\"w-4 h-4\" /> : <Copy className=\"w-4 h-4\" />}\n                </Button>\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button \n              onClick={() => {\n                setShow2FASetup(false);\n                setShow2FAVerify(true);\n              }}\n            >\n              Continue to Verification\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* 2FA Verify Modal */}\n      <Dialog open={show2FAVerify} onOpenChange={setShow2FAVerify}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Verify 2FA Setup</DialogTitle>\n            <DialogDescription>\n              Enter the 6-digit code from your authenticator app\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-center py-6\">\n            <InputOTP maxLength={6} value={verifyCode} onChange={setVerifyCode}>\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => {\n                setShow2FAVerify(false);\n                setVerifyCode(\"\");\n              }}\n            >\n              Cancel\n            </Button>\n            <Button \n              onClick={() => verify2FAMutation.mutate(verifyCode)}\n              disabled={verifyCode.length !== 6 || verify2FAMutation.isPending}\n            >\n              {verify2FAMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Verify & Enable\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* 2FA Disable Modal */}\n      <Dialog open={show2FADisable} onOpenChange={setShow2FADisable}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Disable Two-Factor Authentication</DialogTitle>\n            <DialogDescription>\n              Enter your 6-digit code to confirm disabling 2FA\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-center py-6\">\n            <InputOTP maxLength={6} value={disableCode} onChange={setDisableCode}>\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => {\n                setShow2FADisable(false);\n                setDisableCode(\"\");\n              }}\n            >\n              Cancel\n            </Button>\n            <Button \n              variant=\"destructive\"\n              onClick={() => disable2FAMutation.mutate(disableCode)}\n              disabled={disableCode.length !== 6 || disable2FAMutation.isPending}\n            >\n              {disable2FAMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Disable 2FA\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":96115,"size_tokens":null},"client/src/pages/admin/Dashboard.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { \n  Users, \n  Eye, \n  Activity,\n  Clock,\n  AlertTriangle,\n  FileText,\n  Briefcase,\n  MessageSquare,\n  CheckCircle,\n  XCircle,\n  Info,\n  Zap,\n  Star,\n  Settings,\n  Mail,\n  TrendingUp,\n  ArrowUpRight,\n  ArrowDownRight\n} from \"lucide-react\";\nimport { \n  AreaChart, \n  Area, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n  BarChart,\n  Bar\n} from \"recharts\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport type { Post, Project, Message, Comment, Review, ActivityLog, Skill, Service, Testimonial } from \"@shared/schema\";\nimport { Link } from \"wouter\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\n\nconst trafficSourceData = [\n  { name: \"Organic\", value: 400, color: \"hsl(var(--primary))\" },\n  { name: \"Social\", value: 300, color: \"hsl(var(--chart-2))\" },\n  { name: \"Direct\", value: 300, color: \"hsl(var(--chart-3))\" },\n  { name: \"Referral\", value: 200, color: \"hsl(var(--chart-4))\" },\n];\n\nexport default function AdminDashboard() {\n  const { data: posts = [] } = useQuery<Post[]>({\n    queryKey: ['/api/posts'],\n  });\n\n  const { data: projects = [] } = useQuery<Project[]>({\n    queryKey: ['/api/projects'],\n  });\n\n  const { data: messages = [] } = useQuery<Message[]>({\n    queryKey: ['/api/messages'],\n  });\n\n  const { data: comments = [] } = useQuery<Comment[]>({\n    queryKey: ['/api/comments'],\n  });\n\n  const { data: reviews = [] } = useQuery<Review[]>({\n    queryKey: ['/api/reviews'],\n  });\n\n  const { data: activityLogs = [] } = useQuery<ActivityLog[]>({\n    queryKey: ['/api/activity-logs'],\n  });\n\n  const { data: skills = [] } = useQuery<Skill[]>({\n    queryKey: ['/api/skills'],\n  });\n\n  const { data: services = [] } = useQuery<Service[]>({\n    queryKey: ['/api/services'],\n  });\n\n  const { data: testimonials = [] } = useQuery<Testimonial[]>({\n    queryKey: ['/api/testimonials'],\n  });\n\n  const { data: users = [] } = useQuery<any[]>({\n    queryKey: ['/api/users'],\n  });\n\n  const unreadMessages = messages.filter((m) => !m.read).length;\n  const unreadComments = comments.filter((c) => !c.read).length;\n  const unreadReviews = reviews.filter((r) => !r.read).length;\n  const totalUnread = unreadMessages + unreadComments + unreadReviews;\n\n  const publishedPosts = posts.filter((p) => p.status === \"Published\").length;\n  const publishedProjects = projects.filter((p) => p.status === \"Published\").length;\n  const pendingComments = comments.filter((c) => c.status === \"Pending\").length;\n  const pendingReviews = reviews.filter((r) => r.status === \"Pending\").length;\n  const activeServices = services.filter((s) => s.active).length;\n  const activeTestimonials = testimonials.filter((t) => t.active).length;\n\n  const totalViews = projects.reduce((sum, p) => sum + (p.views || 0), 0) + \n                     posts.reduce((sum, p) => sum + (p.views || 0), 0);\n\n  const avgRating = reviews.length > 0 \n    ? (reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length).toFixed(1)\n    : \"0.0\";\n\n  const recentLogs = activityLogs.slice(0, 6);\n\n  const weeklyData = [\n    { name: \"Mon\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Tue\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Wed\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Thu\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Fri\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Sat\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n    { name: \"Sun\", posts: Math.floor(Math.random() * 5), projects: Math.floor(Math.random() * 3) },\n  ];\n\n  const contentDistribution = [\n    { name: \"Posts\", value: posts.length, color: \"hsl(var(--primary))\" },\n    { name: \"Projects\", value: projects.length, color: \"hsl(var(--chart-2))\" },\n    { name: \"Services\", value: services.length, color: \"hsl(var(--chart-3))\" },\n    { name: \"Skills\", value: skills.length, color: \"hsl(var(--chart-4))\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8 animate-in fade-in duration-500\">\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n          <div>\n             <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-dashboard-title\">Dashboard</h1>\n             <p className=\"text-muted-foreground\">Welcome back! Here's what's happening with your portfolio.</p>\n          </div>\n          <div className=\"flex items-center gap-2 text-sm bg-green-500/10 text-green-500 px-3 py-1 rounded-full border border-green-500/20\">\n            <span className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n            System Operational\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\" data-testid=\"card-total-views\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Total Views\n              </CardTitle>\n              <Eye className=\"h-4 w-4 text-blue-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{totalViews.toLocaleString()}</div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                <span className=\"text-green-500 flex items-center gap-1\">\n                  <ArrowUpRight className=\"h-3 w-3\" /> +12%\n                </span>\n                from last month\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\" data-testid=\"card-total-content\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Total Content\n              </CardTitle>\n              <FileText className=\"h-4 w-4 text-green-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{posts.length + projects.length}</div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                {publishedPosts} posts, {publishedProjects} projects published\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\" data-testid=\"card-unread\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Unread Items\n              </CardTitle>\n              <MessageSquare className=\"h-4 w-4 text-yellow-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{totalUnread}</div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                {unreadMessages} messages, {unreadComments} comments, {unreadReviews} reviews\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\" data-testid=\"card-avg-rating\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Avg. Rating\n              </CardTitle>\n              <Star className=\"h-4 w-4 text-purple-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold flex items-center gap-1\">\n                {avgRating}\n                <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                Based on {reviews.length} reviews\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n           <Card className=\"md:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n              <CardHeader>\n                <CardTitle>Content Overview</CardTitle>\n                <CardDescription>Quick summary of your content status</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n                   <Link href=\"/admin/posts\">\n                     <div className=\"p-4 rounded-xl bg-primary/5 border border-primary/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-primary/10 transition-colors cursor-pointer\" data-testid=\"card-posts-count\">\n                        <FileText className=\"h-8 w-8 text-primary mb-1\" />\n                        <span className=\"text-2xl font-bold\">{posts.length}</span>\n                        <span className=\"text-xs text-muted-foreground\">Blog Posts</span>\n                     </div>\n                   </Link>\n                   <Link href=\"/admin/projects\">\n                     <div className=\"p-4 rounded-xl bg-blue-500/5 border border-blue-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-blue-500/10 transition-colors cursor-pointer\" data-testid=\"card-projects-count\">\n                        <Briefcase className=\"h-8 w-8 text-blue-500 mb-1\" />\n                        <span className=\"text-2xl font-bold\">{projects.length}</span>\n                        <span className=\"text-xs text-muted-foreground\">Projects</span>\n                     </div>\n                   </Link>\n                   <Link href=\"/admin/comments\">\n                     <div className=\"p-4 rounded-xl bg-yellow-500/5 border border-yellow-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-yellow-500/10 transition-colors cursor-pointer\" data-testid=\"card-pending-count\">\n                        <MessageSquare className=\"h-8 w-8 text-yellow-500 mb-1\" />\n                        <span className=\"text-2xl font-bold\">{pendingComments + pendingReviews}</span>\n                        <span className=\"text-xs text-muted-foreground\">Pending</span>\n                     </div>\n                   </Link>\n                   <Link href=\"/admin/messages\">\n                     <div className=\"p-4 rounded-xl bg-purple-500/5 border border-purple-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-purple-500/10 transition-colors cursor-pointer\" data-testid=\"card-messages-count\">\n                        <Mail className=\"h-8 w-8 text-purple-500 mb-1\" />\n                        <span className=\"text-2xl font-bold\">{messages.length}</span>\n                        <span className=\"text-xs text-muted-foreground\">Messages</span>\n                     </div>\n                   </Link>\n                </div>\n              </CardContent>\n           </Card>\n\n           <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 flex flex-col justify-center relative overflow-hidden\">\n              <div className=\"absolute top-0 right-0 p-4 opacity-10\">\n                 <Zap size={120} />\n              </div>\n              <CardHeader>\n                 <CardTitle>Portfolio Stats</CardTitle>\n                 <CardDescription>Skills & Services</CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex flex-col gap-4\">\n                 <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                    <span className=\"text-sm\">Skills</span>\n                    <Badge variant=\"secondary\">{skills.length}</Badge>\n                 </div>\n                 <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                    <span className=\"text-sm\">Active Services</span>\n                    <Badge variant=\"secondary\">{activeServices} / {services.length}</Badge>\n                 </div>\n                 <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                    <span className=\"text-sm\">Testimonials</span>\n                    <Badge variant=\"secondary\">{activeTestimonials}</Badge>\n                 </div>\n                 <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                    <span className=\"text-sm\">Users</span>\n                    <Badge variant=\"secondary\">{users.length}</Badge>\n                 </div>\n              </CardContent>\n           </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <Card className=\"lg:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Content Distribution</CardTitle>\n              <CardDescription>Overview of your portfolio content</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-[300px]\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={contentDistribution}>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border))\" />\n                    <XAxis dataKey=\"name\" stroke=\"hsl(var(--muted-foreground))\" />\n                    <YAxis stroke=\"hsl(var(--muted-foreground))\" />\n                    <Tooltip \n                      contentStyle={{ \n                        backgroundColor: \"hsl(var(--card))\", \n                        border: \"1px solid hsl(var(--border))\", \n                        borderRadius: \"8px\" \n                      }}\n                    />\n                    <Bar dataKey=\"value\" fill=\"hsl(var(--primary))\" radius={[4, 4, 0, 0]} />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Quick Actions</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n               <Link href=\"/admin/posts\">\n                 <Button variant=\"outline\" className=\"w-full justify-start gap-2\" data-testid=\"button-new-post\">\n                   <FileText className=\"h-4 w-4\" /> New Blog Post\n                 </Button>\n               </Link>\n               <Link href=\"/admin/projects\">\n                 <Button variant=\"outline\" className=\"w-full justify-start gap-2\" data-testid=\"button-new-project\">\n                   <Briefcase className=\"h-4 w-4\" /> New Project\n                 </Button>\n               </Link>\n               <Link href=\"/admin/messages\">\n                 <Button variant=\"outline\" className=\"w-full justify-start gap-2\" data-testid=\"button-view-messages\">\n                   <Mail className=\"h-4 w-4\" /> View Messages\n                   {unreadMessages > 0 && (\n                     <Badge variant=\"destructive\" className=\"ml-auto\">{unreadMessages}</Badge>\n                   )}\n                 </Button>\n               </Link>\n               <Link href=\"/admin/settings\">\n                 <Button variant=\"outline\" className=\"w-full justify-start gap-2\" data-testid=\"button-settings\">\n                   <Settings className=\"h-4 w-4\" /> Site Settings\n                 </Button>\n               </Link>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n           <Card className=\"lg:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n              <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n                 <div>\n                   <CardTitle>Recent Activity</CardTitle>\n                   <CardDescription>Latest system actions</CardDescription>\n                 </div>\n                 <Link href=\"/admin/activity-logs\">\n                   <Button variant=\"ghost\" size=\"sm\">View All</Button>\n                 </Link>\n              </CardHeader>\n              <CardContent>\n                 {recentLogs.length === 0 ? (\n                   <div className=\"text-center py-8 text-muted-foreground\">\n                     <Activity className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                     <p>No recent activity</p>\n                   </div>\n                 ) : (\n                   <div className=\"space-y-4\">\n                      {recentLogs.map((log) => (\n                         <div key={log.id} className=\"flex items-start gap-4 pb-4 border-b border-border/50 last:border-0 last:pb-0\" data-testid={`activity-log-${log.id}`}>\n                            <div className={`mt-1 p-2 rounded-full ${\n                               log.type === 'success' ? 'bg-green-500/10 text-green-500' :\n                               log.type === 'warning' ? 'bg-yellow-500/10 text-yellow-500' :\n                               log.type === 'error' ? 'bg-red-500/10 text-red-500' :\n                               'bg-blue-500/10 text-blue-500'\n                            }`}>\n                               {log.type === 'success' ? <CheckCircle size={16} /> :\n                                log.type === 'warning' ? <AlertTriangle size={16} /> :\n                                log.type === 'error' ? <XCircle size={16} /> :\n                                <Info size={16} />}\n                            </div>\n                            <div className=\"flex-1\">\n                               <p className=\"text-sm font-medium\">{log.action}</p>\n                               <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                                  <span>{log.userName || 'System'}</span>\n                                  <span>â€¢</span>\n                                  <span>\n                                    {log.createdAt && formatDistanceToNow(new Date(log.createdAt), { addSuffix: true })}\n                                  </span>\n                               </div>\n                            </div>\n                         </div>\n                      ))}\n                   </div>\n                 )}\n              </CardContent>\n           </Card>\n\n           <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10\">\n              <CardHeader>\n                 <CardTitle>Recent Messages</CardTitle>\n              </CardHeader>\n              <CardContent>\n                 {messages.length === 0 ? (\n                   <div className=\"text-center py-8 text-muted-foreground\">\n                     <Mail className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                     <p>No messages yet</p>\n                   </div>\n                 ) : (\n                   <div className=\"space-y-4\">\n                      {messages.slice(0, 4).map((msg) => (\n                         <div key={msg.id} className=\"p-3 rounded-lg bg-muted/50 border border-border\" data-testid={`message-${msg.id}`}>\n                            <div className=\"flex items-start justify-between gap-2\">\n                              <div className=\"flex-1 min-w-0\">\n                                <p className=\"text-sm font-medium truncate\">{msg.name}</p>\n                                <p className=\"text-xs text-muted-foreground truncate\">{msg.email}</p>\n                                <p className=\"text-xs text-muted-foreground mt-1 line-clamp-2\">{msg.message}</p>\n                              </div>\n                              {!msg.read && (\n                                <Badge variant=\"secondary\" className=\"text-xs shrink-0\">New</Badge>\n                              )}\n                            </div>\n                         </div>\n                      ))}\n                      <Link href=\"/admin/messages\">\n                         <div className=\"p-3 rounded-lg bg-primary/10 border border-primary/20 text-center cursor-pointer hover:bg-primary/20 transition-colors\">\n                            <span className=\"text-xs font-medium text-primary\">View All Messages</span>\n                         </div>\n                      </Link>\n                   </div>\n                 )}\n              </CardContent>\n           </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":20835,"size_tokens":null},"client/src/pages/admin/FAQs.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Plus, \n  Search, \n  GripVertical,\n  Edit,\n  Trash,\n  Eye,\n  EyeOff,\n  MoveUp,\n  MoveDown\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminFAQs() {\n  const [faqs, setFaqs] = useState([\n    { id: 1, question: \"What technologies do you specialize in?\", answer: \"I specialize in the React ecosystem, Node.js, and cloud architecture.\", visible: true, order: 1 },\n    { id: 2, question: \"Do you offer maintenance packages?\", answer: \"Yes, I offer monthly maintenance packages to keep your site secure and updated.\", visible: true, order: 2 },\n    { id: 3, question: \"What is your typical turnaround time?\", answer: \"It depends on the project scope, but typically 2-4 weeks for a standard website.\", visible: true, order: 3 },\n    { id: 4, question: \"Do you work with international clients?\", answer: \"Absolutely! I have experience working with clients across different time zones.\", visible: false, order: 4 },\n  ]);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">FAQs Management</h1>\n            <p className=\"text-muted-foreground\">Manage frequently asked questions for your visitors</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Add New FAQ\n          </Button>\n        </div>\n\n        <div className=\"flex gap-4 bg-card p-4 rounded-lg border border-border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input placeholder=\"Search FAQs...\" className=\"pl-9\" />\n          </div>\n        </div>\n\n        <div className=\"space-y-3\">\n          {faqs.map((faq, index) => (\n            <Card key={faq.id} className=\"group hover:border-primary/50 transition-colors\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"cursor-grab text-muted-foreground hover:text-foreground transition-colors\">\n                    <GripVertical className=\"w-5 h-5\" />\n                  </div>\n                  \n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <h4 className=\"font-semibold text-lg\">{faq.question}</h4>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant={faq.visible ? \"default\" : \"secondary\"}>\n                          {faq.visible ? \"Visible\" : \"Hidden\"}\n                        </Badge>\n                        <span className=\"text-xs text-muted-foreground\">Order: {faq.order}</span>\n                      </div>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">{faq.answer}</p>\n                  </div>\n\n                  <div className=\"opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1\">\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Move Up\">\n                      <MoveUp className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Move Down\">\n                      <MoveDown className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title={faq.visible ? \"Hide\" : \"Show\"}>\n                      {faq.visible ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Edit\">\n                      <Edit className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"text-destructive\" title=\"Delete\">\n                      <Trash className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Add/Edit Form */}\n        <Card className=\"border-primary/20 bg-primary/5\">\n          <CardHeader>\n            <CardTitle>Add New FAQ</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Question</label>\n              <Input placeholder=\"Enter your question here...\" />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Answer</label>\n              <Textarea \n                placeholder=\"Provide a detailed answer...\" \n                className=\"min-h-[120px]\"\n              />\n            </div>\n            <div className=\"flex gap-2 justify-end\">\n              <Button variant=\"outline\">Cancel</Button>\n              <Button>Save FAQ</Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5339,"size_tokens":null},"client/src/pages/admin/SEO.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Search, Globe, FileText, Image, CheckCircle, AlertCircle } from \"lucide-react\";\n\nexport default function AdminSEO() {\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">SEO Optimization</h1>\n            <p className=\"text-muted-foreground\">Improve search engine visibility</p>\n          </div>\n          <Button className=\"bg-primary\">Save SEO Settings</Button>\n        </div>\n\n        {/* SEO Score */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          {[\n            { label: \"SEO Score\", value: \"85/100\", status: \"good\", icon: CheckCircle },\n            { label: \"Meta Tags\", value: \"12/15\", status: \"warning\", icon: AlertCircle },\n            { label: \"Image Alt\", value: \"Complete\", status: \"good\", icon: Image },\n            { label: \"Sitemap\", value: \"Updated\", status: \"good\", icon: FileText },\n          ].map((metric, i) => (\n            <Card key={i}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3\">\n                  <metric.icon className={`w-5 h-5 ${metric.status === 'good' ? 'text-green-500' : 'text-yellow-500'}`} />\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">{metric.label}</p>\n                    <p className=\"font-bold\">{metric.value}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        <Tabs defaultValue=\"meta\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"meta\">Meta Tags</TabsTrigger>\n            <TabsTrigger value=\"schema\">Schema Markup</TabsTrigger>\n            <TabsTrigger value=\"sitemap\">Sitemap</TabsTrigger>\n            <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"meta\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Global Meta Tags</CardTitle>\n                <CardDescription>Default meta information for all pages</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Meta Title</label>\n                  <Input defaultValue=\"Loi Developer - Full-stack Developer Portfolio\" />\n                  <p className=\"text-xs text-muted-foreground mt-1\">60 characters recommended</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Meta Description</label>\n                  <Textarea \n                    defaultValue=\"Professional full-stack developer specializing in React, Node.js, and modern web technologies\"\n                    className=\"min-h-[80px]\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">160 characters recommended</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Keywords</label>\n                  <Input defaultValue=\"web developer, full-stack, react, node.js, portfolio\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Canonical URL</label>\n                  <Input defaultValue=\"https://loideveloper.com\" />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Open Graph / Social Media</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">OG Image</label>\n                  <Input defaultValue=\"https://loideveloper.com/og-image.jpg\" />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block\">Twitter Handle</label>\n                    <Input placeholder=\"@username\" />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block\">Card Type</label>\n                    <select className=\"w-full p-2 border rounded-md bg-background\">\n                      <option>summary_large_image</option>\n                      <option>summary</option>\n                    </select>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"schema\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Schema.org Structured Data</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <Textarea \n                  className=\"font-mono text-xs min-h-[300px]\"\n                  defaultValue={`{\n  \"@context\": \"https://schema.org\",\n  \"@type\": \"Person\",\n  \"name\": \"Loi Developer\",\n  \"jobTitle\": \"Full-stack Developer\",\n  \"url\": \"https://loideveloper.com\"\n}`}\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"sitemap\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>XML Sitemap</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input defaultValue=\"https://loideveloper.com/sitemap.xml\" readOnly className=\"bg-muted\" />\n                  <Button>Regenerate</Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <p className=\"text-sm font-medium\">Included URLs:</p>\n                  <div className=\"space-y-1 text-sm text-muted-foreground\">\n                    <div className=\"flex justify-between\">\n                      <span>Homepage</span>\n                      <Badge variant=\"secondary\">Priority: 1.0</Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Projects (15 pages)</span>\n                      <Badge variant=\"secondary\">Priority: 0.8</Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Blog Posts (28 pages)</span>\n                      <Badge variant=\"secondary\">Priority: 0.7</Badge>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"analytics\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Tracking & Analytics</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Google Analytics ID</label>\n                  <Input placeholder=\"G-XXXXXXXXXX\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Google Search Console</label>\n                  <Input placeholder=\"Verification code\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Facebook Pixel</label>\n                  <Input placeholder=\"Pixel ID\" />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":8061,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/pages/admin/ThemeEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Palette, \n  Type, \n  Layout, \n  Monitor, \n  Smartphone, \n  Tablet,\n  Save, \n  RotateCcw, \n  Download, \n  Upload,\n  Check,\n  Loader2,\n  Sun,\n  Moon,\n  Eye\n} from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { ThemeComparison } from \"./ThemeComparison\";\n\nconst THEME_PRESETS = [\n  { \n    name: \"Modern\", \n    description: \"Clean and professional\",\n    colors: { primary: \"#7c3aed\", secondary: \"#ec4899\", accent: \"#f59e0b\" } \n  },\n  { \n    name: \"Classic\", \n    description: \"Timeless elegance\",\n    colors: { primary: \"#1f2937\", secondary: \"#374151\", accent: \"#6366f1\" } \n  },\n  { \n    name: \"Minimal\", \n    description: \"Simple and focused\",\n    colors: { primary: \"#000000\", secondary: \"#666666\", accent: \"#3b82f6\" } \n  },\n  { \n    name: \"Vibrant\", \n    description: \"Bold and energetic\",\n    colors: { primary: \"#ff6b6b\", secondary: \"#4ecdc4\", accent: \"#95e1d3\" } \n  },\n  { \n    name: \"Ocean\", \n    description: \"Calm and serene\",\n    colors: { primary: \"#0ea5e9\", secondary: \"#06b6d4\", accent: \"#22d3ee\" } \n  },\n  { \n    name: \"Forest\", \n    description: \"Natural and organic\",\n    colors: { primary: \"#059669\", secondary: \"#10b981\", accent: \"#34d399\" } \n  },\n];\n\nconst FONT_OPTIONS = {\n  heading: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Space Grotesk\", label: \"Space Grotesk\" },\n    { value: \"Outfit\", label: \"Outfit\" },\n    { value: \"Poppins\", label: \"Poppins\" },\n    { value: \"Plus Jakarta Sans\", label: \"Plus Jakarta Sans\" },\n    { value: \"Montserrat\", label: \"Montserrat\" },\n  ],\n  body: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Roboto\", label: \"Roboto\" },\n    { value: \"Open Sans\", label: \"Open Sans\" },\n    { value: \"Lato\", label: \"Lato\" },\n    { value: \"Source Sans Pro\", label: \"Source Sans Pro\" },\n  ]\n};\n\ntype ThemeSettings = {\n  primaryColor: string;\n  secondaryColor: string;\n  accentColor: string;\n  headingFont: string;\n  bodyFont: string;\n  fontScale: string;\n  lineHeight: string;\n  letterSpacing: string;\n  containerWidth: string;\n  borderRadius: string;\n  animationSpeed: string;\n  shadowPreset: string;\n  stickyHeader: boolean;\n  darkModeEnabled: boolean;\n  darkModeDefault: string;\n  selectedPreset: string;\n  customCSS: string;\n};\n\nconst defaultTheme: ThemeSettings = {\n  primaryColor: \"#7c3aed\",\n  secondaryColor: \"#ec4899\",\n  accentColor: \"#f59e0b\",\n  headingFont: \"Inter\",\n  bodyFont: \"Inter\",\n  fontScale: \"1\",\n  lineHeight: \"1.5\",\n  letterSpacing: \"0\",\n  containerWidth: \"1440\",\n  borderRadius: \"8\",\n  animationSpeed: \"300\",\n  shadowPreset: \"soft\",\n  stickyHeader: true,\n  darkModeEnabled: true,\n  darkModeDefault: \"system\",\n  selectedPreset: \"Modern\",\n  customCSS: \"\",\n};\n\nexport default function AdminThemeEnhanced() {\n  const { toast } = useToast();\n  const [theme, setTheme] = useState<ThemeSettings>(defaultTheme);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [previewMode, setPreviewMode] = useState<\"desktop\" | \"tablet\" | \"mobile\">(\"desktop\");\n\n  const { data: savedSettings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: ['/api/settings'],\n  });\n\n  useEffect(() => {\n    if (savedSettings) {\n      // If theme is stored as a string (JSON), parse it\n      if (typeof (savedSettings as any).theme === 'string') {\n        try {\n          const parsedTheme = JSON.parse((savedSettings as any).theme);\n          setTheme({ ...defaultTheme, ...parsedTheme });\n          setHasChanges(false);\n        } catch (e) {\n          console.error('Failed to parse theme:', e);\n        }\n      } else if ((savedSettings as any).theme && typeof (savedSettings as any).theme === 'object') {\n        // If it's already an object, use it directly\n        setTheme({ ...defaultTheme, ...(savedSettings as any).theme });\n        setHasChanges(false);\n      }\n    }\n  }, [savedSettings]);\n\n  const saveMutation = useMutation({\n    mutationFn: async (settings: ThemeSettings) => {\n      const res = await apiRequest('PUT', '/api/settings/theme', { value: JSON.stringify(settings) });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      setHasChanges(false);\n      toast({\n        title: \"Theme saved\",\n        description: \"Your theme settings have been saved successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error saving theme\",\n        description: error.message || \"Failed to save theme settings.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateTheme = (updates: Partial<ThemeSettings>) => {\n    setTheme(prev => ({ ...prev, ...updates }));\n    setHasChanges(true);\n  };\n\n  const applyPreset = (preset: typeof THEME_PRESETS[0]) => {\n    updateTheme({\n      primaryColor: preset.colors.primary,\n      secondaryColor: preset.colors.secondary,\n      accentColor: preset.colors.accent,\n      selectedPreset: preset.name,\n    });\n  };\n\n  const handleReset = () => {\n    if (hasChanges) {\n      if (!confirm(\"You have unsaved changes. Reset anyway?\")) {\n        return;\n      }\n    }\n    setTheme(defaultTheme);\n    setHasChanges(true);\n    toast({\n      title: \"Theme reset\",\n      description: \"Theme has been reset to default settings.\",\n    });\n  };\n\n  const handleExport = () => {\n    const blob = new Blob([JSON.stringify(theme, null, 2)], { type: 'application/json' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `theme-settings-${new Date().toISOString().slice(0, 10)}.json`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleImport = () => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          try {\n            const imported = JSON.parse(e.target?.result as string);\n            setTheme({ ...defaultTheme, ...imported });\n            setHasChanges(true);\n            toast({\n              title: \"Theme imported\",\n              description: \"Theme settings have been imported successfully.\",\n            });\n          } catch {\n            toast({\n              title: \"Import failed\",\n              description: \"Invalid theme file format.\",\n              variant: \"destructive\",\n            });\n          }\n        };\n        reader.readAsText(file);\n      }\n    };\n    input.click();\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Theme Customization</h1>\n            <p className=\"text-muted-foreground\">Customize the look and feel of your website</p>\n          </div>\n          <div className=\"flex gap-2 flex-wrap\">\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleExport}\n              data-testid=\"button-export\"\n            >\n              <Download className=\"w-4 h-4\" /> Export\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleImport}\n              data-testid=\"button-import\"\n            >\n              <Upload className=\"w-4 h-4\" /> Import\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleReset}\n              data-testid=\"button-reset\"\n            >\n              <RotateCcw className=\"w-4 h-4\" /> Reset\n            </Button>\n            <Button \n              className=\"gap-2\"\n              onClick={() => saveMutation.mutate(theme)}\n              disabled={saveMutation.isPending || !hasChanges}\n              data-testid=\"button-save\"\n            >\n              {saveMutation.isPending ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4\" />\n              )}\n              Save Changes\n              {hasChanges && <Badge variant=\"secondary\" className=\"ml-1\">Unsaved</Badge>}\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"colors\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-2xl grid-cols-5\">\n            <TabsTrigger value=\"colors\" data-testid=\"tab-colors\">Colors</TabsTrigger>\n            <TabsTrigger value=\"typography\" data-testid=\"tab-typography\">Typography</TabsTrigger>\n            <TabsTrigger value=\"layout\" data-testid=\"tab-layout\">Layout</TabsTrigger>\n            <TabsTrigger value=\"presets\" data-testid=\"tab-presets\">Presets</TabsTrigger>\n            <TabsTrigger value=\"preview\" data-testid=\"tab-preview\">Preview</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"colors\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Palette className=\"w-5 h-5\" /> Color Scheme\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Primary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.primaryColor}\n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-primary-color\"\n                      />\n                      <Input \n                        value={theme.primaryColor} \n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for buttons, links, and main highlights</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Secondary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.secondaryColor}\n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-secondary-color\"\n                      />\n                      <Input \n                        value={theme.secondaryColor} \n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for secondary actions and backgrounds</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Accent Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.accentColor}\n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-accent-color\"\n                      />\n                      <Input \n                        value={theme.accentColor} \n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for accents and notifications</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Quick Color Presets</label>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {[\"#7c3aed\", \"#3b82f6\", \"#10b981\", \"#f59e0b\", \"#ef4444\", \"#ec4899\", \"#8b5cf6\", \"#06b6d4\"].map((color) => (\n                        <button\n                          key={color}\n                          className={`w-8 h-8 rounded-full border-2 transition-all ${theme.primaryColor === color ? 'border-foreground scale-110' : 'border-transparent'}`}\n                          style={{ backgroundColor: color }}\n                          onClick={() => updateTheme({ primaryColor: color })}\n                          data-testid={`color-preset-${color}`}\n                        />\n                      ))}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sun className=\"w-5 h-5\" /> Dark Mode Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Enable Dark Mode</label>\n                      <p className=\"text-xs text-muted-foreground\">Allow users to switch to dark mode</p>\n                    </div>\n                    <Switch \n                      checked={theme.darkModeEnabled}\n                      onCheckedChange={(checked) => updateTheme({ darkModeEnabled: checked })}\n                      data-testid=\"switch-dark-mode\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Default Mode</label>\n                    <Select \n                      value={theme.darkModeDefault} \n                      onValueChange={(value) => updateTheme({ darkModeDefault: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-dark-mode-default\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"system\">System Preference</SelectItem>\n                        <SelectItem value=\"light\">Light Mode</SelectItem>\n                        <SelectItem value=\"dark\">Dark Mode</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"p-4 bg-muted rounded-lg\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <Check className=\"w-4 h-4 text-green-500\" />\n                      <p className=\"text-sm font-medium\">Contrast Check</p>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">WCAG AA compliant</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"typography\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Type className=\"w-5 h-5\" /> Font Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Heading Font</label>\n                    <Select \n                      value={theme.headingFont}\n                      onValueChange={(value) => updateTheme({ headingFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-heading-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.heading.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Body Font</label>\n                    <Select \n                      value={theme.bodyFont}\n                      onValueChange={(value) => updateTheme({ bodyFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-body-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.body.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Font Size Scale</label>\n                    <Select \n                      value={theme.fontScale}\n                      onValueChange={(value) => updateTheme({ fontScale: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-font-scale\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0.875\">Small (0.875x)</SelectItem>\n                        <SelectItem value=\"1\">Normal (1x)</SelectItem>\n                        <SelectItem value=\"1.125\">Large (1.125x)</SelectItem>\n                        <SelectItem value=\"1.25\">Extra Large (1.25x)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Spacing</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Line Height</label>\n                    <Input \n                      value={theme.lineHeight}\n                      onChange={(e) => updateTheme({ lineHeight: e.target.value })}\n                      data-testid=\"input-line-height\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Letter Spacing (px)</label>\n                    <Input \n                      value={theme.letterSpacing}\n                      onChange={(e) => updateTheme({ letterSpacing: e.target.value })}\n                      data-testid=\"input-letter-spacing\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"lg:col-span-2\">\n                <CardHeader>\n                  <CardTitle>Typography Preview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div \n                    className=\"p-6 bg-muted rounded-lg space-y-4\"\n                    style={{ fontFamily: theme.bodyFont, lineHeight: theme.lineHeight }}\n                  >\n                    <h1 \n                      className=\"text-4xl font-bold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      The Quick Brown Fox\n                    </h1>\n                    <h2 \n                      className=\"text-2xl font-semibold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      Jumps Over The Lazy Dog\n                    </h2>\n                    <p className=\"text-base\">\n                      Lorem ipsum dolor sit amet, consectetur adipiscing elit. \n                      Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n                    </p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      This is how your body text will appear with the selected typography settings.\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"layout\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Layout className=\"w-5 h-5\" /> Layout Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Container Width</label>\n                    <Select \n                      value={theme.containerWidth}\n                      onValueChange={(value) => updateTheme({ containerWidth: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-container-width\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"1200\">Boxed (1200px)</SelectItem>\n                        <SelectItem value=\"1440\">Wide (1440px)</SelectItem>\n                        <SelectItem value=\"100%\">Full Width</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Sticky Header</label>\n                      <p className=\"text-xs text-muted-foreground\">Keep header visible on scroll</p>\n                    </div>\n                    <Switch \n                      checked={theme.stickyHeader}\n                      onCheckedChange={(checked) => updateTheme({ stickyHeader: checked })}\n                      data-testid=\"switch-sticky-header\"\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Border Radius</label>\n                    <Select \n                      value={theme.borderRadius}\n                      onValueChange={(value) => updateTheme({ borderRadius: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-border-radius\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0\">Sharp (0px)</SelectItem>\n                        <SelectItem value=\"4\">Small (4px)</SelectItem>\n                        <SelectItem value=\"8\">Medium (8px)</SelectItem>\n                        <SelectItem value=\"12\">Large (12px)</SelectItem>\n                        <SelectItem value=\"16\">Extra Large (16px)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Animation & Effects</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Animation Speed</label>\n                    <Select \n                      value={theme.animationSpeed}\n                      onValueChange={(value) => updateTheme({ animationSpeed: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-animation-speed\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"400\">Slow (400ms)</SelectItem>\n                        <SelectItem value=\"300\">Normal (300ms)</SelectItem>\n                        <SelectItem value=\"200\">Fast (200ms)</SelectItem>\n                        <SelectItem value=\"0\">Instant (0ms)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Shadow Preset</label>\n                    <Select \n                      value={theme.shadowPreset}\n                      onValueChange={(value) => updateTheme({ shadowPreset: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-shadow-preset\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"none\">None</SelectItem>\n                        <SelectItem value=\"soft\">Soft</SelectItem>\n                        <SelectItem value=\"medium\">Medium</SelectItem>\n                        <SelectItem value=\"bold\">Bold</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"grid grid-cols-4 gap-2 pt-2\">\n                    {['none', 'soft', 'medium', 'bold'].map((shadow) => (\n                      <button\n                        key={shadow}\n                        onClick={() => updateTheme({ shadowPreset: shadow })}\n                        className={`p-4 bg-card rounded-lg border transition-all ${\n                          theme.shadowPreset === shadow ? 'border-primary ring-2 ring-primary/20' : 'border-border'\n                        }`}\n                        style={{\n                          boxShadow: shadow === 'none' ? 'none' :\n                            shadow === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                            shadow === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                            '0 10px 15px rgba(0,0,0,0.1)'\n                        }}\n                      >\n                        <span className=\"text-xs capitalize\">{shadow}</span>\n                      </button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"presets\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Theme Presets</CardTitle>\n                <CardDescription>Choose from pre-designed theme combinations</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {THEME_PRESETS.map((preset) => (\n                    <button\n                      key={preset.name}\n                      onClick={() => applyPreset(preset)}\n                      className={`p-4 rounded-lg border-2 transition text-left ${\n                        theme.selectedPreset === preset.name\n                          ? \"border-primary bg-primary/5\"\n                          : \"border-border hover:border-primary/50\"\n                      }`}\n                      data-testid={`preset-${preset.name.toLowerCase()}`}\n                    >\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className=\"flex gap-1\">\n                          {Object.values(preset.colors).map((color, i) => (\n                            <div\n                              key={i}\n                              className=\"w-6 h-6 rounded-full border border-border\"\n                              style={{ backgroundColor: color }}\n                            />\n                          ))}\n                        </div>\n                        {theme.selectedPreset === preset.name && (\n                          <Badge className=\"ml-auto\">Active</Badge>\n                        )}\n                      </div>\n                      <h4 className=\"font-medium\">{preset.name}</h4>\n                      <p className=\"text-xs text-muted-foreground\">{preset.description}</p>\n                    </button>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Custom CSS</CardTitle>\n                <CardDescription>Add custom CSS to override theme styles</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <textarea\n                  className=\"w-full p-3 border rounded-md font-mono text-sm bg-muted/50 min-h-[200px] focus:outline-none focus:ring-2 focus:ring-primary\"\n                  placeholder={`:root {\n  --primary: ${theme.primaryColor};\n  --secondary: ${theme.secondaryColor};\n}`}\n                  value={theme.customCSS}\n                  onChange={(e) => updateTheme({ customCSS: e.target.value })}\n                  data-testid=\"textarea-custom-css\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"preview\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4\">\n              <div>\n                <h3 className=\"font-medium\">Live Preview</h3>\n                <p className=\"text-sm text-muted-foreground\">Changes are applied in real-time</p>\n              </div>\n              <div className=\"flex gap-2 flex-wrap\">\n                <Button\n                  variant={previewMode === \"desktop\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"desktop\")}\n                  data-testid=\"button-preview-desktop\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Monitor className=\"w-4 h-4\" />\n                  <span>Desktop</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"tablet\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"tablet\")}\n                  data-testid=\"button-preview-tablet\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Tablet className=\"w-4 h-4\" />\n                  <span>Tablet</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"mobile\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"mobile\")}\n                  data-testid=\"button-preview-mobile\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Smartphone className=\"w-4 h-4\" />\n                  <span>Mobile</span>\n                </Button>\n              </div>\n            </div>\n\n            <Card className=\"overflow-hidden\">\n              <CardContent className=\"p-6 bg-muted/30\">\n                <div \n                  className={`mx-auto transition-all duration-300 overflow-y-auto max-h-[600px] ${\n                    previewMode === 'desktop' ? 'max-w-full' :\n                    previewMode === 'tablet' ? 'max-w-[768px]' :\n                    'max-w-[375px]'\n                  }`}\n                  style={{\n                    fontFamily: theme.bodyFont,\n                    fontSize: `${parseFloat(theme.fontScale) * 16}px`,\n                    lineHeight: theme.lineHeight,\n                    letterSpacing: `${theme.letterSpacing}px`,\n                  }}\n                >\n                  <div \n                    className=\"border overflow-hidden shadow-lg bg-background\"\n                    style={{ \n                      borderRadius: `${theme.borderRadius}px`,\n                      transition: `all ${theme.animationSpeed}ms ease`,\n                      boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                        theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                        theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                        '0 10px 15px rgba(0,0,0,0.1)'\n                    }}\n                  >\n                    {/* Navbar */}\n                    <div \n                      className=\"h-14 border-b flex items-center justify-between px-4 sticky top-0 z-10\"\n                      style={{ \n                        backgroundColor: `${theme.primaryColor}10`,\n                        borderColor: `${theme.primaryColor}20`\n                      }}\n                    >\n                      <div className=\"font-bold text-lg\" style={{ color: theme.primaryColor, fontFamily: theme.headingFont }}>\n                        Loi Developer\n                      </div>\n                      <div className=\"flex gap-4 text-xs\">\n                        <span>Portfolio</span>\n                        <span>Blog</span>\n                        <span>Contact</span>\n                      </div>\n                    </div>\n\n                    {/* Hero Section */}\n                    <div className=\"p-8 text-center space-y-3 bg-gradient-to-b from-background to-muted/20\">\n                      <h1 \n                        className=\"text-3xl font-bold\" \n                        style={{ fontFamily: theme.headingFont, color: theme.primaryColor }}\n                      >\n                        Hello, I'm Loi Developer\n                      </h1>\n                      <p className=\"text-sm text-muted-foreground max-w-md mx-auto\">\n                        Full-stack Developer | UI/UX Enthusiast | Creative Thinker\n                      </p>\n                      <Button \n                        size=\"sm\" \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        View My Work\n                      </Button>\n                    </div>\n\n                    {/* Services Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Featured Services</h2>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {[\n                          'Web Development',\n                          'UI/UX Design',\n                          'Backend APIs',\n                          'DevOps'\n                        ].map(service => (\n                          <div \n                            key={service}\n                            className=\"p-3 border bg-card\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}30`,\n                              boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                                theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                                theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                                '0 10px 15px rgba(0,0,0,0.1)'\n                            }}\n                          >\n                            <div className=\"text-xs text-center font-medium\" style={{ color: theme.primaryColor }}>\n                              {service}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Projects Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Latest Projects</h2>\n                      <div className=\"space-y-2\">\n                        {[1, 2, 3].map(i => (\n                          <div \n                            key={i}\n                            className=\"p-3 border bg-card flex items-start gap-2\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}20`\n                            }}\n                          >\n                            <div \n                              className=\"w-12 h-12 rounded flex-shrink-0\" \n                              style={{ \n                                backgroundColor: `${theme.primaryColor}20`,\n                                borderRadius: `${theme.borderRadius}px`\n                              }} \n                            />\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"h-2 w-24 bg-muted rounded mb-1\" />\n                              <div className=\"h-2 w-32 bg-muted/60 rounded\" />\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Footer */}\n                    <div \n                      className=\"p-4 text-center text-xs border-t\"\n                      style={{ borderColor: `${theme.primaryColor}20` }}\n                    >\n                      <p className=\"text-muted-foreground\">\n                        2024 Loi Developer. All rights reserved.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <ThemeComparison currentTheme={theme} />\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Component Preview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Buttons</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Button \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Button>\n                      <Button \n                        style={{ \n                          backgroundColor: theme.secondaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Secondary\n                      </Button>\n                      <Button \n                        variant=\"outline\"\n                        style={{ \n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                      >\n                        Outline\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Badges</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Badge>\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.accentColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Accent\n                      </Badge>\n                      <Badge \n                        variant=\"outline\"\n                        style={{ borderRadius: `${theme.borderRadius}px` }}\n                      >\n                        Outline\n                      </Badge>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Cards</h4>\n                    <Card \n                      style={{ \n                        borderRadius: `${theme.borderRadius}px`,\n                        boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                          theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                          theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                          '0 10px 15px rgba(0,0,0,0.1)'\n                      }}\n                    >\n                      <CardContent className=\"p-4\">\n                        <p className=\"text-sm\" style={{ lineHeight: theme.lineHeight }}>\n                          Sample card content\n                        </p>\n                      </CardContent>\n                    </Card>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":42815,"size_tokens":null},"client/src/components/admin/pagination.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\n\ninterface PaginationProps {\n  currentPage: number;\n  totalPages: number;\n  onPageChange: (page: number) => void;\n}\n\nexport function Pagination({ currentPage, totalPages, onPageChange }: PaginationProps) {\n  return (\n    <div className=\"flex items-center justify-between gap-4 mt-6\">\n      <p className=\"text-sm text-muted-foreground\">\n        Page {currentPage} of {totalPages}\n      </p>\n      <div className=\"flex gap-2\">\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={() => onPageChange(currentPage - 1)}\n          disabled={currentPage === 1}\n        >\n          <ChevronLeft className=\"w-4 h-4\" />\n        </Button>\n        {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n          <Button\n            key={page}\n            variant={page === currentPage ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => onPageChange(page)}\n            className=\"w-8\"\n          >\n            {page}\n          </Button>\n        ))}\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={() => onPageChange(currentPage + 1)}\n          disabled={currentPage === totalPages}\n        >\n          <ChevronRight className=\"w-4 h-4\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1384,"size_tokens":null},"client/src/components/ErrorBoundary.tsx":{"content":"import React, { Component, ErrorInfo, ReactNode } from \"react\";\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  public state: State = {\n    hasError: false\n  };\n\n  public static getDerivedStateFromError(_: Error): State {\n    return { hasError: true };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error(\"ErrorBoundary caught an error:\", error, errorInfo);\n  }\n\n  public render() {\n    if (this.state.hasError) {\n      return this.props.fallback || null;\n    }\n\n    return this.props.children;\n  }\n}\n","path":null,"size_bytes":663,"size_tokens":null},"client/src/components/layout/Footer.tsx":{"content":"import { ArrowUp, Github, Linkedin, Twitter, LayoutDashboard } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\n\nexport function Footer() {\n  const [showScrollTop, setShowScrollTop] = useState(false);\n\n  const { data: settings } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n    staleTime: 1000 * 60 * 5,\n  });\n\n  const footerText = settings?.footerText || \"Crafted with love & countless cups of coffee\";\n  const footerCopyright = settings?.footerCopyright || \"2024 Loi Developer. All rights reserved.\";\n  const socialGithub = settings?.socialGithub || \"\";\n  const socialLinkedin = settings?.socialLinkedin || \"\";\n  const socialTwitter = settings?.socialTwitter || \"\";\n\n  useEffect(() => {\n    const handleScroll = () => {\n      setShowScrollTop(window.scrollY > 500);\n    };\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  const scrollToTop = () => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  };\n\n  const socialLinks = [\n    { url: socialGithub, icon: Github, name: \"GitHub\" },\n    { url: socialLinkedin, icon: Linkedin, name: \"LinkedIn\" },\n    { url: socialTwitter, icon: Twitter, name: \"Twitter\" },\n  ].filter(s => s.url);\n\n  return (\n    <footer className=\"py-8 bg-background border-t border-border/50 relative overflow-hidden\">\n      <div className=\"container mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-4\">\n        <div className=\"text-sm text-muted-foreground flex flex-col md:flex-row items-center gap-4\">\n          <span className=\"font-mono\">{footerText}</span>\n          <div className=\"mt-1 md:mt-0\">{footerCopyright}</div>\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <Link href=\"/admin/login\" className=\"text-muted-foreground hover:text-primary transition-colors\" title=\"Admin Login\">\n             <LayoutDashboard size={18} />\n          </Link>\n          {socialLinks.length > 0 && (\n            <>\n              <div className=\"h-4 w-px bg-border mx-2 hidden md:block\" />\n              {socialLinks.map((social, i) => (\n                <a\n                  key={i}\n                  href={social.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"p-2 text-muted-foreground hover:text-primary transition-colors hover:scale-110 transform duration-300\"\n                  data-testid={`link-footer-${social.name.toLowerCase()}`}\n                >\n                  <social.icon size={20} />\n                </a>\n              ))}\n            </>\n          )}\n        </div>\n      </div>\n\n      {showScrollTop && (\n        <button\n          onClick={scrollToTop}\n          className=\"fixed bottom-8 right-8 p-3 bg-primary text-white rounded-full shadow-lg hover:bg-primary/80 transition-all duration-300 z-40 animate-in fade-in zoom-in\"\n          data-testid=\"button-scroll-top\"\n        >\n          <ArrowUp size={24} />\n        </button>\n      )}\n    </footer>\n  );\n}\n","path":null,"size_bytes":3119,"size_tokens":null},"client/src/pages/admin/System.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Database, \n  RotateCcw, \n  Clock, \n  ShieldCheck,\n  AlertTriangle,\n  HardDrive,\n  RefreshCw,\n  Trash2,\n  Activity,\n  Users,\n  FileText,\n  Briefcase,\n  MessageSquare,\n  Loader2,\n  CheckCircle,\n  XCircle,\n  Info\n} from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\nfunction formatUptime(seconds: number): string {\n  const days = Math.floor(seconds / 86400);\n  const hours = Math.floor((seconds % 86400) / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  \n  if (days > 0) {\n    return `${days}d ${hours}h ${minutes}m`;\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m`;\n  } else {\n    return `${minutes}m`;\n  }\n}\n\nfunction getIconForType(type: string) {\n  switch (type) {\n    case \"success\": return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n    case \"error\": return <XCircle className=\"w-4 h-4 text-red-500\" />;\n    case \"warning\": return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\n    default: return <Info className=\"w-4 h-4 text-blue-500\" />;\n  }\n}\n\nexport default function AdminSystem() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: systemStats, isLoading: statsLoading, refetch: refetchStats } = useQuery({\n    queryKey: [\"/api/system/stats\"],\n    queryFn: () => api.getSystemStats(),\n    refetchInterval: 30000,\n  });\n\n  const { data: activityLogs = [], isLoading: logsLoading, refetch: refetchLogs } = useQuery({\n    queryKey: [\"/api/system/activity-logs\"],\n    queryFn: () => api.getSystemActivityLogs(100, 0),\n  });\n\n  const clearLogsMutation = useMutation({\n    mutationFn: () => api.clearActivityLogs(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/system/activity-logs\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/system/stats\"] });\n      refetchStats();\n      refetchLogs();\n      toast({ title: \"Success\", description: \"Activity logs cleared\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to clear logs\", variant: \"destructive\" });\n    },\n  });\n\n  const resetMutation = useMutation({\n    mutationFn: () => api.resetSystem(),\n    onSuccess: (data) => {\n      refetchStats();\n      refetchLogs();\n      toast({ title: \"Info\", description: data.message });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to reset system\", variant: \"destructive\" });\n    },\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"Healthy\": return \"text-green-500\";\n      case \"Warning\": return \"text-yellow-500\";\n      case \"Error\": return \"text-red-500\";\n      default: return \"text-muted-foreground\";\n    }\n  };\n\n  const getStatusBgColor = (status: string) => {\n    switch (status) {\n      case \"Healthy\": return \"bg-green-500/5 border-green-500/20\";\n      case \"Warning\": return \"bg-yellow-500/5 border-yellow-500/20\";\n      case \"Error\": return \"bg-red-500/5 border-red-500/20\";\n      default: return \"\";\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">System & Monitoring</h1>\n            <p className=\"text-muted-foreground\">Monitor system health and activity logs</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => refetchStats()}\n              disabled={statsLoading}\n              data-testid=\"button-refresh-stats\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${statsLoading ? 'animate-spin' : ''}`} />\n              Refresh\n            </Button>\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button \n                  variant=\"outline\" \n                  className=\"text-destructive border-destructive/50\"\n                  data-testid=\"button-reset-system\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset System\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Reset System</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    This action will attempt to reset the system. This operation is restricted in this environment.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction \n                    onClick={() => resetMutation.mutate()}\n                    className=\"bg-destructive text-destructive-foreground\"\n                  >\n                    {resetMutation.isPending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Reset\"}\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        </div>\n\n        {statsLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n          </div>\n        ) : (\n          <>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <Card className={getStatusBgColor(systemStats?.status || \"Healthy\")}>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                    <ShieldCheck className={`w-4 h-4 ${getStatusColor(systemStats?.status || \"Healthy\")}`} /> \n                    System Status\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className={`text-2xl font-bold ${getStatusColor(systemStats?.status || \"Healthy\")}`}>\n                    {systemStats?.status || \"Checking...\"}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    Last check: {systemStats?.lastCheck ? formatDistanceToNow(new Date(systemStats.lastCheck), { addSuffix: true }) : \"Unknown\"}\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                    <HardDrive className=\"w-4 h-4 text-primary\" /> Database Size\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{systemStats?.databaseSize || \"Unknown\"}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {systemStats?.tableStats?.reduce((sum, t) => sum + t.count, 0) || 0} total records\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                    <Clock className=\"w-4 h-4 text-blue-500\" /> Server Uptime\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">\n                    {systemStats?.serverUptime ? formatUptime(systemStats.serverUptime) : \"Unknown\"}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Since last restart</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Database className=\"w-5 h-5\" />\n                  Database Tables\n                </CardTitle>\n                <CardDescription>Record counts per table</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4\">\n                  {systemStats?.tableStats?.map((table) => (\n                    <div \n                      key={table.name} \n                      className=\"flex items-center gap-3 p-3 rounded-lg bg-muted/50\"\n                    >\n                      <div className=\"p-2 rounded-md bg-primary/10\">\n                        {table.name === \"Users\" && <Users className=\"w-4 h-4 text-primary\" />}\n                        {table.name === \"Projects\" && <Briefcase className=\"w-4 h-4 text-primary\" />}\n                        {table.name === \"Posts\" && <FileText className=\"w-4 h-4 text-primary\" />}\n                        {table.name === \"Messages\" && <MessageSquare className=\"w-4 h-4 text-primary\" />}\n                        {![\"Users\", \"Projects\", \"Posts\", \"Messages\"].includes(table.name) && \n                          <Database className=\"w-4 h-4 text-primary\" />}\n                      </div>\n                      <div>\n                        <p className=\"font-semibold\">{table.count}</p>\n                        <p className=\"text-xs text-muted-foreground\">{table.name}</p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </>\n        )}\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between gap-4\">\n              <div>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Activity className=\"w-5 h-5\" />\n                  Activity Log\n                </CardTitle>\n                <CardDescription>Recent system and user activities</CardDescription>\n              </div>\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\"\n                    className=\"text-destructive\"\n                    data-testid=\"button-clear-logs\"\n                  >\n                    <Trash2 className=\"w-4 h-4 mr-2\" /> Clear Logs\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>Clear Activity Logs</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      This will permanently delete all activity logs. This action cannot be undone.\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel>Cancel</AlertDialogCancel>\n                    <AlertDialogAction \n                      onClick={() => clearLogsMutation.mutate()}\n                      className=\"bg-destructive text-destructive-foreground\"\n                    >\n                      {clearLogsMutation.isPending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Clear All\"}\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {logsLoading ? (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n              </div>\n            ) : activityLogs && activityLogs.length > 0 ? (\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Action</TableHead>\n                    <TableHead>User</TableHead>\n                    <TableHead>Type</TableHead>\n                    <TableHead className=\"text-right\">Time</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {activityLogs.map((log: any) => (\n                    <TableRow key={log.id}>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          {getIconForType(log.type)}\n                          <span className=\"font-medium\">{log.action}</span>\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"text-muted-foreground\">\n                        {log.userName || \"System\"}\n                      </TableCell>\n                      <TableCell>\n                        <Badge \n                          variant={\n                            log.type === \"success\" ? \"default\" : \n                            log.type === \"error\" ? \"destructive\" : \n                            log.type === \"warning\" ? \"secondary\" : \"outline\"\n                          }\n                          className=\"text-xs\"\n                        >\n                          {log.type}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right text-muted-foreground text-sm\">\n                        {log.createdAt ? formatDistanceToNow(new Date(log.createdAt), { addSuffix: true }) : \"Unknown\"}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <Activity className=\"w-12 h-12 mx-auto mb-4 opacity-20\" />\n                <p>No activity logs found</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":14432,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  \n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  \n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  \n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  \n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  \n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  \n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  \n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  \n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  \n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n\n  --font-sans: \"Inter\", sans-serif;\n  --font-heading: \"Outfit\", sans-serif;\n  --font-mono: \"Space Grotesk\", monospace;\n}\n\n/* Dark Mode by Default as requested for \"Creative Coder\" vibe */\n:root {\n  --background: 222 47% 11%; /* Slate 950 */\n  --foreground: 210 40% 98%;\n  \n  --card: 222 47% 11%;\n  --card-foreground: 210 40% 98%;\n  \n  --popover: 222 47% 11%;\n  --popover-foreground: 210 40% 98%;\n  \n  --primary: 263 70% 50%; /* Purple Neon */\n  --primary-foreground: 210 40% 98%;\n  \n  --secondary: 199 89% 48%; /* Cyan Neon */\n  --secondary-foreground: 210 40% 98%;\n  \n  --muted: 217 33% 17%;\n  --muted-foreground: 215 20% 65%;\n  \n  --accent: 217 33% 17%;\n  --accent-foreground: 210 40% 98%;\n  \n  --destructive: 0 62% 30%;\n  --destructive-foreground: 210 40% 98%;\n  \n  --border: 217 33% 17%;\n  --input: 217 33% 17%;\n  --ring: 263 70% 50%;\n  \n  --radius: 0.75rem;\n}\n\n.dark {\n  /* Same as root since we are dark default, but explicit for toggling if needed */\n  --background: 222 47% 11%;\n  --foreground: 210 40% 98%;\n  --card: 222 47% 11%;\n  --card-foreground: 210 40% 98%;\n  --popover: 222 47% 11%;\n  --popover-foreground: 210 40% 98%;\n  --primary: 263 70% 50%;\n  --primary-foreground: 210 40% 98%;\n  --secondary: 199 89% 48%;\n  --secondary-foreground: 210 40% 98%;\n  --muted: 217 33% 17%;\n  --muted-foreground: 215 20% 65%;\n  --accent: 217 33% 17%;\n  --accent-foreground: 210 40% 98%;\n  --destructive: 0 62% 30%;\n  --destructive-foreground: 210 40% 98%;\n  --border: 217 33% 17%;\n  --input: 217 33% 17%;\n  --ring: 263 70% 50%;\n}\n\n/* Light Mode - Clean & Sharp */\n.light {\n  --background: 0 0% 100%;\n  --foreground: 222 47% 11%;\n  \n  --card: 0 0% 100%;\n  --card-foreground: 222 47% 11%;\n  \n  --popover: 0 0% 100%;\n  --popover-foreground: 222 47% 11%;\n  \n  --primary: 263 70% 50%;\n  --primary-foreground: 210 40% 98%;\n  \n  --secondary: 199 89% 48%;\n  --secondary-foreground: 210 40% 98%;\n  \n  --muted: 210 40% 96.1%;\n  --muted-foreground: 215.4 16.3% 46.9%;\n  \n  --accent: 210 40% 96.1%;\n  --accent-foreground: 222.2 47.4% 11.2%;\n  \n  --destructive: 0 84.2% 60.2%;\n  --destructive-foreground: 210 40% 98%;\n  \n  --border: 214.3 31.8% 91.4%;\n  --input: 214.3 31.8% 91.4%;\n  --ring: 263 70% 50%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground selection:bg-primary/30 selection:text-primary-foreground;\n  }\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-heading font-bold tracking-tight;\n  }\n}\n\n@layer utilities {\n  .glass {\n    @apply bg-background/60 backdrop-blur-md border-b border-white/10;\n  }\n  .text-gradient {\n    @apply bg-clip-text text-transparent bg-gradient-to-r from-primary via-purple-400 to-secondary;\n  }\n  .text-gradient-gold {\n    @apply bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 via-orange-300 to-yellow-600;\n  }\n  \n  /* Custom Scrollbar */\n  ::-webkit-scrollbar {\n    width: 8px;\n  }\n  ::-webkit-scrollbar-track {\n    @apply bg-muted;\n  }\n  ::-webkit-scrollbar-thumb {\n    @apply bg-primary/50 rounded-full hover:bg-primary transition-colors;\n  }\n}\n\n/* Hacker/IT Style Animations */\n\n/* Glitch Text Effect */\n.glitch-text {\n  position: relative;\n  animation: glitch-skew 1s infinite linear alternate-reverse;\n}\n\n.glitch-text::before,\n.glitch-text::after {\n  content: attr(data-text);\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: hsl(var(--background));\n}\n\n.glitch-text::before {\n  left: 2px;\n  text-shadow: -2px 0 #00ff41;\n  clip: rect(44px, 450px, 56px, 0);\n  animation: glitch-anim 5s infinite linear alternate-reverse;\n}\n\n.glitch-text::after {\n  left: -2px;\n  text-shadow: -2px 0 #00d4ff, 2px 2px #7c3aed;\n  animation: glitch-anim2 1s infinite linear alternate-reverse;\n}\n\n@keyframes glitch-anim {\n  0% {\n    clip: rect(10px, 9999px, 31px, 0);\n    transform: skew(0.85deg);\n  }\n  5% {\n    clip: rect(70px, 9999px, 71px, 0);\n    transform: skew(0.34deg);\n  }\n  10% {\n    clip: rect(35px, 9999px, 58px, 0);\n    transform: skew(0.92deg);\n  }\n  15% {\n    clip: rect(12px, 9999px, 83px, 0);\n    transform: skew(0.08deg);\n  }\n  20% {\n    clip: rect(45px, 9999px, 40px, 0);\n    transform: skew(0.53deg);\n  }\n  25% {\n    clip: rect(76px, 9999px, 23px, 0);\n    transform: skew(0.17deg);\n  }\n  30% {\n    clip: rect(67px, 9999px, 62px, 0);\n    transform: skew(0.89deg);\n  }\n  35% {\n    clip: rect(5px, 9999px, 90px, 0);\n    transform: skew(0.42deg);\n  }\n  40% {\n    clip: rect(88px, 9999px, 15px, 0);\n    transform: skew(0.71deg);\n  }\n  45% {\n    clip: rect(21px, 9999px, 49px, 0);\n    transform: skew(0.25deg);\n  }\n  50% {\n    clip: rect(33px, 9999px, 78px, 0);\n    transform: skew(0.63deg);\n  }\n  55% {\n    clip: rect(92px, 9999px, 11px, 0);\n    transform: skew(0.14deg);\n  }\n  60% {\n    clip: rect(48px, 9999px, 55px, 0);\n    transform: skew(0.95deg);\n  }\n  65% {\n    clip: rect(7px, 9999px, 87px, 0);\n    transform: skew(0.38deg);\n  }\n  70% {\n    clip: rect(59px, 9999px, 29px, 0);\n    transform: skew(0.77deg);\n  }\n  75% {\n    clip: rect(81px, 9999px, 44px, 0);\n    transform: skew(0.02deg);\n  }\n  80% {\n    clip: rect(16px, 9999px, 69px, 0);\n    transform: skew(0.56deg);\n  }\n  85% {\n    clip: rect(38px, 9999px, 94px, 0);\n    transform: skew(0.83deg);\n  }\n  90% {\n    clip: rect(73px, 9999px, 18px, 0);\n    transform: skew(0.29deg);\n  }\n  95% {\n    clip: rect(52px, 9999px, 36px, 0);\n    transform: skew(0.67deg);\n  }\n  100% {\n    clip: rect(27px, 9999px, 82px, 0);\n    transform: skew(0.45deg);\n  }\n}\n\n@keyframes glitch-anim2 {\n  0% {\n    clip: rect(65px, 9999px, 100px, 0);\n    transform: skew(0.6deg);\n  }\n  5% {\n    clip: rect(52px, 9999px, 74px, 0);\n    transform: skew(0.27deg);\n  }\n  10% {\n    clip: rect(79px, 9999px, 85px, 0);\n    transform: skew(0.88deg);\n  }\n  15% {\n    clip: rect(32px, 9999px, 46px, 0);\n    transform: skew(0.15deg);\n  }\n  20% {\n    clip: rect(91px, 9999px, 12px, 0);\n    transform: skew(0.73deg);\n  }\n  25% {\n    clip: rect(43px, 9999px, 67px, 0);\n    transform: skew(0.39deg);\n  }\n  30% {\n    clip: rect(18px, 9999px, 93px, 0);\n    transform: skew(0.81deg);\n  }\n  35% {\n    clip: rect(56px, 9999px, 28px, 0);\n    transform: skew(0.04deg);\n  }\n  40% {\n    clip: rect(84px, 9999px, 51px, 0);\n    transform: skew(0.62deg);\n  }\n  45% {\n    clip: rect(25px, 9999px, 77px, 0);\n    transform: skew(0.33deg);\n  }\n  50% {\n    clip: rect(68px, 9999px, 39px, 0);\n    transform: skew(0.91deg);\n  }\n  55% {\n    clip: rect(11px, 9999px, 95px, 0);\n    transform: skew(0.19deg);\n  }\n  60% {\n    clip: rect(47px, 9999px, 61px, 0);\n    transform: skew(0.76deg);\n  }\n  65% {\n    clip: rect(86px, 9999px, 22px, 0);\n    transform: skew(0.48deg);\n  }\n  70% {\n    clip: rect(34px, 9999px, 88px, 0);\n    transform: skew(0.07deg);\n  }\n  75% {\n    clip: rect(72px, 9999px, 42px, 0);\n    transform: skew(0.69deg);\n  }\n  80% {\n    clip: rect(19px, 9999px, 71px, 0);\n    transform: skew(0.35deg);\n  }\n  85% {\n    clip: rect(58px, 9999px, 16px, 0);\n    transform: skew(0.94deg);\n  }\n  90% {\n    clip: rect(82px, 9999px, 54px, 0);\n    transform: skew(0.22deg);\n  }\n  95% {\n    clip: rect(41px, 9999px, 89px, 0);\n    transform: skew(0.58deg);\n  }\n  100% {\n    clip: rect(63px, 9999px, 33px, 0);\n    transform: skew(0.84deg);\n  }\n}\n\n@keyframes glitch-skew {\n  0% {\n    transform: skew(0deg);\n  }\n  10% {\n    transform: skew(-0.5deg);\n  }\n  20% {\n    transform: skew(0.5deg);\n  }\n  30% {\n    transform: skew(0deg);\n  }\n  40% {\n    transform: skew(0.5deg);\n  }\n  50% {\n    transform: skew(-0.3deg);\n  }\n  60% {\n    transform: skew(0.3deg);\n  }\n  70% {\n    transform: skew(0deg);\n  }\n  80% {\n    transform: skew(-0.5deg);\n  }\n  90% {\n    transform: skew(0.5deg);\n  }\n  100% {\n    transform: skew(0deg);\n  }\n}\n\n/* Cyber Grid */\n.cyber-grid {\n  background-image: \n    linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px),\n    linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);\n  background-size: 50px 50px;\n  animation: grid-move 20s linear infinite;\n}\n\n@keyframes grid-move {\n  0% {\n    background-position: 0 0;\n  }\n  100% {\n    background-position: 50px 50px;\n  }\n}\n\n/* Hacker Typewriter Effect */\n.hacker-typewriter {\n  border-right: 2px solid transparent;\n  animation: typewriter-cursor 1s step-end infinite;\n}\n\n@keyframes typewriter-cursor {\n  50% {\n    border-color: #00ff41;\n  }\n}\n\n/* Spin animations */\n@keyframes spin-slow {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes spin-slow-reverse {\n  from {\n    transform: rotate(360deg);\n  }\n  to {\n    transform: rotate(0deg);\n  }\n}\n\n.animate-spin-slow {\n  animation: spin-slow 10s linear infinite;\n}\n\n.animate-spin-slow-reverse {\n  animation: spin-slow-reverse 15s linear infinite;\n}\n\n/* Scroll down animation */\n@keyframes scroll-down {\n  0%, 100% {\n    transform: translateY(0);\n    opacity: 1;\n  }\n  50% {\n    transform: translateY(16px);\n    opacity: 0.3;\n  }\n}\n\n.animate-scroll-down {\n  animation: scroll-down 1.5s ease-in-out infinite;\n}\n\n/* Enhanced Glitch Animation */\n@keyframes animate-glitch {\n  0% {\n    transform: translate(0);\n    filter: hue-rotate(0deg);\n  }\n  10% {\n    transform: translate(-2px, 2px);\n    filter: hue-rotate(90deg);\n  }\n  20% {\n    transform: translate(2px, -2px);\n    filter: hue-rotate(180deg);\n  }\n  30% {\n    transform: translate(-1px, 1px);\n    filter: hue-rotate(270deg);\n  }\n  40% {\n    transform: translate(1px, -1px);\n    filter: hue-rotate(360deg);\n  }\n  50% {\n    transform: translate(0);\n    filter: hue-rotate(0deg);\n  }\n  100% {\n    transform: translate(0);\n    filter: hue-rotate(0deg);\n  }\n}\n\n.animate-glitch {\n  animation: animate-glitch 0.3s ease-in-out;\n}\n\n/* Neon Glow Effects */\n.neon-green {\n  text-shadow: \n    0 0 5px #00ff41,\n    0 0 10px #00ff41,\n    0 0 20px #00ff41,\n    0 0 40px #00ff41;\n}\n\n.neon-cyan {\n  text-shadow: \n    0 0 5px #00d4ff,\n    0 0 10px #00d4ff,\n    0 0 20px #00d4ff,\n    0 0 40px #00d4ff;\n}\n\n.neon-purple {\n  text-shadow: \n    0 0 5px #7c3aed,\n    0 0 10px #7c3aed,\n    0 0 20px #7c3aed,\n    0 0 40px #7c3aed;\n}\n\n.neon-box-green {\n  box-shadow: \n    0 0 5px #00ff41,\n    0 0 10px #00ff41,\n    0 0 20px rgba(0, 255, 65, 0.5),\n    inset 0 0 10px rgba(0, 255, 65, 0.1);\n}\n\n.neon-box-cyan {\n  box-shadow: \n    0 0 5px #00d4ff,\n    0 0 10px #00d4ff,\n    0 0 20px rgba(0, 212, 255, 0.5),\n    inset 0 0 10px rgba(0, 212, 255, 0.1);\n}\n\n.neon-box-purple {\n  box-shadow: \n    0 0 5px #7c3aed,\n    0 0 10px #7c3aed,\n    0 0 20px rgba(124, 58, 237, 0.5),\n    inset 0 0 10px rgba(124, 58, 237, 0.1);\n}\n\n/* Scanline Effect */\n.scanlines::before {\n  content: \"\";\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: repeating-linear-gradient(\n    0deg,\n    rgba(0, 0, 0, 0.15),\n    rgba(0, 0, 0, 0.15) 1px,\n    transparent 1px,\n    transparent 2px\n  );\n  pointer-events: none;\n  z-index: 100;\n}\n\n/* Flicker Animation */\n@keyframes flicker {\n  0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {\n    opacity: 1;\n  }\n  20%, 24%, 55% {\n    opacity: 0.8;\n  }\n}\n\n.animate-flicker {\n  animation: flicker 3s infinite;\n}\n\n/* Pulse Glow */\n@keyframes pulse-glow {\n  0%, 100% {\n    box-shadow: 0 0 5px currentColor, 0 0 10px currentColor;\n  }\n  50% {\n    box-shadow: 0 0 20px currentColor, 0 0 40px currentColor, 0 0 60px currentColor;\n  }\n}\n\n.animate-pulse-glow {\n  animation: pulse-glow 2s ease-in-out infinite;\n}\n\n/* Text Gradient Animation */\n@keyframes gradient-shift {\n  0% {\n    background-position: 0% 50%;\n  }\n  50% {\n    background-position: 100% 50%;\n  }\n  100% {\n    background-position: 0% 50%;\n  }\n}\n\n.text-gradient-animated {\n  background: linear-gradient(90deg, #00ff41, #00d4ff, #7c3aed, #00ff41);\n  background-size: 300% 100%;\n  -webkit-background-clip: text;\n  background-clip: text;\n  color: transparent;\n  animation: gradient-shift 5s ease infinite;\n}\n\n/* Floating Animation */\n@keyframes float {\n  0%, 100% {\n    transform: translateY(0) rotate(0deg);\n  }\n  25% {\n    transform: translateY(-10px) rotate(2deg);\n  }\n  50% {\n    transform: translateY(-5px) rotate(-2deg);\n  }\n  75% {\n    transform: translateY(-15px) rotate(1deg);\n  }\n}\n\n.animate-float {\n  animation: float 6s ease-in-out infinite;\n}\n\n/* Border Glow Animation */\n@keyframes border-glow {\n  0%, 100% {\n    border-color: rgba(0, 255, 65, 0.5);\n    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);\n  }\n  33% {\n    border-color: rgba(0, 212, 255, 0.5);\n    box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);\n  }\n  66% {\n    border-color: rgba(124, 58, 237, 0.5);\n    box-shadow: 0 0 10px rgba(124, 58, 237, 0.3);\n  }\n}\n\n.animate-border-glow {\n  animation: border-glow 4s ease-in-out infinite;\n}\n\n/* Cyber Button Styles */\n.cyber-button {\n  position: relative;\n  overflow: hidden;\n  transition: all 0.3s ease;\n}\n\n.cyber-button::before {\n  content: \"\";\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(\n    90deg,\n    transparent,\n    rgba(255, 255, 255, 0.2),\n    transparent\n  );\n  transition: left 0.5s ease;\n}\n\n.cyber-button:hover::before {\n  left: 100%;\n}\n\n/* Terminal Cursor */\n@keyframes terminal-blink {\n  0%, 50% {\n    opacity: 1;\n  }\n  51%, 100% {\n    opacity: 0;\n  }\n}\n\n.terminal-cursor {\n  animation: terminal-blink 1s step-end infinite;\n}\n\n/* Data Stream Effect */\n@keyframes data-stream {\n  0% {\n    transform: translateY(-100%);\n    opacity: 0;\n  }\n  10% {\n    opacity: 1;\n  }\n  90% {\n    opacity: 1;\n  }\n  100% {\n    transform: translateY(100vh);\n    opacity: 0;\n  }\n}\n\n.data-stream {\n  animation: data-stream 3s linear infinite;\n}\n\n/* Perspective for 3D effects */\n.perspective-1000 {\n  perspective: 1000px;\n}\n\n/* Enhanced Cyber Grid */\n.cyber-grid-enhanced {\n  background-image: \n    linear-gradient(rgba(0, 255, 65, 0.05) 1px, transparent 1px),\n    linear-gradient(90deg, rgba(0, 255, 65, 0.05) 1px, transparent 1px),\n    radial-gradient(circle at 50% 50%, rgba(0, 255, 65, 0.02) 0%, transparent 50%);\n  background-size: 40px 40px, 40px 40px, 100% 100%;\n}\n\n/* Section Divider */\n.section-divider {\n  position: relative;\n  height: 2px;\n  background: linear-gradient(90deg, transparent, #00ff41, #00d4ff, #7c3aed, transparent);\n  opacity: 0.5;\n}\n\n/* Card Hover Effects */\n.card-hover-effect {\n  transition: all 0.3s ease;\n}\n\n.card-hover-effect:hover {\n  transform: translateY(-5px);\n  box-shadow: \n    0 10px 40px rgba(0, 255, 65, 0.1),\n    0 0 20px rgba(0, 255, 65, 0.05);\n}\n\n/* Skills Progress Bar */\n.skill-progress {\n  position: relative;\n  height: 8px;\n  background: rgba(0, 255, 65, 0.1);\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.skill-progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, #00ff41, #00d4ff);\n  border-radius: 4px;\n  position: relative;\n}\n\n.skill-progress-bar::after {\n  content: \"\";\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: linear-gradient(\n    90deg,\n    transparent,\n    rgba(255, 255, 255, 0.3),\n    transparent\n  );\n  animation: progress-shine 2s ease-in-out infinite;\n}\n\n@keyframes progress-shine {\n  0% {\n    transform: translateX(-100%);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n}\n\n/* Hexagon Shape */\n.hexagon {\n  clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);\n}\n\n/* Code Block Styling */\n.code-block {\n  background: rgba(0, 0, 0, 0.5);\n  border: 1px solid rgba(0, 255, 65, 0.2);\n  border-radius: 8px;\n  font-family: \"Space Grotesk\", monospace;\n}\n\n/* Typing Animation */\n@keyframes typing {\n  from {\n    width: 0;\n  }\n  to {\n    width: 100%;\n  }\n}\n\n.typing-animation {\n  overflow: hidden;\n  white-space: nowrap;\n  animation: typing 3s steps(40) forwards;\n}\n","path":null,"size_bytes":16646,"size_tokens":null},"client/src/pages/admin/Scheduler.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Clock, Plus, Play, Pause, Trash2, Calendar } from \"lucide-react\";\n\nexport default function AdminScheduler() {\n  const tasks = [\n    {\n      id: 1,\n      name: \"Daily Database Backup\",\n      schedule: \"0 2 * * *\",\n      nextRun: \"Tomorrow at 2:00 AM\",\n      lastRun: \"Today at 2:00 AM\",\n      status: \"active\",\n      type: \"backup\"\n    },\n    {\n      id: 2,\n      name: \"Weekly Newsletter\",\n      schedule: \"0 9 * * 1\",\n      nextRun: \"Monday at 9:00 AM\",\n      lastRun: \"Last Monday at 9:00 AM\",\n      status: \"active\",\n      type: \"email\"\n    },\n    {\n      id: 3,\n      name: \"Clear Cache\",\n      schedule: \"0 */6 * * *\",\n      nextRun: \"In 3 hours\",\n      lastRun: \"3 hours ago\",\n      status: \"paused\",\n      type: \"maintenance\"\n    }\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Scheduled Tasks</h1>\n            <p className=\"text-muted-foreground\">Manage automated tasks and cron jobs</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> New Task\n          </Button>\n        </div>\n\n        <div className=\"space-y-4\">\n          {tasks.map((task) => (\n            <Card key={task.id}>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <Clock className=\"w-5 h-5 text-primary\" />\n                      <h3 className=\"font-bold\">{task.name}</h3>\n                      <Badge variant={task.status === \"active\" ? \"default\" : \"secondary\"}>\n                        {task.status}\n                      </Badge>\n                      <Badge variant=\"outline\">{task.type}</Badge>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-3 gap-4 mt-4 text-sm\">\n                      <div>\n                        <p className=\"text-muted-foreground text-xs\">Schedule</p>\n                        <code className=\"font-mono\">{task.schedule}</code>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground text-xs\">Next Run</p>\n                        <p className=\"font-medium\">{task.nextRun}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground text-xs\">Last Run</p>\n                        <p className=\"font-medium\">{task.lastRun}</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\">\n                      {task.status === \"active\" ? (\n                        <Pause className=\"w-4 h-4\" />\n                      ) : (\n                        <Play className=\"w-4 h-4\" />\n                      )}\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"text-destructive\">\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":3662,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/pages/admin/Comments.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Search, \n  Trash, \n  GripVertical,\n  Edit,\n  Plus,\n  Star,\n  MessageSquare,\n  Loader2,\n  Eye,\n  HelpCircle,\n  Save,\n  X\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport type { Comment, Review, FAQ } from \"@shared/schema\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\n\nexport default function AdminComments() {\n  const [activeTab, setActiveTab] = useState(\"comments\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [faqDialogOpen, setFaqDialogOpen] = useState(false);\n  const [editingFaq, setEditingFaq] = useState<FAQ | null>(null);\n  const [faqForm, setFaqForm] = useState({ question: \"\", answer: \"\", visible: true, order: 0 });\n  const { toast } = useToast();\n\n  const { data: comments = [], isLoading: commentsLoading } = useQuery<Comment[]>({\n    queryKey: ['/api/comments']\n  });\n\n  const { data: reviews = [], isLoading: reviewsLoading } = useQuery<Review[]>({\n    queryKey: ['/api/reviews']\n  });\n\n  const { data: faqs = [], isLoading: faqsLoading } = useQuery<FAQ[]>({\n    queryKey: ['/api/faqs']\n  });\n\n  const { data: posts = [] } = useQuery<any[]>({\n    queryKey: ['/api/posts']\n  });\n\n  const { data: projects = [] } = useQuery<any[]>({\n    queryKey: ['/api/projects']\n  });\n\n  const deleteCommentMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/comments/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment deleted\" });\n    }\n  });\n\n  const markCommentAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/comments/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment marked as read\" });\n    }\n  });\n\n  const deleteReviewMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/reviews/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      toast({ title: \"Review deleted\" });\n    }\n  });\n\n  const markReviewAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/reviews/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      toast({ title: \"Review marked as read\" });\n    }\n  });\n\n  const createFaqMutation = useMutation({\n    mutationFn: async (data: { question: string; answer: string; visible: boolean; order: number }) => {\n      return apiRequest(\"POST\", \"/api/faqs\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ created successfully\" });\n      setFaqDialogOpen(false);\n      resetFaqForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error creating FAQ\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const updateFaqMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: Partial<FAQ> }) => {\n      return apiRequest(\"PUT\", `/api/faqs/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ updated successfully\" });\n      setFaqDialogOpen(false);\n      setEditingFaq(null);\n      resetFaqForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error updating FAQ\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const deleteFaqMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/faqs/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ deleted\" });\n    }\n  });\n\n  const resetFaqForm = () => {\n    setFaqForm({ question: \"\", answer: \"\", visible: true, order: faqs.length });\n    setEditingFaq(null);\n  };\n\n  const openFaqDialog = (faq?: FAQ) => {\n    if (faq) {\n      setEditingFaq(faq);\n      setFaqForm({\n        question: faq.question,\n        answer: faq.answer,\n        visible: faq.visible,\n        order: faq.order\n      });\n    } else {\n      resetFaqForm();\n      setFaqForm(prev => ({ ...prev, order: faqs.length }));\n    }\n    setFaqDialogOpen(true);\n  };\n\n  const handleFaqSubmit = () => {\n    if (!faqForm.question.trim() || !faqForm.answer.trim()) {\n      toast({ title: \"Please fill in all fields\", variant: \"destructive\" });\n      return;\n    }\n    \n    if (editingFaq) {\n      updateFaqMutation.mutate({ id: editingFaq.id, data: faqForm });\n    } else {\n      createFaqMutation.mutate(faqForm);\n    }\n  };\n\n  const getPostTitle = (postId: number | null) => {\n    if (!postId) return null;\n    const post = posts.find((p: any) => p.id === postId);\n    return post?.title || \"Unknown Post\";\n  };\n\n  const getProjectTitle = (projectId: number | null) => {\n    if (!projectId) return null;\n    const project = projects.find((p: any) => p.id === projectId);\n    return project?.title || \"Unknown Project\";\n  };\n\n  const filteredComments = comments.filter(comment => \n    comment.authorName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    comment.content.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const filteredReviews = reviews.filter(review =>\n    review.authorName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    review.content.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const filteredFaqs = faqs.filter(faq =>\n    faq.question.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    faq.answer.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'Approved': return 'border-l-green-500';\n      case 'Pending': return 'border-l-yellow-500';\n      case 'Spam': return 'border-l-red-500';\n      default: return 'border-l-gray-500';\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Interactions</h1>\n            <p className=\"text-muted-foreground\">Manage user comments, reviews, and FAQs</p>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"comments\" value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full max-w-md grid-cols-3\">\n            <TabsTrigger value=\"comments\" data-testid=\"tab-comments\">\n              Comments\n              {comments.filter(c => c.status === 'Pending').length > 0 && (\n                <Badge variant=\"destructive\" className=\"ml-2 h-5 w-5 p-0 flex items-center justify-center text-xs\">\n                  {comments.filter(c => c.status === 'Pending').length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"reviews\" data-testid=\"tab-reviews\">\n              Reviews\n              {reviews.filter(r => r.status === 'Pending').length > 0 && (\n                <Badge variant=\"destructive\" className=\"ml-2 h-5 w-5 p-0 flex items-center justify-center text-xs\">\n                  {reviews.filter(r => r.status === 'Pending').length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"faqs\" data-testid=\"tab-faqs\">\n              FAQs\n              <Badge variant=\"secondary\" className=\"ml-2\">{faqs.length}</Badge>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"comments\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search comments...\" \n                  className=\"pl-9\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-comments\"\n                />\n              </div>\n            </div>\n\n            {commentsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredComments.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <MessageSquare className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No comments yet</h3>\n                <p className=\"text-muted-foreground\">Comments will appear here when users leave them on your content.</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {filteredComments.map((comment) => (\n                  <Card key={comment.id} className={`border-l-4 ${getStatusColor(comment.status)}`} data-testid={`card-comment-${comment.id}`}>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex gap-4\">\n                          <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary\">\n                            {comment.authorName.charAt(0).toUpperCase()}\n                          </div>\n                          <div>\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <span className=\"font-semibold\">{comment.authorName}</span>\n                              <span className=\"text-xs text-muted-foreground\">\n                                {comment.createdAt && formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}\n                              </span>\n                              <Badge variant={comment.status === 'Approved' ? 'default' : comment.status === 'Pending' ? 'secondary' : 'destructive'} className=\"text-xs\">\n                                {comment.status}\n                              </Badge>\n                              {!comment.read && (\n                                <Badge variant=\"outline\" className=\"text-xs bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400\">New</Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm mt-1 text-foreground/90\">{comment.content}</p>\n                            <p className=\"text-xs text-primary mt-2\">\n                              On: {comment.postId ? getPostTitle(comment.postId) : getProjectTitle(comment.projectId)}\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-1\">\n                          {!comment.read && (\n                            <Button \n                              variant=\"ghost\" \n                              size=\"icon\" \n                              className=\"text-primary\"\n                              onClick={() => markCommentAsReadMutation.mutate(comment.id)}\n                              disabled={markCommentAsReadMutation.isPending}\n                              title=\"Mark as read\"\n                              data-testid={`button-read-comment-${comment.id}`}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteCommentMutation.mutate(comment.id)}\n                            disabled={deleteCommentMutation.isPending}\n                            data-testid={`button-delete-comment-${comment.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"reviews\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search reviews...\" \n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-reviews\"\n                />\n              </div>\n            </div>\n\n            {reviewsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredReviews.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Star className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No reviews yet</h3>\n                <p className=\"text-muted-foreground\">Reviews will appear here when users rate your projects.</p>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredReviews.map((review) => (\n                  <Card key={review.id} className={`border-l-4 ${getStatusColor(review.status)}`} data-testid={`card-review-${review.id}`}>\n                    <CardHeader className=\"flex flex-row items-start justify-between gap-4 pb-2\">\n                      <div>\n                        <CardTitle className=\"text-lg flex items-center gap-2\">\n                          {review.authorName}\n                          {!review.read && (\n                            <Badge variant=\"outline\" className=\"text-xs bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400\">New</Badge>\n                          )}\n                        </CardTitle>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Project: {getProjectTitle(review.projectId)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {review.createdAt && formatDistanceToNow(new Date(review.createdAt), { addSuffix: true })}\n                        </p>\n                      </div>\n                      <div className=\"flex\">\n                        {[1, 2, 3, 4, 5].map(s => (\n                          <Star \n                            key={s} \n                            className={`w-4 h-4 ${s <= review.rating ? 'text-yellow-500 fill-yellow-500' : 'text-gray-300'}`} \n                          />\n                        ))}\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm italic\">\"{review.content}\"</p>\n                      <div className=\"flex justify-between items-center gap-2 mt-4\">\n                        <Badge variant=\"default\">\n                          {review.status}\n                        </Badge>\n                        <div className=\"flex gap-1\">\n                          {!review.read && (\n                            <Button \n                              variant=\"ghost\" \n                              size=\"icon\" \n                              className=\"text-primary\"\n                              onClick={() => markReviewAsReadMutation.mutate(review.id)}\n                              disabled={markReviewAsReadMutation.isPending}\n                              title=\"Mark as read\"\n                              data-testid={`button-read-review-${review.id}`}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteReviewMutation.mutate(review.id)}\n                            disabled={deleteReviewMutation.isPending}\n                            data-testid={`button-delete-review-${review.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"faqs\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4 flex-wrap\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search FAQs...\" \n                  className=\"pl-9\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-faqs\" \n                />\n              </div>\n              <Button onClick={() => openFaqDialog()} data-testid=\"button-add-faq\">\n                <Plus className=\"w-4 h-4 mr-2\" /> Add Question\n              </Button>\n            </div>\n            \n            {faqsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredFaqs.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <HelpCircle className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No FAQs yet</h3>\n                <p className=\"text-muted-foreground\">Add frequently asked questions to help your visitors.</p>\n                <Button onClick={() => openFaqDialog()} className=\"mt-4\">\n                  <Plus className=\"w-4 h-4 mr-2\" /> Add Your First FAQ\n                </Button>\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {filteredFaqs.map((faq) => (\n                  <div \n                    key={faq.id} \n                    className={`flex items-center gap-4 p-4 bg-card border border-border rounded-lg group ${!faq.visible ? 'opacity-60' : ''}`} \n                    data-testid={`card-faq-${faq.id}`}\n                  >\n                    <div className=\"cursor-grab text-muted-foreground hover:text-foreground\">\n                      <GripVertical className=\"w-5 h-5\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <h4 className=\"font-semibold\">{faq.question}</h4>\n                        {!faq.visible && (\n                          <Badge variant=\"outline\" className=\"text-xs\">Hidden</Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground line-clamp-2\">{faq.answer}</p>\n                    </div>\n                    <div className=\"invisible group-hover:visible flex gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        onClick={() => openFaqDialog(faq)}\n                        data-testid={`button-edit-faq-${faq.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"text-destructive\"\n                        onClick={() => deleteFaqMutation.mutate(faq.id)}\n                        disabled={deleteFaqMutation.isPending}\n                        data-testid={`button-delete-faq-${faq.id}`}\n                      >\n                        <Trash className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={faqDialogOpen} onOpenChange={setFaqDialogOpen}>\n        <DialogContent className=\"sm:max-w-[500px]\">\n          <DialogHeader>\n            <DialogTitle>{editingFaq ? \"Edit FAQ\" : \"Add New FAQ\"}</DialogTitle>\n            <DialogDescription>\n              {editingFaq ? \"Update this frequently asked question.\" : \"Add a new frequently asked question to help your visitors.\"}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"question\">Question</Label>\n              <Input\n                id=\"question\"\n                placeholder=\"e.g., What technologies do you specialize in?\"\n                value={faqForm.question}\n                onChange={(e) => setFaqForm({ ...faqForm, question: e.target.value })}\n                data-testid=\"input-faq-question\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"answer\">Answer</Label>\n              <Textarea\n                id=\"answer\"\n                placeholder=\"Provide a helpful answer...\"\n                rows={4}\n                value={faqForm.answer}\n                onChange={(e) => setFaqForm({ ...faqForm, answer: e.target.value })}\n                data-testid=\"input-faq-answer\"\n              />\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"visible\"\n                  checked={faqForm.visible}\n                  onCheckedChange={(checked) => setFaqForm({ ...faqForm, visible: checked })}\n                  data-testid=\"switch-faq-visible\"\n                />\n                <Label htmlFor=\"visible\">Visible on website</Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Label htmlFor=\"order\" className=\"text-sm\">Order:</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  className=\"w-20\"\n                  min=\"0\"\n                  value={faqForm.order}\n                  onChange={(e) => setFaqForm({ ...faqForm, order: parseInt(e.target.value) || 0 })}\n                  data-testid=\"input-faq-order\"\n                />\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setFaqDialogOpen(false)}>\n              <X className=\"w-4 h-4 mr-2\" /> Cancel\n            </Button>\n            <Button \n              onClick={handleFaqSubmit}\n              disabled={createFaqMutation.isPending || updateFaqMutation.isPending}\n              data-testid=\"button-save-faq\"\n            >\n              {(createFaqMutation.isPending || updateFaqMutation.isPending) ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4 mr-2\" />\n              )}\n              {editingFaq ? \"Update\" : \"Save\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":24575,"size_tokens":null},"client/src/components/sections/Projects.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ExternalLink, Github, Plus } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { useMockData } from \"@/context/MockContext\";\nimport { api } from \"@/lib/api\";\nimport { ReviewSection } from \"@/components/sections/ReviewSection\";\n\nconst useSafeMockData = () => {\n  try {\n    return useMockData();\n  } catch (e) {\n    return { projects: [] };\n  }\n};\n\nexport function Projects() {\n  const [filter, setFilter] = useState(\"all\");\n  const [categories, setCategories] = useState<Array<{ id: string; label: string }>>([\n    { id: \"all\", label: \"All\" }\n  ]);\n  const mockData = useSafeMockData();\n  const allProjects = mockData?.projects || [];\n  const [selectedProject, setSelectedProject] = useState<any | null>(null);\n\n  useEffect(() => {\n    const loadCategories = async () => {\n      try {\n        const cats = await api.getCategories(\"project\");\n        setCategories([\n          { id: \"all\", label: \"All\" },\n          ...cats.map((cat: any) => ({ id: cat.slug, label: cat.name }))\n        ]);\n      } catch (error) {\n        console.error(\"Failed to load categories:\", error);\n      }\n    };\n    loadCategories();\n  }, []);\n\n  const featuredProjects = allProjects\n    .filter(p => p.status === \"Published\" && p.featured === true)\n    .slice(0, 6);\n\n  const filteredProjects = featuredProjects.filter(\n    (p) => {\n      if (filter === \"all\") return true;\n      return p.category.toLowerCase().includes(filter.toLowerCase()) || filter.toLowerCase().includes(p.category.toLowerCase());\n    }\n  );\n\n  return (\n    <section id=\"projects\" className=\"py-24 bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex flex-col items-center mb-12\">\n          <h2 className=\"text-3xl md:text-4xl font-heading font-bold text-center mb-4\">\n            Featured <span className=\"text-primary\">Projects</span>\n          </h2>\n          <div className=\"w-20 h-1 bg-primary rounded-full mb-8\" />\n          \n          {/* Filters */}\n          <div className=\"flex flex-wrap justify-center gap-2 md:gap-4\">\n            {categories.map((cat) => (\n              <button\n                key={cat.id}\n                onClick={() => setFilter(cat.id)}\n                className={`px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 ${\n                  filter === cat.id\n                    ? \"bg-primary text-white shadow-lg shadow-primary/25\"\n                    : \"bg-muted text-muted-foreground hover:bg-muted/80\"\n                }`}\n              >\n                {cat.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Grid */}\n        <motion.div \n          layout\n          className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\"\n        >\n          <AnimatePresence>\n            {filteredProjects.map((project) => (\n              <motion.div\n                layout\n                key={project.id}\n                initial={{ opacity: 0, scale: 0.9 }}\n                animate={{ opacity: 1, scale: 1 }}\n                exit={{ opacity: 0, scale: 0.9 }}\n                transition={{ duration: 0.3 }}\n                className=\"group relative rounded-xl overflow-hidden bg-card border border-border shadow-md hover:shadow-xl transition-all duration-300\"\n              >\n                {/* Image */}\n                <div className=\"aspect-video overflow-hidden bg-muted\">\n                  <img\n                    src={project.image || '/placeholder.jpg'}\n                    alt={project.title}\n                    className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\n                  />\n                </div>\n\n                {/* Overlay */}\n                <div className=\"absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center p-6 text-center backdrop-blur-sm\">\n                  <h3 className=\"text-xl font-bold text-white mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-75\">\n                    {project.title}\n                  </h3>\n                  <p className=\"text-white/70 text-sm mb-4 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-100\">\n                    {project.shortDescription || project.description}\n                  </p>\n                  <div className=\"flex flex-wrap gap-2 justify-center mb-6 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-150\">\n                    {project.tech.map((t: string) => (\n                      <span key={t} className=\"text-xs px-2 py-1 bg-white/10 text-white rounded\">\n                        {t}\n                      </span>\n                    ))}\n                  </div>\n                  \n                  <div className=\"flex gap-3 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-200\">\n                    <Button size=\"icon\" variant=\"outline\" className=\"rounded-full border-white/20 text-white hover:bg-white hover:text-black transition-colors\" onClick={() => setSelectedProject(project)}>\n                       <Plus size={20} />\n                    </Button>\n                    <Button size=\"icon\" variant=\"outline\" className=\"rounded-full border-white/20 text-white hover:bg-white hover:text-black transition-colors\">\n                       <ExternalLink size={20} />\n                    </Button>\n                    <Button size=\"icon\" variant=\"outline\" className=\"rounded-full border-white/20 text-white hover:bg-white hover:text-black transition-colors\">\n                       <Github size={20} />\n                    </Button>\n                  </div>\n                </div>\n              </motion.div>\n            ))}\n          </AnimatePresence>\n        </motion.div>\n\n        {/* Details Modal */}\n        <Dialog open={!!selectedProject} onOpenChange={() => setSelectedProject(null)}>\n          <DialogContent className=\"max-w-3xl max-h-[90vh] p-0\">\n            <ScrollArea className=\"max-h-[85vh]\">\n              <div className=\"p-6\">\n                <DialogHeader>\n                  <DialogTitle>{selectedProject?.title}</DialogTitle>\n                  <DialogDescription>{selectedProject?.description}</DialogDescription>\n                </DialogHeader>\n                {selectedProject && (\n                  <div className=\"space-y-6 mt-4\">\n                    <div className=\"aspect-video rounded-lg overflow-hidden bg-muted\">\n                      <img src={selectedProject.image} alt={selectedProject.title} className=\"w-full h-full object-cover\" />\n                    </div>\n                    <div className=\"grid md:grid-cols-2 gap-6\">\n                      <div>\n                        <h4 className=\"font-bold mb-2\">Challenge & Solution</h4>\n                        <p className=\"text-muted-foreground text-sm\">\n                          {selectedProject.description || \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\"}\n                        </p>\n                      </div>\n                      <div>\n                        <h4 className=\"font-bold mb-2\">Technologies</h4>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {selectedProject.tech.map((t: string) => (\n                            <span key={t} className=\"px-2 py-1 bg-primary/10 text-primary rounded text-sm\">\n                              {t}\n                            </span>\n                          ))}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    <ReviewSection projectId={selectedProject.id} title=\"Project Reviews\" />\n                    \n                    <div className=\"flex justify-end gap-4\">\n                      <Button variant=\"outline\" onClick={() => setSelectedProject(null)}>Close</Button>\n                      <Button>View Live Project</Button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </ScrollArea>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":8488,"size_tokens":null},"client/src/pages/admin/SettingsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Save,\n  Upload,\n  Mail,\n  Database,\n  Zap,\n  Key,\n  Plug,\n  Bell,\n  Code2,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  Globe,\n  DollarSign,\n  Hash,\n  Languages,\n  HardDrive,\n  RefreshCw,\n  Download,\n  Trash2,\n  Terminal,\n  Bug,\n  Gauge,\n  Server,\n  X,\n  ImageIcon,\n  Eye,\n  EyeOff,\n  Loader2,\n} from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { SettingsPerformance } from \"./SettingsPerformance\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { StorageTab } from \"@/components/admin/StorageTab\";\nimport { DatabaseTab } from \"@/components/admin/DatabaseTab\";\nimport { LoggingTab } from \"@/components/admin/LoggingTab\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\ninterface EmailTemplate {\n  subject: string;\n  body: string;\n}\n\nexport default function AdminSettingsEnhanced() {\n  const [logoFile, setLogoFile] = useState<string | null>(null);\n  const [profileImageUploading, setProfileImageUploading] = useState(false);\n  const [cvFileUploading, setCVFileUploading] = useState(false);\n  const [brandingUploading, setBrandingUploading] = useState(false);\n  const [showSmtpPassword, setShowSmtpPassword] = useState(false);\n  const [editingTemplate, setEditingTemplate] = useState<string | null>(null);\n  const [templateSubject, setTemplateSubject] = useState(\"\");\n  const [templateBody, setTemplateBody] = useState(\"\");\n  const profileImageInputRef = useRef<HTMLInputElement>(null);\n  const cvFileInputRef = useRef<HTMLInputElement>(null);\n  const { settings, updateSettings, saveSettings, isSaving } =\n    useSiteSettings();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch email templates with TanStack Query\n  const { data: emailTemplates = {}, isLoading: templatesLoading } = useQuery({\n    queryKey: ['/api/email/templates'],\n    queryFn: () => api.getEmailTemplates()\n  });\n\n  // Mutation for updating email templates\n  const updateTemplateMutation = useMutation({\n    mutationFn: ({ name, data }: { name: string; data: { subject: string; body: string } }) =>\n      api.updateEmailTemplate(name, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/email/templates'] });\n      toast({ title: \"Success\", description: \"Email template saved successfully\" });\n      setEditingTemplate(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const openTemplateEditor = (templateName: string) => {\n    const template = emailTemplates[templateName];\n    if (template) {\n      setTemplateSubject(template.subject);\n      setTemplateBody(template.body);\n    } else {\n      setTemplateSubject(\"\");\n      setTemplateBody(\"\");\n    }\n    setEditingTemplate(templateName);\n  };\n\n  const saveTemplate = () => {\n    if (!editingTemplate) return;\n    updateTemplateMutation.mutate({\n      name: editingTemplate,\n      data: { subject: templateSubject, body: templateBody }\n    });\n  };\n\n  const templateLabels: Record<string, string> = {\n    welcome: \"Welcome Email\",\n    notification: \"Notification Email\",\n    newsletter: \"Newsletter Template\",\n    contact: \"Contact Form Email\",\n    comment: \"Comment Notification\"\n  };\n\n  const handleBrandingUpload = async (\n    file: File,\n    settingKey: \"logoUrl\" | \"faviconUrl\"\n  ) => {\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setBrandingUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n\n      const response = await fetch(\"/api/storage/upload\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(errorText || \"Upload failed\");\n      }\n\n      const data = await response.json();\n      updateSettings({ [settingKey]: data.url });\n      toast({\n        title: \"Success\",\n        description: \"Image uploaded successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setBrandingUploading(false);\n    }\n  };\n\n  const handleProfileImageUpload = async (\n    e: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_IMAGE_SIZE = 5 * 1024 * 1024; // 5MB\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_IMAGE_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 5MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setProfileImageUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ aboutImage: base64 });\n        toast({ title: \"Success\", description: `Image uploaded successfully (${(file.size / 1024).toFixed(2)}KB)` });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setProfileImageUploading(false);\n    }\n  };\n\n  const handleCVFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_PDF_SIZE = 10 * 1024 * 1024; // 10MB\n    if (file.type !== \"application/pdf\") {\n      toast({\n        title: \"Error\",\n        description: \"Please select a PDF file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_PDF_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 10MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setCVFileUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ cvFileUrl: base64 });\n        toast({\n          title: \"Success\",\n          description: `CV file uploaded successfully (${(file.size / 1024).toFixed(2)}KB)`,\n        });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload CV file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setCVFileUploading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    console.log(\"handleSave called with current settings:\", settings);\n    const result = await saveSettings();\n    console.log(\"Save result:\", result);\n    if (result?.success) {\n      toast({ \n        title: \"ThÃ nh cÃ´ng âœ“\", \n        description: \"CÃ i Ä‘áº·t Ä‘Æ°á»£c lÆ°u thÃ nh cÃ´ng\" \n      });\n    } else {\n      toast({\n        title: \"Lá»—i\",\n        description: result?.error || \"KhÃ´ng thá»ƒ lÆ°u cÃ i Ä‘áº·t\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Settings</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your website configuration\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary hover:bg-primary/90\"\n            onClick={handleSave}\n            disabled={isSaving}\n          >\n            {isSaving ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              <>\n                <Save className=\"w-4 h-4 mr-2\" />\n                Save Changes\n              </>\n            )}\n          </Button>\n        </div>\n\n        <Tabs defaultValue=\"general\" className=\"space-y-6\">\n          <div className=\"w-full overflow-x-auto\">\n            <TabsList className=\"inline-flex gap-1 h-auto p-1 min-w-full\">\n              <TabsTrigger value=\"general\">General</TabsTrigger>\n              <TabsTrigger value=\"branding\">Branding</TabsTrigger>\n              <TabsTrigger value=\"seo\">SEO</TabsTrigger>\n              <TabsTrigger value=\"email\">Email</TabsTrigger>\n              <TabsTrigger value=\"storage\">Storage</TabsTrigger>\n              <TabsTrigger value=\"performance\">Performance</TabsTrigger>\n              <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\n              <TabsTrigger value=\"developer\">Developer</TabsTrigger>\n              <TabsTrigger value=\"localization\">Localization</TabsTrigger>\n              <TabsTrigger value=\"database\">Database</TabsTrigger>\n              <TabsTrigger value=\"logging\">Logging</TabsTrigger>\n            </TabsList>\n          </div>\n\n          {/* GENERAL TAB */}\n          <TabsContent value=\"general\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Site Information</CardTitle>\n                <CardDescription>\n                  Basic information about your portfolio website.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Site Title (Homepage & Admin)</Label>\n                  <Input\n                    value={settings.siteTitle}\n                    onChange={(e) =>\n                      updateSettings({ siteTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Loi Developer - Full-stack Creative\"\n                    data-testid=\"input-site-title\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Appears in browser tab and header\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Tagline</Label>\n                  <Input\n                    value={settings.tagline}\n                    onChange={(e) =>\n                      updateSettings({ tagline: e.target.value })\n                    }\n                    placeholder=\"e.g., Building digital experiences with code.\"\n                    data-testid=\"input-tagline\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle>Hero Section</CardTitle>\n                <CardDescription>\n                  Main heading and call-to-action on homepage.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Hero Title</Label>\n                  <Input\n                    value={settings.heroTitle}\n                    onChange={(e) =>\n                      updateSettings({ heroTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Hello, I'm Loi Developer\"\n                    data-testid=\"input-hero-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Hero Subtitle</Label>\n                  <Textarea\n                    value={settings.heroSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ heroSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer | UI/UX Enthusiast\"\n                    rows={2}\n                    data-testid=\"input-hero-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>View Projects CTA Button Text</Label>\n                  <Input\n                    value={settings.heroCTA}\n                    onChange={(e) =>\n                      updateSettings({ heroCTA: e.target.value })\n                    }\n                    placeholder=\"e.g., View My Work\"\n                    data-testid=\"input-hero-cta\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label className=\"text-base font-semibold\">\n                    CV File Management\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Upload a PDF or paste a link for your CV Download button\n                  </p>\n                  {settings.cvFileUrl && (\n                    <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-muted/50\">\n                      <div className=\"flex items-center gap-2 min-w-0\">\n                        <FileText className=\"w-4 h-4 flex-shrink-0 text-primary\" />\n                        <span\n                          className=\"text-sm font-medium truncate\"\n                          data-testid=\"text-cv-file-name\"\n                        >\n                          {settings.cvFileUrl.startsWith(\"data:\")\n                            ? \"CV.pdf\"\n                            : settings.cvFileUrl.split(\"/\").pop() || \"CV file\"}\n                        </span>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => updateSettings({ cvFileUrl: \"\" })}\n                        data-testid=\"button-remove-cv\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  )}\n                  {!settings.cvFileUrl && (\n                    <div className=\"border-2 border-dashed rounded-lg p-4 text-center hover:bg-muted/50 transition-colors\">\n                      <FileText className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                      <p className=\"text-sm text-muted-foreground mb-3\">\n                        No CV uploaded\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mb-2\">\n                        Upload from device or paste a PDF link\n                      </p>\n                    </div>\n                  )}\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => cvFileInputRef.current?.click()}\n                      disabled={cvFileUploading}\n                      data-testid=\"button-upload-cv\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />{\" \"}\n                      {cvFileUploading ? \"Uploading...\" : \"Upload PDF\"}\n                    </Button>\n                    <input\n                      ref={cvFileInputRef}\n                      type=\"file\"\n                      accept=\".pdf,application/pdf\"\n                      onChange={handleCVFileUpload}\n                      className=\"hidden\"\n                      data-testid=\"input-cv-file-upload\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or Paste PDF URL</Label>\n                    <Input\n                      value={settings.cvFileUrl}\n                      onChange={(e) =>\n                        updateSettings({ cvFileUrl: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/CV.pdf or /uploads/CV.pdf\"\n                      data-testid=\"input-cv-file-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Paste a direct link to your CV PDF file\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>About Me Section</CardTitle>\n                <CardDescription>\n                  Complete information about yourself with professional\n                  formatting.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.aboutTitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., About Me\"\n                    data-testid=\"input-about-title\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Profile Image</Label>\n                  <div className=\"flex flex-col gap-3\">\n                    {settings.aboutImage && (\n                      <div className=\"relative w-full max-w-xs\">\n                        <img\n                          src={settings.aboutImage}\n                          alt=\"Profile preview\"\n                          className=\"w-full h-64 object-cover rounded-lg border border-border\"\n                        />\n                        <Button\n                          size=\"icon\"\n                          variant=\"destructive\"\n                          className=\"absolute top-2 right-2\"\n                          onClick={() => updateSettings({ aboutImage: \"\" })}\n                          data-testid=\"button-remove-profile-image\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    )}\n                    {!settings.aboutImage && (\n                      <div className=\"border-2 border-dashed rounded-lg p-8 text-center hover:bg-muted/50 transition-colors\">\n                        <ImageIcon className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                        <p className=\"text-sm text-muted-foreground mb-3\">\n                          No image selected\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => profileImageInputRef.current?.click()}\n                      disabled={profileImageUploading}\n                      data-testid=\"button-upload-profile-image\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />\n                      Upload Image\n                    </Button>\n                    <input\n                      ref={profileImageInputRef}\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      onChange={handleProfileImageUpload}\n                      data-testid=\"input-profile-image-file\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or paste image URL</Label>\n                    <Input\n                      value={settings.aboutImage}\n                      onChange={(e) =>\n                        updateSettings({ aboutImage: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/image.jpg or /uploads/profile.jpg\"\n                      data-testid=\"input-about-image-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Supports any image format (JPG, PNG, GIF, WebP, etc.)\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Your Name</Label>\n                  <Input\n                    value={settings.aboutName}\n                    onChange={(e) =>\n                      updateSettings({ aboutName: e.target.value })\n                    }\n                    placeholder=\"e.g., Nguyen Thanh Loi\"\n                    data-testid=\"input-about-name\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From (Location)</Label>\n                    <Input\n                      value={settings.aboutLocation}\n                      onChange={(e) =>\n                        updateSettings({ aboutLocation: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City\"\n                      data-testid=\"input-about-location\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Freelance Status</Label>\n                    <Input\n                      value={settings.aboutFreelance}\n                      onChange={(e) =>\n                        updateSettings({ aboutFreelance: e.target.value })\n                      }\n                      placeholder=\"e.g., Available\"\n                      data-testid=\"input-about-freelance\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Subtitle</Label>\n                  <Input\n                    value={settings.aboutSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer based in Vietnam\"\n                    data-testid=\"input-about-subtitle\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>First Paragraph (Description)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use the rich text editor to format your content with\n                    headings, lists, links, and more.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription: value })\n                    }\n                    placeholder=\"Write your first paragraph about yourself...\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Second Paragraph (Philosophy/Additional Info)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Add your philosophy or additional information in the second\n                    paragraph.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription2}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription2: value })\n                    }\n                    placeholder=\"Write your philosophy or additional information...\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Contact Section</CardTitle>\n                <CardDescription>\n                  Contact form and information display.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.contactTitle}\n                    onChange={(e) =>\n                      updateSettings({ contactTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Let's Talk\"\n                    data-testid=\"input-contact-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Section Subtitle</Label>\n                  <Textarea\n                    value={settings.contactSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ contactSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Have a project in mind?\"\n                    rows={2}\n                    data-testid=\"input-contact-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Contact Email</Label>\n                  <Input\n                    type=\"email\"\n                    value={settings.contactEmail}\n                    onChange={(e) =>\n                      updateSettings({ contactEmail: e.target.value })\n                    }\n                    placeholder=\"e.g., hello@example.com\"\n                    data-testid=\"input-contact-email\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    This email is used in both About and Contact sections\n                  </p>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Phone Number</Label>\n                    <Input\n                      value={settings.contactPhone}\n                      onChange={(e) =>\n                        updateSettings({ contactPhone: e.target.value })\n                      }\n                      placeholder=\"e.g., +84 123 456 789\"\n                      data-testid=\"input-contact-phone\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Address</Label>\n                    <Input\n                      value={settings.contactAddress}\n                      onChange={(e) =>\n                        updateSettings({ contactAddress: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City, Vietnam\"\n                      data-testid=\"input-contact-address\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Social Media Links (Follow Me)</CardTitle>\n                <CardDescription>\n                  Add your social media profiles.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"space-y-2\">\n                  <Label>Facebook URL</Label>\n                  <Input\n                    value={settings.socialFacebook}\n                    onChange={(e) =>\n                      updateSettings({ socialFacebook: e.target.value })\n                    }\n                    placeholder=\"https://facebook.com/username\"\n                    data-testid=\"input-social-facebook\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter/X URL</Label>\n                  <Input\n                    value={settings.socialTwitter}\n                    onChange={(e) =>\n                      updateSettings({ socialTwitter: e.target.value })\n                    }\n                    placeholder=\"https://twitter.com/username\"\n                    data-testid=\"input-social-twitter\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Instagram URL</Label>\n                  <Input\n                    value={settings.socialInstagram}\n                    onChange={(e) =>\n                      updateSettings({ socialInstagram: e.target.value })\n                    }\n                    placeholder=\"https://instagram.com/username\"\n                    data-testid=\"input-social-instagram\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>LinkedIn URL</Label>\n                  <Input\n                    value={settings.socialLinkedin}\n                    onChange={(e) =>\n                      updateSettings({ socialLinkedin: e.target.value })\n                    }\n                    placeholder=\"https://linkedin.com/in/username\"\n                    data-testid=\"input-social-linkedin\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>GitHub URL</Label>\n                  <Input\n                    value={settings.socialGithub}\n                    onChange={(e) =>\n                      updateSettings({ socialGithub: e.target.value })\n                    }\n                    placeholder=\"https://github.com/username\"\n                    data-testid=\"input-social-github\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>YouTube URL</Label>\n                  <Input\n                    value={settings.socialYoutube}\n                    onChange={(e) =>\n                      updateSettings({ socialYoutube: e.target.value })\n                    }\n                    placeholder=\"https://youtube.com/@username\"\n                    data-testid=\"input-social-youtube\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Footer</CardTitle>\n                <CardDescription>\n                  Footer content and copyright information.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Footer Text</Label>\n                  <Input\n                    value={settings.footerText}\n                    onChange={(e) =>\n                      updateSettings({ footerText: e.target.value })\n                    }\n                    placeholder=\"e.g., Crafted with love & countless cups of coffee\"\n                    data-testid=\"input-footer-text\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Copyright Notice</Label>\n                  <Input\n                    value={settings.footerCopyright}\n                    onChange={(e) =>\n                      updateSettings({ footerCopyright: e.target.value })\n                    }\n                    placeholder=\"e.g., 2024 Loi Developer. All rights reserved.\"\n                    data-testid=\"input-footer-copyright\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Maintenance Mode</CardTitle>\n                <CardDescription>\n                  Temporarily disable access to the public site.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex items-center justify-between\">\n                <div className=\"space-y-0.5\">\n                  <Label>Enable Maintenance Mode</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Visitors will see a \"Coming Soon\" page.\n                  </p>\n                </div>\n                <Switch\n                  checked={settings.maintenanceMode}\n                  onCheckedChange={(checked) =>\n                    updateSettings({ maintenanceMode: checked })\n                  }\n                  data-testid=\"toggle-maintenance-mode\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* BRANDING TAB */}\n          <TabsContent value=\"branding\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Logo & Favicon</CardTitle>\n                <CardDescription>\n                  Upload your site logo and favicon from the uploads folder.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"logo-upload\">Site Logo</Label>\n                  <div\n                    className=\"border-2 border-dashed rounded-lg p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-accent/50 transition\"\n                    onClick={() => {\n                      const input = document.getElementById(\"logo-upload\") as HTMLInputElement;\n                      input?.click();\n                    }}\n                  >\n                    <input\n                      id=\"logo-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"logoUrl\");\n                        }\n                      }}\n                      data-testid=\"input-logo-upload\"\n                    />\n                    {settings.logoUrl ? (\n                      <div className=\"flex flex-col items-center gap-2\">\n                        <img\n                          src={settings.logoUrl}\n                          alt=\"Logo\"\n                          className=\"h-12 w-auto\"\n                        />\n                        <p className=\"text-xs text-muted-foreground\">\n                          {brandingUploading ? \"Uploading...\" : \"Click to replace\"}\n                        </p>\n                      </div>\n                    ) : (\n                      <>\n                        <Upload className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                        <p className=\"text-sm font-medium\">\n                          Drop image or click to upload\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          PNG, SVG, JPG (Max 2MB)\n                        </p>\n                      </>\n                    )}\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"favicon-upload\">Favicon</Label>\n                  <div className=\"flex gap-2\">\n                    <div className=\"w-16 h-16 rounded-lg border border-border flex items-center justify-center bg-muted overflow-hidden\">\n                      {settings.faviconUrl ? (\n                        <img\n                          src={settings.faviconUrl}\n                          alt=\"Favicon\"\n                          className=\"w-full h-full object-cover\"\n                        />\n                      ) : (\n                        <span className=\"text-2xl\">âœ¨</span>\n                      )}\n                    </div>\n                    <input\n                      id=\"favicon-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"faviconUrl\");\n                        }\n                      }}\n                      data-testid=\"input-favicon-upload\"\n                    />\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      disabled={brandingUploading}\n                      onClick={() => {\n                        const input = document.getElementById(\"favicon-upload\") as HTMLInputElement;\n                        input?.click();\n                      }}\n                    >\n                      {brandingUploading\n                        ? \"Uploading...\"\n                        : settings.faviconUrl\n                          ? \"Change Favicon\"\n                          : \"Upload Favicon\"}\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SEO TAB */}\n          <TabsContent value=\"seo\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>SEO Configuration</CardTitle>\n                <CardDescription>\n                  Optimize your site for search engines.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Meta Description (Default)</Label>\n                  <Input\n                    placeholder=\"Describe your website...\"\n                    value={settings.metaDescription || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaDescription: e.target.value })\n                    }\n                    data-testid=\"input-meta-description\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Keywords</Label>\n                  <Input\n                    placeholder=\"web development, full-stack, react, node.js\"\n                    value={settings.metaKeywords || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaKeywords: e.target.value })\n                    }\n                    data-testid=\"input-meta-keywords\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Google Analytics ID</Label>\n                  <Input\n                    placeholder=\"G-XXXXXXXXXX or UA-XXXXXXXXX-X\"\n                    value={settings.googleAnalyticsId || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ googleAnalyticsId: e.target.value })\n                    }\n                    data-testid=\"input-google-analytics\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Open Graph & Twitter Cards</CardTitle>\n                <CardDescription>\n                  Control how your site appears on social media.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Open Graph Image URL</Label>\n                  <Input\n                    placeholder=\"https://example.com/og-image.png\"\n                    value={settings.ogImageUrl || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ ogImageUrl: e.target.value })\n                    }\n                    data-testid=\"input-og-image\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter Card Type</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.twitterCardType || \"summary_large_image\"}\n                    onChange={(e) =>\n                      updateSettings({ twitterCardType: e.target.value })\n                    }\n                    data-testid=\"select-twitter-card\"\n                  >\n                    <option value=\"summary_large_image\">\n                      summary_large_image\n                    </option>\n                    <option value=\"summary\">summary</option>\n                    <option value=\"app\">app</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Robots.txt & Sitemap</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-edit-robots\"\n                >\n                  Edit robots.txt\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-regenerate-sitemap\"\n                >\n                  Regenerate Sitemap\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* EMAIL TAB */}\n          <TabsContent value=\"email\" className=\"space-y-4\">\n            <Card className=\"border-amber-500/20 bg-amber-500/5\">\n              <CardContent className=\"flex items-center gap-3 py-3\">\n                <AlertCircle className=\"w-5 h-5 text-amber-500\" />\n                <div>\n                  <p className=\"text-sm font-medium\">Configuration Required</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    SMTP settings are saved but email sending requires a mail\n                    server integration.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> SMTP Configuration\n                </CardTitle>\n                <CardDescription>\n                  Configure email settings for notifications and newsletters.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From Name</Label>\n                    <Input\n                      placeholder=\"Loi Developer\"\n                      value={settings.emailFromName || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromName: e.target.value })\n                      }\n                      data-testid=\"input-email-from-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>From Email Address</Label>\n                    <Input\n                      placeholder=\"noreply@example.com\"\n                      value={settings.emailFromAddress || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromAddress: e.target.value })\n                      }\n                      data-testid=\"input-email-from-address\"\n                    />\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-2\">\n                  <Label>SMTP Host</Label>\n                  <Input\n                    placeholder=\"smtp.gmail.com\"\n                    value={settings.smtpHost || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ smtpHost: e.target.value })\n                    }\n                    data-testid=\"input-smtp-host\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>SMTP Port</Label>\n                    <Input\n                      placeholder=\"587\"\n                      value={settings.smtpPort || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPort: e.target.value })\n                      }\n                      data-testid=\"input-smtp-port\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>SMTP User</Label>\n                    <Input\n                      placeholder=\"your-email@gmail.com\"\n                      value={settings.smtpUser || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpUser: e.target.value })\n                      }\n                      data-testid=\"input-smtp-user\"\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>SMTP Password</Label>\n                  <div className=\"flex gap-2\">\n                    <Input\n                      type={showSmtpPassword ? \"text\" : \"password\"}\n                      placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                      value={settings.smtpPassword || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPassword: e.target.value })\n                      }\n                      data-testid=\"input-smtp-password\"\n                    />\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      onClick={() => setShowSmtpPassword(!showSmtpPassword)}\n                      data-testid=\"button-toggle-smtp-password\"\n                    >\n                      {showSmtpPassword ? (\n                        <EyeOff className=\"w-4 h-4\" />\n                      ) : (\n                        <Eye className=\"w-4 h-4\" />\n                      )}\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Use TLS/SSL</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Encrypt email transmission\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.smtpSecure ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ smtpSecure: checked })\n                    }\n                    data-testid=\"switch-smtp-secure\"\n                  />\n                </div>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  data-testid=\"button-test-email\"\n                  onClick={async () => {\n                    try {\n                      const testEmail = prompt(\"Enter email address to send test email to:\");\n                      if (!testEmail) return;\n                      \n                      await api.sendTestEmail({\n                        to: testEmail,\n                        subject: \"Test Email from Portfolio\",\n                        body: \"<h1>Test Email</h1><p>This is a test email from your portfolio admin panel.</p>\"\n                      });\n                      \n                      toast({\n                        title: \"Success\",\n                        description: \"Test email sent successfully\"\n                      });\n                    } catch (error: any) {\n                      toast({\n                        title: \"Error\",\n                        description: error.message || \"Failed to send test email\",\n                        variant: \"destructive\"\n                      });\n                    }\n                  }}\n                >\n                  <Mail className=\"w-4 h-4 mr-2\" /> Send Test Email\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Email Templates</CardTitle>\n                <CardDescription>\n                  Customize email templates for different notifications. Use placeholders like {\"{{siteName}}\"}, {\"{{userName}}\"}, {\"{{date}}\"} etc.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                {templatesLoading ? (\n                  <div className=\"text-center py-4 text-muted-foreground\">Loading templates...</div>\n                ) : (\n                  Object.entries(templateLabels).map(([key, label]) => (\n                    <Button\n                      key={key}\n                      variant=\"outline\"\n                      className=\"w-full justify-start\"\n                      onClick={() => openTemplateEditor(key)}\n                      data-testid={`button-edit-${key}-email`}\n                    >\n                      <FileText className=\"w-4 h-4 mr-2\" />\n                      {label}\n                      {emailTemplates[key] && (\n                        <Badge variant=\"secondary\" className=\"ml-auto\">Configured</Badge>\n                      )}\n                    </Button>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Email Template Editor Dialog */}\n            <Dialog open={!!editingTemplate} onOpenChange={(open) => !open && setEditingTemplate(null)}>\n              <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>Edit {editingTemplate && templateLabels[editingTemplate]}</DialogTitle>\n                  <DialogDescription>\n                    Customize the email template. Use placeholders that will be replaced with actual values.\n                  </DialogDescription>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Subject</Label>\n                    <Input\n                      value={templateSubject}\n                      onChange={(e) => setTemplateSubject(e.target.value)}\n                      placeholder=\"Email subject...\"\n                      data-testid=\"input-template-subject\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Body (HTML)</Label>\n                    <Textarea\n                      value={templateBody}\n                      onChange={(e) => setTemplateBody(e.target.value)}\n                      placeholder=\"<h1>Hello {{userName}}</h1>...\"\n                      className=\"min-h-[300px] font-mono text-sm\"\n                      data-testid=\"input-template-body\"\n                    />\n                  </div>\n                  <div className=\"bg-muted p-3 rounded-lg\">\n                    <p className=\"text-sm font-medium mb-2\">Available Placeholders:</p>\n                    <div className=\"flex flex-wrap gap-2 text-xs\">\n                      <Badge variant=\"outline\">{\"{{siteName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{userName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{date}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderEmail}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{messageContent}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{postTitle}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{commentContent}}\"}</Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2 justify-end\">\n                    <Button variant=\"outline\" onClick={() => setEditingTemplate(null)}>\n                      Cancel\n                    </Button>\n                    <Button onClick={saveTemplate} disabled={updateTemplateMutation.isPending}>\n                      {updateTemplateMutation.isPending ? \"Saving...\" : \"Save Template\"}\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          </TabsContent>\n\n          {/* STORAGE TAB */}\n          <TabsContent value=\"storage\" className=\"space-y-4\">\n            <StorageTab />\n          </TabsContent>\n\n          {/* PERFORMANCE TAB */}\n          <TabsContent value=\"performance\" className=\"space-y-4\">\n            <SettingsPerformance />\n          </TabsContent>\n\n          {/* NOTIFICATIONS & ALERTS TAB */}\n          <TabsContent value=\"notifications\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Notification preferences are saved. Email notifications require SMTP configuration in the Email tab.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bell className=\"w-5 h-5\" /> Notification Preferences\n                </CardTitle>\n                <CardDescription>\n                  Configure how and when you receive notifications\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Email Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          New contact form submissions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Receive email when someone contacts you\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewContact ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewContact: checked })\n                        }\n                        data-testid=\"switch-notify-contact\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">New comments</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Get notified when comments are posted\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewComment ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewComment: checked })\n                        }\n                        data-testid=\"switch-notify-comment\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Security alerts</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Important security-related notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifySecurityAlert ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifySecurityAlert: checked })\n                        }\n                        data-testid=\"switch-notify-security\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Newsletter subscriptions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          When new users subscribe\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewsletter ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewsletter: checked })\n                        }\n                        data-testid=\"switch-notify-newsletter\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Weekly analytics summary\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Weekly report of site performance\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyWeeklySummary ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyWeeklySummary: checked })\n                        }\n                        data-testid=\"switch-notify-weekly\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Push Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Browser notifications\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Show desktop notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyBrowser ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyBrowser: checked })\n                        }\n                        data-testid=\"switch-push-browser\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Mobile push</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Send to mobile devices\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyMobile ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyMobile: checked })\n                        }\n                        data-testid=\"switch-push-mobile\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Channel Priority & Routing</CardTitle>\n                <CardDescription>\n                  Configure notification delivery channels and priority\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  {[\n                    {\n                      channel: \"Email\",\n                      priority: 1,\n                      enabled: true,\n                      desc: \"Primary notification channel\",\n                    },\n                    {\n                      channel: \"Browser Push\",\n                      priority: 2,\n                      enabled: false,\n                      desc: \"Desktop notifications\",\n                    },\n                    {\n                      channel: \"SMS\",\n                      priority: 3,\n                      enabled: false,\n                      desc: \"Text messages for critical alerts\",\n                    },\n                    {\n                      channel: \"Slack\",\n                      priority: 4,\n                      enabled: true,\n                      desc: \"Team notifications\",\n                    },\n                    {\n                      channel: \"Discord\",\n                      priority: 5,\n                      enabled: true,\n                      desc: \"Community updates\",\n                    },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-xs font-bold\">\n                          {item.priority}\n                        </div>\n                        <div>\n                          <p className=\"font-medium text-sm\">{item.channel}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {item.desc}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†‘\n                        </Button>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†“\n                        </Button>\n                        <Switch defaultChecked={item.enabled} />\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-muted/50\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Fallback Routing</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Try next channel if delivery fails\n                    </p>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Alert Thresholds</CardTitle>\n                <CardDescription>\n                  Set triggers for automatic alerts\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Storage Usage Alert (%)</Label>\n                    <Input type=\"number\" defaultValue=\"80\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Failed Login Attempts</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Error Rate Threshold (%)</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Response Time (ms)</Label>\n                    <Input type=\"number\" defaultValue=\"3000\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification History</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {[\n                  {\n                    message: \"Storage usage reached 75%\",\n                    time: \"2 hours ago\",\n                    type: \"warning\",\n                  },\n                  {\n                    message: \"Weekly backup completed successfully\",\n                    time: \"Yesterday\",\n                    type: \"success\",\n                  },\n                  {\n                    message: \"3 failed login attempts detected\",\n                    time: \"2 days ago\",\n                    type: \"error\",\n                  },\n                ].map((notif, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center gap-3 p-3 border rounded-lg\"\n                  >\n                    {notif.type === \"warning\" && (\n                      <AlertCircle className=\"w-5 h-5 text-yellow-500\" />\n                    )}\n                    {notif.type === \"success\" && (\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                    )}\n                    {notif.type === \"error\" && (\n                      <AlertCircle className=\"w-5 h-5 text-red-500\" />\n                    )}\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm\">{notif.message}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {notif.time}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DEVELOPER SETTINGS TAB */}\n          <TabsContent value=\"developer\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Developer settings are saved to database. Actual logic application requires backend implementation.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bug className=\"w-5 h-5\" /> Debug Mode\n                </CardTitle>\n                <CardDescription>\n                  Enable debugging features for development\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-yellow-500/5 border-yellow-500/20\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable Debug Mode</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Shows detailed error messages and stack traces\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.debugMode ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ debugMode: checked })\n                    }\n                    data-testid=\"switch-debug-mode\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to Console</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Output logs to browser/server console\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToConsole ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToConsole: checked })\n                    }\n                    data-testid=\"switch-log-console\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to File</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Save logs to file system\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToFile ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToFile: checked })\n                    }\n                    data-testid=\"switch-log-file\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Gauge className=\"w-5 h-5\" /> API Rate Limits\n                </CardTitle>\n                <CardDescription>\n                  Configure rate limiting for API endpoints\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Requests per minute (global)</Label>\n                  <Input\n                    type=\"number\"\n                    value={settings.apiRateLimit ?? 100}\n                    onChange={(e) =>\n                      updateSettings({\n                        apiRateLimit: parseInt(e.target.value) || 100,\n                      })\n                    }\n                    data-testid=\"input-api-rate-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Maximum API requests per minute across all endpoints\n                  </p>\n                </div>\n                <div className=\"space-y-3\">\n                  <h4 className=\"font-medium text-sm\">\n                    Endpoint-specific limits (read-only)\n                  </h4>\n                  {[\n                    { endpoint: \"/api/contact\", limit: 5, window: \"1 hour\" },\n                    {\n                      endpoint: \"/api/auth/login\",\n                      limit: 10,\n                      window: \"15 mins\",\n                    },\n                    { endpoint: \"/api/upload\", limit: 20, window: \"1 hour\" },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-2 border rounded text-sm\"\n                    >\n                      <code className=\"text-xs bg-muted px-2 py-1 rounded\">\n                        {item.endpoint}\n                      </code>\n                      <span>\n                        {item.limit} requests / {item.window}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Terminal className=\"w-5 h-5\" /> Advanced Options\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable CORS</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Allow cross-origin requests\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.corsEnabled ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ corsEnabled: checked })\n                    }\n                    data-testid=\"switch-cors-enabled\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Allowed Origins (CORS)</Label>\n                  <Input\n                    placeholder=\"* (all origins) or https://example.com, https://app.example.com\"\n                    value={settings.corsOrigins || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ corsOrigins: e.target.value })\n                    }\n                    data-testid=\"input-cors-origins\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Use * to allow all origins, or specify comma-separated\n                    domains\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Custom Headers</Label>\n                  <Textarea\n                    placeholder=\"X-Custom-Header: value&#10;X-Another-Header: value\"\n                    className=\"font-mono text-sm\"\n                    rows={3}\n                    value={settings.customHeaders || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ customHeaders: e.target.value })\n                    }\n                    data-testid=\"input-custom-headers\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Add custom HTTP headers to all responses\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* LOCALIZATION TAB (Enhanced) */}\n          <TabsContent value=\"localization\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"w-5 h-5\" /> Regional Settings\n                </CardTitle>\n                <CardDescription>\n                  Configure timezone and language preferences\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Timezone</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timezone || \"Asia/Ho_Chi_Minh\"}\n                    onChange={(e) =>\n                      updateSettings({ timezone: e.target.value })\n                    }\n                    data-testid=\"select-timezone\"\n                  >\n                    <option value=\"Asia/Ho_Chi_Minh\">\n                      UTC+07:00 (Vietnam)\n                    </option>\n                    <option value=\"Asia/Shanghai\">UTC+08:00 (Shanghai)</option>\n                    <option value=\"Asia/Tokyo\">UTC+09:00 (Tokyo)</option>\n                    <option value=\"Europe/London\">UTC+00:00 (London)</option>\n                    <option value=\"America/New_York\">\n                      UTC-05:00 (New York)\n                    </option>\n                    <option value=\"America/Los_Angeles\">\n                      UTC-08:00 (Los Angeles)\n                    </option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Language</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.language || \"en\"}\n                    onChange={(e) =>\n                      updateSettings({ language: e.target.value })\n                    }\n                    data-testid=\"select-language\"\n                  >\n                    <option value=\"en\">English</option>\n                    <option value=\"vi\">Tiáº¿ng Viá»‡t</option>\n                    <option value=\"zh\">ä¸­æ–‡</option>\n                    <option value=\"ja\">æ—¥æœ¬èªž</option>\n                    <option value=\"ko\">í•œêµ­ì–´</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Date Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.dateFormat || \"MM/DD/YYYY\"}\n                    onChange={(e) =>\n                      updateSettings({ dateFormat: e.target.value })\n                    }\n                    data-testid=\"select-date-format\"\n                  >\n                    <option value=\"MM/DD/YYYY\">MM/DD/YYYY</option>\n                    <option value=\"DD/MM/YYYY\">DD/MM/YYYY</option>\n                    <option value=\"YYYY-MM-DD\">YYYY-MM-DD</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Time Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timeFormat || \"12h\"}\n                    onChange={(e) =>\n                      updateSettings({ timeFormat: e.target.value })\n                    }\n                    data-testid=\"select-time-format\"\n                  >\n                    <option value=\"12h\">12 Hour (AM/PM)</option>\n                    <option value=\"24h\">24 Hour</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <DollarSign className=\"w-5 h-5\" /> Currency Settings\n                </CardTitle>\n                <CardDescription>\n                  Configure currency display preferences\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Default Currency</Label>\n                    <select\n                      className=\"w-full p-2 rounded-md border border-input bg-background\"\n                      value={settings.currency || \"USD\"}\n                      onChange={(e) => {\n                        const currencySymbols: Record<string, string> = {\n                          USD: \"$\",\n                          VND: \"â‚«\",\n                          EUR: \"â‚¬\",\n                          GBP: \"Â£\",\n                          JPY: \"Â¥\",\n                          CNY: \"Â¥\",\n                        };\n                        updateSettings({\n                          currency: e.target.value,\n                          currencySymbol:\n                            currencySymbols[e.target.value] || \"$\",\n                        });\n                      }}\n                      data-testid=\"select-currency\"\n                    >\n                      <option value=\"USD\">USD ($)</option>\n                      <option value=\"VND\">VND (â‚«)</option>\n                      <option value=\"EUR\">EUR (â‚¬)</option>\n                      <option value=\"GBP\">GBP (Â£)</option>\n                      <option value=\"JPY\">JPY (Â¥)</option>\n                      <option value=\"CNY\">CNY (Â¥)</option>\n                    </select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Currency Symbol</Label>\n                    <Input\n                      value={settings.currencySymbol || \"$\"}\n                      onChange={(e) =>\n                        updateSettings({ currencySymbol: e.target.value })\n                      }\n                      data-testid=\"input-currency-symbol\"\n                    />\n                  </div>\n                </div>\n                <div className=\"p-3 bg-muted rounded-lg\">\n                  <p className=\"text-sm font-medium mb-2\">Preview:</p>\n                  <div className=\"grid grid-cols-3 gap-4 text-sm\">\n                    <div>\n                      <span className=\"text-muted-foreground\">Currency:</span>{\" \"}\n                      {settings.currencySymbol || \"$\"}1,234.56\n                    </div>\n                    <div>\n                      <span className=\"text-muted-foreground\">Date:</span>{\" \"}\n                      {new Date().toLocaleDateString()}\n                    </div>\n                    <div>\n                      <span className=\"text-muted-foreground\">Time:</span>{\" \"}\n                      {new Date().toLocaleTimeString()}\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Hash className=\"w-5 h-5\" /> Number Formatting\n                </CardTitle>\n                <CardDescription>\n                  Configure number display preferences\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Thousand Separator</Label>\n                    <select className=\"w-full p-2 rounded-md border border-input bg-background\">\n                      <option>Comma (1,000)</option>\n                      <option>Period (1.000)</option>\n                      <option>Space (1 000)</option>\n                      <option>None (1000)</option>\n                    </select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Measurement System</Label>\n                    <select className=\"w-full p-2 rounded-md border border-input bg-background\">\n                      <option>Metric (km, kg, Â°C)</option>\n                      <option>Imperial (mi, lb, Â°F)</option>\n                    </select>\n                  </div>\n                </div>\n                <div className=\"p-3 bg-muted rounded-lg\">\n                  <p className=\"text-sm font-medium mb-2\">Preview:</p>\n                  <div className=\"grid grid-cols-3 gap-4 text-sm\">\n                    <div>\n                      <span className=\"text-muted-foreground\">Number:</span>{\" \"}\n                      1,234,567.89\n                    </div>\n                    <div>\n                      <span className=\"text-muted-foreground\">Currency:</span>{\" \"}\n                      $1,234.56\n                    </div>\n                    <div>\n                      <span className=\"text-muted-foreground\">Date:</span>{\" \"}\n                      03/20/2024\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Languages className=\"w-5 h-5\" /> Custom Translations\n                </CardTitle>\n                <CardDescription>\n                  Manage custom translation strings for multi-language support\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2 flex-wrap\">\n                  <Button variant=\"outline\" size=\"sm\">\n                    Import Translations\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\">\n                    Export Translations\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-3 gap-2 p-2 bg-muted rounded text-sm font-medium\">\n                    <span>Key</span>\n                    <span>English</span>\n                    <span>Vietnamese</span>\n                  </div>\n                  <div className=\"max-h-[400px] overflow-y-auto space-y-1\">\n                    {[\n                      { key: \"site.title\", en: \"Loi Developer\", vi: \"Loi Developer\" },\n                      { key: \"site.tagline\", en: \"Full-stack Developer\", vi: \"Láº­p trÃ¬nh viÃªn Full-stack\" },\n                      { key: \"nav.home\", en: \"Home\", vi: \"Trang chá»§\" },\n                      { key: \"nav.about\", en: \"About\", vi: \"Giá»›i thiá»‡u\" },\n                      { key: \"nav.projects\", en: \"Projects\", vi: \"Dá»± Ã¡n\" },\n                      { key: \"nav.blog\", en: \"Blog\", vi: \"BÃ i viáº¿t\" },\n                      { key: \"nav.services\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"nav.contact\", en: \"Contact\", vi: \"LiÃªn há»‡\" },\n                      { key: \"hero.greeting\", en: \"Hello, I'm\", vi: \"Xin chÃ o, tÃ´i lÃ \" },\n                      { key: \"hero.cta\", en: \"View My Work\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"hero.download_cv\", en: \"Download CV\", vi: \"Táº£i CV\" },\n                      { key: \"about.title\", en: \"About Me\", vi: \"Vá» tÃ´i\" },\n                      { key: \"about.experience\", en: \"Years of Experience\", vi: \"NÄƒm kinh nghiá»‡m\" },\n                      { key: \"about.projects\", en: \"Projects Completed\", vi: \"Dá»± Ã¡n hoÃ n thÃ nh\" },\n                      { key: \"projects.title\", en: \"My Projects\", vi: \"Dá»± Ã¡n cá»§a tÃ´i\" },\n                      { key: \"projects.view\", en: \"View Project\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"projects.all\", en: \"All Projects\", vi: \"Táº¥t cáº£\" },\n                      { key: \"blog.title\", en: \"Latest Posts\", vi: \"BÃ i viáº¿t má»›i\" },\n                      { key: \"blog.read_more\", en: \"Read More\", vi: \"Äá»c thÃªm\" },\n                      { key: \"services.title\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"services.learn_more\", en: \"Learn More\", vi: \"TÃ¬m hiá»ƒu thÃªm\" },\n                      { key: \"contact.title\", en: \"Get In Touch\", vi: \"LiÃªn há»‡\" },\n                      { key: \"contact.name\", en: \"Your Name\", vi: \"Há» tÃªn\" },\n                      { key: \"contact.email\", en: \"Your Email\", vi: \"Email\" },\n                      { key: \"contact.message\", en: \"Your Message\", vi: \"Ná»™i dung\" },\n                      { key: \"contact.send\", en: \"Send Message\", vi: \"Gá»­i tin nháº¯n\" },\n                      { key: \"contact.success\", en: \"Message sent successfully!\", vi: \"Gá»­i thÃ nh cÃ´ng!\" },\n                      { key: \"footer.copyright\", en: \"All rights reserved\", vi: \"Báº£n quyá»n thuá»™c vá»\" },\n                      { key: \"common.loading\", en: \"Loading...\", vi: \"Äang táº£i...\" },\n                      { key: \"common.error\", en: \"Something went wrong\", vi: \"ÄÃ£ xáº£y ra lá»—i\" },\n                      { key: \"common.save\", en: \"Save\", vi: \"LÆ°u\" },\n                      { key: \"common.cancel\", en: \"Cancel\", vi: \"Há»§y\" },\n                      { key: \"common.delete\", en: \"Delete\", vi: \"XÃ³a\" },\n                      { key: \"common.edit\", en: \"Edit\", vi: \"Sá»­a\" },\n                    ].map((item, i) => (\n                      <div\n                        key={i}\n                        className=\"grid grid-cols-3 gap-2 p-2 border rounded text-sm\"\n                      >\n                        <code className=\"text-xs bg-muted px-2 py-1 rounded truncate\">\n                          {item.key}\n                        </code>\n                        <Input defaultValue={item.en} className=\"h-8\" />\n                        <Input defaultValue={item.vi} className=\"h-8\" />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 justify-end\">\n                  <Button variant=\"outline\">\n                    + Add Translation Key\n                  </Button>\n                  <Button>\n                    Save Translations\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DATABASE MANAGEMENT TAB */}\n          <TabsContent value=\"database\" className=\"space-y-4\">\n            <DatabaseTab />\n          </TabsContent>\n\n          {/* LOGGING CONFIGURATION TAB */}\n          <TabsContent value=\"logging\" className=\"space-y-4\">\n            <LoggingTab />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":88372,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"client/src/components/sections/Testimonials.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { ChevronLeft, ChevronRight, Quote, Star } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\nconst defaultTestimonials = [\n  {\n    id: 1,\n    name: \"John Smith\",\n    role: \"CEO\",\n    company: \"TechCorp\",\n    content: \"Loi delivered exceptional work on our web application. His attention to detail and technical expertise exceeded our expectations.\",\n    rating: 5,\n  },\n  {\n    id: 2,\n    name: \"Sarah Johnson\",\n    role: \"Product Manager\",\n    company: \"StartupXYZ\",\n    content: \"Working with Loi was a fantastic experience. He understood our vision and translated it into a beautiful, functional product.\",\n    rating: 5,\n  },\n];\n\nexport function Testimonials() {\n  const { data: testimonialsData = [] } = useQuery({\n    queryKey: ['testimonials', 'active'],\n    queryFn: () => api.getTestimonials(true),\n    staleTime: 60000,\n  });\n\n  const testimonials = testimonialsData.length > 0 ? testimonialsData : defaultTestimonials;\n  const [current, setCurrent] = useState(0);\n  const [autoplay, setAutoplay] = useState(true);\n\n  useEffect(() => {\n    if (!autoplay || testimonials.length === 0) return;\n    const timer = setInterval(() => {\n      setCurrent((prev) => (prev + 1) % testimonials.length);\n    }, 5000);\n    return () => clearInterval(timer);\n  }, [autoplay, testimonials.length]);\n\n  const next = () => {\n    setCurrent((prev) => (prev + 1) % testimonials.length);\n    setAutoplay(false);\n  };\n\n  const prev = () => {\n    setCurrent((prev) => (prev - 1 + testimonials.length) % testimonials.length);\n    setAutoplay(false);\n  };\n\n  if (testimonials.length === 0) return null;\n\n  return (\n    <section className=\"py-24 bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex flex-col items-center mb-16\">\n          <h2 className=\"text-3xl md:text-4xl font-heading font-bold text-center mb-4\">\n            What Clients <span className=\"text-primary\">Say</span>\n          </h2>\n          <p className=\"text-muted-foreground text-center max-w-2xl mb-2\">\n            Real feedback from clients who've transformed their business with our solutions\n          </p>\n          <div className=\"w-20 h-1 bg-primary rounded-full\" />\n        </div>\n\n        <div className=\"max-w-4xl mx-auto\">\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={current}\n              initial={{ opacity: 0, x: 100 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -100 }}\n              transition={{ duration: 0.5 }}\n              className=\"bg-card border border-border rounded-2xl p-8 md:p-12\"\n            >\n              <div className=\"flex items-start gap-4 mb-6\">\n                <Quote className=\"w-8 h-8 text-primary flex-shrink-0\" />\n                <div className=\"flex gap-1\">\n                  {Array.from({ length: testimonials[current].rating }).map((_, i) => (\n                    <Star key={i} className=\"w-4 h-4 fill-primary text-primary\" />\n                  ))}\n                </div>\n              </div>\n\n              <p className=\"text-lg md:text-xl mb-8 italic text-foreground/90\">\n                \"{testimonials[current].content}\"\n              </p>\n\n              <div className=\"flex items-center gap-4\">\n                <Avatar className=\"w-12 h-12\">\n                  <AvatarImage \n                    src={testimonials[current].avatar || undefined}\n                    alt={testimonials[current].name}\n                  />\n                  <AvatarFallback className=\"bg-primary/10 text-primary font-bold\">\n                    {testimonials[current].name.split(' ').map((n: string) => n[0]).join('').slice(0, 2)}\n                  </AvatarFallback>\n                </Avatar>\n                <div>\n                  <p className=\"font-bold\">{testimonials[current].name}</p>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {testimonials[current].role}{testimonials[current].company ? `, ${testimonials[current].company}` : ''}\n                  </p>\n                </div>\n              </div>\n            </motion.div>\n          </AnimatePresence>\n\n          {/* Controls */}\n          <div className=\"flex items-center justify-between mt-8\">\n            <Button variant=\"outline\" size=\"icon\" onClick={prev}>\n              <ChevronLeft className=\"w-4 h-4\" />\n            </Button>\n\n            <div className=\"flex gap-2\">\n              {testimonials.map((_, idx) => (\n                <button\n                  key={idx}\n                  onClick={() => {\n                    setCurrent(idx);\n                    setAutoplay(false);\n                  }}\n                  className={`h-2 rounded-full transition-all ${\n                    idx === current ? \"bg-primary w-8\" : \"bg-muted w-2\"\n                  }`}\n                />\n              ))}\n            </div>\n\n            <Button variant=\"outline\" size=\"icon\" onClick={next}>\n              <ChevronRight className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":5318,"size_tokens":null},"client/src/pages/admin/ProjectsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Eye, Star, ExternalLink, Github, Image as ImageIcon, X, Loader2 } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ProjectEditor } from \"@/components/admin/project-editor\";\n\ninterface Project {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  shortDescription: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: string;\n  views: number;\n  featured: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\nconst emptyProject = {\n  title: \"\",\n  category: \"full-stack\",\n  image: \"\",\n  shortDescription: \"\",\n  description: \"\",\n  tech: [] as string[],\n  link: \"\",\n  github: \"\",\n  status: \"Draft\",\n  featured: false,\n};\n\nconst defaultCategory = \"full-stack\";\n\nexport default function AdminProjectsEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProject, setEditingProject] = useState<Project | null>(null);\n  const [formData, setFormData] = useState(emptyProject);\n  const [techInput, setTechInput] = useState(\"\");\n  const [filter, setFilter] = useState(\"all\");\n  const [uploadingImage, setUploadingImage] = useState(false);\n\n  const { data: projects = [], isLoading } = useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: () => api.getProjects(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createProject(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<typeof formData> }) => \n      api.updateProject(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteProject(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleFeaturedMutation = useMutation({\n    mutationFn: ({ id, featured }: { id: number; featured: boolean }) =>\n      api.updateProject(id, { featured }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: ({ id, status }: { id: number; status: string }) =>\n      api.updateProject(id, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(emptyProject);\n    setEditingProject(null);\n    setTechInput(\"\");\n  };\n\n  const openCreateDialog = () => {\n    resetForm();\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (project: Project) => {\n    setEditingProject(project);\n    setFormData({\n      title: project.title,\n      category: project.category,\n      image: project.image || \"\",\n      shortDescription: project.shortDescription || \"\",\n      description: project.description || \"\",\n      tech: project.tech || [],\n      link: project.link || \"\",\n      github: project.github || \"\",\n      status: project.status,\n      featured: project.featured,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Error\", description: \"Title is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingProject) {\n      updateMutation.mutate({ id: editingProject.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const addTech = () => {\n    if (techInput.trim() && !formData.tech.includes(techInput.trim())) {\n      setFormData({ ...formData, tech: [...formData.tech, techInput.trim()] });\n      setTechInput(\"\");\n    }\n  };\n\n  const removeTech = (tech: string) => {\n    setFormData({ ...formData, tech: formData.tech.filter(t => t !== tech) });\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({ title: \"Error\", description: \"Image size must be less than 5MB\", variant: \"destructive\" });\n      return;\n    }\n\n    setUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const base64 = reader.result as string;\n        try {\n          const result = await api.uploadImage(base64, file.name);\n          setFormData({ ...formData, image: result.url });\n          toast({ title: \"Success\", description: \"Image uploaded successfully\" });\n        } catch (error: any) {\n          toast({ title: \"Error\", description: error.message || \"Failed to upload image\", variant: \"destructive\" });\n        } finally {\n          setUploadingImage(false);\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      setUploadingImage(false);\n      toast({ title: \"Error\", description: \"Failed to read image file\", variant: \"destructive\" });\n    }\n  };\n\n  const filteredProjects = projects.filter((project: Project) => {\n    if (filter === \"all\") return true;\n    if (filter === \"featured\") return project.featured;\n    if (filter === \"published\") return project.status === \"Published\";\n    if (filter === \"draft\") return project.status === \"Draft\";\n    return project.category === filter;\n  });\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"page-title\">Projects</h1>\n            <p className=\"text-muted-foreground\">Manage your portfolio projects</p>\n          </div>\n          <Button onClick={openCreateDialog} data-testid=\"button-create-project\">\n            <Plus className=\"w-4 h-4 mr-2\" /> New Project\n          </Button>\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          {[\"all\", \"featured\", \"published\", \"draft\", ...categories.map(c => c.slug)].map((f) => (\n            <Button\n              key={f}\n              variant={filter === f ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setFilter(f)}\n              data-testid={`filter-${f}`}\n            >\n              {f === \"all\" ? \"All\" : \n               f === \"featured\" ? \"Featured\" :\n               f === \"published\" ? \"Published\" :\n               f === \"draft\" ? \"Draft\" :\n               categories.find(c => c.slug === f)?.name || f}\n            </Button>\n          ))}\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No projects found</p>\n              <Button onClick={openCreateDialog}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create your first project\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project: Project) => (\n              <Card key={project.id} className=\"overflow-hidden group\" data-testid={`card-project-${project.id}`}>\n                <div className=\"aspect-video relative bg-muted overflow-hidden\">\n                  {project.image ? (\n                    <img\n                      src={project.image}\n                      alt={project.title}\n                      className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <ImageIcon className=\"w-12 h-12 text-muted-foreground/50\" />\n                    </div>\n                  )}\n                  <div className=\"absolute top-2 left-2 flex gap-1\">\n                    <Badge variant={project.status === \"Published\" ? \"default\" : \"secondary\"}>\n                      {project.status}\n                    </Badge>\n                    {project.featured && (\n                      <Badge variant=\"default\" className=\"bg-yellow-500\">\n                        <Star className=\"w-3 h-3 mr-1\" /> Featured\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-lg line-clamp-1\">{project.title}</CardTitle>\n                  <CardDescription className=\"line-clamp-2\">\n                    {project.description || \"No description\"}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex flex-wrap gap-1\">\n                    {(project.tech || []).slice(0, 4).map((tech) => (\n                      <Badge key={tech} variant=\"outline\" className=\"text-xs\">\n                        {tech}\n                      </Badge>\n                    ))}\n                    {(project.tech || []).length > 4 && (\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        +{project.tech.length - 4}\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                    <span className=\"flex items-center gap-1\">\n                      <Eye className=\"w-4 h-4\" /> {project.views}\n                    </span>\n                    <span>{categories.find(c => c.slug === project.category)?.name || project.category}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between pt-2 border-t\">\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={project.featured}\n                        onCheckedChange={(checked) => \n                          toggleFeaturedMutation.mutate({ id: project.id, featured: checked })\n                        }\n                        data-testid={`switch-featured-${project.id}`}\n                      />\n                      <span className=\"text-sm text-muted-foreground\">Featured</span>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      {project.link && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.link} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <ExternalLink className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      {project.github && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.github} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <Github className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      <Button \n                        size=\"icon\" \n                        variant=\"ghost\" \n                        onClick={() => openEditDialog(project)}\n                        data-testid={`button-edit-${project.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <AlertDialog>\n                        <AlertDialogTrigger asChild>\n                          <Button size=\"icon\" variant=\"ghost\" data-testid={`button-delete-${project.id}`}>\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </AlertDialogTrigger>\n                        <AlertDialogContent>\n                          <AlertDialogHeader>\n                            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n                            <AlertDialogDescription>\n                              Are you sure you want to delete \"{project.title}\"? This action cannot be undone.\n                            </AlertDialogDescription>\n                          </AlertDialogHeader>\n                          <AlertDialogFooter>\n                            <AlertDialogCancel>Cancel</AlertDialogCancel>\n                            <AlertDialogAction\n                              onClick={() => deleteMutation.mutate(project.id)}\n                              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                            >\n                              Delete\n                            </AlertDialogAction>\n                          </AlertDialogFooter>\n                        </AlertDialogContent>\n                      </AlertDialog>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{editingProject ? \"Edit Project\" : \"Create New Project\"}</DialogTitle>\n            <DialogDescription>\n              {editingProject ? \"Update your project details\" : \"Add a new project to your portfolio\"}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-6 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                placeholder=\"Project title\"\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-category\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value) => setFormData({ ...formData, status: value })}\n                >\n                  <SelectTrigger data-testid=\"select-status\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"shortDescription\">Short Description</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                A brief summary shown in featured project cards (max 150 characters)\n              </p>\n              <Input\n                id=\"shortDescription\"\n                value={formData.shortDescription}\n                onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}\n                placeholder=\"Brief project summary for featured display...\"\n                maxLength={150}\n                data-testid=\"input-short-description\"\n              />\n              <p className=\"text-xs text-muted-foreground text-right\">\n                {formData.shortDescription.length}/150\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Full Description</Label>\n              <p className=\"text-sm text-muted-foreground mb-3\">\n                Add detailed information about your project with rich formatting support\n              </p>\n              <ProjectEditor\n                value={formData.description}\n                onChange={(html) => setFormData({ ...formData, description: html })}\n                placeholder=\"Describe your project with details, features, and technologies...\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Project Image</Label>\n              <div className=\"flex items-center gap-4\">\n                {formData.image ? (\n                  <div className=\"relative w-32 h-20 rounded-lg overflow-hidden bg-muted\">\n                    <img src={formData.image} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n                    <Button\n                      size=\"icon\"\n                      variant=\"destructive\"\n                      className=\"absolute top-1 right-1 h-6 w-6\"\n                      onClick={() => setFormData({ ...formData, image: \"\" })}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"w-32 h-20 rounded-lg bg-muted flex items-center justify-center\">\n                    <ImageIcon className=\"w-8 h-8 text-muted-foreground\" />\n                  </div>\n                )}\n                <div className=\"flex-1\">\n                  <Input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleImageUpload}\n                    disabled={uploadingImage}\n                    data-testid=\"input-image\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Max 5MB. Recommended: 1200x630px</p>\n                </div>\n                {uploadingImage && <Loader2 className=\"w-5 h-5 animate-spin\" />}\n              </div>\n              <div className=\"flex items-center gap-2 mt-2\">\n                <span className=\"text-sm text-muted-foreground\">Or enter URL:</span>\n                <Input\n                  placeholder=\"https://example.com/image.jpg\"\n                  value={formData.image}\n                  onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                  className=\"flex-1\"\n                  data-testid=\"input-image-url\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Technologies</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  value={techInput}\n                  onChange={(e) => setTechInput(e.target.value)}\n                  placeholder=\"Add technology (e.g., React)\"\n                  onKeyPress={(e) => e.key === \"Enter\" && (e.preventDefault(), addTech())}\n                  data-testid=\"input-tech\"\n                />\n                <Button type=\"button\" onClick={addTech} variant=\"outline\">\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.tech.map((tech) => (\n                  <Badge key={tech} variant=\"secondary\" className=\"gap-1\">\n                    {tech}\n                    <button onClick={() => removeTech(tech)} className=\"ml-1 hover:text-destructive\">\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"link\">Live URL</Label>\n                <Input\n                  id=\"link\"\n                  value={formData.link}\n                  onChange={(e) => setFormData({ ...formData, link: e.target.value })}\n                  placeholder=\"https://example.com\"\n                  data-testid=\"input-link\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"github\">GitHub URL</Label>\n                <Input\n                  id=\"github\"\n                  value={formData.github}\n                  onChange={(e) => setFormData({ ...formData, github: e.target.value })}\n                  placeholder=\"https://github.com/...\"\n                  data-testid=\"input-github\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Switch\n                id=\"featured\"\n                checked={formData.featured}\n                onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n                data-testid=\"switch-featured-form\"\n              />\n              <Label htmlFor=\"featured\">Featured on homepage</Label>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-submit\">\n              {isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              {editingProject ? \"Update Project\" : \"Create Project\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":24572,"size_tokens":null},"client/src/components/LanguageSwitcher.tsx":{"content":"import { Globe } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useLanguage } from \"@/context/LanguageContext\";\n\nexport function LanguageSwitcher() {\n  const { languages, currentLanguage, setCurrentLanguage } = useLanguage();\n  \n  const currentLang = languages.find(l => l.code === currentLanguage);\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\n          <Globe className=\"w-4 h-4\" />\n          <span className=\"hidden sm:inline\">{currentLang?.nativeName || currentLang?.name}</span>\n          <span className=\"sm:hidden\">{currentLanguage.toUpperCase()}</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        {languages.map((lang) => (\n          <DropdownMenuItem\n            key={lang.code}\n            onClick={() => setCurrentLanguage(lang.code)}\n            className={currentLanguage === lang.code ? \"bg-primary/10\" : \"\"}\n          >\n            <span className=\"font-medium\">{lang.nativeName}</span>\n            <span className=\"ml-2 text-muted-foreground text-xs\">({lang.code.toUpperCase()})</span>\n          </DropdownMenuItem>\n        ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","path":null,"size_bytes":1397,"size_tokens":null},"client/src/components/sections/Services.tsx":{"content":"import { Check, Code, Smartphone, Palette, Lightbulb } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\nconst iconMap: Record<string, any> = {\n  code: Code,\n  smartphone: Smartphone,\n  palette: Palette,\n  lightbulb: Lightbulb,\n};\n\nconst defaultServices = [\n  {\n    id: 1,\n    title: \"Web Development\",\n    description: \"Custom websites and web applications tailored to your needs\",\n    price: \"From $2,000\",\n    features: [\"React/Next.js\", \"Node.js/Express\", \"Database Design\", \"API Development\"],\n    icon: \"code\",\n  },\n  {\n    id: 2,\n    title: \"Mobile App Development\",\n    description: \"Cross-platform mobile applications\",\n    price: \"From $5,000\",\n    features: [\"React Native\", \"iOS & Android\", \"App Store Publishing\", \"Maintenance\"],\n    icon: \"smartphone\",\n  },\n  {\n    id: 3,\n    title: \"UI/UX Design\",\n    description: \"User-centered design solutions\",\n    price: \"From $1,500\",\n    features: [\"User Research\", \"Wireframing\", \"Prototyping\", \"Design Systems\"],\n    icon: \"palette\",\n  },\n];\n\nexport function Services() {\n  const { data: servicesData = [] } = useQuery({\n    queryKey: ['services', 'active'],\n    queryFn: () => api.getServices(true),\n    staleTime: 60000,\n  });\n\n  const services = servicesData.length > 0 ? servicesData : defaultServices;\n\n  const handleContactClick = (service: any) => {\n    const subject = `${service.title} - ${service.description}`;\n    const message = `${service.price}\\n${(service.features || []).join('\\n')}`;\n    \n    sessionStorage.setItem('contactFormData', JSON.stringify({\n      subject,\n      message\n    }));\n    \n    window.dispatchEvent(new CustomEvent('contact:prefill', {\n      detail: { subject, message }\n    }));\n    \n    setTimeout(() => {\n      const contactSection = document.getElementById('contact');\n      if (contactSection) {\n        contactSection.scrollIntoView({ behavior: 'smooth' });\n      }\n    }, 100);\n  };\n\n  return (\n    <section id=\"services\" className=\"py-24 bg-muted/30\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex flex-col items-center mb-16\">\n          <h2 className=\"text-3xl md:text-4xl font-heading font-bold text-center mb-4\">\n            Services &amp; <span className=\"text-primary\">Solutions</span>\n          </h2>\n          <p className=\"text-muted-foreground text-center max-w-2xl mb-2\">\n            Comprehensive services to bring your digital vision to life\n          </p>\n          <div className=\"w-20 h-1 bg-primary rounded-full\" />\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {services.map((service: any) => {\n            const IconComponent = iconMap[service.icon] || Code;\n            return (\n              <Card key={service.id} className=\"flex flex-col hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-3\">\n                    <IconComponent className=\"w-6 h-6 text-primary\" />\n                  </div>\n                  <CardTitle className=\"text-lg\">{service.title}</CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-2\">{service.description}</p>\n                </CardHeader>\n                <CardContent className=\"flex-1 space-y-4\">\n                  {service.price && (\n                    <div className=\"flex items-baseline gap-1\">\n                      <span className=\"text-xl font-bold text-primary\">{service.price}</span>\n                    </div>\n                  )}\n                  <ul className=\"space-y-2\">\n                    {(service.features || []).map((feature: string) => (\n                      <li key={feature} className=\"flex items-center gap-2 text-sm\">\n                        <Check className=\"w-4 h-4 text-primary\" />\n                        {feature}\n                      </li>\n                    ))}\n                  </ul>\n                  <Button \n                    className=\"w-full mt-auto\"\n                    onClick={() => handleContactClick(service)}\n                    data-testid=\"button-contact-service\"\n                  >\n                    Contact\n                  </Button>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":4497,"size_tokens":null},"client/src/pages/admin/SettingsIntegrations.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Plug, Plus, Settings, ExternalLink, Check, X, Github, Mail, BarChart3, CreditCard, MessageSquare } from \"lucide-react\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst integrations = [\n  { \n    id: \"google_analytics\",\n    name: \"Google Analytics\", \n    description: \"Track website traffic and user behavior\", \n    icon: BarChart3,\n    configKey: \"googleAnalyticsId\" as const,\n    placeholder: \"G-XXXXXXXXXX\"\n  },\n  { \n    id: \"github\",\n    name: \"GitHub\", \n    description: \"Display repositories and contribution stats\", \n    icon: Github,\n    configKey: \"socialGithub\" as const,\n    placeholder: \"https://github.com/username\"\n  },\n  { \n    id: \"smtp\",\n    name: \"Email (SMTP)\", \n    description: \"Send contact form notifications\", \n    icon: Mail,\n    configKey: \"smtpHost\" as const,\n    placeholder: \"smtp.gmail.com\",\n    linkTo: \"email\"\n  },\n  { \n    id: \"disqus\",\n    name: \"Disqus Comments\", \n    description: \"Third-party commenting system\", \n    icon: MessageSquare,\n    configKey: \"disqusShortname\" as const,\n    placeholder: \"your-site-shortname\"\n  },\n];\n\nexport function SettingsIntegrations() {\n  const { toast } = useToast();\n  const { settings, updateSettings, saveSettings, isSaving } = useSiteSettings();\n  \n  const isConfigured = (configKey: keyof typeof settings) => {\n    return !!(settings[configKey]);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h3 className=\"font-medium\">Third-Party Integrations</h3>\n          <p className=\"text-sm text-muted-foreground\">Connect external services to enhance your portfolio</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        {integrations.map((integration) => {\n          const configured = isConfigured(integration.configKey);\n          const Icon = integration.icon;\n          \n          return (\n            <Card key={integration.id} data-testid={`card-integration-${integration.id}`}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex gap-3\">\n                    <div className=\"p-2 bg-muted rounded-lg\">\n                      <Icon className=\"w-5 h-5\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium\">{integration.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{integration.description}</p>\n                    </div>\n                  </div>\n                  <Badge variant={configured ? \"default\" : \"outline\"}>\n                    {configured ? (\n                      <><Check className=\"w-3 h-3 mr-1\" /> Connected</>\n                    ) : (\n                      <><X className=\"w-3 h-3 mr-1\" /> Not configured</>\n                    )}\n                  </Badge>\n                </div>\n                <div className=\"mt-4 space-y-3\">\n                  <div className=\"space-y-1\">\n                    <Label className=\"text-xs\">{integration.name} {integration.configKey.includes(\"Id\") ? \"ID\" : \"Config\"}</Label>\n                    <Input \n                      placeholder={integration.placeholder}\n                      value={String(settings[integration.configKey] || \"\")}\n                      onChange={(e) => updateSettings({ [integration.configKey]: e.target.value })}\n                      data-testid={`input-${integration.id}`}\n                    />\n                  </div>\n                  {integration.linkTo && (\n                    <p className=\"text-xs text-muted-foreground\">\n                      Configure additional settings in the {integration.linkTo.charAt(0).toUpperCase() + integration.linkTo.slice(1)} tab\n                    </p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Plug className=\"w-5 h-5\" /> Social Media Links\n          </CardTitle>\n          <CardDescription>Connect your social media profiles</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>GitHub URL</Label>\n              <Input \n                placeholder=\"https://github.com/username\"\n                value={settings.socialGithub || \"\"}\n                onChange={(e) => updateSettings({ socialGithub: e.target.value })}\n                data-testid=\"input-github-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>LinkedIn URL</Label>\n              <Input \n                placeholder=\"https://linkedin.com/in/username\"\n                value={settings.socialLinkedin || \"\"}\n                onChange={(e) => updateSettings({ socialLinkedin: e.target.value })}\n                data-testid=\"input-linkedin-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Twitter/X URL</Label>\n              <Input \n                placeholder=\"https://twitter.com/username\"\n                value={settings.socialTwitter || \"\"}\n                onChange={(e) => updateSettings({ socialTwitter: e.target.value })}\n                data-testid=\"input-twitter-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>YouTube URL</Label>\n              <Input \n                placeholder=\"https://youtube.com/@channel\"\n                value={settings.socialYoutube || \"\"}\n                onChange={(e) => updateSettings({ socialYoutube: e.target.value })}\n                data-testid=\"input-youtube-url\"\n              />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Webhook Notifications</CardTitle>\n          <CardDescription>Send notifications to external services when events occur</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label>Webhook URL</Label>\n            <Input \n              placeholder=\"https://hooks.slack.com/services/...\"\n              value={settings.webhookUrl || \"\"}\n              onChange={(e) => updateSettings({ webhookUrl: e.target.value })}\n              data-testid=\"input-webhook-url\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Receive notifications for new messages and comments</p>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Webhook Notifications</Label>\n              <p className=\"text-xs text-muted-foreground\">Send POST requests when events occur</p>\n            </div>\n            <Switch \n              checked={settings.enableWebhook === true}\n              onCheckedChange={(checked) => updateSettings({ enableWebhook: checked })}\n              data-testid=\"switch-enable-webhook\"\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg\">\n        <p className=\"text-xs text-blue-700 dark:text-blue-400\">\n          All changes are automatically tracked and saved using the \"Save Changes\" button in the header.\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7894,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: false,\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1510,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/pages/BlogPost.tsx":{"content":"import { useRoute, Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion } from \"framer-motion\";\nimport { ArrowLeft, Calendar, User, Tag, Eye, Clock, Share2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { CommentSection } from \"@/components/CommentSection\";\n\nexport default function BlogPost() {\n  const [match, params] = useRoute(\"/blog/:slug\");\n  const slug = params?.slug;\n\n  const { data: post, isLoading, error } = useQuery({\n    queryKey: [\"post\", slug],\n    queryFn: async () => {\n      const postData = await api.getPost(slug!);\n      // Increment view count\n      if (postData?.id) {\n        try {\n          await fetch(`/api/posts/${postData.id}/view`, { method: 'POST' });\n        } catch (e) {\n          console.error('Failed to increment view count');\n        }\n      }\n      return postData;\n    },\n    enabled: !!slug,\n  });\n\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const estimateReadTime = (content: string | null) => {\n    if (!content) return \"1 min read\";\n    const words = content.split(/\\s+/).length;\n    const minutes = Math.ceil(words / 200);\n    return `${minutes} min read`;\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-24\">\n          <div className=\"max-w-3xl mx-auto\">\n            <div className=\"animate-pulse space-y-6\">\n              <div className=\"h-8 bg-muted rounded w-3/4\"></div>\n              <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n              <div className=\"space-y-3 mt-8\">\n                <div className=\"h-4 bg-muted rounded\"></div>\n                <div className=\"h-4 bg-muted rounded\"></div>\n                <div className=\"h-4 bg-muted rounded w-5/6\"></div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  if (error || !post) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-24\">\n          <div className=\"max-w-3xl mx-auto text-center\">\n            <h1 className=\"text-4xl font-bold mb-4\">Post Not Found</h1>\n            <p className=\"text-muted-foreground mb-8\">\n              The article you're looking for doesn't exist or has been removed.\n            </p>\n            <Link href=\"/#blog\">\n              <Button>\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Blog\n              </Button>\n            </Link>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n      \n      <article className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"max-w-3xl mx-auto\"\n          >\n            <Link href=\"/#blog\">\n              <Button variant=\"ghost\" className=\"mb-8 group\" data-testid=\"button-back-blog\">\n                <ArrowLeft className=\"w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform\" />\n                Back to Blog\n              </Button>\n            </Link>\n\n            <header className=\"mb-8\">\n              <div className=\"flex flex-wrap gap-2 mb-4\">\n                <Badge variant=\"secondary\" className=\"text-sm\" data-testid=\"badge-category\">\n                  {post.category}\n                </Badge>\n                {post.status === \"Draft\" && (\n                  <Badge variant=\"outline\" className=\"text-yellow-500 border-yellow-500\">\n                    Draft\n                  </Badge>\n                )}\n              </div>\n\n              <h1 \n                className=\"text-4xl md:text-5xl font-heading font-bold mb-6 leading-tight\"\n                data-testid=\"text-post-title\"\n              >\n                {post.title}\n              </h1>\n\n              {post.excerpt && (\n                <p className=\"text-xl text-muted-foreground mb-6\" data-testid=\"text-post-excerpt\">\n                  {post.excerpt}\n                </p>\n              )}\n\n              <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground\">\n                <div className=\"flex items-center gap-2\">\n                  <User className=\"w-4 h-4\" />\n                  <span data-testid=\"text-post-author\">{post.author}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span data-testid=\"text-post-date\">\n                    {formatDate(post.publishedAt || post.createdAt)}\n                  </span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"w-4 h-4\" />\n                  <span>{estimateReadTime(post.content)}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Eye className=\"w-4 h-4\" />\n                  <span>{post.views || 0} views</span>\n                </div>\n              </div>\n            </header>\n\n            <Separator className=\"my-8\" />\n\n            {post.featuredImage && (\n              <div className=\"mb-8 rounded-xl overflow-hidden\">\n                <img\n                  src={post.featuredImage}\n                  alt={post.title}\n                  className=\"w-full h-auto object-cover\"\n                />\n              </div>\n            )}\n\n            <div \n              className=\"prose prose-lg prose-invert max-w-none\n                [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mt-8 [&_h1]:mb-4\n                [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-6 [&_h2]:mb-3\n                [&_h3]:text-xl [&_h3]:font-bold [&_h3]:mt-4 [&_h3]:mb-2\n                [&_ul]:list-disc [&_ul]:ml-6\n                [&_ol]:list-decimal [&_ol]:ml-6\n                [&_li]:mb-2 [&_li]:text-foreground/90\n                [&_blockquote]:border-l-4 [&_blockquote]:border-primary [&_blockquote]:pl-4 [&_blockquote]:italic [&_blockquote]:my-4\n                [&_p]:mb-4 [&_p]:text-foreground/90 [&_p]:leading-relaxed\n                [&_strong]:font-bold\n                [&_em]:italic\n                [&_a]:text-primary [&_a]:underline [&_a]:hover:text-primary/80\n                [&_code]:bg-muted [&_code]:px-2 [&_code]:py-1 [&_code]:rounded\n                [&_pre]:bg-muted [&_pre]:p-4 [&_pre]:rounded [&_pre]:overflow-x-auto [&_pre]:my-4\"\n              data-testid=\"content-post-body\"\n              dangerouslySetInnerHTML={{ __html: post.content || \"\" }}\n            />\n\n            {post.tags && post.tags.length > 0 && (\n              <>\n                <Separator className=\"my-8\" />\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <Tag className=\"w-4 h-4 text-muted-foreground\" />\n                  {post.tags.map((tag: string) => (\n                    <Badge key={tag} variant=\"outline\" className=\"text-sm\">\n                      {tag}\n                    </Badge>\n                  ))}\n                </div>\n              </>\n            )}\n\n            <Separator className=\"my-8\" />\n\n            <div className=\"flex items-center justify-between\">\n              <Link href=\"/#blog\">\n                <Button variant=\"outline\">\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" /> More Articles\n                </Button>\n              </Link>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  if (navigator.share) {\n                    navigator.share({\n                      title: post.title,\n                      text: post.excerpt || \"\",\n                      url: window.location.href,\n                    });\n                  } else {\n                    navigator.clipboard.writeText(window.location.href);\n                  }\n                }}\n              >\n                <Share2 className=\"w-4 h-4 mr-2\" /> Share\n              </Button>\n            </div>\n\n            <CommentSection postId={post.id} title=\"Comments\" />\n          </motion.div>\n        </div>\n      </article>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":8643,"size_tokens":null},"client/src/components/admin/RichTextEditor.tsx":{"content":"import { useEditor, EditorContent } from \"@tiptap/react\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Image from \"@tiptap/extension-image\";\nimport CodeBlockLowlight from \"@tiptap/extension-code-block-lowlight\";\nimport Link from \"@tiptap/extension-link\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport Underline from \"@tiptap/extension-underline\";\nimport Placeholder from \"@tiptap/extension-placeholder\";\nimport HorizontalRule from \"@tiptap/extension-horizontal-rule\";\nimport { TextStyle } from \"@tiptap/extension-text-style\";\nimport Color from \"@tiptap/extension-color\";\nimport Highlight from \"@tiptap/extension-highlight\";\nimport Subscript from \"@tiptap/extension-subscript\";\nimport Superscript from \"@tiptap/extension-superscript\";\nimport { Table } from \"@tiptap/extension-table\";\nimport { TableRow } from \"@tiptap/extension-table-row\";\nimport { TableCell } from \"@tiptap/extension-table-cell\";\nimport { TableHeader } from \"@tiptap/extension-table-header\";\nimport { createLowlight } from \"lowlight\";\nimport javascript from \"highlight.js/lib/languages/javascript\";\nimport typescript from \"highlight.js/lib/languages/typescript\";\nimport python from \"highlight.js/lib/languages/python\";\nimport bash from \"highlight.js/lib/languages/bash\";\nimport html from \"highlight.js/lib/languages/xml\";\nimport css from \"highlight.js/lib/languages/css\";\nimport json from \"highlight.js/lib/languages/json\";\n\nconst lowlight = createLowlight();\nlowlight.register(\"js\", javascript);\nlowlight.register(\"ts\", typescript);\nlowlight.register(\"py\", python);\nlowlight.register(\"bash\", bash);\nlowlight.register(\"html\", html);\nlowlight.register(\"css\", css);\nlowlight.register(\"json\", json);\n\nimport {\n  Bold,\n  Italic,\n  Underline as UnderlineIcon,\n  Strikethrough,\n  Heading1,\n  Heading2,\n  Heading3,\n  List,\n  ListOrdered,\n  Quote,\n  Undo,\n  Redo,\n  Code2,\n  Image as ImageIcon,\n  Music,\n  AlignLeft,\n  AlignCenter,\n  AlignRight,\n  AlignJustify,\n  Link as LinkIcon,\n  Unlink,\n  Minus,\n  Highlighter,\n  Palette,\n  Table as TableIcon,\n  Plus,\n  Trash2,\n  Subscript as SubscriptIcon,\n  Superscript as SuperscriptIcon,\n  MoreHorizontal,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useState, useRef, useCallback, useEffect } from \"react\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { cn } from \"@/lib/utils\";\n\ninterface RichTextEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n}\n\nconst COLORS = [\n  \"#000000\", \"#374151\", \"#6B7280\", \"#9CA3AF\",\n  \"#EF4444\", \"#F97316\", \"#F59E0B\", \"#EAB308\",\n  \"#22C55E\", \"#10B981\", \"#14B8A6\", \"#06B6D4\",\n  \"#3B82F6\", \"#6366F1\", \"#8B5CF6\", \"#A855F7\",\n  \"#EC4899\", \"#F43F5E\", \"#FFFFFF\", \"#F3F4F6\",\n];\n\nconst HIGHLIGHT_COLORS = [\n  \"#FEF08A\", \"#FECACA\", \"#BBF7D0\", \"#BFDBFE\",\n  \"#DDD6FE\", \"#FBCFE8\", \"#FED7AA\", \"#E5E7EB\",\n];\n\nexport function RichTextEditor({ value, onChange, placeholder = \"Write your content...\" }: RichTextEditorProps) {\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const audioInputRef = useRef<HTMLInputElement>(null);\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [showImageDialog, setShowImageDialog] = useState(false);\n  const [audioUrl, setAudioUrl] = useState(\"\");\n  const [showAudioDialog, setShowAudioDialog] = useState(false);\n  const [linkUrl, setLinkUrl] = useState(\"\");\n  const [showLinkDialog, setShowLinkDialog] = useState(false);\n\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        codeBlock: false,\n        heading: {\n          levels: [1, 2, 3],\n        },\n      }),\n      CodeBlockLowlight.configure({\n        lowlight,\n        defaultLanguage: \"javascript\",\n      }),\n      Image.configure({\n        allowBase64: true,\n        HTMLAttributes: {\n          class: 'max-w-full h-auto rounded-lg',\n        },\n      }),\n      Link.configure({\n        openOnClick: false,\n        HTMLAttributes: {\n          class: 'text-primary underline cursor-pointer',\n        },\n      }),\n      TextAlign.configure({\n        types: ['heading', 'paragraph'],\n      }),\n      Underline,\n      Placeholder.configure({\n        placeholder,\n      }),\n      HorizontalRule,\n      TextStyle,\n      Color,\n      Highlight.configure({\n        multicolor: true,\n      }),\n      Subscript,\n      Superscript,\n      Table.configure({\n        resizable: true,\n        HTMLAttributes: {\n          class: 'border-collapse table-auto w-full',\n        },\n      }),\n      TableRow,\n      TableHeader,\n      TableCell,\n    ],\n    content: value,\n    onUpdate: ({ editor }) => {\n      onChange(editor.getHTML());\n    },\n  });\n\n  useEffect(() => {\n    if (editor && value !== editor.getHTML()) {\n      editor.commands.setContent(value, { emitUpdate: false });\n    }\n  }, [value, editor]);\n\n  const setLink = useCallback(() => {\n    if (!editor) return;\n    \n    if (linkUrl === '') {\n      editor.chain().focus().extendMarkRange('link').unsetLink().run();\n      return;\n    }\n\n    const url = linkUrl.startsWith('http') ? linkUrl : `https://${linkUrl}`;\n    editor.chain().focus().extendMarkRange('link').setLink({ href: url }).run();\n    setLinkUrl('');\n    setShowLinkDialog(false);\n  }, [editor, linkUrl]);\n\n  if (!editor) {\n    return null;\n  }\n\n  const ToolbarButton = ({ \n    onClick, \n    isActive = false, \n    disabled = false,\n    title,\n    children \n  }: { \n    onClick: () => void; \n    isActive?: boolean; \n    disabled?: boolean;\n    title: string;\n    children: React.ReactNode;\n  }) => (\n    <Button\n      type=\"button\"\n      size=\"sm\"\n      variant=\"ghost\"\n      onClick={onClick}\n      disabled={disabled}\n      title={title}\n      className={cn(\n        \"h-8 w-8 p-0\",\n        isActive && \"bg-muted text-primary\"\n      )}\n    >\n      {children}\n    </Button>\n  );\n\n  const handleImageFile = (file: File) => {\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const dataUrl = e.target?.result as string;\n      editor.chain().focus().setImage({ src: dataUrl }).run();\n      setShowImageDialog(false);\n      setImageUrl(\"\");\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleAudioFile = (file: File) => {\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const dataUrl = e.target?.result as string;\n      editor\n        .chain()\n        .focus()\n        .insertContent(\n          `<audio controls style=\"width: 100%; margin: 10px 0;\"><source src=\"${dataUrl}\" type=\"${file.type}\" />Your browser does not support the audio element.</audio>`\n        )\n        .run();\n      setShowAudioDialog(false);\n      setAudioUrl(\"\");\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const insertImageFromUrl = () => {\n    if (imageUrl.trim()) {\n      editor.chain().focus().setImage({ src: imageUrl }).run();\n      setShowImageDialog(false);\n      setImageUrl(\"\");\n    }\n  };\n\n  const insertAudioFromUrl = () => {\n    if (audioUrl.trim()) {\n      const ext = audioUrl.split(\".\").pop()?.toLowerCase() || \"mp3\";\n      const mimeTypes: { [key: string]: string } = {\n        mp3: \"audio/mpeg\",\n        wav: \"audio/wav\",\n        ogg: \"audio/ogg\",\n        m4a: \"audio/mp4\",\n      };\n      const mimeType = mimeTypes[ext] || \"audio/mpeg\";\n\n      editor\n        .chain()\n        .focus()\n        .insertContent(\n          `<audio controls style=\"width: 100%; margin: 10px 0;\"><source src=\"${audioUrl}\" type=\"${mimeType}\" />Your browser does not support the audio element.</audio>`\n        )\n        .run();\n      setShowAudioDialog(false);\n      setAudioUrl(\"\");\n    }\n  };\n\n  return (\n    <div className=\"border rounded-lg overflow-hidden bg-background\">\n      <div className=\"bg-muted/30 p-2 border-b flex flex-wrap items-center gap-0.5\">\n        <div className=\"flex items-center\">\n          <ToolbarButton\n            onClick={() => editor.chain().focus().undo().run()}\n            disabled={!editor.can().undo()}\n            title=\"Undo\"\n          >\n            <Undo className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().redo().run()}\n            disabled={!editor.can().redo()}\n            title=\"Redo\"\n          >\n            <Redo className=\"w-4 h-4\" />\n          </ToolbarButton>\n        </div>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 gap-1 px-2\">\n              <Heading1 className=\"w-4 h-4\" />\n              <span className=\"text-xs\">Heading</span>\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent>\n            <DropdownMenuItem onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}>\n              <Heading1 className=\"w-4 h-4 mr-2\" /> Heading 1\n            </DropdownMenuItem>\n            <DropdownMenuItem onClick={() => editor.chain().focus().toggleHeading({ level: 2 }).run()}>\n              <Heading2 className=\"w-4 h-4 mr-2\" /> Heading 2\n            </DropdownMenuItem>\n            <DropdownMenuItem onClick={() => editor.chain().focus().toggleHeading({ level: 3 }).run()}>\n              <Heading3 className=\"w-4 h-4 mr-2\" /> Heading 3\n            </DropdownMenuItem>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem onClick={() => editor.chain().focus().setParagraph().run()}>\n              Paragraph\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <div className=\"flex items-center\">\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleBold().run()}\n            isActive={editor.isActive(\"bold\")}\n            title=\"Bold\"\n          >\n            <Bold className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleItalic().run()}\n            isActive={editor.isActive(\"italic\")}\n            title=\"Italic\"\n          >\n            <Italic className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleUnderline().run()}\n            isActive={editor.isActive(\"underline\")}\n            title=\"Underline\"\n          >\n            <UnderlineIcon className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleStrike().run()}\n            isActive={editor.isActive(\"strike\")}\n            title=\"Strikethrough\"\n          >\n            <Strikethrough className=\"w-4 h-4\" />\n          </ToolbarButton>\n        </div>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <Popover>\n          <PopoverTrigger asChild>\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\" title=\"Text Color\">\n              <Palette className=\"w-4 h-4\" />\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-auto p-2\">\n            <div className=\"grid grid-cols-5 gap-1\">\n              {COLORS.map((color) => (\n                <button\n                  key={color}\n                  className=\"w-6 h-6 rounded border border-border hover:scale-110 transition-transform\"\n                  style={{ backgroundColor: color }}\n                  onClick={() => editor.chain().focus().setColor(color).run()}\n                />\n              ))}\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"w-full mt-2\"\n              onClick={() => editor.chain().focus().unsetColor().run()}\n            >\n              Reset Color\n            </Button>\n          </PopoverContent>\n        </Popover>\n\n        <Popover>\n          <PopoverTrigger asChild>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className={cn(\"h-8 w-8 p-0\", editor.isActive(\"highlight\") && \"bg-muted\")}\n              title=\"Highlight\"\n            >\n              <Highlighter className=\"w-4 h-4\" />\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-auto p-2\">\n            <div className=\"grid grid-cols-4 gap-1\">\n              {HIGHLIGHT_COLORS.map((color) => (\n                <button\n                  key={color}\n                  className=\"w-6 h-6 rounded border border-border hover:scale-110 transition-transform\"\n                  style={{ backgroundColor: color }}\n                  onClick={() => editor.chain().focus().toggleHighlight({ color }).run()}\n                />\n              ))}\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"w-full mt-2\"\n              onClick={() => editor.chain().focus().unsetHighlight().run()}\n            >\n              Remove Highlight\n            </Button>\n          </PopoverContent>\n        </Popover>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <div className=\"flex items-center\">\n          <ToolbarButton\n            onClick={() => editor.chain().focus().setTextAlign('left').run()}\n            isActive={editor.isActive({ textAlign: 'left' })}\n            title=\"Align Left\"\n          >\n            <AlignLeft className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().setTextAlign('center').run()}\n            isActive={editor.isActive({ textAlign: 'center' })}\n            title=\"Align Center\"\n          >\n            <AlignCenter className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().setTextAlign('right').run()}\n            isActive={editor.isActive({ textAlign: 'right' })}\n            title=\"Align Right\"\n          >\n            <AlignRight className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().setTextAlign('justify').run()}\n            isActive={editor.isActive({ textAlign: 'justify' })}\n            title=\"Justify\"\n          >\n            <AlignJustify className=\"w-4 h-4\" />\n          </ToolbarButton>\n        </div>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <div className=\"flex items-center\">\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleBulletList().run()}\n            isActive={editor.isActive(\"bulletList\")}\n            title=\"Bullet List\"\n          >\n            <List className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleOrderedList().run()}\n            isActive={editor.isActive(\"orderedList\")}\n            title=\"Ordered List\"\n          >\n            <ListOrdered className=\"w-4 h-4\" />\n          </ToolbarButton>\n        </div>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <div className=\"flex items-center\">\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleBlockquote().run()}\n            isActive={editor.isActive(\"blockquote\")}\n            title=\"Quote\"\n          >\n            <Quote className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().toggleCodeBlock().run()}\n            isActive={editor.isActive(\"codeBlock\")}\n            title=\"Code Block\"\n          >\n            <Code2 className=\"w-4 h-4\" />\n          </ToolbarButton>\n          <ToolbarButton\n            onClick={() => editor.chain().focus().setHorizontalRule().run()}\n            title=\"Horizontal Line\"\n          >\n            <Minus className=\"w-4 h-4\" />\n          </ToolbarButton>\n        </div>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <Popover open={showLinkDialog} onOpenChange={setShowLinkDialog}>\n          <PopoverTrigger asChild>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className={cn(\"h-8 w-8 p-0\", editor.isActive(\"link\") && \"bg-muted\")}\n              title=\"Insert Link\"\n            >\n              <LinkIcon className=\"w-4 h-4\" />\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-80\">\n            <div className=\"space-y-3\">\n              <Label>Link URL</Label>\n              <Input\n                value={linkUrl}\n                onChange={(e) => setLinkUrl(e.target.value)}\n                placeholder=\"https://example.com\"\n                onKeyDown={(e) => e.key === 'Enter' && setLink()}\n              />\n              <div className=\"flex gap-2\">\n                <Button size=\"sm\" onClick={setLink} className=\"flex-1\">\n                  Insert Link\n                </Button>\n                {editor.isActive(\"link\") && (\n                  <Button \n                    size=\"sm\" \n                    variant=\"destructive\"\n                    onClick={() => editor.chain().focus().unsetLink().run()}\n                  >\n                    <Unlink className=\"w-4 h-4\" />\n                  </Button>\n                )}\n              </div>\n            </div>\n          </PopoverContent>\n        </Popover>\n\n        <ToolbarButton\n          onClick={() => setShowImageDialog(true)}\n          title=\"Insert Image\"\n        >\n          <ImageIcon className=\"w-4 h-4\" />\n        </ToolbarButton>\n\n        <ToolbarButton\n          onClick={() => setShowAudioDialog(true)}\n          title=\"Insert Audio\"\n        >\n          <Music className=\"w-4 h-4\" />\n        </ToolbarButton>\n\n        <Separator orientation=\"vertical\" className=\"mx-1 h-6\" />\n\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className={cn(\"h-8 w-8 p-0\", editor.isActive(\"table\") && \"bg-muted\")}\n              title=\"Table\"\n            >\n              <TableIcon className=\"w-4 h-4\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent>\n            <DropdownMenuItem onClick={() => editor.chain().focus().insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run()}>\n              <Plus className=\"w-4 h-4 mr-2\" /> Insert Table\n            </DropdownMenuItem>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().addColumnBefore().run()}\n              disabled={!editor.can().addColumnBefore()}\n            >\n              Add Column Before\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().addColumnAfter().run()}\n              disabled={!editor.can().addColumnAfter()}\n            >\n              Add Column After\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().deleteColumn().run()}\n              disabled={!editor.can().deleteColumn()}\n            >\n              Delete Column\n            </DropdownMenuItem>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().addRowBefore().run()}\n              disabled={!editor.can().addRowBefore()}\n            >\n              Add Row Before\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().addRowAfter().run()}\n              disabled={!editor.can().addRowAfter()}\n            >\n              Add Row After\n            </DropdownMenuItem>\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().deleteRow().run()}\n              disabled={!editor.can().deleteRow()}\n            >\n              Delete Row\n            </DropdownMenuItem>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem \n              onClick={() => editor.chain().focus().deleteTable().run()}\n              disabled={!editor.can().deleteTable()}\n              className=\"text-destructive\"\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" /> Delete Table\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\" title=\"More Options\">\n              <MoreHorizontal className=\"w-4 h-4\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent>\n            <DropdownMenuItem onClick={() => editor.chain().focus().toggleSubscript().run()}>\n              <SubscriptIcon className=\"w-4 h-4 mr-2\" /> Subscript\n            </DropdownMenuItem>\n            <DropdownMenuItem onClick={() => editor.chain().focus().toggleSuperscript().run()}>\n              <SuperscriptIcon className=\"w-4 h-4 mr-2\" /> Superscript\n            </DropdownMenuItem>\n            <DropdownMenuSeparator />\n            <DropdownMenuItem onClick={() => editor.chain().focus().clearNodes().unsetAllMarks().run()}>\n              Clear Formatting\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n\n      <EditorContent\n        editor={editor}\n        className=\"prose prose-sm dark:prose-invert max-w-none p-4 focus:outline-none min-h-64\n          [&_.ProseMirror]:outline-none\n          [&_.ProseMirror]:min-h-[200px]\n          [&_.ProseMirror_p.is-editor-empty:first-child::before]:text-muted-foreground\n          [&_.ProseMirror_p.is-editor-empty:first-child::before]:content-[attr(data-placeholder)]\n          [&_.ProseMirror_p.is-editor-empty:first-child::before]:float-left\n          [&_.ProseMirror_p.is-editor-empty:first-child::before]:h-0\n          [&_.ProseMirror_p.is-editor-empty:first-child::before]:pointer-events-none\n          [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mt-6 [&_h1]:mb-4\n          [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-5 [&_h2]:mb-3\n          [&_h3]:text-xl [&_h3]:font-bold [&_h3]:mt-4 [&_h3]:mb-2\n          [&_ul]:list-disc [&_ul]:ml-6 [&_ul]:my-2\n          [&_ol]:list-decimal [&_ol]:ml-6 [&_ol]:my-2\n          [&_li]:my-1\n          [&_blockquote]:border-l-4 [&_blockquote]:border-primary [&_blockquote]:pl-4 [&_blockquote]:italic [&_blockquote]:my-4\n          [&_p]:mb-3 [&_p]:leading-relaxed\n          [&_code]:bg-muted [&_code]:px-1.5 [&_code]:py-0.5 [&_code]:rounded [&_code]:text-sm [&_code]:font-mono\n          [&_pre]:bg-muted [&_pre]:p-4 [&_pre]:rounded-lg [&_pre]:overflow-x-auto [&_pre]:my-4 [&_pre]:border\n          [&_img]:max-w-full [&_img]:h-auto [&_img]:rounded-lg [&_img]:my-4\n          [&_audio]:w-full [&_audio]:my-4\n          [&_hr]:my-6 [&_hr]:border-border\n          [&_table]:border-collapse [&_table]:w-full [&_table]:my-4\n          [&_th]:border [&_th]:border-border [&_th]:p-2 [&_th]:bg-muted [&_th]:font-semibold\n          [&_td]:border [&_td]:border-border [&_td]:p-2\n          [&_a]:text-primary [&_a]:underline\"\n      />\n\n      <input\n        type=\"file\"\n        ref={imageInputRef}\n        accept=\"image/*\"\n        onChange={(e) => {\n          const file = e.currentTarget.files?.[0];\n          if (file) handleImageFile(file);\n        }}\n        className=\"hidden\"\n      />\n\n      <input\n        type=\"file\"\n        ref={audioInputRef}\n        accept=\"audio/*\"\n        onChange={(e) => {\n          const file = e.currentTarget.files?.[0];\n          if (file) handleAudioFile(file);\n        }}\n        className=\"hidden\"\n      />\n\n      {showImageDialog && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-background border rounded-lg p-6 max-w-md w-full shadow-xl\">\n            <h3 className=\"text-lg font-bold mb-4\">Insert Image</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <Label className=\"mb-2 block\">Image URL</Label>\n                <Input\n                  value={imageUrl}\n                  onChange={(e) => setImageUrl(e.target.value)}\n                  placeholder=\"https://example.com/image.jpg\"\n                />\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  onClick={() => imageInputRef.current?.click()}\n                  className=\"flex-1\"\n                  variant=\"outline\"\n                >\n                  Upload File\n                </Button>\n                <Button onClick={insertImageFromUrl} className=\"flex-1\">\n                  Insert URL\n                </Button>\n              </div>\n              <Button\n                variant=\"ghost\"\n                onClick={() => {\n                  setShowImageDialog(false);\n                  setImageUrl(\"\");\n                }}\n                className=\"w-full\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {showAudioDialog && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-background border rounded-lg p-6 max-w-md w-full shadow-xl\">\n            <h3 className=\"text-lg font-bold mb-4\">Insert Audio</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <Label className=\"mb-2 block\">Audio URL</Label>\n                <Input\n                  value={audioUrl}\n                  onChange={(e) => setAudioUrl(e.target.value)}\n                  placeholder=\"https://example.com/audio.mp3\"\n                />\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  onClick={() => audioInputRef.current?.click()}\n                  className=\"flex-1\"\n                  variant=\"outline\"\n                >\n                  Upload File\n                </Button>\n                <Button onClick={insertAudioFromUrl} className=\"flex-1\">\n                  Insert URL\n                </Button>\n              </div>\n              <Button\n                variant=\"ghost\"\n                onClick={() => {\n                  setShowAudioDialog(false);\n                  setAudioUrl(\"\");\n                }}\n                className=\"w-full\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":26561,"size_tokens":null},"server/websocket.ts":{"content":"import { WebSocketServer, WebSocket } from \"ws\";\nimport type { Server } from \"http\";\nimport type { Message, Comment, Review } from \"@shared/schema\";\n\nlet wss: WebSocketServer | null = null;\n\nexport function setupWebSocket(server: Server) {\n  // Use the same port as the HTTP server, no separate port needed\n  wss = new WebSocketServer({ \n    server, \n    path: \"/ws\",\n    perMessageDeflate: false,\n    clientTracking: true\n  });\n\n  wss.on(\"connection\", (ws: WebSocket) => {\n    ws.on(\"close\", (code: number, reason: Buffer) => {\n      // Connection closed - clients will automatically reconnect\n    });\n\n    ws.on(\"error\", (error: Error) => {\n      // WebSocket error - connection will be terminated\n      ws.terminate();\n    });\n  });\n\n  return wss;\n}\n\nexport function broadcastNewMessage(message: Message) {\n  if (!wss) return;\n\n  const payload = JSON.stringify({\n    type: \"NEW_MESSAGE\",\n    data: message,\n  });\n\n  wss.clients.forEach((client) => {\n    if (client.readyState === WebSocket.OPEN) {\n      client.send(payload);\n    }\n  });\n}\n\nexport function broadcastNotification(notification: { type: string; message: string; data?: any }) {\n  if (!wss) return;\n\n  const payload = JSON.stringify({\n    type: \"NOTIFICATION\",\n    data: notification,\n  });\n\n  wss.clients.forEach((client) => {\n    if (client.readyState === WebSocket.OPEN) {\n      client.send(payload);\n    }\n  });\n}\n\nexport function broadcastNewComment(comment: Comment) {\n  if (!wss) return;\n\n  const payload = JSON.stringify({\n    type: \"NEW_COMMENT\",\n    data: comment,\n  });\n\n  wss.clients.forEach((client) => {\n    if (client.readyState === WebSocket.OPEN) {\n      client.send(payload);\n    }\n  });\n}\n\nexport function broadcastNewReview(review: Review) {\n  if (!wss) return;\n\n  const payload = JSON.stringify({\n    type: \"NEW_REVIEW\",\n    data: review,\n  });\n\n  wss.clients.forEach((client) => {\n    if (client.readyState === WebSocket.OPEN) {\n      client.send(payload);\n    }\n  });\n}\n","path":null,"size_bytes":1959,"size_tokens":null},"client/src/pages/admin/Profile.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Camera, Save, Mail, User as UserIcon, Shield, Clock, AlertCircle, Check } from \"lucide-react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { api } from \"@/lib/api\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { z } from \"zod\";\n\nconst passwordSchema = z.object({\n  currentPassword: z.string().min(1, \"Current password is required\"),\n  newPassword: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype PasswordForm = z.infer<typeof passwordSchema>;\n\nexport default function AdminProfile() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isEditing, setIsEditing] = useState(false);\n  const [avatarPreview, setAvatarPreview] = useState<string>(\"\");\n  const [isUploadingImage, setIsUploadingImage] = useState(false);\n  const [isPasswordModalOpen, setIsPasswordModalOpen] = useState(false);\n  const [passwordForm, setPasswordForm] = useState({\n    currentPassword: \"\",\n    newPassword: \"\",\n    confirmPassword: \"\",\n  });\n  const [passwordErrors, setPasswordErrors] = useState<Partial<PasswordForm>>({});\n  const [formData, setFormData] = useState({\n    name: \"\",\n    email: \"\",\n    username: \"\",\n    avatar: \"\",\n  });\n\n  const { data: currentUser, isLoading } = useQuery({\n    queryKey: [\"currentUser\"],\n    queryFn: api.getCurrentUser,\n  });\n\n  useEffect(() => {\n    if (currentUser) {\n      setFormData({\n        name: currentUser.name || \"\",\n        email: currentUser.email || \"\",\n        username: currentUser.username || \"\",\n        avatar: currentUser.avatar || \"\",\n      });\n      setAvatarPreview(currentUser.avatar || \"/avatars/01.png\");\n    }\n  }, [currentUser]);\n\n  const updateMutation = useMutation({\n    mutationFn: (data: any) => api.updateProfile(data),\n    onSuccess: (response: any) => {\n      queryClient.setQueryData([\"currentUser\"], response);\n      queryClient.invalidateQueries({ queryKey: [\"currentUser\"] });\n      setFormData({\n        name: response.name || \"\",\n        email: response.email || \"\",\n        username: response.username || \"\",\n        avatar: response.avatar || \"\",\n      });\n      setAvatarPreview(response.avatar || \"/avatars/01.png\");\n      setIsEditing(false);\n      toast({\n        title: \"Profile Updated\",\n        description: \"Your profile has been updated successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update profile.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const passwordMutation = useMutation({\n    mutationFn: (data: PasswordForm) => api.changePassword(data.currentPassword, data.newPassword),\n    onSuccess: () => {\n      setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n      setPasswordErrors({});\n      setIsPasswordModalOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Your password has been changed successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to change password.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSave = async () => {\n    if (!currentUser) return;\n    updateMutation.mutate(formData);\n  };\n\n  const handleCancel = () => {\n    setFormData({\n      name: currentUser?.name || \"\",\n      email: currentUser?.email || \"\",\n      username: currentUser?.username || \"\",\n      avatar: currentUser?.avatar || \"\",\n    });\n    setAvatarPreview(currentUser?.avatar || \"/avatars/01.png\");\n    setIsEditing(false);\n  };\n\n  const handleChangePassword = () => {\n    setPasswordErrors({});\n    const result = passwordSchema.safeParse(passwordForm);\n    if (!result.success) {\n      const errors: Partial<PasswordForm> = {};\n      result.error.errors.forEach((err) => {\n        if (err.path[0]) {\n          errors[err.path[0] as keyof PasswordForm] = { message: err.message } as any;\n        }\n      });\n      setPasswordErrors(errors);\n      return;\n    }\n    passwordMutation.mutate(result.data);\n  };\n\n  const handleClosePasswordModal = () => {\n    setIsPasswordModalOpen(false);\n    setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n    setPasswordErrors({});\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Invalid file\",\n        description: \"Please select an image file.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"File too large\",\n        description: \"Image size must be less than 5MB.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        try {\n          const base64 = event.target?.result as string;\n          const result = await api.uploadImage(base64);\n          setFormData({ ...formData, avatar: result.url });\n          setAvatarPreview(result.url);\n          toast({\n            title: \"Success\",\n            description: \"Image uploaded successfully.\",\n          });\n        } catch (error: any) {\n          toast({\n            title: \"Upload failed\",\n            description: error.message || \"Failed to upload image.\",\n            variant: \"destructive\",\n          });\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to process image.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploadingImage(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"text-muted-foreground\">Loading...</div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  if (!currentUser) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"text-muted-foreground\">Please log in to view your profile</div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6 max-w-4xl mx-auto\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">My Profile</h1>\n            <p className=\"text-muted-foreground\">Manage your account information</p>\n          </div>\n          {!isEditing ? (\n            <Button onClick={() => setIsEditing(true)}>Edit Profile</Button>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={handleCancel}>Cancel</Button>\n              <Button onClick={handleSave} disabled={updateMutation.isPending}>\n                <Save className=\"w-4 h-4 mr-2\" />\n                {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid gap-6\">\n          {/* Profile Header Card */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex flex-col sm:flex-row items-center sm:items-start gap-6\">\n                <div className=\"relative\">\n                  <Avatar className=\"h-24 w-24\">\n                    <AvatarImage src={avatarPreview} alt={currentUser.name} />\n                    <AvatarFallback className=\"text-2xl\">\n                      {currentUser.name.charAt(0).toUpperCase()}\n                    </AvatarFallback>\n                  </Avatar>\n                  {isEditing && (\n                    <>\n                      <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        onChange={handleImageUpload}\n                        disabled={isUploadingImage}\n                        data-testid=\"input-avatar-upload\"\n                      />\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\" \n                        className=\"absolute bottom-0 right-0 h-8 w-8 rounded-full\"\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={isUploadingImage}\n                        type=\"button\"\n                        data-testid=\"button-upload-avatar\"\n                      >\n                        <Camera className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  )}\n                </div>\n                <div className=\"flex-1 text-center sm:text-left space-y-1\">\n                  <h2 className=\"text-2xl font-bold\">{currentUser.name}</h2>\n                  <p className=\"text-muted-foreground\">@{currentUser.username}</p>\n                  <div className=\"flex flex-wrap gap-2 justify-center sm:justify-start pt-2\">\n                    <div className=\"flex items-center gap-1 px-3 py-1 bg-primary/10 text-primary rounded-full text-sm\">\n                      <Shield className=\"w-3 h-3\" />\n                      {currentUser.role}\n                    </div>\n                    <div className={`flex items-center gap-1 px-3 py-1 rounded-full text-sm ${\n                      currentUser.status === \"Active\" \n                        ? \"bg-green-500/10 text-green-500\" \n                        : \"bg-red-500/10 text-red-500\"\n                    }`}>\n                      <div className=\"w-2 h-2 rounded-full bg-current\" />\n                      {currentUser.status}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Personal Information Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Personal Information</CardTitle>\n              <CardDescription>Update your personal details</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid sm:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Full Name</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <UserIcon className=\"w-4 h-4 text-muted-foreground\" />\n                    <Input\n                      id=\"name\"\n                      value={formData.name}\n                      onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                      disabled={!isEditing}\n                      className={!isEditing ? \"bg-muted\" : \"\"}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"username\">Username</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <UserIcon className=\"w-4 h-4 text-muted-foreground\" />\n                    <Input\n                      id=\"username\"\n                      value={formData.username}\n                      onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                      disabled={!isEditing}\n                      className={!isEditing ? \"bg-muted\" : \"\"}\n                    />\n                  </div>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email Address</Label>\n                <div className=\"flex items-center gap-2\">\n                  <Mail className=\"w-4 h-4 text-muted-foreground\" />\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                    disabled={!isEditing}\n                    className={!isEditing ? \"bg-muted\" : \"\"}\n                  />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Account Information Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Account Information</CardTitle>\n              <CardDescription>View your account details</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid sm:grid-cols-2 gap-6\">\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Account Role</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Shield className=\"w-4 h-4 text-primary\" />\n                    <span className=\"font-medium\">{currentUser.role}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Account Status</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <div className={`w-2 h-2 rounded-full ${\n                      currentUser.status === \"Active\" ? \"bg-green-500\" : \"bg-red-500\"\n                    }`} />\n                    <span className=\"font-medium\">{currentUser.status}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Member Since</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                    <span className=\"font-medium\">\n                      {currentUser.createdAt \n                        ? new Date(currentUser.createdAt).toLocaleDateString()\n                        : \"N/A\"}\n                    </span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Last Active</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                    <span className=\"font-medium\">\n                      {currentUser.lastActive \n                        ? formatDistanceToNow(new Date(currentUser.lastActive), { addSuffix: true })\n                        : \"Never\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Security Settings Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Security Settings</CardTitle>\n              <CardDescription>Manage your password and security preferences</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <Button \n                variant=\"outline\" \n                className=\"w-full sm:w-auto\"\n                onClick={() => setIsPasswordModalOpen(true)}\n                data-testid=\"button-change-password\"\n              >\n                Change Password\n              </Button>\n              <Separator />\n              <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                <div>\n                  <p className=\"font-medium\">Two-Factor Authentication</p>\n                  <p className=\"text-sm text-muted-foreground\">Add an extra layer of security</p>\n                </div>\n                <Button variant=\"outline\" size=\"sm\">Enable</Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* Change Password Dialog */}\n      <Dialog open={isPasswordModalOpen} onOpenChange={handleClosePasswordModal}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Change Password</DialogTitle>\n            <DialogDescription>\n              Enter your current password and a new password to change it.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"current-password\">Current Password</Label>\n              <Input\n                id=\"current-password\"\n                type=\"password\"\n                value={passwordForm.currentPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, currentPassword: e.target.value })}\n                placeholder=\"Enter your current password\"\n                data-testid=\"input-current-password\"\n              />\n              {passwordErrors.currentPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.currentPassword as any).message}\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"new-password\">New Password</Label>\n              <Input\n                id=\"new-password\"\n                type=\"password\"\n                value={passwordForm.newPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, newPassword: e.target.value })}\n                placeholder=\"Enter your new password (minimum 8 characters)\"\n                data-testid=\"input-new-password\"\n              />\n              {passwordErrors.newPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.newPassword as any).message}\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirm-password\">Confirm New Password</Label>\n              <Input\n                id=\"confirm-password\"\n                type=\"password\"\n                value={passwordForm.confirmPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, confirmPassword: e.target.value })}\n                placeholder=\"Confirm your new password\"\n                data-testid=\"input-confirm-password\"\n              />\n              {passwordErrors.confirmPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.confirmPassword as any).message}\n                </p>\n              )}\n            </div>\n          </div>\n          <DialogFooter className=\"flex gap-2 justify-end\">\n            <Button \n              variant=\"outline\" \n              onClick={handleClosePasswordModal}\n              data-testid=\"button-cancel-password\"\n            >\n              Cancel\n            </Button>\n            <Button \n              onClick={handleChangePassword}\n              disabled={passwordMutation.isPending}\n              data-testid=\"button-save-password\"\n            >\n              {passwordMutation.isPending ? \"Saving...\" : \"Change Password\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":20071,"size_tokens":null},"client/src/hooks/use-websocket.ts":{"content":"import { useEffect, useRef, useCallback, useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQueryClient } from \"@tanstack/react-query\";\n\ninterface WebSocketMessage {\n  type: string;\n  data: any;\n}\n\nconst notificationSound = new Audio(\"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleR8LYLTl23NeABaZ4edeRAAcr+NuNQ4Rut94JQAOx+9xGgAPzu9nCgAP1e9dAAAA3u9QAAAE4u9BAAAI5e8wAAAM6O8eAAAQ6+8LAAAb8vIADgAm+vgHEQAy//4NEgA7//8RDgA9//8YCAA8//8bAgA3//8e/AA0//8h+QAv//8k9gAp//8n8gAi//8q7gAa//8t6wAT//8wygAM//8z0AAF//826QAA//865v/7//8+4v/3//9B3v/x//9E1v/r//9Hzv/l//9Kxv/f//9Nvv/Z//9Qtv/T//9Trv/N//9WqP/I//9Zo//C//9cnf++//9fl//5//9jkf/0//9mix/v//9ph//q//9sgf/l//9wff/h//90eP/d//94c//Y//98bv/U//+AaP/Q///Egf7L///IY/7H///MXf7D///QWP6///TUUv67///YTP63///cRv6z///gP/6w///kOf6s///oM/6p///sLf6l///wJ/6h///0Iv6e///4HP6a///8Fv6W//8AEf6T//8EC/6P//8IBf6M//8MA/6I//8QAP6F//8U/v6B//8Y+/5+//8c+P57//8g9f54//8k8v51//8o7/5y//8s7P5v//8w6f5s//807v5p//847/5m//8++f5k//9C//5h//9GC/5e//9KGP5b//9OJf5Y//9SM/5V//9WQP5S//9aTv5P//9eXP5N//9ia/5K//9mef5H//9qh/5E//9ulv5B//9ypf4+//92s/47//96wf44//9+z/41///CUf4z///GMP4x///KD/4u///O7v0r///S0P0o///Wrf0l///anf0i///erv0f///ipP0c///mff0a///qav0X///uVf0U///yQP0R///2K/0O///6Fv0L///+Af0I//8C7fwF//8G2PwC//8Kw/z///8Orvz8//8SmPz5//8Wg/z2//8abfzz//8eV/zw//8iQfzt//8mK/zq//8qFfzn//8u//8vl//8y6fvi//826/vf//86yfvc//8+q/vZ///Gcf3X///KVP3U///OO/3R///SNf3O///WMP3L///aLv3I///eLP3F///iKv3C///mLP2////qLv28///uMv26//8yOf24//82QP21//86Sf2z//8+U/2w///CV/2t///GXf2q///Kd/2n///Od/2l///Sbv2i///WVf2f///aO/2c///eH/2Z///iA/2W///m5/yT///q0PyR///uuPyO//8yof6L//82if6I//86cf6F//8+Wf6C///CQf5////GKf58///KD/55///O9f12///S2/1z///WwP1w///aqP1t///elv1q///inP1n///mwP1k///q6v1h///uFP5e//8yQP5b//82bP5Y//86mP5V//8+xP5S///C8P5P///GHP9M///KSP9J///OdP9G///SoP9D///WzP9A///a+P89///e\" + \"//86///i//83///m//80///q//8x///u//8u//8y//8r//82//8o//86//8l//8+//8i///C//8f///G//8c///K//8Z///O//8W///S//8T///W//8Q///a//8N///e//8K///i//8H///m//8E///q//8B///u/////8=\");\n\nexport function useWebSocket() {\n  const wsRef = useRef<WebSocket | null>(null);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const isClosingRef = useRef(false);\n  const [isConnected, setIsConnected] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const playNotificationSound = useCallback(() => {\n    notificationSound.currentTime = 0;\n    notificationSound.volume = 0.5;\n    notificationSound.play().catch(() => {});\n  }, []);\n\n  const connect = useCallback(() => {\n    if (isClosingRef.current) return;\n    if (wsRef.current?.readyState === WebSocket.OPEN || wsRef.current?.readyState === WebSocket.CONNECTING) return;\n\n    const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n    const wsUrl = `${protocol}//${window.location.host}/ws`;\n\n    try {\n      // Close existing connection if any\n      if (wsRef.current) {\n        wsRef.current.close();\n        wsRef.current = null;\n      }\n      \n      wsRef.current = new WebSocket(wsUrl);\n\n      wsRef.current.onopen = () => {\n        if (!isClosingRef.current) {\n          setIsConnected(true);\n        }\n      };\n\n      wsRef.current.onmessage = async (event) => {\n        try {\n          const message: WebSocketMessage = JSON.parse(event.data);\n\n          if (message.type === \"NEW_MESSAGE\") {\n            playNotificationSound();\n\n            toast({\n              title: \"New Contact Message\",\n              description: `${message.data?.sender || 'Someone'}: ${message.data?.subject || \"No subject\"}`,\n              duration: 5000,\n            });\n\n            queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n          }\n\n          const isNewComment = message.type === \"NEW_COMMENT\" || \n            (message.type === \"NOTIFICATION\" && message.data?.type === \"NEW_COMMENT\");\n\n          if (isNewComment) {\n            playNotificationSound();\n            const commentData = message.type === \"NEW_COMMENT\" ? message.data : message.data?.data;\n            const msgText = message.type === \"NOTIFICATION\" \n              ? message.data?.message \n              : `New comment from ${commentData?.authorName || 'Someone'}`;\n\n            toast({\n              title: \"New Comment\",\n              description: msgText || \"New comment received\",\n              duration: 5000,\n            });\n\n            queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n          }\n\n          const isNewReview = message.type === \"NEW_REVIEW\" || \n            (message.type === \"NOTIFICATION\" && message.data?.type === \"NEW_REVIEW\");\n\n          if (isNewReview) {\n            playNotificationSound();\n            const reviewData = message.type === \"NEW_REVIEW\" ? message.data : message.data?.data;\n            const msgText = message.type === \"NOTIFICATION\" \n              ? message.data?.message \n              : `New ${reviewData?.rating || 5}-star review from ${reviewData?.authorName || 'Someone'}`;\n\n            toast({\n              title: \"New Review\",\n              description: msgText || \"New review received\",\n              duration: 5000,\n            });\n\n            queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n          }\n        } catch (error) {\n          // Silent error handling for message parsing\n        }\n      };\n\n      wsRef.current.onclose = () => {\n        setIsConnected(false);\n        if (!isClosingRef.current) {\n          reconnectTimeoutRef.current = setTimeout(connect, 5000);\n        }\n      };\n\n      wsRef.current.onerror = (event) => {\n        setIsConnected(false);\n        event.preventDefault?.();\n      };\n    } catch (error) {\n      setIsConnected(false);\n      if (!isClosingRef.current) {\n        reconnectTimeoutRef.current = setTimeout(connect, 5000);\n      }\n    }\n  }, [playNotificationSound, toast, queryClient]);\n\n  const disconnect = useCallback(() => {\n    isClosingRef.current = true;\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n    setTimeout(() => {\n      isClosingRef.current = false;\n    }, 100);\n  }, []);\n\n  useEffect(() => {\n    connect();\n\n    const handleBeforeUnload = () => {\n      isClosingRef.current = true;\n      if (wsRef.current) {\n        wsRef.current.close();\n      }\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n      disconnect();\n    };\n  }, [connect, disconnect]);\n\n  return { connect, disconnect, isConnected };\n}","path":null,"size_bytes":6695,"size_tokens":null},"client/src/components/admin/project-editor.tsx":{"content":"import { useEditor, EditorContent } from \"@tiptap/react\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Link from \"@tiptap/extension-link\";\nimport Image from \"@tiptap/extension-image\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport Placeholder from \"@tiptap/extension-placeholder\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport {\n  Bold,\n  Italic,\n  Underline,\n  Heading1,\n  Heading2,\n  List,\n  ListOrdered,\n  Code,\n  Quote,\n  AlignLeft,\n  AlignCenter,\n  AlignRight,\n  Undo,\n  Redo,\n} from \"lucide-react\";\nimport { useEffect } from \"react\";\n\ninterface ProjectEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n}\n\nexport function ProjectEditor({\n  value,\n  onChange,\n  placeholder = \"Describe your project in detail...\",\n}: ProjectEditorProps) {\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        heading: { levels: [1, 2, 3] },\n        bulletList: { HTMLAttributes: { class: \"list-disc list-inside\" } },\n        orderedList: { HTMLAttributes: { class: \"list-decimal list-inside\" } },\n      }),\n      Link.configure({ openOnClick: false }),\n      Image,\n      TextAlign.configure({ types: [\"heading\", \"paragraph\"] }),\n      Placeholder.configure({ placeholder }),\n    ],\n    content: value,\n    onUpdate: ({ editor }) => {\n      onChange(editor.getHTML());\n    },\n  });\n\n  useEffect(() => {\n    if (editor && value !== editor.getHTML()) {\n      editor.commands.setContent(value);\n    }\n  }, [value, editor]);\n\n  if (!editor) return <div>Loading editor...</div>;\n\n  return (\n    <div className=\"border rounded-lg overflow-hidden\">\n      {/* Toolbar */}\n      <div className=\"border-b bg-muted p-2 flex flex-wrap gap-1\">\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleBold().run()}\n          className={editor.isActive(\"bold\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Bold (Ctrl+B)\"\n          data-testid=\"button-bold\"\n        >\n          <Bold className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleItalic().run()}\n          className={editor.isActive(\"italic\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Italic (Ctrl+I)\"\n          data-testid=\"button-italic\"\n        >\n          <Italic className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleStrike().run()}\n          className={editor.isActive(\"strike\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Strikethrough (Ctrl+Shift+X)\"\n          data-testid=\"button-strikethrough\"\n        >\n          <Underline className=\"w-4 h-4\" />\n        </Button>\n\n        <div className=\"w-px bg-border\" />\n\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}\n          className={editor.isActive(\"heading\", { level: 1 }) ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Heading 1\"\n          data-testid=\"button-h1\"\n        >\n          <Heading1 className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleHeading({ level: 2 }).run()}\n          className={editor.isActive(\"heading\", { level: 2 }) ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Heading 2\"\n          data-testid=\"button-h2\"\n        >\n          <Heading2 className=\"w-4 h-4\" />\n        </Button>\n\n        <div className=\"w-px bg-border\" />\n\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleBulletList().run()}\n          className={editor.isActive(\"bulletList\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Bullet List\"\n          data-testid=\"button-bullet-list\"\n        >\n          <List className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleOrderedList().run()}\n          className={editor.isActive(\"orderedList\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Ordered List\"\n          data-testid=\"button-ordered-list\"\n        >\n          <ListOrdered className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleCodeBlock().run()}\n          className={editor.isActive(\"codeBlock\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Code Block\"\n          data-testid=\"button-code-block\"\n        >\n          <Code className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().toggleBlockquote().run()}\n          className={editor.isActive(\"blockquote\") ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Quote\"\n          data-testid=\"button-blockquote\"\n        >\n          <Quote className=\"w-4 h-4\" />\n        </Button>\n\n        <div className=\"w-px bg-border\" />\n\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().setTextAlign(\"left\").run()}\n          className={editor.isActive({ textAlign: \"left\" }) ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Align Left\"\n          data-testid=\"button-align-left\"\n        >\n          <AlignLeft className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().setTextAlign(\"center\").run()}\n          className={editor.isActive({ textAlign: \"center\" }) ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Align Center\"\n          data-testid=\"button-align-center\"\n        >\n          <AlignCenter className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().setTextAlign(\"right\").run()}\n          className={editor.isActive({ textAlign: \"right\" }) ? \"bg-primary text-primary-foreground\" : \"\"}\n          title=\"Align Right\"\n          data-testid=\"button-align-right\"\n        >\n          <AlignRight className=\"w-4 h-4\" />\n        </Button>\n\n        <div className=\"w-px bg-border\" />\n\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().undo().run()}\n          disabled={!editor.can().undo()}\n          title=\"Undo (Ctrl+Z)\"\n          data-testid=\"button-undo\"\n        >\n          <Undo className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          size=\"sm\"\n          variant=\"outline\"\n          onClick={() => editor.chain().focus().redo().run()}\n          disabled={!editor.can().redo()}\n          title=\"Redo (Ctrl+Y)\"\n          data-testid=\"button-redo\"\n        >\n          <Redo className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      {/* Editor */}\n      <Card className=\"border-0 rounded-none prose prose-sm dark:prose-invert max-w-none\">\n        <EditorContent\n          editor={editor}\n          className=\"p-4 min-h-80 focus-within:outline-none\"\n          data-testid=\"editor-content\"\n        />\n      </Card>\n\n      {/* Footer */}\n      <div className=\"border-t bg-muted px-4 py-2 text-xs text-muted-foreground\">\n        Rich text editor ready\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7584,"size_tokens":null},"client/src/pages/admin/ProjectCategories.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description: string | null;\n  createdAt: string;\n}\n\nconst getEmptyCategory = () => ({\n  name: \"\",\n  slug: \"\",\n  type: \"project\",\n  description: \"\",\n});\n\nexport default function AdminProjectCategories() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\n  const [formData, setFormData] = useState(getEmptyCategory());\n\n  const { data: categories = [], isLoading } = useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to fetch categories\");\n        return res.json();\n      }),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(\"/api/categories\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to create category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category created\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create category\", variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(`/api/categories/${editingCategory?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to update category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update category\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) =>\n      fetch(`/api/categories/${id}`, { \n        method: \"DELETE\",\n        credentials: \"include\"\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to delete category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Category deleted\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete category\", variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyCategory());\n    setEditingCategory(null);\n  };\n\n  const handleOpenDialog = (category?: Category) => {\n    if (category) {\n      setEditingCategory(category);\n      setFormData({\n        name: category.name,\n        slug: category.slug,\n        type: category.type,\n        description: category.description || \"\",\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim() || !formData.slug.trim()) {\n      toast({ title: \"Error\", description: \"Name and slug are required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingCategory) {\n      updateMutation.mutate(formData);\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const generateSlug = (name: string) => {\n    const slug = name\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n    return slug;\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-6 space-y-6 max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Project Categories</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage your project categories</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-new-category\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            New Category\n          </Button>\n        </div>\n\n        {/* Categories List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Categories ({categories.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"flex justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin\" />\n              </div>\n            ) : categories.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No categories yet. Create your first one!\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {categories.map((category: Category) => (\n                  <div\n                    key={category.id}\n                    className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\n                    data-testid={`category-item-${category.id}`}\n                  >\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-foreground\">{category.name}</h3>\n                      <p className=\"text-sm text-muted-foreground\">/{category.slug}</p>\n                      {category.description && (\n                        <p className=\"text-sm text-muted-foreground mt-1\">{category.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2 ml-4\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleOpenDialog(category)}\n                        data-testid={`button-edit-category-${category.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setDeleteId(category.id)}\n                        data-testid={`button-delete-category-${category.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4 text-red-500\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{editingCategory ? \"Edit Category\" : \"New Category\"}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"name\">Category Name *</Label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => {\n                  const newName = e.target.value;\n                  const newSlug = generateSlug(newName);\n                  setFormData({ ...formData, name: newName, slug: newSlug });\n                }}\n                placeholder=\"e.g., Full-stack\"\n                data-testid=\"input-category-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"slug\">Slug *</Label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                placeholder=\"e.g., full-stack\"\n                data-testid=\"input-category-slug\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description}\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                placeholder=\"Category description (optional)\"\n                data-testid=\"textarea-category-description\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-save-category\"\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                \"Save Category\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation */}\n      <AlertDialog open={deleteId !== null} onOpenChange={(open) => !open && setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Category</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. Are you sure you want to delete this category?\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deleteId && deleteMutation.mutate(deleteId)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11229,"size_tokens":null},"client/src/pages/admin/PostCategories.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description: string | null;\n  createdAt: string;\n}\n\nconst getEmptyCategory = () => ({\n  name: \"\",\n  slug: \"\",\n  type: \"post\",\n  description: \"\",\n});\n\nexport default function AdminPostCategories() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\n  const [formData, setFormData] = useState(getEmptyCategory());\n\n  const { data: categories = [], isLoading } = useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () => \n      fetch(\"/api/categories?type=post\", { credentials: \"include\" }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to fetch categories\");\n        return res.json();\n      }),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(\"/api/categories\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to create category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category created\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create category\", variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(`/api/categories/${editingCategory?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to update category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update category\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) =>\n      fetch(`/api/categories/${id}`, { \n        method: \"DELETE\",\n        credentials: \"include\"\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to delete category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Category deleted\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete category\", variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyCategory());\n    setEditingCategory(null);\n  };\n\n  const handleOpenDialog = (category?: Category) => {\n    if (category) {\n      setEditingCategory(category);\n      setFormData({\n        name: category.name,\n        slug: category.slug,\n        type: category.type,\n        description: category.description || \"\",\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim() || !formData.slug.trim()) {\n      toast({ title: \"Error\", description: \"Name and slug are required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingCategory) {\n      updateMutation.mutate(formData);\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const generateSlug = (name: string) => {\n    const slug = name\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n    return slug;\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-6 space-y-6 max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Post Categories</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage your blog post categories</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-new-category\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            New Category\n          </Button>\n        </div>\n\n        {/* Categories List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Categories ({categories.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"flex justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin\" />\n              </div>\n            ) : categories.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No categories yet. Create your first one!\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {categories.map((category: Category) => (\n                  <div\n                    key={category.id}\n                    className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\n                    data-testid={`category-item-${category.id}`}\n                  >\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-foreground\">{category.name}</h3>\n                      <p className=\"text-sm text-muted-foreground\">/{category.slug}</p>\n                      {category.description && (\n                        <p className=\"text-sm text-muted-foreground mt-1\">{category.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2 ml-4\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleOpenDialog(category)}\n                        data-testid={`button-edit-category-${category.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setDeleteId(category.id)}\n                        data-testid={`button-delete-category-${category.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4 text-red-500\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{editingCategory ? \"Edit Category\" : \"New Category\"}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"name\">Category Name *</Label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => {\n                  const newName = e.target.value;\n                  const newSlug = generateSlug(newName);\n                  setFormData({ ...formData, name: newName, slug: newSlug });\n                }}\n                placeholder=\"e.g., Web Development\"\n                data-testid=\"input-category-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"slug\">Slug *</Label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                placeholder=\"e.g., web-development\"\n                data-testid=\"input-category-slug\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description}\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                placeholder=\"Category description (optional)\"\n                data-testid=\"textarea-category-description\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-save-category\"\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                \"Save Category\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation */}\n      <AlertDialog open={deleteId !== null} onOpenChange={(open) => !open && setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Category</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. Are you sure you want to delete this category?\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deleteId && deleteMutation.mutate(deleteId)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11218,"size_tokens":null},"client/src/components/CommentSection.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { MessageSquare, Send, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport type { Comment } from \"@shared/schema\";\n\ninterface CommentSectionProps {\n  postId?: number;\n  projectId?: number;\n  title?: string;\n}\n\nconst commentFormSchema = z.object({\n  authorName: z.string().min(2, \"Name must be at least 2 characters\"),\n  authorEmail: z.string().email(\"Please enter a valid email\"),\n  content: z.string().min(10, \"Comment must be at least 10 characters\"),\n});\n\ntype CommentFormValues = z.infer<typeof commentFormSchema>;\n\nexport function CommentSection({ postId, projectId, title = \"Comments\" }: CommentSectionProps) {\n  const { toast } = useToast();\n  const [showForm, setShowForm] = useState(false);\n\n  const queryKey = postId \n    ? ['/api/comments', { postId, approved: true }]\n    : ['/api/comments', { projectId, approved: true }];\n\n  const { data: comments = [], isLoading } = useQuery<Comment[]>({\n    queryKey,\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (postId) params.append('postId', postId.toString());\n      if (projectId) params.append('projectId', projectId.toString());\n      params.append('approved', 'true');\n      const response = await fetch(`/api/comments?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch comments');\n      return response.json();\n    }\n  });\n\n  const form = useForm<CommentFormValues>({\n    resolver: zodResolver(commentFormSchema),\n    defaultValues: {\n      authorName: \"\",\n      authorEmail: \"\",\n      content: \"\",\n    },\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: CommentFormValues) => {\n      const payload = {\n        ...data,\n        postId: postId || null,\n        projectId: projectId || null,\n        status: 'Approved',\n      };\n      const response = await fetch('/api/comments', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n      const responseText = await response.text();\n      if (!response.ok) {\n        throw new Error(`Failed to submit comment: ${responseText}`);\n      }\n      return JSON.parse(responseText);\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Comment submitted\",\n        description: \"Your comment is pending approval and will appear shortly.\",\n      });\n      form.reset();\n      setShowForm(false);\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit comment. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CommentFormValues) => {\n    submitMutation.mutate(data);\n  };\n\n  return (\n    <Card className=\"mt-8\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4 pb-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <MessageSquare className=\"w-5 h-5\" />\n          {title} ({comments.length})\n        </CardTitle>\n        <Button \n          variant=\"outline\" \n          size=\"sm\"\n          onClick={() => setShowForm(!showForm)}\n          data-testid=\"button-add-comment\"\n        >\n          {showForm ? \"Cancel\" : \"Add Comment\"}\n        </Button>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {showForm && (\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 p-4 bg-muted/50 rounded-lg\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"authorName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"Your name\" {...field} data-testid=\"input-comment-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"authorEmail\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"your@email.com\" {...field} data-testid=\"input-comment-email\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Comment</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"Share your thoughts...\" \n                        className=\"min-h-[100px]\" \n                        {...field} \n                        data-testid=\"textarea-comment-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button \n                type=\"submit\" \n                disabled={submitMutation.isPending}\n                data-testid=\"button-submit-comment\"\n              >\n                {submitMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                Submit Comment\n              </Button>\n            </form>\n          </Form>\n        )}\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : comments.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <MessageSquare className=\"w-10 h-10 mx-auto mb-3 opacity-50\" />\n            <p>No comments yet. Be the first to share your thoughts!</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {comments.map((comment) => (\n              <div \n                key={comment.id} \n                className=\"flex gap-4 p-4 rounded-lg bg-muted/30\"\n                data-testid={`comment-${comment.id}`}\n              >\n                <Avatar className=\"w-10 h-10\">\n                  <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n                    {comment.authorName.charAt(0).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    <span className=\"font-semibold\">{comment.authorName}</span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {comment.createdAt && formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}\n                    </span>\n                  </div>\n                  <p className=\"text-foreground/90\">{comment.content}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":8188,"size_tokens":null},"client/src/components/ReviewSection.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Star, Send, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport type { Review } from \"@shared/schema\";\n\ninterface ReviewSectionProps {\n  projectId: number;\n  title?: string;\n  compact?: boolean;\n}\n\nconst reviewFormSchema = z.object({\n  authorName: z.string().min(2, \"Name must be at least 2 characters\"),\n  authorEmail: z.string().email(\"Please enter a valid email\"),\n  content: z.string().min(10, \"Review must be at least 10 characters\"),\n  rating: z.number().min(1).max(5),\n});\n\ntype ReviewFormValues = z.infer<typeof reviewFormSchema>;\n\nexport function ReviewSection({ projectId, title = \"Reviews\", compact = false }: ReviewSectionProps) {\n  const { toast } = useToast();\n  const [showForm, setShowForm] = useState(false);\n  const [hoverRating, setHoverRating] = useState(0);\n\n  const { data: reviews = [], isLoading } = useQuery<Review[]>({\n    queryKey: ['/api/reviews', { projectId, approved: true }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      params.append('projectId', projectId.toString());\n      params.append('approved', 'true');\n      const response = await fetch(`/api/reviews?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch reviews');\n      return response.json();\n    }\n  });\n\n  const averageRating = reviews.length > 0 \n    ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length \n    : 0;\n\n  const form = useForm<ReviewFormValues>({\n    resolver: zodResolver(reviewFormSchema),\n    defaultValues: {\n      authorName: \"\",\n      authorEmail: \"\",\n      content: \"\",\n      rating: 5,\n    },\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: ReviewFormValues) => {\n      const payload = {\n        ...data,\n        projectId,\n        status: 'Approved',\n      };\n      console.log('Submitting review:', payload);\n      const response = await fetch('/api/reviews', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n      const responseText = await response.text();\n      console.log('Response status:', response.status, 'Body:', responseText);\n      if (!response.ok) {\n        throw new Error(`Failed to submit review: ${responseText}`);\n      }\n      return JSON.parse(responseText);\n    },\n    onSuccess: (data) => {\n      console.log('Review created successfully:', data);\n      toast({\n        title: \"Review submitted\",\n        description: \"Your review is pending approval and will appear shortly.\",\n      });\n      form.reset();\n      setShowForm(false);\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n    },\n    onError: (error: any) => {\n      console.error('Review submission error:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit review. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ReviewFormValues) => {\n    submitMutation.mutate(data);\n  };\n\n  const StarRating = ({ rating, interactive = false, size = \"md\" }: { rating: number; interactive?: boolean; size?: \"sm\" | \"md\" }) => {\n    const starSize = size === \"sm\" ? \"w-4 h-4\" : \"w-5 h-5\";\n    return (\n      <div className=\"flex gap-1\">\n        {[1, 2, 3, 4, 5].map((star) => (\n          <Star\n            key={star}\n            className={`${starSize} ${\n              star <= (interactive ? hoverRating || rating : rating)\n                ? \"text-yellow-500 fill-yellow-500\"\n                : \"text-gray-300 dark:text-gray-600\"\n            } ${interactive ? \"cursor-pointer transition-colors\" : \"\"}`}\n            onMouseEnter={() => interactive && setHoverRating(star)}\n            onMouseLeave={() => interactive && setHoverRating(0)}\n            onClick={() => {\n              if (interactive) {\n                form.setValue(\"rating\", star);\n                setHoverRating(0);\n              }\n            }}\n          />\n        ))}\n      </div>\n    );\n  };\n\n  if (compact) {\n    return (\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center gap-2\">\n          <StarRating rating={Math.round(averageRating)} size=\"sm\" />\n          <span className=\"text-sm text-muted-foreground\">\n            ({reviews.length} review{reviews.length !== 1 ? 's' : ''})\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"mt-4\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4 pb-4\">\n        <div>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Star className=\"w-5 h-5\" />\n            {title}\n          </CardTitle>\n          {reviews.length > 0 && (\n            <div className=\"flex items-center gap-2 mt-1\">\n              <StarRating rating={Math.round(averageRating)} size=\"sm\" />\n              <span className=\"text-sm text-muted-foreground\">\n                {averageRating.toFixed(1)} ({reviews.length} review{reviews.length !== 1 ? 's' : ''})\n              </span>\n            </div>\n          )}\n        </div>\n        <Button \n          variant=\"outline\" \n          size=\"sm\"\n          onClick={() => setShowForm(!showForm)}\n          data-testid=\"button-add-review\"\n        >\n          {showForm ? \"Cancel\" : \"Add Review\"}\n        </Button>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {showForm && (\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 p-4 bg-muted/50 rounded-lg\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"authorName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"Your name\" {...field} data-testid=\"input-review-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"authorEmail\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"your@email.com\" {...field} data-testid=\"input-review-email\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"rating\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Rating</FormLabel>\n                    <FormControl>\n                      <StarRating rating={field.value} interactive />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Your Review</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"Share your experience...\" \n                        className=\"min-h-[100px]\" \n                        {...field} \n                        data-testid=\"textarea-review-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button \n                type=\"submit\" \n                disabled={submitMutation.isPending}\n                data-testid=\"button-submit-review\"\n              >\n                {submitMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                Submit Review\n              </Button>\n            </form>\n          </Form>\n        )}\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : reviews.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <Star className=\"w-10 h-10 mx-auto mb-3 opacity-50\" />\n            <p>No reviews yet. Be the first to share your experience!</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {reviews.map((review) => (\n              <div \n                key={review.id} \n                className=\"flex gap-4 p-4 rounded-lg bg-muted/30\"\n                data-testid={`review-${review.id}`}\n              >\n                <Avatar className=\"w-10 h-10\">\n                  <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n                    {review.authorName.charAt(0).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n                    <span className=\"font-semibold\">{review.authorName}</span>\n                    <StarRating rating={review.rating} size=\"sm\" />\n                    <span className=\"text-xs text-muted-foreground\">\n                      {review.createdAt && formatDistanceToNow(new Date(review.createdAt), { addSuffix: true })}\n                    </span>\n                  </div>\n                  <p className=\"text-foreground/90\">{review.content}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":10674,"size_tokens":null},"client/src/pages/Blog.tsx":{"content":"import { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion } from \"framer-motion\";\nimport { Calendar, User, Eye, Clock, Search, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { useState, useMemo } from \"react\";\n\nexport default function Blog() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\n\n  const { data: posts = [], isLoading } = useQuery({\n    queryKey: ['/api/posts'],\n    queryFn: async () => {\n      const response = await fetch('/api/posts');\n      if (!response.ok) throw new Error('Failed to fetch posts');\n      return response.json();\n    }\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: ['/api/categories', 'post'],\n    queryFn: async () => {\n      const response = await fetch('/api/categories?type=post');\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    }\n  });\n\n  const publishedPosts = posts.filter((post: any) => post.status === 'Published');\n\n  const filteredPosts = useMemo(() => {\n    return publishedPosts.filter((post: any) => {\n      const matchesSearch = post.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        post.excerpt?.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesCategory = !selectedCategory || post.category === selectedCategory;\n      return matchesSearch && matchesCategory;\n    });\n  }, [publishedPosts, searchQuery, selectedCategory]);\n\n  const uniqueCategories: string[] = Array.from(new Set(publishedPosts.map((p: any) => p.category))).sort() as string[];\n\n  const formatDate = (date: string | null) => {\n    if (!date) return 'N/A';\n    return new Date(date).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          {/* Header */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Blog & <span className=\"text-primary\">Articles</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Thoughts on web development, design, and creative coding.\n              </p>\n            </div>\n          </motion.div>\n\n          {/* Search and Filters */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-12 space-y-6\"\n          >\n            {/* Search */}\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search articles...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10 max-w-md\"\n                data-testid=\"input-search-blog\"\n              />\n            </div>\n\n            {/* Categories */}\n            <div className=\"flex flex-wrap gap-2\">\n              <Button\n                variant={selectedCategory === null ? \"default\" : \"outline\"}\n                onClick={() => setSelectedCategory(null)}\n                data-testid=\"button-filter-all\"\n              >\n                All Articles\n              </Button>\n              {uniqueCategories.map((cat: string) => (\n                <Button\n                  key={cat}\n                  variant={selectedCategory === cat ? \"default\" : \"outline\"}\n                  onClick={() => setSelectedCategory(cat)}\n                  data-testid={`button-filter-${cat}`}\n                >\n                  {cat}\n                </Button>\n              ))}\n            </div>\n          </motion.div>\n\n          {/* Posts List */}\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-16\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n          ) : filteredPosts.length === 0 ? (\n            <div className=\"text-center py-16\">\n              <p className=\"text-lg text-muted-foreground mb-4\">No articles found</p>\n              <Button variant=\"outline\" onClick={() => {\n                setSearchQuery(\"\");\n                setSelectedCategory(null);\n              }} data-testid=\"button-clear-filters\">\n                Clear filters\n              </Button>\n            </div>\n          ) : (\n            <div className=\"space-y-6 max-w-4xl\">\n              {filteredPosts.map((post: any, index: number) => (\n                <motion.div\n                  key={post.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.3, delay: index * 0.05 }}\n                  data-testid={`card-blog-${post.id}`}\n                >\n                  <Link href={`/blog/${post.slug}`}>\n                    <Card className=\"hover:shadow-lg transition-shadow duration-300 cursor-pointer\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex flex-wrap gap-2\">\n                            <Badge variant=\"secondary\">{post.category}</Badge>\n                            {post.status === 'Draft' && (\n                              <Badge variant=\"outline\" className=\"text-yellow-500 border-yellow-500\">\n                                Draft\n                              </Badge>\n                            )}\n                          </div>\n                          <span className=\"text-sm text-muted-foreground whitespace-nowrap\">\n                            {formatDate(post.publishedAt)}\n                          </span>\n                        </div>\n                        <h2 className=\"text-2xl font-bold hover:text-primary transition-colors\">\n                          {post.title}\n                        </h2>\n                        <p className=\"text-muted-foreground mt-2\">\n                          {post.excerpt}\n                        </p>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground border-t pt-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <User className=\"w-4 h-4\" />\n                            <span>{post.author || 'Unknown'}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4\" />\n                            <span>{post.views || 0} views</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Clock className=\"w-4 h-4\" />\n                            <span>\n                              {post.content \n                                ? Math.ceil(post.content.split(/\\s+/).length / 200) \n                                : 1} min read\n                            </span>\n                          </div>\n                        </div>\n\n                        {/* Tags */}\n                        {post.tags && post.tags.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2 mt-4\">\n                            {post.tags.slice(0, 3).map((tag: string) => (\n                              <Badge key={tag} variant=\"outline\" className=\"text-xs\">\n                                {tag}\n                              </Badge>\n                            ))}\n                            {post.tags.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{post.tags.length - 3}\n                              </Badge>\n                            )}\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  </Link>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":8876,"size_tokens":null},"client/src/pages/Projects.tsx":{"content":"import { useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ExternalLink, Github, Plus, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { ReviewSection } from \"@/components/ReviewSection\";\nimport { useState, useMemo } from \"react\";\n\nexport default function Projects() {\n  const [selectedProject, setSelectedProject] = useState<any | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterCategory, setFilterCategory] = useState(\"all\");\n  const [, setLocation] = useLocation();\n\n  const { data: projects = [], isLoading } = useQuery({\n    queryKey: ['/api/projects'],\n    queryFn: async () => {\n      const response = await fetch('/api/projects');\n      if (!response.ok) throw new Error('Failed to fetch projects');\n      return response.json();\n    }\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: ['/api/categories', 'project'],\n    queryFn: async () => {\n      const response = await fetch('/api/categories?type=project');\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    }\n  });\n\n  const filteredProjects = useMemo(() => {\n    return projects.filter((project: any) => {\n      const matchesSearch = project.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        project.description.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesCategory = filterCategory === 'all' || \n        project.category.toLowerCase() === filterCategory.toLowerCase();\n      return matchesSearch && matchesCategory && project.status === 'Published';\n    });\n  }, [projects, searchQuery, filterCategory]);\n\n  const categoryOptions = [\n    { id: 'all', name: 'All Projects' },\n    ...categories.map((cat: any) => ({ id: cat.slug, name: cat.name }))\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n      \n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          {/* Header */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Featured <span className=\"text-primary\">Projects</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Explore my portfolio of web applications, designs, and creative solutions.\n              </p>\n            </div>\n          </motion.div>\n\n          {/* Search and Filters */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-12 space-y-6\"\n          >\n            {/* Search */}\n            <Input\n              placeholder=\"Search projects...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"max-w-md\"\n              data-testid=\"input-search-projects\"\n            />\n\n            {/* Categories */}\n            <div className=\"flex flex-wrap gap-2\">\n              {categoryOptions.map((cat) => (\n                <Button\n                  key={cat.id}\n                  variant={filterCategory === cat.id ? \"default\" : \"outline\"}\n                  onClick={() => setFilterCategory(cat.id)}\n                  data-testid={`button-filter-${cat.id}`}\n                >\n                  {cat.name}\n                </Button>\n              ))}\n            </div>\n          </motion.div>\n\n          {/* Projects Grid */}\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-16\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n          ) : filteredProjects.length === 0 ? (\n            <div className=\"text-center py-16\">\n              <p className=\"text-lg text-muted-foreground mb-4\">No projects found</p>\n              <Button variant=\"outline\" onClick={() => {\n                setSearchQuery(\"\");\n                setFilterCategory(\"all\");\n              }} data-testid=\"button-clear-filters\">\n                Clear filters\n              </Button>\n            </div>\n          ) : (\n            <motion.div\n              layout\n              className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\"\n            >\n              <AnimatePresence>\n                {filteredProjects.map((project: any) => (\n                  <motion.div\n                    layout\n                    key={project.id}\n                    initial={{ opacity: 0, scale: 0.9 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.9 }}\n                    transition={{ duration: 0.3 }}\n                    className=\"group relative rounded-xl overflow-hidden bg-card border border-border shadow-md hover:shadow-xl transition-all duration-300\"\n                    data-testid={`card-project-${project.id}`}\n                  >\n                    {/* Image */}\n                    <div className=\"aspect-video overflow-hidden bg-muted\">\n                      <img\n                        src={project.image || '/placeholder.jpg'}\n                        alt={project.title}\n                        className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\n                      />\n                    </div>\n\n                    {/* Content */}\n                    <div className=\"p-6\">\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <h3 className=\"text-lg font-bold line-clamp-2\">{project.title}</h3>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n                        {project.description}\n                      </p>\n\n                      {/* Tech Tags */}\n                      <div className=\"flex flex-wrap gap-2 mb-4\">\n                        {(project.tech || []).slice(0, 3).map((t: string) => (\n                          <Badge key={t} variant=\"secondary\" className=\"text-xs\">\n                            {t}\n                          </Badge>\n                        ))}\n                        {(project.tech || []).length > 3 && (\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            +{(project.tech || []).length - 3}\n                          </Badge>\n                        )}\n                      </div>\n\n                      {/* Actions */}\n                      <div className=\"flex gap-2 pt-4 border-t\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"flex-1\"\n                          onClick={() => setSelectedProject(project)}\n                          data-testid={`button-view-details-${project.id}`}\n                        >\n                          <Plus className=\"w-4 h-4 mr-1\" />\n                          Details\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          data-testid={`button-external-link-${project.id}`}\n                        >\n                          <ExternalLink className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          data-testid={`button-github-${project.id}`}\n                        >\n                          <Github className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            </motion.div>\n          )}\n        </div>\n      </div>\n\n      {/* Project Detail Modal */}\n      <Dialog open={!!selectedProject} onOpenChange={() => setSelectedProject(null)}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] p-0\">\n          <ScrollArea className=\"max-h-[85vh]\">\n            <div className=\"p-6\">\n              <DialogHeader>\n                <DialogTitle>{selectedProject?.title}</DialogTitle>\n                <DialogDescription>{selectedProject?.description}</DialogDescription>\n              </DialogHeader>\n              {selectedProject && (\n                <div className=\"space-y-6 mt-4\">\n                  <div className=\"aspect-video rounded-lg overflow-hidden bg-muted\">\n                    <img\n                      src={selectedProject.image}\n                      alt={selectedProject.title}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  </div>\n\n                  <div className=\"grid md:grid-cols-2 gap-6\">\n                    <div>\n                      <h4 className=\"font-bold mb-2\">Challenge & Solution</h4>\n                      <p className=\"text-muted-foreground text-sm\">\n                        {selectedProject.description || \"Comprehensive project solution with modern technologies and best practices.\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-bold mb-2\">Technologies</h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {selectedProject.tech.map((t: string) => (\n                          <Badge key={t} variant=\"secondary\">\n                            {t}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n\n                  <ReviewSection projectId={selectedProject.id} title=\"Project Reviews\" />\n\n                  <div className=\"flex justify-end gap-4 pt-4 border-t\">\n                    <Button variant=\"outline\" onClick={() => setSelectedProject(null)} data-testid=\"button-close-modal\">\n                      Close\n                    </Button>\n                    <Button data-testid=\"button-view-live\">View Live Project</Button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":10890,"size_tokens":null},"client/src/contexts/SiteSettingsContext.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\nexport interface SiteSettings {\n  siteTitle: string;\n  tagline: string;\n  contactEmail: string;\n  heroTitle: string;\n  heroSubtitle: string;\n  heroDescription: string;\n  heroStatus: string;\n  aboutTitle: string;\n  aboutSubtitle: string;\n  aboutDescription: string;\n  aboutDescription2: string;\n  aboutName: string;\n  aboutEmail: string;\n  aboutLocation: string;\n  aboutFreelance: string;\n  contactTitle: string;\n  contactSubtitle: string;\n  contactPhone: string;\n  contactAddress: string;\n  socialFacebook: string;\n  socialTwitter: string;\n  socialInstagram: string;\n  socialLinkedin: string;\n  socialGithub: string;\n  footerText: string;\n  footerCopyright: string;\n  metaDescription: string;\n  googleAnalyticsId: string;\n  maintenanceMode: boolean;\n}\n\nconst defaultSettings: SiteSettings = {\n  siteTitle: \"Loi Developer - Full-stack Creative\",\n  tagline: \"Building digital experiences with code.\",\n  contactEmail: \"loideveloper@example.com\",\n  heroTitle: \"NGUYEN THANH LOI\",\n  heroSubtitle: \"Full-stack Developer & Security Enthusiast\",\n  heroDescription: \"Crafting secure & performant digital experiences with code\",\n  heroStatus: \"SYSTEM ONLINE\",\n  aboutTitle: \"About Me\",\n  aboutSubtitle: \"Full-stack Developer based in Vietnam\",\n  aboutDescription: \"I started my coding journey with a curiosity for how things work on the web. Now, I specialize in building modern, scalable, and user-friendly applications using the latest technologies.\",\n  aboutDescription2: \"My philosophy is simple: Code with passion, build with purpose. Whether it's a complex backend system or a pixel-perfect frontend interface, I strive for excellence in every line of code.\",\n  aboutName: \"Nguyen Thanh Loi\",\n  aboutEmail: \"loideveloper@example.com\",\n  aboutLocation: \"Ho Chi Minh City\",\n  aboutFreelance: \"Available\",\n  contactTitle: \"Let's Talk\",\n  contactSubtitle: \"Have a project in mind or just want to say hi? I'm always open to discussing new projects, creative ideas or opportunities to be part of your visions.\",\n  contactPhone: \"+84 123 456 789\",\n  contactAddress: \"Ho Chi Minh City, Vietnam\",\n  socialFacebook: \"\",\n  socialTwitter: \"\",\n  socialInstagram: \"\",\n  socialLinkedin: \"\",\n  socialGithub: \"\",\n  footerText: \"Crafted with love & countless cups of coffee\",\n  footerCopyright: \"2024 Loi Developer. All rights reserved.\",\n  metaDescription: \"Portfolio of Nguyen Thanh Loi - Full-stack Developer & Creative Coder\",\n  googleAnalyticsId: \"\",\n  maintenanceMode: false,\n};\n\ninterface SiteSettingsContextType {\n  settings: SiteSettings;\n  isLoading: boolean;\n  updateSettings: (newSettings: Partial<SiteSettings>) => Promise<void>;\n  isUpdating: boolean;\n}\n\nconst SiteSettingsContext = createContext<SiteSettingsContextType | undefined>(undefined);\n\nexport function SiteSettingsProvider({ children }: { children: React.ReactNode }) {\n  const queryClient = useQueryClient();\n  const [localSettings, setLocalSettings] = useState<SiteSettings>(defaultSettings);\n\n  const { data: serverSettings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: [\"/api/settings\"],\n    staleTime: 1000 * 60 * 5,\n  });\n\n  useEffect(() => {\n    if (serverSettings) {\n      setLocalSettings({\n        ...defaultSettings,\n        ...serverSettings,\n      });\n    }\n  }, [serverSettings]);\n\n  const updateMutation = useMutation({\n    mutationFn: (settings: Partial<SiteSettings>) => api.updateSettings(settings),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/settings\"] });\n    },\n  });\n\n  const updateSettings = async (newSettings: Partial<SiteSettings>) => {\n    await updateMutation.mutateAsync(newSettings);\n    setLocalSettings(prev => ({ ...prev, ...newSettings }));\n  };\n\n  return (\n    <SiteSettingsContext.Provider\n      value={{\n        settings: localSettings,\n        isLoading,\n        updateSettings,\n        isUpdating: updateMutation.isPending,\n      }}\n    >\n      {children}\n    </SiteSettingsContext.Provider>\n  );\n}\n\nexport function useSiteSettings() {\n  const context = useContext(SiteSettingsContext);\n  if (!context) {\n    throw new Error(\"useSiteSettings must be used within a SiteSettingsProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":4339,"size_tokens":null},".local/state/replit/agent/progress_tracker.md":{"content":"[x] 1. Install the required packages\n[x] 2. Setup database and run migrations + seed data\n[x] 3. Fix authentication persistence on page reload\n[x] 4. Add real-time notifications for contact form (WebSocket + sound + badge)\n[x] 5. Restart the workflow to verify project is working\n[x] 6. Verify the project is working using the screenshot tool\n[x] 7. Inform user the import is completed and they can start building, mark the import as completed using the complete_project_import tool\n[x] 8. Fix notification popup behavior - clicking notification now marks as read instead of deleting content\n[x] 9. Apply mark-as-read functionality to Comments and Reviews pages\n[x] 10. Add markCommentAsRead and markReviewAsRead functions to API\n[x] 11. Update Notifications page with mark-as-read buttons for all notification types\n[x] 12. Reinstall tsx package that was missing after migration\n[x] 13. Run database migrations using npm run db:push to create all required tables\n[x] 14. Verify application is running successfully with all API endpoints responding correctly\n[x] 15. Fix admin/notifications Clear All and Trash buttons - now properly archive (not delete) comments/reviews\n[x] 16. Fix Quick Stats to show unread/total counts (e.g., \"0 / 4\") for consistency with All Notifications list\n[x] 17. Show ALL non-archived comments and reviews in notifications list\n[x] 18. Add \"archived\" field to comments and reviews tables to preserve data when removing from notifications\n[x] 19. Add archive API endpoints and client functions for comments and reviews\n[x] 20. Final migration verification - tsx package reinstalled and workflow running successfully\n[x] 21. Re-installed tsx package after workflow restart\n[x] 22. Verified application is running successfully - server responding on port 5000 with all API endpoints working\n[x] 23. Confirmed HTML is being served correctly with all metadata and assets\n[x] 24. Fixed admin/notifications Clear All and Trash buttons for Messages - added missing archiveMessage function to storage interface and implementation, and added /api/messages/:id/archive route endpoint","path":null,"size_bytes":2101,"size_tokens":null},"client/src/hooks/useThemeSettings.ts":{"content":"\nimport { useEffect } from 'react';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface ThemeSettings {\n  primaryColor?: string;\n  secondaryColor?: string;\n  accentColor?: string;\n  headingFont?: string;\n  bodyFont?: string;\n  borderRadius?: string;\n  [key: string]: any;\n}\n\nfunction loadGoogleFont(fontName: string) {\n  const fontId = `google-font-${fontName.replace(/\\s+/g, '-')}`;\n  if (document.getElementById(fontId)) return;\n  \n  const link = document.createElement('link');\n  link.id = fontId;\n  link.rel = 'stylesheet';\n  link.href = `https://fonts.googleapis.com/css2?family=${fontName.replace(/\\s+/g, '+')}:wght@300;400;500;600;700&display=swap`;\n  document.head.appendChild(link);\n}\n\nfunction hexToHsl(hex: string): string {\n  const r = parseInt(hex.slice(1, 3), 16) / 255;\n  const g = parseInt(hex.slice(3, 5), 16) / 255;\n  const b = parseInt(hex.slice(5, 7), 16) / 255;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h = 0, s = 0;\n  const l = (max + min) / 2;\n\n  if (max !== min) {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    \n    switch (max) {\n      case r:\n        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n        break;\n      case g:\n        h = ((b - r) / d + 2) / 6;\n        break;\n      case b:\n        h = ((r - g) / d + 4) / 6;\n        break;\n    }\n  }\n\n  const hDeg = Math.round(h * 360);\n  const sPct = Math.round(s * 100);\n  const lPct = Math.round(l * 100);\n\n  return `${hDeg} ${sPct}% ${lPct}%`;\n}\n\nexport function useThemeSettings() {\n  const { data: settings, isLoading } = useQuery({\n    queryKey: ['/api/settings'],\n    refetchInterval: false,\n    staleTime: 1000 * 60 * 5, // 5 minutes\n  });\n\n  useEffect(() => {\n    if (!settings || isLoading) return;\n\n    let theme = (settings as any).theme;\n    \n    // If theme is a JSON string, parse it\n    if (typeof theme === 'string') {\n      try {\n        theme = JSON.parse(theme);\n      } catch (e) {\n        console.error('Failed to parse theme from settings:', e);\n        return;\n      }\n    }\n    \n    if (!theme || typeof theme !== 'object') return;\n\n    try {\n      const root = document.documentElement;\n      console.log('Applying theme settings:', theme);\n    \n      // Apply color settings\n      if (theme.primaryColor) {\n        const rgb = hexToHsl(theme.primaryColor);\n        root.style.setProperty('--primary', rgb);\n      }\n      \n      if (theme.secondaryColor) {\n        const rgb = hexToHsl(theme.secondaryColor);\n        root.style.setProperty('--secondary', rgb);\n      }\n      \n      if (theme.accentColor) {\n        const rgb = hexToHsl(theme.accentColor);\n        root.style.setProperty('--accent', rgb);\n      }\n\n      // Apply font settings\n      if (theme.bodyFont) {\n        loadGoogleFont(theme.bodyFont);\n        root.style.setProperty('--font-sans', `\"${theme.bodyFont}\", sans-serif`);\n      }\n\n      if (theme.headingFont) {\n        loadGoogleFont(theme.headingFont);\n        root.style.setProperty('--font-heading', `\"${theme.headingFont}\", sans-serif`);\n      }\n\n      // Apply border radius\n      if (theme.borderRadius) {\n        root.style.setProperty('--radius', `${theme.borderRadius}px`);\n      }\n\n      // Apply animation speed\n      if (theme.animationSpeed) {\n        root.style.setProperty('--animation-speed', `${theme.animationSpeed}ms`);\n      }\n\n      // Apply line height\n      if (theme.lineHeight) {\n        root.style.setProperty('--line-height', theme.lineHeight);\n      }\n\n      // Apply letter spacing\n      if (theme.letterSpacing) {\n        root.style.setProperty('--letter-spacing', `${theme.letterSpacing}px`);\n      }\n\n      // Apply container width\n      if (theme.containerWidth) {\n        root.style.setProperty('--container-width', theme.containerWidth === '100%' ? '100%' : `${theme.containerWidth}px`);\n      }\n\n      // Apply shadow preset\n      if (theme.shadowPreset) {\n        const shadowValues = {\n          none: 'none',\n          soft: '0 1px 3px rgba(0,0,0,0.1)',\n          medium: '0 4px 6px rgba(0,0,0,0.1)',\n          bold: '0 10px 15px rgba(0,0,0,0.1)',\n        };\n        root.style.setProperty('--shadow', shadowValues[theme.shadowPreset as keyof typeof shadowValues] || shadowValues.soft);\n      }\n\n      // Apply custom CSS if provided\n      if (theme.customCSS) {\n        let styleElement = document.getElementById('custom-theme-css');\n        if (!styleElement) {\n          styleElement = document.createElement('style');\n          styleElement.id = 'custom-theme-css';\n          document.head.appendChild(styleElement);\n        }\n        styleElement.textContent = theme.customCSS;\n      }\n    } catch (error) {\n      console.error('Error applying theme settings:', error);\n    }\n  }, [settings, isLoading]);\n}\n","path":null,"size_bytes":4752,"size_tokens":null},"client/src/pages/PageDetail.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { Loader2, ArrowLeft } from \"lucide-react\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { motion } from \"framer-motion\";\n\nexport default function PageDetail() {\n  const [match, params] = useRoute(\"/page/:slug\");\n  const [, setLocation] = useLocation();\n\n  const { data: page, isLoading } = useQuery({\n    queryKey: [\"/api/pages\", params?.slug],\n    queryFn: async () => {\n      const response = await fetch(`/api/pages/${params?.slug}`);\n      if (!response.ok) throw new Error(\"Page not found\");\n      return response.json();\n    },\n    enabled: !!params?.slug,\n  });\n\n  if (!match) return null;\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!page) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"pt-32 pb-16 text-center container mx-auto px-4\">\n          <h1 className=\"text-4xl font-bold mb-4\">Page Not Found</h1>\n          <p className=\"text-muted-foreground mb-8\">The page you're looking for doesn't exist.</p>\n          <Button onClick={() => setLocation(\"/pages\")}>\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Pages\n          </Button>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <motion.article\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        transition={{ duration: 0.5 }}\n        className=\"pt-24 pb-16\"\n      >\n        <div className=\"container mx-auto px-4 max-w-4xl\">\n          <Button \n            variant=\"ghost\" \n            className=\"mb-8\"\n            onClick={() => setLocation(\"/pages\")}\n            data-testid=\"button-back-to-pages\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Pages\n          </Button>\n\n          {page.featuredImage && (\n            <div className=\"mb-8 rounded-lg overflow-hidden h-96\">\n              <img\n                src={page.featuredImage}\n                alt={page.title}\n                className=\"w-full h-full object-cover\"\n              />\n            </div>\n          )}\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-8\"\n          >\n            <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">{page.title}</h1>\n            {page.excerpt && (\n              <p className=\"text-xl text-muted-foreground mb-4\">{page.excerpt}</p>\n            )}\n            <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n              <span>{new Date(page.updatedAt).toLocaleDateString()}</span>\n              <span>{page.views} views</span>\n            </div>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ duration: 0.5, delay: 0.2 }}\n            className=\"prose prose-sm dark:prose-invert max-w-none\"\n          >\n            <div\n              dangerouslySetInnerHTML={{ __html: page.content || \"\" }}\n              className=\"\n                [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mt-6 [&_h1]:mb-4\n                [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-5 [&_h2]:mb-3\n                [&_h3]:text-xl [&_h3]:font-bold [&_h3]:mt-4 [&_h3]:mb-2\n                [&_p]:mb-4 [&_p]:leading-relaxed\n                [&_ul]:list-disc [&_ul]:ml-6 [&_ul]:my-4\n                [&_ol]:list-decimal [&_ol]:ml-6 [&_ol]:my-4\n                [&_li]:my-2\n                [&_blockquote]:border-l-4 [&_blockquote]:border-primary [&_blockquote]:pl-4 [&_blockquote]:my-4 [&_blockquote]:text-muted-foreground [&_blockquote]:italic\n                [&_code]:bg-muted [&_code]:px-2 [&_code]:py-1 [&_code]:rounded [&_code]:font-mono\n                [&_pre]:bg-muted [&_pre]:p-4 [&_pre]:rounded-lg [&_pre]:overflow-x-auto [&_pre]:my-4\n                [&_a]:text-primary [&_a]:underline [&_a]:hover:text-primary/80\n                [&_img]:rounded-lg [&_img]:my-4 [&_img]:max-w-full [&_img]:h-auto\n                [&_table]:w-full [&_table]:border-collapse [&_table]:my-4\n                [&_th]:bg-muted [&_th]:px-4 [&_th]:py-2 [&_th]:text-left [&_th]:font-semibold\n                [&_td]:border [&_td]:border-border [&_td]:px-4 [&_td]:py-2\n              \"\n            />\n          </motion.div>\n        </div>\n      </motion.article>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":4795,"size_tokens":null},"client/src/pages/Pages.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { Calendar, Eye, Loader2, FileText } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useState } from \"react\";\n\nexport default function Pages() {\n  const { data: pages = [], isLoading } = useQuery({\n    queryKey: [\"/api/pages\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/pages?published=true\");\n      if (!response.ok) throw new Error(\"Failed to fetch pages\");\n      return response.json();\n    },\n  });\n\n  const publishedPages = pages.filter((page: any) => page.status === \"Published\");\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Pages & <span className=\"text-primary\">Resources</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Explore our custom pages and resources\n              </p>\n            </div>\n          </motion.div>\n\n          {publishedPages.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <FileText className=\"w-16 h-16 mx-auto mb-4 text-muted-foreground opacity-50\" />\n              <p className=\"text-muted-foreground text-lg\">No published pages available</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {publishedPages.map((page: any, index: number) => (\n                <motion.div\n                  key={page.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: index * 0.1 }}\n                >\n                  <Card className=\"h-full hover:shadow-lg transition-shadow overflow-hidden\">\n                    {page.featuredImage && (\n                      <div className=\"h-48 overflow-hidden\">\n                        <img\n                          src={page.featuredImage}\n                          alt={page.title}\n                          className=\"w-full h-full object-cover hover:scale-105 transition-transform duration-300\"\n                        />\n                      </div>\n                    )}\n                    <CardHeader className=\"pb-3\">\n                      <Link href={`/page/${page.slug}`}>\n                        <div className=\"cursor-pointer group\">\n                          <h3 className=\"text-xl font-bold group-hover:text-primary transition-colors line-clamp-2\">\n                            {page.title}\n                          </h3>\n                        </div>\n                      </Link>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      {page.excerpt && (\n                        <p className=\"text-muted-foreground line-clamp-3\">\n                          {page.excerpt}\n                        </p>\n                      )}\n\n                      <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                        <div className=\"flex items-center gap-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <Calendar className=\"w-4 h-4\" />\n                            {new Date(page.updatedAt).toLocaleDateString()}\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4\" />\n                            {page.views}\n                          </div>\n                        </div>\n                      </div>\n\n                      <Link href={`/page/${page.slug}`}>\n                        <button className=\"w-full px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium mt-4\">\n                          Read More\n                        </button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":4913,"size_tokens":null},"client/src/pages/admin/Pages.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useState, useEffect } from \"react\";\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash,\n  FileText,\n  Eye,\n  Loader2,\n  BookOpen,\n  Layers,\n  Home,\n  User,\n  Briefcase,\n  MessageSquare,\n  Star,\n  Mail,\n  Save,\n  Settings,\n  GripVertical,\n  Image as ImageIcon\n} from \"lucide-react\";\nimport { type Page, type HomepageSection } from \"@shared/schema\";\nimport { PageEditor } from \"@/components/admin/page-editor\";\n\ninterface SiteSettings {\n  siteTitle?: string;\n  tagline?: string;\n  contactEmail?: string;\n  heroTitle?: string;\n  heroSubtitle?: string;\n  heroDescription?: string;\n  heroStatus?: string;\n  heroCTA?: string;\n  aboutTitle?: string;\n  aboutSubtitle?: string;\n  aboutDescription?: string;\n  aboutDescription2?: string;\n  aboutName?: string;\n  aboutEmail?: string;\n  aboutLocation?: string;\n  aboutFreelance?: string;\n  aboutImage?: string;\n  cvFileUrl?: string;\n  contactTitle?: string;\n  contactSubtitle?: string;\n  contactPhone?: string;\n  contactAddress?: string;\n  socialFacebook?: string;\n  socialTwitter?: string;\n  socialInstagram?: string;\n  socialLinkedin?: string;\n  socialGithub?: string;\n  socialYoutube?: string;\n  footerText?: string;\n  footerCopyright?: string;\n  [key: string]: any;\n}\n\nconst sectionConfig = [\n  { \n    name: \"hero\", \n    icon: Home, \n    label: \"Hero Section\",\n    description: \"Main banner with title, subtitle and call-to-action\",\n    fields: [\"heroTitle\", \"heroSubtitle\", \"heroDescription\", \"heroStatus\", \"heroCTA\"]\n  },\n  { \n    name: \"about\", \n    icon: User, \n    label: \"About Section\",\n    description: \"Personal information and bio\",\n    fields: [\"aboutTitle\", \"aboutSubtitle\", \"aboutDescription\", \"aboutDescription2\", \"aboutName\", \"aboutLocation\", \"aboutFreelance\", \"aboutImage\", \"cvFileUrl\"]\n  },\n  { \n    name: \"skills\", \n    icon: Settings, \n    label: \"Skills Section\",\n    description: \"Technical skills and proficiencies\",\n    fields: []\n  },\n  { \n    name: \"services\", \n    icon: Briefcase, \n    label: \"Services Section\",\n    description: \"Services offered to clients\",\n    fields: []\n  },\n  { \n    name: \"projects\", \n    icon: Layers, \n    label: \"Projects Section\",\n    description: \"Portfolio of completed projects\",\n    fields: []\n  },\n  { \n    name: \"testimonials\", \n    icon: Star, \n    label: \"Testimonials Section\",\n    description: \"Client reviews and feedback\",\n    fields: []\n  },\n  { \n    name: \"blog\", \n    icon: BookOpen, \n    label: \"Blog Section\",\n    description: \"Latest blog posts\",\n    fields: []\n  },\n  { \n    name: \"contact\", \n    icon: Mail, \n    label: \"Contact Section\",\n    description: \"Contact form and information\",\n    fields: [\"contactTitle\", \"contactSubtitle\", \"contactPhone\", \"contactAddress\"]\n  },\n];\n\nconst fieldLabels: Record<string, string> = {\n  heroTitle: \"Hero Title\",\n  heroSubtitle: \"Hero Subtitle\", \n  heroDescription: \"Hero Description\",\n  heroStatus: \"Status Text\",\n  heroCTA: \"Call-to-Action Button\",\n  aboutTitle: \"About Title\",\n  aboutSubtitle: \"About Subtitle\",\n  aboutDescription: \"About Description\",\n  aboutDescription2: \"Additional Description\",\n  aboutName: \"Your Name\",\n  aboutLocation: \"Location\",\n  aboutFreelance: \"Availability Status\",\n  aboutImage: \"Profile Image URL\",\n  cvFileUrl: \"CV/Resume URL\",\n  contactTitle: \"Contact Title\",\n  contactSubtitle: \"Contact Subtitle\",\n  contactPhone: \"Phone Number\",\n  contactAddress: \"Address\",\n};\n\nexport default function AdminPages() {\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState(\"homepage\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [editorOpen, setEditorOpen] = useState(false);\n  const [selectedPage, setSelectedPage] = useState<Page | undefined>();\n  const [editingSection, setEditingSection] = useState<string | null>(null);\n  const [localSettings, setLocalSettings] = useState<SiteSettings>({});\n\n  const { data: pages = [], isLoading: pagesLoading, refetch: refetchPages } = useQuery<Page[]>({\n    queryKey: [\"/api/pages\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/pages\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch pages\");\n      return res.json();\n    },\n  });\n\n  const { data: posts = [], isLoading: postsLoading } = useQuery({\n    queryKey: [\"/api/posts\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/posts\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch posts\");\n      return res.json();\n    },\n  });\n\n  const { data: projects = [], isLoading: projectsLoading } = useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/projects\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch projects\");\n      return res.json();\n    },\n  });\n\n  const { data: sections = [], isLoading: sectionsLoading, refetch: refetchSections } = useQuery<HomepageSection[]>({\n    queryKey: [\"/api/homepage/sections\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/homepage/sections\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch sections\");\n      return res.json();\n    },\n  });\n\n  const { data: settings, isLoading: settingsLoading, refetch: refetchSettings } = useQuery<SiteSettings>({\n    queryKey: [\"/api/settings\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/settings\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch settings\");\n      return res.json();\n    },\n  });\n\n  useEffect(() => {\n    if (settings) {\n      setLocalSettings(settings);\n    }\n  }, [settings]);\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await fetch(`/api/pages/${id}`, {\n        method: \"DELETE\",\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Failed to delete page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchPages();\n      toast({ title: \"Success\", description: \"Page deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: number; status: string }) => {\n      const res = await fetch(`/api/pages/${id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ status }),\n      });\n      if (!res.ok) throw new Error(\"Failed to update page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchPages();\n      toast({ title: \"Success\", description: \"Page status updated\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleSectionMutation = useMutation({\n    mutationFn: async ({ name, visible }: { name: string; visible: boolean }) => {\n      const res = await fetch(`/api/homepage/sections/${name}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ visible }),\n      });\n      if (!res.ok) throw new Error(\"Failed to update section visibility\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchSections();\n      queryClient.invalidateQueries({ queryKey: [\"/api/homepage/sections\"] });\n      toast({ title: \"Success\", description: \"Section visibility updated\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (updates: Record<string, any>) => {\n      const res = await fetch(\"/api/settings\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(updates),\n      });\n      if (!res.ok) throw new Error(\"Failed to update settings\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchSettings();\n      queryClient.invalidateQueries({ queryKey: [\"/api/settings\"] });\n      toast({ title: \"Success\", description: \"Content updated successfully\" });\n      setEditingSection(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleDelete = (id: number, title: string) => {\n    if (confirm(`Are you sure you want to delete \"${title}\"?`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const toggleStatus = (id: number, currentStatus: string) => {\n    const newStatus = currentStatus === \"Published\" ? \"Draft\" : \"Published\";\n    updateStatusMutation.mutate({ id, status: newStatus });\n  };\n\n  const startEdit = (id: number) => {\n    const page = pages.find(p => p.id === id);\n    if (page) {\n      setSelectedPage(page);\n      setEditorOpen(true);\n    }\n  };\n\n  const handleCreatePage = () => {\n    setSelectedPage(undefined);\n    setEditorOpen(true);\n  };\n\n  const handleSaveSection = (sectionName: string) => {\n    const section = sectionConfig.find(s => s.name === sectionName);\n    if (!section) return;\n\n    const updates: Record<string, string> = {};\n    section.fields.forEach(field => {\n      const value = localSettings[field];\n      if (value !== undefined && value !== null) {\n        const trimmedValue = typeof value === 'string' ? value.trim() : value;\n        if (trimmedValue !== '') {\n          updates[field] = trimmedValue;\n        }\n      }\n    });\n\n    if (Object.keys(updates).length === 0) {\n      toast({ title: \"No changes\", description: \"Please fill in at least one field\", variant: \"default\" });\n      return;\n    }\n\n    updateSettingsMutation.mutate(updates);\n  };\n\n  const updateLocalSetting = (key: string, value: string) => {\n    setLocalSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const filteredPages = pages.filter(page =>\n    page.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    page.slug.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const filteredPosts = posts.filter((post: any) =>\n    post.title.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const filteredProjects = projects.filter((project: any) =>\n    project.title.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const getSectionVisibility = (sectionName: string) => {\n    const section = sections.find(s => s.name === sectionName);\n    return section?.visible ?? true;\n  };\n\n  const isLoading = pagesLoading || postsLoading || projectsLoading || sectionsLoading || settingsLoading;\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <PageEditor \n        page={selectedPage}\n        open={editorOpen}\n        onOpenChange={setEditorOpen}\n      />\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Content Management</h1>\n            <p className=\"text-muted-foreground\">Manage homepage sections, pages, and content</p>\n          </div>\n          {activeTab === \"pages\" && (\n            <Button \n              className=\"bg-primary\" \n              data-testid=\"button-create-page\"\n              onClick={handleCreatePage}\n            >\n              <Plus className=\"w-4 h-4 mr-2\" /> New Page\n            </Button>\n          )}\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"homepage\" data-testid=\"tab-homepage\">\n              <Home className=\"w-4 h-4 mr-2\" />\n              Homepage\n            </TabsTrigger>\n            <TabsTrigger value=\"pages\" data-testid=\"tab-pages\">\n              <FileText className=\"w-4 h-4 mr-2\" />\n              Pages\n            </TabsTrigger>\n            <TabsTrigger value=\"blog\" data-testid=\"tab-blog\">\n              <BookOpen className=\"w-4 h-4 mr-2\" />\n              Blog Posts\n            </TabsTrigger>\n            <TabsTrigger value=\"projects\" data-testid=\"tab-projects\">\n              <Layers className=\"w-4 h-4 mr-2\" />\n              Projects\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Homepage Content Management Tab */}\n          <TabsContent value=\"homepage\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Home className=\"w-5 h-5\" />\n                  Homepage Sections\n                </CardTitle>\n                <CardDescription>\n                  Manage visibility and content of each section on your homepage\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Accordion type=\"single\" collapsible className=\"w-full\">\n                  {sectionConfig.map((section) => {\n                    const Icon = section.icon;\n                    const isVisible = getSectionVisibility(section.name);\n                    const hasContent = section.fields.length > 0;\n                    \n                    return (\n                      <AccordionItem key={section.name} value={section.name}>\n                        <AccordionTrigger className=\"hover:no-underline\">\n                          <div className=\"flex items-center justify-between w-full pr-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className={`p-2 rounded-lg ${isVisible ? 'bg-primary/10 text-primary' : 'bg-muted text-muted-foreground'}`}>\n                                <Icon className=\"w-4 h-4\" />\n                              </div>\n                              <div className=\"text-left\">\n                                <p className=\"font-medium\">{section.label}</p>\n                                <p className=\"text-xs text-muted-foreground\">{section.description}</p>\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-3\" onClick={(e) => e.stopPropagation()}>\n                              <Badge variant={isVisible ? \"default\" : \"secondary\"} className=\"text-xs\">\n                                {isVisible ? \"Visible\" : \"Hidden\"}\n                              </Badge>\n                              <Switch\n                                checked={isVisible}\n                                onCheckedChange={(checked) => \n                                  toggleSectionMutation.mutate({ \n                                    name: section.name, \n                                    visible: checked \n                                  })\n                                }\n                                disabled={toggleSectionMutation.isPending}\n                                data-testid={`switch-section-${section.name}`}\n                              />\n                            </div>\n                          </div>\n                        </AccordionTrigger>\n                        <AccordionContent>\n                          <div className=\"pt-4 space-y-4\">\n                            {hasContent ? (\n                              <>\n                                <div className=\"grid gap-4\">\n                                  {section.fields.map(field => (\n                                    <div key={field} className=\"space-y-2\">\n                                      <Label htmlFor={field}>{fieldLabels[field] || field}</Label>\n                                      {field.includes(\"Description\") ? (\n                                        <Textarea\n                                          id={field}\n                                          value={localSettings[field] || \"\"}\n                                          onChange={(e) => updateLocalSetting(field, e.target.value)}\n                                          rows={3}\n                                          data-testid={`input-${field}`}\n                                        />\n                                      ) : (\n                                        <Input\n                                          id={field}\n                                          value={localSettings[field] || \"\"}\n                                          onChange={(e) => updateLocalSetting(field, e.target.value)}\n                                          data-testid={`input-${field}`}\n                                        />\n                                      )}\n                                    </div>\n                                  ))}\n                                </div>\n                                <div className=\"flex justify-end pt-4\">\n                                  <Button \n                                    onClick={() => handleSaveSection(section.name)}\n                                    disabled={updateSettingsMutation.isPending}\n                                    data-testid={`button-save-${section.name}`}\n                                  >\n                                    {updateSettingsMutation.isPending ? (\n                                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    ) : (\n                                      <Save className=\"w-4 h-4 mr-2\" />\n                                    )}\n                                    Save Changes\n                                  </Button>\n                                </div>\n                              </>\n                            ) : (\n                              <div className=\"text-center py-6 text-muted-foreground\">\n                                <p className=\"text-sm mb-2\">Content for this section is managed separately.</p>\n                                <Button variant=\"outline\" size=\"sm\" asChild>\n                                  <a href={`/admin/${section.name}`}>\n                                    <Settings className=\"w-4 h-4 mr-2\" />\n                                    Manage {section.label.replace(\" Section\", \"\")}\n                                  </a>\n                                </Button>\n                              </div>\n                            )}\n                          </div>\n                        </AccordionContent>\n                      </AccordionItem>\n                    );\n                  })}\n                </Accordion>\n              </CardContent>\n            </Card>\n\n            {/* Quick Stats */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-primary/10 rounded-lg\">\n                      <Eye className=\"w-4 h-4 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{sections.filter(s => s.visible).length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Visible Sections</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-blue-500/10 rounded-lg\">\n                      <Layers className=\"w-4 h-4 text-blue-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{projects.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Total Projects</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-green-500/10 rounded-lg\">\n                      <BookOpen className=\"w-4 h-4 text-green-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{posts.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Blog Posts</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-purple-500/10 rounded-lg\">\n                      <FileText className=\"w-4 h-4 text-purple-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{pages.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Static Pages</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Pages Tab */}\n          <TabsContent value=\"pages\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search pages...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-pages\"\n                />\n              </div>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredPages.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <FileText className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No pages found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Slug</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Updated</TableHead>\n                      <TableHead className=\"text-right\">Actions</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredPages.map((page) => (\n                      <TableRow key={page.id}>\n                        <TableCell>\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-8 h-8 bg-primary/10 rounded flex items-center justify-center text-primary\">\n                              <FileText size={16} />\n                            </div>\n                            <span className=\"font-medium\">{page.title}</span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <code className=\"text-sm bg-muted px-2 py-1 rounded\">/{page.slug}</code>\n                        </TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={page.status === \"Published\" ? \"default\" : \"secondary\"}\n                            className=\"cursor-pointer\"\n                            onClick={() => toggleStatus(page.id, page.status)}\n                            data-testid={`badge-status-${page.id}`}\n                          >\n                            {page.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {page.views}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {page.updatedAt ? new Date(page.updatedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <div className=\"flex justify-end gap-2\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              data-testid={`button-edit-page-${page.id}`}\n                              onClick={() => startEdit(page.id)}\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"text-destructive\"\n                              onClick={() => handleDelete(page.id, page.title)}\n                              disabled={deleteMutation.isPending}\n                              data-testid={`button-delete-page-${page.id}`}\n                            >\n                              {deleteMutation.isPending ? (\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                              ) : (\n                                <Trash className=\"w-4 h-4\" />\n                              )}\n                            </Button>\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n\n          {/* Blog Posts Tab */}\n          <TabsContent value=\"blog\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search blog posts...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-posts\"\n                />\n              </div>\n              <Button asChild>\n                <a href=\"/admin/posts\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Manage Posts\n                </a>\n              </Button>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredPosts.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <BookOpen className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No blog posts found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Category</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Published</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredPosts.map((post: any) => (\n                      <TableRow key={post.id}>\n                        <TableCell>\n                          <span className=\"font-medium\">{post.title}</span>\n                        </TableCell>\n                        <TableCell>{post.category}</TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={post.status === \"Published\" ? \"default\" : \"secondary\"}\n                            data-testid={`badge-post-status-${post.id}`}\n                          >\n                            {post.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {post.views || 0}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {post.publishedAt ? new Date(post.publishedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n\n          {/* Projects Tab */}\n          <TabsContent value=\"projects\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search projects...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-projects\"\n                />\n              </div>\n              <Button asChild>\n                <a href=\"/admin/projects\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Manage Projects\n                </a>\n              </Button>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredProjects.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <Layers className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No projects found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Category</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Updated</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredProjects.map((project: any) => (\n                      <TableRow key={project.id}>\n                        <TableCell>\n                          <span className=\"font-medium\">{project.title}</span>\n                        </TableCell>\n                        <TableCell>{project.category}</TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={project.status === \"Published\" ? \"default\" : \"secondary\"}\n                            data-testid={`badge-project-status-${project.id}`}\n                          >\n                            {project.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {project.views || 0}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {project.updatedAt ? new Date(project.updatedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":33114,"size_tokens":null},"client/src/components/admin/page-editor.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { type Page, insertPageSchema } from \"@shared/schema\";\nimport { Loader2 } from \"lucide-react\";\nimport { RichTextEditor } from \"./RichTextEditor\";\n\ninterface PageEditorProps {\n  page?: Page;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nconst getDefaultFormData = (page?: Page) => ({\n  title: page?.title || \"\",\n  slug: page?.slug || \"\",\n  content: page?.content || \"\",\n  excerpt: page?.excerpt || \"\",\n  status: page?.status || \"Draft\",\n  metaTitle: page?.metaTitle || \"\",\n  metaDescription: page?.metaDescription || \"\",\n  featuredImage: page?.featuredImage || \"\",\n});\n\nexport function PageEditor({ page, open, onOpenChange }: PageEditorProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [formData, setFormData] = useState(getDefaultFormData(page));\n\n  useEffect(() => {\n    if (open) {\n      setFormData(getDefaultFormData(page));\n    }\n  }, [page, open]);\n\n  const createMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const res = await fetch(\"/api/pages\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      });\n      if (!res.ok) throw new Error(\"Failed to create page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pages\"] });\n      toast({ title: \"Success\", description: \"Page created successfully\" });\n      onOpenChange(false);\n      setFormData({\n        title: \"\",\n        slug: \"\",\n        content: \"\",\n        excerpt: \"\",\n        status: \"Draft\",\n        metaTitle: \"\",\n        metaDescription: \"\",\n        featuredImage: \"\",\n      });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const res = await fetch(`/api/pages/${page?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      });\n      if (!res.ok) throw new Error(\"Failed to update page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pages\"] });\n      toast({ title: \"Success\", description: \"Page updated successfully\" });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleGenerateSlug = () => {\n    const slug = formData.title\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n    setFormData({ ...formData, slug });\n  };\n\n  const handleSubmit = async () => {\n    try {\n      const parsed = insertPageSchema.safeParse(formData);\n      if (!parsed.success) {\n        toast({\n          title: \"Validation Error\",\n          description: parsed.error.errors[0].message,\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      if (page) {\n        updateMutation.mutate(parsed.data);\n      } else {\n        createMutation.mutate(parsed.data);\n      }\n    } catch (error: any) {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  };\n\n  const isLoading = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{page ? \"Edit Page\" : \"Create New Page\"}</DialogTitle>\n          <DialogDescription>\n            {page ? \"Update page details\" : \"Create a new custom page\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"content\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"content\">Content</TabsTrigger>\n            <TabsTrigger value=\"seo\">SEO</TabsTrigger>\n            <TabsTrigger value=\"meta\">Meta</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"content\" className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Page Title</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"Enter page title\"\n                value={formData.title}\n                onChange={(e) =>\n                  setFormData({ ...formData, title: e.target.value })\n                }\n                data-testid=\"input-page-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"slug\">URL Slug</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  id=\"slug\"\n                  placeholder=\"page-slug\"\n                  value={formData.slug}\n                  onChange={(e) =>\n                    setFormData({ ...formData, slug: e.target.value })\n                  }\n                  data-testid=\"input-page-slug\"\n                />\n                <Button\n                  variant=\"outline\"\n                  onClick={handleGenerateSlug}\n                  type=\"button\"\n                  data-testid=\"button-generate-slug\"\n                >\n                  Auto\n                </Button>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"excerpt\">Excerpt</Label>\n              <Textarea\n                id=\"excerpt\"\n                placeholder=\"Short summary of the page\"\n                value={formData.excerpt}\n                onChange={(e) =>\n                  setFormData({ ...formData, excerpt: e.target.value })\n                }\n                className=\"min-h-20\"\n                data-testid=\"textarea-page-excerpt\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Content</Label>\n              <RichTextEditor\n                value={formData.content}\n                onChange={(content) =>\n                  setFormData({ ...formData, content })\n                }\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"featuredImage\">Featured Image URL</Label>\n              <Input\n                id=\"featuredImage\"\n                placeholder=\"https://example.com/image.jpg\"\n                value={formData.featuredImage}\n                onChange={(e) =>\n                  setFormData({ ...formData, featuredImage: e.target.value })\n                }\n                data-testid=\"input-featured-image\"\n              />\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"seo\" className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"metaTitle\">Meta Title</Label>\n              <Input\n                id=\"metaTitle\"\n                placeholder=\"Page title for search engines\"\n                value={formData.metaTitle}\n                onChange={(e) =>\n                  setFormData({ ...formData, metaTitle: e.target.value })\n                }\n                data-testid=\"input-meta-title\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Recommended: 50-60 characters\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"metaDescription\">Meta Description</Label>\n              <Textarea\n                id=\"metaDescription\"\n                placeholder=\"Page description for search engines\"\n                value={formData.metaDescription}\n                onChange={(e) =>\n                  setFormData({ ...formData, metaDescription: e.target.value })\n                }\n                className=\"min-h-20\"\n                data-testid=\"textarea-meta-description\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Recommended: 155-160 characters\n              </p>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"meta\" className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"status\">Status</Label>\n              <Select\n                value={formData.status}\n                onValueChange={(status) =>\n                  setFormData({ ...formData, status })\n                }\n              >\n                <SelectTrigger data-testid=\"select-page-status\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Draft\">Draft</SelectItem>\n                  <SelectItem value=\"Published\">Published</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"bg-muted p-4 rounded-lg space-y-2\">\n              <h4 className=\"font-medium text-sm\">Page Information</h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground\">Created:</span>\n                  <p className=\"font-medium\">\n                    {page && page.createdAt\n                      ? new Date(page.createdAt as unknown as string).toLocaleDateString()\n                      : \"New\"}\n                  </p>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground\">Updated:</span>\n                  <p className=\"font-medium\">\n                    {page && page.updatedAt\n                      ? new Date(page.updatedAt as unknown as string).toLocaleDateString()\n                      : \"New\"}\n                  </p>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground\">Views:</span>\n                  <p className=\"font-medium\">{page?.views || 0}</p>\n                </div>\n                <div>\n                  <span className=\"text-muted-foreground\">Status:</span>\n                  <Badge variant={formData.status === \"Published\" ? \"default\" : \"secondary\"}>\n                    {formData.status}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            disabled={isLoading}\n            data-testid=\"button-cancel-page\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleSubmit}\n            disabled={isLoading}\n            data-testid=\"button-save-page\"\n          >\n            {isLoading && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n            {page ? \"Update Page\" : \"Create Page\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":11580,"size_tokens":null},"client/src/hooks/use-recaptcha.ts":{"content":"import { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface CaptchaSettings {\n  captchaType?: 'disabled' | 'local' | 'google' | 'cloudflare';\n  captchaSettings?: {\n    honeypotEnabled?: boolean;\n    timeValidation?: boolean;\n    ipRateLimit?: boolean;\n    googleSiteKey?: string;\n    googleSecretKey?: string;\n    googleMinScore?: number;\n    cloudflareSiteKey?: string;\n    cloudflareSecretKey?: string;\n    cloudflareManagedMode?: boolean;\n  };\n  protectionCoverage?: {\n    loginForm?: boolean;\n    contactForm?: boolean;\n    newsletterForm?: boolean;\n    commentForms?: boolean;\n    registrationForm?: boolean;\n  };\n}\n\ndeclare global {\n  interface Window {\n    grecaptcha?: {\n      ready: (callback: () => void) => void;\n      execute: (siteKey: string, options: { action: string }) => Promise<string>;\n    };\n    turnstile?: {\n      render: (container: string | HTMLElement, options: {\n        sitekey: string;\n        callback: (token: string) => void;\n        'error-callback'?: (error: any) => void;\n        theme?: 'light' | 'dark' | 'auto';\n        size?: 'normal' | 'compact';\n      }) => string;\n      remove: (widgetId: string) => void;\n      reset: (widgetId: string) => void;\n    };\n  }\n}\n\ntype FormType = 'login' | 'contact' | 'newsletter' | 'comment' | 'registration';\n\ninterface UseRecaptchaOptions {\n  formType: FormType;\n  action?: string;\n}\n\ninterface UseRecaptchaReturn {\n  isEnabled: boolean;\n  isLoaded: boolean;\n  isLoading: boolean;\n  captchaType: 'disabled' | 'local' | 'google' | 'cloudflare' | null;\n  executeRecaptcha: () => Promise<string | null>;\n  renderTurnstile: (containerId: string) => void;\n  resetTurnstile: () => void;\n  getFormStartTime: () => number;\n  honeypotFieldName: string;\n  error: string | null;\n}\n\nexport function useRecaptcha({ formType, action }: UseRecaptchaOptions): UseRecaptchaReturn {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [turnstileToken, setTurnstileToken] = useState<string | null>(null);\n  const turnstileWidgetId = useRef<string | null>(null);\n  const formStartTime = useRef<number>(Date.now());\n  const scriptLoadAttempted = useRef(false);\n\n  const { data: settings, isLoading } = useQuery<CaptchaSettings>({\n    queryKey: ['/api/security/settings'],\n    staleTime: 1000 * 60 * 5,\n    retry: false,\n  });\n\n  const captchaType = settings?.captchaType || 'local';\n  const captchaSettings = settings?.captchaSettings || {};\n  const protectionCoverage = settings?.protectionCoverage || {};\n\n  const isFormProtected = useCallback(() => {\n    switch (formType) {\n      case 'login':\n        return protectionCoverage.loginForm !== false;\n      case 'contact':\n        return protectionCoverage.contactForm !== false;\n      case 'newsletter':\n        return protectionCoverage.newsletterForm !== false;\n      case 'comment':\n        return protectionCoverage.commentForms !== false;\n      case 'registration':\n        return protectionCoverage.registrationForm !== false;\n      default:\n        return true;\n    }\n  }, [formType, protectionCoverage]);\n\n  const isEnabled = captchaType !== 'disabled' && isFormProtected();\n\n  useEffect(() => {\n    formStartTime.current = Date.now();\n  }, []);\n\n  useEffect(() => {\n    if (scriptLoadAttempted.current) return;\n    if (isLoading || !settings) return;\n    if (captchaType === 'disabled' || captchaType === 'local') {\n      setIsLoaded(true);\n      return;\n    }\n\n    scriptLoadAttempted.current = true;\n\n    const loadScript = (src: string, id: string): Promise<void> => {\n      return new Promise((resolve, reject) => {\n        if (document.getElementById(id)) {\n          resolve();\n          return;\n        }\n\n        const script = document.createElement('script');\n        script.id = id;\n        script.src = src;\n        script.async = true;\n        script.defer = true;\n        script.onload = () => resolve();\n        script.onerror = () => reject(new Error(`Failed to load ${id}`));\n        document.head.appendChild(script);\n      });\n    };\n\n    const loadCaptchaScript = async () => {\n      try {\n        if (captchaType === 'google' && captchaSettings.googleSiteKey) {\n          await loadScript(\n            `https://www.google.com/recaptcha/api.js?render=${captchaSettings.googleSiteKey}`,\n            'google-recaptcha-script'\n          );\n          if (window.grecaptcha) {\n            window.grecaptcha.ready(() => {\n              setIsLoaded(true);\n            });\n          }\n        } else if (captchaType === 'cloudflare' && captchaSettings.cloudflareSiteKey) {\n          await loadScript(\n            'https://challenges.cloudflare.com/turnstile/v0/api.js',\n            'cloudflare-turnstile-script'\n          );\n          const checkTurnstile = setInterval(() => {\n            if (window.turnstile) {\n              clearInterval(checkTurnstile);\n              setIsLoaded(true);\n            }\n          }, 100);\n          setTimeout(() => clearInterval(checkTurnstile), 5000);\n        } else {\n          setIsLoaded(true);\n        }\n      } catch (err: any) {\n        setError(err.message);\n        setIsLoaded(true);\n      }\n    };\n\n    loadCaptchaScript();\n  }, [captchaType, captchaSettings, isLoading, settings]);\n\n  const executeRecaptcha = useCallback(async (): Promise<string | null> => {\n    if (captchaType === 'disabled') {\n      return null;\n    }\n\n    if (captchaType === 'local') {\n      const timeDiff = Date.now() - formStartTime.current;\n      if (captchaSettings.timeValidation && timeDiff < 3000) {\n        setError('Form submitted too quickly. Please wait a moment.');\n        return null;\n      }\n      return JSON.stringify({\n        type: 'local',\n        timestamp: Date.now(),\n        formStartTime: formStartTime.current,\n        timeDiff\n      });\n    }\n\n    if (captchaType === 'google') {\n      if (!window.grecaptcha || !captchaSettings.googleSiteKey) {\n        console.warn('Google reCAPTCHA not available');\n        return null;\n      }\n      try {\n        const token = await window.grecaptcha.execute(captchaSettings.googleSiteKey, {\n          action: action || formType\n        });\n        return token;\n      } catch (err: any) {\n        setError('reCAPTCHA verification failed');\n        return null;\n      }\n    }\n\n    if (captchaType === 'cloudflare') {\n      if (turnstileToken) {\n        return turnstileToken;\n      }\n      setError('Please complete the Turnstile challenge');\n      return null;\n    }\n\n    return null;\n  }, [captchaType, captchaSettings, action, formType, turnstileToken]);\n\n  const renderTurnstile = useCallback((containerId: string) => {\n    if (captchaType !== 'cloudflare' || !window.turnstile || !captchaSettings.cloudflareSiteKey) {\n      return;\n    }\n\n    const container = document.getElementById(containerId);\n    if (!container) return;\n\n    if (turnstileWidgetId.current) {\n      window.turnstile.remove(turnstileWidgetId.current);\n    }\n\n    turnstileWidgetId.current = window.turnstile.render(container, {\n      sitekey: captchaSettings.cloudflareSiteKey,\n      callback: (token: string) => {\n        setTurnstileToken(token);\n        setError(null);\n      },\n      'error-callback': (err: any) => {\n        setError('Turnstile verification failed');\n        setTurnstileToken(null);\n      },\n      theme: 'auto',\n      size: 'normal'\n    });\n  }, [captchaType, captchaSettings.cloudflareSiteKey]);\n\n  const resetTurnstile = useCallback(() => {\n    if (turnstileWidgetId.current && window.turnstile) {\n      window.turnstile.reset(turnstileWidgetId.current);\n      setTurnstileToken(null);\n    }\n  }, []);\n\n  const getFormStartTime = useCallback(() => {\n    return formStartTime.current;\n  }, []);\n\n  const honeypotFieldName = 'website_url';\n\n  // This useEffect is for the Turnstile component.\n  // It handles rendering the Turnstile widget when captchaType is 'cloudflare'\n  // and ensures cleanup when the component unmounts or captchaType changes.\n  useEffect(() => {\n    // Assuming captchaLoaded is a state or derived value indicating if the captcha script is loaded.\n    // For this example, let's assume it's true if window.turnstile is available.\n    const captchaLoaded = !!window.turnstile;\n\n    if (captchaType === 'cloudflare' && captchaLoaded && turnstileWidgetId.current === null) {\n      // We need a container ID to render the widget. Assuming 'turnstile-container'\n      // is the ID of the element in your JSX where Turnstile should be rendered.\n      renderTurnstile('turnstile-container');\n    }\n\n    // Cleanup function\n    return () => {\n      if (turnstileWidgetId.current && window.turnstile) {\n        window.turnstile.remove(turnstileWidgetId.current);\n        turnstileWidgetId.current = null;\n        setTurnstileToken(null); // Clear the token as well\n      }\n    };\n  }, [captchaType, renderTurnstile]);\n\n\n  return {\n    isEnabled,\n    isLoaded,\n    isLoading,\n    captchaType: captchaType as 'disabled' | 'local' | 'google' | 'cloudflare' | null,\n    executeRecaptcha,\n    renderTurnstile,\n    resetTurnstile,\n    getFormStartTime,\n    honeypotFieldName,\n    error\n  };\n}","path":null,"size_bytes":9152,"size_tokens":null},"client/src/pages/Maintenance.tsx":{"content":"import { useSiteSettings } from \"@/context/SiteContext\";\nimport { AlertTriangle, Cpu, Terminal, Shield } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\n\nexport default function Maintenance() {\n  const { settings } = useSiteSettings();\n  const [progress, setProgress] = useState(0);\n  const [glitchText, setGlitchText] = useState(\"\");\n\n  const maintenanceTitle =\n    settings.maintenanceTitle || \"SYSTEM_UPGRADE_IN_PROGRESS\";\n  const maintenanceMessage =\n    settings.maintenanceMessage ||\n    \"// Critical infrastructure maintenance underway\";\n  const maintenanceEstimate = settings.maintenanceEstimate || \"ETA: 00:23:17\";\n\n  // Glitch effect for title\n  useEffect(() => {\n    const chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$#@!%^&*\";\n    let interval: NodeJS.Timeout;\n\n    if (Math.random() > 0.7) {\n      interval = setInterval(() => {\n        const length = maintenanceTitle.length;\n        const positions = Array.from({ length: 2 }, () =>\n          Math.floor(Math.random() * length),\n        );\n\n        let newText = maintenanceTitle;\n        positions.forEach((pos) => {\n          newText =\n            newText.substring(0, pos) +\n            chars[Math.floor(Math.random() * chars.length)] +\n            newText.substring(pos + 1);\n        });\n\n        setGlitchText(newText);\n\n        setTimeout(() => setGlitchText(\"\"), 100);\n      }, 3000);\n    }\n\n    return () => clearInterval(interval);\n  }, [maintenanceTitle]);\n\n  // Progress simulation\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setProgress((prev) => (prev >= 87 ? 87 : prev + Math.random() * 3));\n    }, 800);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // SVG background as constant\n  const gridSvg = `url(\"data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h60v60H0z' fill='none'/%3E%3Cpath d='M30 2l4 8 9 1-6 6 1 9-8-4-8 4 1-9-6-6 9-1z' fill='%2300ff0020' fill-rule='evenodd'/%3E%3C/svg%3E\")`;\n\n  return (\n    <div className=\"min-h-screen bg-black text-green-400 font-mono overflow-hidden relative\">\n      {/* Animated background elements */}\n      <div\n        className=\"absolute inset-0 opacity-20\"\n        style={{ backgroundImage: gridSvg }}\n      ></div>\n\n      {/* Scanline effect */}\n      <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-green-500/5 to-transparent animate-scan pointer-events-none\"></div>\n\n      {/* Grid overlay */}\n      <div className=\"absolute inset-0 bg-grid-green-900/[0.02] bg-[size:20px_20px]\"></div>\n\n      <div className=\"container mx-auto px-4 py-12 relative z-10\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* Header with status bars */}\n          <div className=\"flex items-center justify-between mb-8 p-4 border border-green-500/30 bg-black/50 backdrop-blur-sm\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"p-2 bg-green-900/30 border border-green-500/50\">\n                <Cpu className=\"w-6 h-6 text-green-400\" />\n              </div>\n              <div>\n                <div className=\"text-xs text-green-300 uppercase tracking-wider\">\n                  System Status\n                </div>\n                <div className=\"text-green-400 font-bold\">MAINTENANCE_MODE</div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-6\">\n              <div className=\"text-right\">\n                <div className=\"text-xs text-green-300\">Uptime</div>\n                <div className=\"text-green-400 font-bold\">99.87%</div>\n              </div>\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n            </div>\n          </div>\n\n          {/* Main content */}\n          <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\n            {/* Left panel - System info */}\n            <div className=\"md:col-span-2 border border-green-500/30 bg-black/70 p-6\">\n              <div className=\"flex items-center space-x-3 mb-6\">\n                <AlertTriangle className=\"w-8 h-8 text-yellow-500 animate-pulse\" />\n                <h1 className=\"text-2xl font-bold text-green-300 tracking-wider\">\n                  {glitchText || maintenanceTitle}\n                </h1>\n              </div>\n\n              <div className=\"space-y-4 mb-8\">\n                <div className=\"flex items-start space-x-3\">\n                  <Terminal className=\"w-5 h-5 text-green-500 mt-1 flex-shrink-0\" />\n                  <p className=\"text-green-400 font-medium\">\n                    {maintenanceMessage}\n                  </p>\n                </div>\n\n                <div className=\"flex items-start space-x-3\">\n                  <Shield className=\"w-5 h-5 text-blue-400 mt-1 flex-shrink-0\" />\n                  <p className=\"text-blue-300 text-sm\">{maintenanceEstimate}</p>\n                </div>\n              </div>\n\n              {/* Progress bar */}\n              <div className=\"mb-6\">\n                <div className=\"flex justify-between text-xs text-green-300 mb-2\">\n                  <span>System Rebuild Progress</span>\n                  <span>{progress.toFixed(1)}%</span>\n                </div>\n                <div className=\"h-2 bg-green-900/30 overflow-hidden\">\n                  <div\n                    className=\"h-full bg-gradient-to-r from-green-500 to-emerald-400 transition-all duration-500 relative\"\n                    style={{ width: `${progress}%` }}\n                  >\n                    <div className=\"absolute inset-y-0 left-0 w-4 bg-white/30 animate-shimmer\"></div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Status indicators */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                {[\n                  { label: \"Database\", status: \"Upgrading\", color: \"yellow\" },\n                  { label: \"API Layer\", status: \"Rebuilding\", color: \"blue\" },\n                  { label: \"Security\", status: \"Active\", color: \"green\" },\n                  { label: \"Cache\", status: \"Clearing\", color: \"purple\" },\n                ].map((item, index) => (\n                  <div\n                    key={index}\n                    className=\"p-3 border border-green-500/20 bg-black/50\"\n                  >\n                    <div className=\"text-xs text-green-300 mb-1\">\n                      {item.label}\n                    </div>\n                    <div className=\"flex items-center\">\n                      <div\n                        className={`w-2 h-2 rounded-full mr-2 ${\n                          item.color === \"yellow\"\n                            ? \"bg-yellow-500\"\n                            : item.color === \"blue\"\n                              ? \"bg-blue-500\"\n                              : item.color === \"green\"\n                                ? \"bg-green-500\"\n                                : \"bg-purple-500\"\n                        } animate-pulse`}\n                      ></div>\n                      <div\n                        className={`text-sm font-bold ${\n                          item.color === \"yellow\"\n                            ? \"text-yellow-400\"\n                            : item.color === \"blue\"\n                              ? \"text-blue-400\"\n                              : item.color === \"green\"\n                                ? \"text-green-400\"\n                                : \"text-purple-400\"\n                        }`}\n                      >\n                        {item.status}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Right panel - Logs */}\n            <div className=\"border border-green-500/30 bg-black/70 p-6\">\n              <div className=\"text-green-300 font-bold mb-4 flex items-center\">\n                <Terminal className=\"w-5 h-5 mr-2\" />\n                SYSTEM LOGS\n              </div>\n              <div className=\"space-y-2 text-sm font-mono\">\n                {[\n                  \"> Initializing maintenance protocol...\",\n                  \"> Securing active connections... âœ“\",\n                  \"> Backing up database tables... âœ“\",\n                  \"> Deploying security patches...\",\n                  \"> Optimizing query performance...\",\n                  \"> Testing failover systems...\",\n                  \"> Cleaning temporary files...\",\n                  \"> Preparing restart sequence...\",\n                ].map((log, index) => (\n                  <div\n                    key={index}\n                    className=\"text-green-400/80 animate-pulse\"\n                    style={{ animationDelay: `${index * 0.2}s` }}\n                  >\n                    {log}\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* Footer */}\n          <div className=\"border-t border-green-500/30 pt-6\">\n            <div className=\"flex flex-col md:flex-row justify-between items-center text-sm\">\n              <div className=\"text-green-500/60 mb-4 md:mb-0\">\n                <div className=\"flex items-center space-x-4\">\n                  <span>Contact:</span>\n                  <a\n                    href={`mailto:${settings.contactEmail || \"sysadmin@domain.com\"}`}\n                    className=\"text-green-400 hover:text-green-300 transition-colors underline\"\n                  >\n                    {settings.contactEmail || \"sysadmin@domain.com\"}\n                  </a>\n                </div>\n              </div>\n\n              <div className=\"text-green-500/40 text-xs tracking-wider\">\n                {settings.footerCopyright ||\n                  `[${new Date().getFullYear()}] All systems reserved.`}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Glitch overlay effect */}\n      <div className=\"absolute inset-0 pointer-events-none opacity-[0.02]\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-green-500 to-transparent animate-pulse\"></div>\n      </div>\n\n      <style>{`\n        @keyframes scan {\n          0% {\n            transform: translateY(-100%);\n          }\n          100% {\n            transform: translateY(100vh);\n          }\n        }\n\n        @keyframes shimmer {\n          0% {\n            transform: translateX(-100%);\n          }\n          100% {\n            transform: translateX(100%);\n          }\n        }\n\n        .animate-scan {\n          animation: scan 3s linear infinite;\n        }\n\n        .animate-shimmer {\n          animation: shimmer 2s infinite;\n        }\n\n        .bg-grid-green-900 {\n          background-image:\n            linear-gradient(to right, currentColor 1px, transparent 1px),\n            linear-gradient(to bottom, currentColor 1px, transparent 1px);\n        }\n      `}</style>\n    </div>\n  );\n}\n","path":null,"size_bytes":10803,"size_tokens":null},"client/src/hooks/use-auth.ts":{"content":"import { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useLocation } from \"wouter\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport interface User {\n  id: number;\n  username: string;\n  email: string;\n  fullName?: string;\n  avatar?: string;\n  role: string;\n  createdAt?: string;\n}\n\nexport function useAuth() {\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const { data: user, isLoading, refetch, error } = useQuery<User | null>({\n    queryKey: [\"currentUser\"],\n    queryFn: async () => {\n      try {\n        return await api.getCurrentUser();\n      } catch {\n        return null;\n      }\n    },\n    retry: false,\n    staleTime: 5 * 60 * 1000,\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: ({ username, password }: { username: string; password: string }) =>\n      api.login(username, password),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"currentUser\"] });\n      refetch();\n      toast({ title: \"Login successful\", description: \"Welcome back!\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Login failed\", \n        description: error.message || \"Invalid credentials\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const logoutMutation = useMutation({\n    mutationFn: api.logout,\n    onSuccess: () => {\n      queryClient.removeQueries({ queryKey: [\"currentUser\"] });\n      queryClient.invalidateQueries();\n      setLocation(\"/admin/login\");\n      toast({ title: \"Logged out\", description: \"You have been logged out successfully\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Logout failed\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: (data: { username: string; password: string; email: string; fullName?: string }) => \n      api.register(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"currentUser\"] });\n      toast({ title: \"Registration successful\", description: \"Account created successfully\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Registration failed\", \n        description: error.message || \"Could not create account\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  return {\n    user: user ?? null,\n    isLoading,\n    isAuthenticated: !!user,\n    error,\n    loginMutation,\n    logoutMutation,\n    registerMutation,\n    refetch,\n  };\n}\n","path":null,"size_bytes":2578,"size_tokens":null},"client/src/pages/admin/Users.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { useMockData } from \"@/context/MockContext\";\nimport { useState } from \"react\";\nimport { \n  Plus, \n  Search, \n  Filter, \n  MoreVertical, \n  Shield,\n  Trash,\n  UserCog\n} from \"lucide-react\";\n\nexport default function AdminUsers() {\n  const { users, deleteUser, addUser, updateUser } = useMockData();\n  const [editingRoleId, setEditingRoleId] = useState<number | null>(null);\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Are you sure you want to remove this user?\")) {\n      deleteUser(id);\n    }\n  };\n\n  const handleAddDummy = () => {\n    addUser({\n      name: \"New User\",\n      email: `user${Date.now()}@example.com`,\n      role: \"Editor\",\n      status: \"Active\",\n      avatar: \"\"\n    });\n  };\n\n  const changeRole = (id: number, newRole: string) => {\n    updateUser(id, { role: newRole });\n    setEditingRoleId(null);\n  };\n\n  const toggleStatus = (id: number, currentStatus: string) => {\n    const newStatus = currentStatus === \"Active\" ? \"Inactive\" : \"Active\";\n    updateUser(id, { status: newStatus });\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Users</h1>\n            <p className=\"text-muted-foreground\">Manage team access and roles</p>\n          </div>\n          <Button className=\"bg-primary hover:bg-primary/90\" onClick={handleAddDummy}>\n            <Plus className=\"w-4 h-4 mr-2\" /> Invite User\n          </Button>\n        </div>\n\n        <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input placeholder=\"Search users...\" className=\"pl-9\" />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Filter className=\"w-4 h-4\" /> Role\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>User</TableHead>\n                <TableHead>Role</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Last Active</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {users.map((user) => (\n                <TableRow key={user.id}>\n                  <TableCell>\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar>\n                        <AvatarImage src={user.avatar} />\n                        <AvatarFallback>{user.name.charAt(0)}</AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <div className=\"font-medium\">{user.name}</div>\n                        <div className=\"text-xs text-muted-foreground\">{user.email}</div>\n                      </div>\n                    </div>\n                  </TableCell>\n                  <TableCell>\n                    {editingRoleId === user.id ? (\n                      <select \n                        className=\"p-1 rounded border bg-background text-sm\"\n                        defaultValue={user.role}\n                        onChange={(e) => changeRole(user.id, e.target.value)}\n                        onBlur={() => setEditingRoleId(null)}\n                        autoFocus\n                      >\n                        <option>Super Admin</option>\n                        <option>Admin</option>\n                        <option>Editor</option>\n                        <option>Viewer</option>\n                      </select>\n                    ) : (\n                      <div className=\"flex items-center gap-2 cursor-pointer\" onClick={() => setEditingRoleId(user.id)}>\n                        {user.role === \"Super Admin\" && <Shield className=\"w-3 h-3 text-primary\" />}\n                        <span>{user.role}</span>\n                      </div>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    <Badge \n                      variant=\"outline\" \n                      className={`cursor-pointer ${user.status === \"Active\" ? \"text-green-500 border-green-500/20 bg-green-500/10\" : \"text-muted-foreground\"}`}\n                      onClick={() => toggleStatus(user.id, user.status)}\n                    >\n                      {user.status}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"text-muted-foreground text-sm\">{user.lastActive}</TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex justify-end gap-2\">\n                      <Button variant=\"ghost\" size=\"icon\">\n                        <UserCog className=\"w-4 h-4\" />\n                      </Button>\n                      <Button variant=\"ghost\" size=\"icon\" className=\"text-destructive hover:text-destructive\" onClick={() => handleDelete(user.id)}>\n                        <Trash className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5887,"size_tokens":null},"client/src/pages/admin/Roles.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Plus, Edit, Trash, Users } from \"lucide-react\";\n\nexport default function AdminRoles() {\n  const roles = [\n    { id: 1, name: \"Super Admin\", users: 1, permissions: 45, color: \"bg-red-500\" },\n    { id: 2, name: \"Admin\", users: 3, permissions: 38, color: \"bg-orange-500\" },\n    { id: 3, name: \"Editor\", users: 5, permissions: 20, color: \"bg-blue-500\" },\n    { id: 4, name: \"Subscriber\", users: 128, permissions: 5, color: \"bg-green-500\" },\n  ];\n\n  const permissions = [\n    { group: \"Posts\", items: [\"Create\", \"Edit\", \"Delete\", \"Publish\"] },\n    { group: \"Projects\", items: [\"Create\", \"Edit\", \"Delete\", \"View\"] },\n    { group: \"Users\", items: [\"Create\", \"Edit\", \"Delete\", \"Manage Roles\"] },\n    { group: \"Settings\", items: [\"View\", \"Edit\", \"Access Logs\"] },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Roles & Permissions</h1>\n            <p className=\"text-muted-foreground\">Manage user roles and access levels</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Create Role\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          {roles.map((role) => (\n            <Card key={role.id}>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className={`w-8 h-8 rounded-full ${role.color}`} />\n                  <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\">\n                    <Edit className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n                <h3 className=\"font-bold\">{role.name}</h3>\n                <div className=\"flex items-center gap-4 mt-2 text-sm text-muted-foreground\">\n                  <div className=\"flex items-center gap-1\">\n                    <Users className=\"w-3 h-3\" /> {role.users}\n                  </div>\n                  <Badge variant=\"secondary\" className=\"text-xs\">{role.permissions} perms</Badge>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Permission Matrix</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-sm\">\n                <thead>\n                  <tr className=\"border-b\">\n                    <th className=\"text-left py-2 px-2 font-bold\">Permission</th>\n                    {roles.map((role) => (\n                      <th key={role.id} className=\"text-center py-2 px-2\">{role.name}</th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {permissions.flatMap((group) =>\n                    group.items.map((item, idx) => (\n                      <tr key={`${group.group}-${item}`} className=\"border-b last:border-0\">\n                        <td className=\"py-3 px-2\">{idx === 0 ? <strong>{group.group}</strong> : null} {item}</td>\n                        {roles.map((role) => (\n                          <td key={role.id} className=\"text-center\">\n                            <Switch defaultChecked={role.id <= 2} />\n                          </td>\n                        ))}\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":3947,"size_tokens":null},"client/src/pages/admin/Social.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  Facebook, \n  Twitter, \n  Linkedin, \n  Instagram, \n  Github, \n  Youtube,\n  Share2,\n  BarChart2,\n  Calendar,\n  Image as ImageIcon,\n  Link as LinkIcon\n} from \"lucide-react\";\n\nexport default function AdminSocial() {\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Social Media</h1>\n            <p className=\"text-muted-foreground\">Manage integrations and auto-posting</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n             <Share2 className=\"w-4 h-4\" /> Create New Post\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n           {/* Connected Accounts */}\n           <div className=\"lg:col-span-1 space-y-6\">\n              <h2 className=\"text-xl font-bold\">Connected Accounts</h2>\n              <div className=\"space-y-4\">\n                 {[\n                    { name: \"Facebook\", icon: Facebook, connected: true, handle: \"@loideveloper\" },\n                    { name: \"Twitter / X\", icon: Twitter, connected: true, handle: \"@loicode\" },\n                    { name: \"LinkedIn\", icon: Linkedin, connected: false, handle: \"\" },\n                    { name: \"Instagram\", icon: Instagram, connected: true, handle: \"@loi.dev\" },\n                    { name: \"GitHub\", icon: Github, connected: true, handle: \"@loigit\" },\n                 ].map((platform, i) => (\n                    <Card key={i} className=\"overflow-hidden\">\n                       <CardContent className=\"p-4 flex items-center justify-between\">\n                          <div className=\"flex items-center gap-3\">\n                             <div className=\"p-2 bg-muted rounded-full\">\n                                <platform.icon className=\"w-5 h-5\" />\n                             </div>\n                             <div>\n                                <h4 className=\"font-medium\">{platform.name}</h4>\n                                {platform.connected ? (\n                                   <span className=\"text-xs text-green-500 flex items-center gap-1\">\n                                      â— Connected as {platform.handle}\n                                   </span>\n                                ) : (\n                                   <span className=\"text-xs text-muted-foreground\">Not connected</span>\n                                )}\n                             </div>\n                          </div>\n                          <Switch checked={platform.connected} />\n                       </CardContent>\n                    </Card>\n                 ))}\n              </div>\n           </div>\n\n           {/* Post Scheduler & Analytics */}\n           <div className=\"lg:col-span-2 space-y-6\">\n              <Card>\n                 <CardHeader>\n                    <CardTitle>Auto-Post Settings</CardTitle>\n                    <CardDescription>Configure automatic sharing when new content is published</CardDescription>\n                 </CardHeader>\n                 <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                       <div className=\"space-y-0.5\">\n                          <h4 className=\"font-medium\">Share New Blog Posts</h4>\n                          <p className=\"text-sm text-muted-foreground\">Automatically tweet and post to LinkedIn when a new blog is published</p>\n                       </div>\n                       <Switch defaultChecked />\n                    </div>\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                       <div className=\"space-y-0.5\">\n                          <h4 className=\"font-medium\">Share New Projects</h4>\n                          <p className=\"text-sm text-muted-foreground\">Post to Instagram and Facebook when a portfolio item is added</p>\n                       </div>\n                       <Switch defaultChecked />\n                    </div>\n                 </CardContent>\n              </Card>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                 <Card>\n                    <CardHeader>\n                       <CardTitle className=\"flex items-center gap-2\">\n                          <BarChart2 className=\"w-5 h-5\" /> Engagement\n                       </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                       <div className=\"text-3xl font-bold mb-2\">12.5K</div>\n                       <p className=\"text-sm text-muted-foreground\">Total interactions this month</p>\n                       <div className=\"mt-4 h-24 flex items-end gap-1\">\n                          {[40, 65, 45, 80, 55, 90, 70].map((h, i) => (\n                             <div key={i} className=\"flex-1 bg-primary/20 rounded-t hover:bg-primary/50 transition-colors\" style={{ height: `${h}%` }} />\n                          ))}\n                       </div>\n                    </CardContent>\n                 </Card>\n\n                 <Card>\n                    <CardHeader>\n                       <CardTitle className=\"flex items-center gap-2\">\n                          <Calendar className=\"w-5 h-5\" /> Scheduled Posts\n                       </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                       <div className=\"space-y-4\">\n                          {[\n                             { title: \"React 19 Feature Breakdown\", time: \"Tomorrow, 10:00 AM\", platforms: [Twitter, Linkedin] },\n                             { title: \"Project Showcase: E-commerce\", time: \"Fri, 2:00 PM\", platforms: [Instagram, Facebook] },\n                          ].map((post, i) => (\n                             <div key={i} className=\"flex items-center justify-between border-b last:border-0 pb-2 last:pb-0\">\n                                <div>\n                                   <p className=\"font-medium text-sm truncate max-w-[150px]\">{post.title}</p>\n                                   <p className=\"text-xs text-muted-foreground\">{post.time}</p>\n                                </div>\n                                <div className=\"flex gap-1\">\n                                   {post.platforms.map((Icon, idx) => (\n                                      <Icon key={idx} className=\"w-3 h-3 text-muted-foreground\" />\n                                   ))}\n                                </div>\n                             </div>\n                          ))}\n                       </div>\n                       <Button variant=\"outline\" size=\"sm\" className=\"w-full mt-4\">View Calendar</Button>\n                    </CardContent>\n                 </Card>\n              </div>\n           </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":7292,"size_tokens":null},"INTEGRATION_GUIDE.md":{"content":"\n# Integration Guide\n\nThis guide explains how to integrate external services with your portfolio admin panel.\n\n## Email Integration (SMTP)\n\nTo enable email sending functionality:\n\n1. **Install nodemailer**:\n```bash\nnpm install nodemailer @types/nodemailer\n```\n\n2. **Update server/routes.ts** to use nodemailer:\n```typescript\nimport nodemailer from 'nodemailer';\n\n// In the /api/email/test endpoint:\nconst transporter = nodemailer.createTransport({\n  host: smtpSettings.value.smtpHost,\n  port: smtpSettings.value.smtpPort,\n  secure: smtpSettings.value.smtpSecure,\n  auth: {\n    user: smtpSettings.value.smtpUser,\n    pass: smtpSettings.value.smtpPassword,\n  },\n});\n\nawait transporter.sendMail({\n  from: settings.value.emailFromAddress,\n  to,\n  subject,\n  html: body,\n});\n```\n\n## Cloud Storage (AWS S3, Cloudflare R2)\n\n1. **Install AWS SDK**:\n```bash\nnpm install @aws-sdk/client-s3 @aws-sdk/s3-request-presigner\n```\n\n2. **Configure in Settings**:\n- Add cloud storage credentials in admin settings\n- Update file upload to use S3 instead of local storage\n\n## CDN Integration (Cloudflare)\n\n1. **Add Cloudflare API**:\n```bash\nnpm install cloudflare\n```\n\n2. **Configure**:\n- Store API key in security settings\n- Implement cache purge endpoints\n- Add zone configuration\n\n## Third-Party Integrations\n\n### Stripe\n```bash\nnpm install stripe\n```\n\n### SendGrid\n```bash\nnpm install @sendgrid/mail\n```\n\n### Slack Notifications\n```bash\nnpm install @slack/web-api\n```\n\n## Database Backup/Restore\n\nFor production database backups:\n\n1. **PostgreSQL Backup**:\n```bash\npg_dump $DATABASE_URL > backup.sql\n```\n\n2. **Automated Backups**:\n- Use cron jobs or Replit scheduled tasks\n- Store backups in cloud storage\n- Implement rotation policy\n\n## Logging Enhancement\n\nFor advanced logging:\n\n1. **Install Winston**:\n```bash\nnpm install winston winston-daily-rotate-file\n```\n\n2. **Configure**:\n- File-based logs with rotation\n- Remote logging (Logtail, Papertrail)\n- Error tracking (Sentry)\n\n## Security Notes\n\n- Store all API keys and secrets in Replit Secrets\n- Never commit credentials to version control\n- Use environment variables for sensitive data\n- Implement rate limiting for external API calls\n\n## Testing\n\nTest each integration individually:\n- SMTP: Send test email\n- Storage: Upload test file\n- CDN: Purge cache\n- Backup: Create and restore test backup\n","path":null,"size_bytes":2337,"size_tokens":null},"client/src/pages/admin/Logs.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Download, RefreshCw, Trash2, Filter } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\nimport { formatDistanceToNow } from \"date-fns\";\n\nexport default function AdminLogs() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [logLevel, setLogLevel] = useState<string>(\"all\");\n\n  const { data: logs = [], isLoading, refetch } = useQuery({\n    queryKey: [\"/api/logs\", logLevel],\n    queryFn: () => api.getLogs(logLevel),\n  });\n\n  const clearLogsMutation = useMutation({\n    mutationFn: () => api.clearActivityLogs(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/logs\"] });\n      toast({ title: \"Success\", description: \"Logs cleared\" });\n    },\n  });\n\n  const exportLogs = async () => {\n    try {\n      await api.exportLogs();\n      toast({ title: \"Success\", description: \"Logs exported\" });\n    } catch (error: any) {\n      toast({ \n        title: \"Error\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">System Logs</h1>\n            <p className=\"text-muted-foreground\">Advanced log management and analysis</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={() => refetch()}>\n              <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh\n            </Button>\n            <Button variant=\"outline\" onClick={exportLogs}>\n              <Download className=\"w-4 h-4 mr-2\" /> Export\n            </Button>\n            <Button \n              variant=\"destructive\" \n              onClick={() => clearLogsMutation.mutate()}\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" /> Clear All\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Activity Logs</CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"w-4 h-4 text-muted-foreground\" />\n                <Select value={logLevel} onValueChange={setLogLevel}>\n                  <SelectTrigger className=\"w-[180px]\">\n                    <SelectValue placeholder=\"Filter by level\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Levels</SelectItem>\n                    <SelectItem value=\"info\">Info</SelectItem>\n                    <SelectItem value=\"warning\">Warning</SelectItem>\n                    <SelectItem value=\"error\">Error</SelectItem>\n                    <SelectItem value=\"success\">Success</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <CardDescription>\n              View and filter system activity logs ({logs.length} entries)\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">Loading logs...</div>\n            ) : logs.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No logs found\n              </div>\n            ) : (\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Timestamp</TableHead>\n                    <TableHead>User</TableHead>\n                    <TableHead>Action</TableHead>\n                    <TableHead>Type</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {logs.map((log: any) => (\n                    <TableRow key={log.id}>\n                      <TableCell className=\"text-sm\">\n                        {formatDistanceToNow(new Date(log.createdAt), { \n                          addSuffix: true \n                        })}\n                      </TableCell>\n                      <TableCell>{log.userName || \"System\"}</TableCell>\n                      <TableCell>{log.action}</TableCell>\n                      <TableCell>\n                        <Badge \n                          variant={\n                            log.type === \"success\" ? \"default\" :\n                            log.type === \"error\" ? \"destructive\" :\n                            log.type === \"warning\" ? \"secondary\" : \"outline\"\n                          }\n                        >\n                          {log.type}\n                        </Badge>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5486,"size_tokens":null},"server/middleware/security.ts":{"content":"\nimport { Request, Response, NextFunction } from 'express';\nimport { storage } from '../storage';\n\n// Rate limiting store\nconst rateLimitStore = new Map<string, { count: number; resetTime: number }>();\nconst loginAttemptStore = new Map<string, { attempts: number; lockoutUntil: number }>();\n\n// IP whitelist/blacklist enforcement\nexport async function ipFilterMiddleware(req: Request, res: Response, next: NextFunction) {\n  const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n  \n  const ipRules = await storage.getAllIpRules();\n  const whitelist = ipRules.filter(r => r.type === 'whitelist');\n  const blacklist = ipRules.filter(r => r.type === 'blacklist');\n  \n  // Check blacklist first\n  const isBlacklisted = blacklist.some(rule => {\n    if (rule.ipAddress.includes('/')) {\n      // CIDR notation - simple check (should use ip-range-check library in production)\n      return clientIp.startsWith(rule.ipAddress.split('/')[0].split('.').slice(0, 3).join('.'));\n    }\n    return rule.ipAddress === clientIp;\n  });\n  \n  if (isBlacklisted) {\n    await storage.createSecurityLog({\n      action: 'Blocked by IP blacklist',\n      ipAddress: clientIp,\n      userAgent: req.get('User-Agent'),\n      eventType: 'ip_blocked',\n      blocked: true\n    });\n    return res.status(403).json({ message: 'Access denied' });\n  }\n  \n  // If whitelist exists and IP not in whitelist, block\n  if (whitelist.length > 0) {\n    const isWhitelisted = whitelist.some(rule => {\n      if (rule.ipAddress.includes('/')) {\n        return clientIp.startsWith(rule.ipAddress.split('/')[0].split('.').slice(0, 3).join('.'));\n      }\n      return rule.ipAddress === clientIp;\n    });\n    \n    if (!isWhitelisted) {\n      await storage.createSecurityLog({\n        action: 'Not in IP whitelist',\n        ipAddress: clientIp,\n        userAgent: req.get('User-Agent'),\n        eventType: 'ip_not_whitelisted',\n        blocked: true\n      });\n      return res.status(403).json({ message: 'Access denied' });\n    }\n  }\n  \n  next();\n}\n\nexport async function rateLimitMiddleware(req: Request, res: Response, next: NextFunction) {\n  const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n  const now = Date.now();\n  \n  // Get rate limit settings\n  const settings = await storage.getAllSecuritySettings();\n  const apiRateLimit = settings.find(s => s.key === 'apiRateLimit')?.value || 1000;\n  \n  const key = `${clientIp}:${req.path}`;\n  const record = rateLimitStore.get(key);\n  \n  if (record) {\n    if (now < record.resetTime) {\n      if (record.count >= Number(apiRateLimit)) {\n        await storage.createSecurityLog({\n          action: 'Rate limit exceeded',\n          ipAddress: clientIp,\n          userAgent: req.get('User-Agent'),\n          eventType: 'rate_limit_exceeded',\n          blocked: true,\n          requestPath: req.path\n        });\n        return res.status(429).json({ message: 'Too many requests, please try again later' });\n      }\n      record.count++;\n    } else {\n      rateLimitStore.set(key, { count: 1, resetTime: now + 3600000 }); // 1 hour window\n    }\n  } else {\n    rateLimitStore.set(key, { count: 1, resetTime: now + 3600000 });\n  }\n  \n  next();\n}\n\nexport async function loginRateLimitMiddleware(req: Request, res: Response, next: NextFunction) {\n  const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n  const now = Date.now();\n  \n  // Get login attempt settings\n  const settings = await storage.getAllSecuritySettings();\n  const maxAttempts = Number(settings.find(s => s.key === 'loginAttemptsLimit')?.value || 5);\n  const lockoutDuration = Number(settings.find(s => s.key === 'lockoutDuration')?.value || 15) * 60000; // minutes to ms\n  \n  const record = loginAttemptStore.get(clientIp);\n  \n  if (record) {\n    if (now < record.lockoutUntil) {\n      await storage.createSecurityLog({\n        action: 'Login attempt during lockout',\n        ipAddress: clientIp,\n        userAgent: req.get('User-Agent'),\n        eventType: 'login_lockout',\n        blocked: true\n      });\n      return res.status(429).json({ \n        message: `Too many login attempts. Please try again in ${Math.ceil((record.lockoutUntil - now) / 60000)} minutes` \n      });\n    }\n    \n    if (record.attempts >= maxAttempts) {\n      record.lockoutUntil = now + lockoutDuration;\n      await storage.createSecurityLog({\n        action: 'IP locked out due to failed login attempts',\n        ipAddress: clientIp,\n        userAgent: req.get('User-Agent'),\n        eventType: 'login_lockout',\n        blocked: true\n      });\n      return res.status(429).json({ \n        message: `Too many login attempts. Locked out for ${lockoutDuration / 60000} minutes` \n      });\n    }\n  }\n  \n  next();\n}\n\nexport function recordFailedLogin(clientIp: string) {\n  const record = loginAttemptStore.get(clientIp);\n  if (record) {\n    record.attempts++;\n  } else {\n    loginAttemptStore.set(clientIp, { attempts: 1, lockoutUntil: 0 });\n  }\n}\n\nexport function clearLoginAttempts(clientIp: string) {\n  loginAttemptStore.delete(clientIp);\n}\n\n// Clean up expired entries periodically\nsetInterval(() => {\n  const now = Date.now();\n  for (const [key, record] of rateLimitStore.entries()) {\n    if (now > record.resetTime) {\n      rateLimitStore.delete(key);\n    }\n  }\n  for (const [key, record] of loginAttemptStore.entries()) {\n    if (now > record.lockoutUntil && record.lockoutUntil > 0) {\n      loginAttemptStore.delete(key);\n    }\n  }\n}, 300000); // Clean every 5 minutes\n","path":null,"size_bytes":5444,"size_tokens":null},"client/src/components/admin/DatabaseTab.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport { \n  Database, HardDrive, Download, Upload, Trash2, \n  RefreshCw, CheckCircle, AlertCircle \n} from \"lucide-react\";\n\ninterface DatabaseStatus {\n  status: string;\n  uptime: string;\n  tables: Record<string, number>;\n  totalRecords: number;\n  databaseSize: string;\n}\n\ninterface BackupFile {\n  filename: string;\n  size: number;\n  sizeFormatted: string;\n  created: string;\n  modified: string;\n}\n\nexport function DatabaseTab() {\n  const { toast } = useToast();\n  const [status, setStatus] = useState<DatabaseStatus | null>(null);\n  const [backups, setBackups] = useState<BackupFile[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [creatingBackup, setCreatingBackup] = useState(false);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const [statusData, backupsData] = await Promise.all([\n        api.getDatabaseStatus(),\n        api.getBackups()\n      ]);\n      setStatus(statusData);\n      setBackups(backupsData);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const handleCreateBackup = async () => {\n    setCreatingBackup(true);\n    try {\n      const result = await api.createBackup();\n      toast({\n        title: \"Backup Created\",\n        description: `${result.filename} (${result.sizeFormatted}) - ${result.recordCount} records`\n      });\n      loadData();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setCreatingBackup(false);\n    }\n  };\n\n  const handleDownloadBackup = async (filename: string) => {\n    try {\n      await api.downloadBackup(filename);\n      toast({\n        title: \"Success\",\n        description: \"Backup download started\"\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleDeleteBackup = async (filename: string) => {\n    if (!confirm(`Delete backup \"${filename}\"?`)) return;\n    \n    try {\n      await api.deleteBackup(filename);\n      toast({\n        title: \"Success\",\n        description: \"Backup deleted successfully\"\n      });\n      loadData();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleRestoreBackup = async () => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".json\";\n    input.onchange = async (e: any) => {\n      const file = e.target.files[0];\n      if (file) {\n        try {\n          const result = await api.restoreBackup(file);\n          toast({\n            title: result.success ? \"Success\" : \"Info\",\n            description: result.message\n          });\n        } catch (error: any) {\n          toast({\n            title: \"Error\",\n            description: error.message,\n            variant: \"destructive\"\n          });\n        }\n      }\n    };\n    input.click();\n  };\n\n  const handleClearCache = async () => {\n    try {\n      await api.clearCache();\n      toast({\n        title: \"Success\",\n        description: \"Cache cleared successfully\"\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  if (loading && !status) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <RefreshCw className=\"w-6 h-6 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <HardDrive className=\"w-5 h-5\" /> Database Status\n          </CardTitle>\n          <CardDescription>Monitor your database health</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {status && (\n            <>\n              <div className=\"grid grid-cols-4 gap-4\">\n                <div className=\"p-4 border rounded-lg text-center\">\n                  <p className=\"text-xs text-muted-foreground\">Status</p>\n                  <p className={`text-lg font-bold flex items-center justify-center gap-1 ${status.status === \"Connected\" ? \"text-green-500\" : \"text-red-500\"}`}>\n                    {status.status === \"Connected\" ? <CheckCircle className=\"w-4 h-4\" /> : <AlertCircle className=\"w-4 h-4\" />}\n                    {status.status}\n                  </p>\n                </div>\n                <div className=\"p-4 border rounded-lg text-center\">\n                  <p className=\"text-xs text-muted-foreground\">Total Records</p>\n                  <p className=\"text-lg font-bold\">{status.totalRecords}</p>\n                </div>\n                <div className=\"p-4 border rounded-lg text-center\">\n                  <p className=\"text-xs text-muted-foreground\">Tables</p>\n                  <p className=\"text-lg font-bold\">{Object.keys(status.tables).length}</p>\n                </div>\n                <div className=\"p-4 border rounded-lg text-center\">\n                  <p className=\"text-xs text-muted-foreground\">Uptime</p>\n                  <p className=\"text-lg font-bold text-green-500\">{status.uptime}</p>\n                </div>\n              </div>\n\n              <div className=\"p-4 bg-muted rounded-lg\">\n                <h4 className=\"font-medium text-sm mb-3\">Table Statistics</h4>\n                <div className=\"grid grid-cols-5 gap-2\">\n                  {Object.entries(status.tables).map(([table, count]) => (\n                    <div key={table} className=\"text-center p-2 bg-background rounded\">\n                      <p className=\"text-xs text-muted-foreground capitalize\">{table}</p>\n                      <p className=\"text-sm font-bold\">{count}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Download className=\"w-5 h-5\" /> Backup & Restore\n            </CardTitle>\n            <Button variant=\"outline\" size=\"sm\" onClick={loadData} data-testid=\"button-refresh-backups\">\n              <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"default\" \n              className=\"w-full\"\n              onClick={handleCreateBackup}\n              disabled={creatingBackup}\n              data-testid=\"button-create-backup\"\n            >\n              {creatingBackup ? (\n                <RefreshCw className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : (\n                <Download className=\"w-4 h-4 mr-2\" />\n              )}\n              Create Backup\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"w-full\"\n              onClick={handleRestoreBackup}\n              data-testid=\"button-restore-backup\"\n            >\n              <Upload className=\"w-4 h-4 mr-2\" /> Restore from Backup\n            </Button>\n          </div>\n\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium text-sm\">Available Backups</h4>\n            {backups.length === 0 ? (\n              <p className=\"text-center text-muted-foreground py-4\">No backups found</p>\n            ) : (\n              <div className=\"max-h-64 overflow-y-auto space-y-2\">\n                {backups.map((backup, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center justify-between p-3 border rounded-lg\"\n                    data-testid={`backup-item-${i}`}\n                  >\n                    <div>\n                      <p className=\"text-sm font-mono\">{backup.filename}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {backup.sizeFormatted} &bull; {new Date(backup.created).toLocaleString()}\n                      </p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\"\n                        onClick={() => handleDownloadBackup(backup.filename)}\n                        data-testid={`button-download-backup-${i}`}\n                      >\n                        <Download className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\" \n                        className=\"text-destructive\"\n                        onClick={() => handleDeleteBackup(backup.filename)}\n                        data-testid={`button-delete-backup-${i}`}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <RefreshCw className=\"w-5 h-5\" /> Maintenance\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          <Button \n            variant=\"outline\" \n            className=\"w-full justify-start\"\n            onClick={handleClearCache}\n            data-testid=\"button-clear-cache\"\n          >\n            <Trash2 className=\"w-4 h-4 mr-2\" /> Clear Cache\n          </Button>\n          <Button \n            variant=\"outline\" \n            className=\"w-full justify-start\"\n            onClick={loadData}\n            data-testid=\"button-refresh-status\"\n          >\n            <Database className=\"w-4 h-4 mr-2\" /> Refresh Status\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","path":null,"size_bytes":10439,"size_tokens":null},"client/src/components/admin/StorageTab.tsx":{"content":"// This file has been removed as part of cleanup\nexport function StorageTab() {\n  return null;\n}","path":null,"size_bytes":96,"size_tokens":null},"client/src/components/admin/LoggingTab.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport { \n  FileText, Download, Trash2, RefreshCw, \n  AlertCircle, Info, AlertTriangle, Bug\n} from \"lucide-react\";\n\ninterface LogEntry {\n  id?: number;\n  action?: string;\n  message?: string;\n  type?: string;\n  level?: string;\n  timestamp?: string;\n  createdAt?: string;\n  source?: string;\n  userName?: string;\n  details?: any;\n}\n\ninterface LogFile {\n  filename: string;\n  size: number;\n  sizeFormatted: string;\n  modified: string;\n  date: string;\n}\n\nexport function LoggingTab() {\n  const { toast } = useToast();\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [logFiles, setLogFiles] = useState<LogFile[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedLevel, setSelectedLevel] = useState<string>(\"all\");\n  const [selectedSource, setSelectedSource] = useState<string>(\"all\");\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const [logsData, filesData] = await Promise.all([\n        api.getLogs(selectedLevel === \"all\" ? undefined : selectedLevel, 100, selectedSource === \"all\" ? undefined : selectedSource),\n        api.getLogFiles()\n      ]);\n      setLogs(logsData);\n      setLogFiles(filesData);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadData();\n  }, [selectedLevel, selectedSource]);\n\n  const handleExportLogs = async () => {\n    try {\n      await api.exportLogs(selectedSource === \"all\" ? undefined : selectedSource);\n      toast({\n        title: \"Success\",\n        description: \"Logs exported successfully\"\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleClearLogs = async () => {\n    if (!confirm(\"Delete all log files? This action cannot be undone.\")) return;\n    \n    try {\n      await api.clearAllLogs();\n      toast({\n        title: \"Success\",\n        description: \"All log files cleared\"\n      });\n      loadData();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleDeleteLogFile = async (filename: string) => {\n    if (!confirm(`Delete log file \"${filename}\"?`)) return;\n    \n    try {\n      await api.deleteLogFile(filename);\n      toast({\n        title: \"Success\",\n        description: \"Log file deleted\"\n      });\n      loadData();\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const getLogIcon = (type: string) => {\n    switch (type?.toLowerCase()) {\n      case \"error\": return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n      case \"warning\": return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\n      case \"debug\": return <Bug className=\"w-4 h-4 text-purple-500\" />;\n      default: return <Info className=\"w-4 h-4 text-blue-500\" />;\n    }\n  };\n\n  const getLogBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n    switch (type?.toLowerCase()) {\n      case \"error\": return \"destructive\";\n      case \"warning\": return \"outline\";\n      default: return \"secondary\";\n    }\n  };\n\n  if (loading && logs.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <RefreshCw className=\"w-6 h-6 animate-spin\" />\n      </div>\n    );\n  }\n\n  const totalLogSize = logFiles.reduce((sum, file) => sum + file.size, 0);\n  const formatSize = (bytes: number) => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / 1024 / 1024).toFixed(2)} MB`;\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"w-5 h-5\" /> Log Management\n              </CardTitle>\n              <CardDescription>\n                View and manage application logs\n              </CardDescription>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={loadData} data-testid=\"button-refresh-logs\">\n                <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" onClick={handleExportLogs} data-testid=\"button-export-logs\">\n                <Download className=\"w-4 h-4 mr-1\" /> Export\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-4 flex-wrap\">\n            <div className=\"flex gap-2 items-center\">\n              <span className=\"text-sm text-muted-foreground\">Level:</span>\n              {[\"all\", \"info\", \"warning\", \"error\", \"debug\"].map(level => (\n                <Button\n                  key={level}\n                  variant={selectedLevel === level ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setSelectedLevel(level)}\n                  data-testid={`button-filter-${level}`}\n                >\n                  {level.charAt(0).toUpperCase() + level.slice(1)}\n                </Button>\n              ))}\n            </div>\n            <div className=\"flex gap-2 items-center\">\n              <span className=\"text-sm text-muted-foreground\">Source:</span>\n              {[\"all\", \"database\", \"file\"].map(source => (\n                <Button\n                  key={source}\n                  variant={selectedSource === source ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setSelectedSource(source)}\n                  data-testid={`button-source-${source}`}\n                >\n                  {source.charAt(0).toUpperCase() + source.slice(1)}\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n            {logs.length === 0 ? (\n              <p className=\"text-center text-muted-foreground py-8\">No logs found</p>\n            ) : (\n              logs.map((log, i) => (\n                <div\n                  key={i}\n                  className=\"flex items-start gap-3 p-3 border rounded-lg\"\n                  data-testid={`log-entry-${i}`}\n                >\n                  {getLogIcon(log.type || log.level || \"info\")}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 flex-wrap\">\n                      <Badge variant={getLogBadgeVariant(log.type || log.level || \"info\")} className=\"text-xs\">\n                        {(log.type || log.level || \"info\").toUpperCase()}\n                      </Badge>\n                      {log.source && (\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {log.source}\n                        </Badge>\n                      )}\n                      {log.userName && (\n                        <span className=\"text-xs text-muted-foreground\">by {log.userName}</span>\n                      )}\n                    </div>\n                    <p className=\"text-sm mt-1\">{log.action || log.message || \"No message\"}</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {new Date(log.timestamp || log.createdAt || \"\").toLocaleString()}\n                    </p>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle>Log Files</CardTitle>\n            <Button \n              variant=\"outline\" \n              size=\"sm\" \n              className=\"text-destructive\"\n              onClick={handleClearLogs}\n              data-testid=\"button-clear-all-logs\"\n            >\n              <Trash2 className=\"w-4 h-4 mr-1\" /> Clear All\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"p-4 bg-muted rounded-lg\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span>Total Log Size</span>\n              <span className=\"font-medium\">{formatSize(totalLogSize)}</span>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {logFiles.length} log file(s)\n            </p>\n          </div>\n\n          <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n            {logFiles.length === 0 ? (\n              <p className=\"text-center text-muted-foreground py-4\">No log files</p>\n            ) : (\n              logFiles.map((file, i) => (\n                <div\n                  key={i}\n                  className=\"flex items-center justify-between p-3 border rounded-lg\"\n                  data-testid={`log-file-${i}`}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <FileText className=\"w-4 h-4 text-muted-foreground\" />\n                    <div>\n                      <p className=\"text-sm font-mono\">{file.filename}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {file.sizeFormatted} &bull; {file.date}\n                      </p>\n                    </div>\n                  </div>\n                  <Button \n                    variant=\"ghost\" \n                    size=\"sm\" \n                    className=\"text-destructive\"\n                    onClick={() => handleDeleteLogFile(file.filename)}\n                    data-testid={`button-delete-logfile-${i}`}\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              ))\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","path":null,"size_bytes":10392,"size_tokens":null},"server/cron.ts":{"content":"\nimport { storage } from \"./storage\";\nimport nodemailer from \"nodemailer\";\n\n// Check for expiring passwords and send reminder emails\nexport async function checkPasswordExpiry() {\n  try {\n    const passwordExpirationSetting = await storage.getSecuritySetting('passwordExpiration');\n    if (passwordExpirationSetting?.value !== 'true' && passwordExpirationSetting?.value !== true) {\n      return; // Password expiration is disabled\n    }\n\n    const allUsers = await storage.getAllUsers();\n    const now = Date.now();\n    const reminderThreshold = 7 * 24 * 60 * 60 * 1000; // 7 days before expiry\n    const maxAge = 90 * 24 * 60 * 60 * 1000; // 90 days\n\n    for (const user of allUsers) {\n      if (!user.passwordUpdatedAt) {\n        // Set initial password update date if missing\n        const expiresAt = new Date(now + maxAge);\n        await storage.updateUser(user.id, {\n          passwordUpdatedAt: new Date(),\n          passwordExpiresAt: expiresAt\n        });\n        continue;\n      }\n\n      const passwordAge = now - new Date(user.passwordUpdatedAt).getTime();\n      const timeUntilExpiry = maxAge - passwordAge;\n\n      // Check if password will expire in the next 7 days\n      if (timeUntilExpiry > 0 && timeUntilExpiry <= reminderThreshold) {\n        const daysUntilExpiry = Math.ceil(timeUntilExpiry / (24 * 60 * 60 * 1000));\n        await sendPasswordExpiryReminder(user, daysUntilExpiry);\n        \n        await storage.createActivityLog({\n          action: `Password expiry reminder sent to ${user.username} (${daysUntilExpiry} days remaining)`,\n          userId: user.id,\n          userName: user.username,\n          type: 'info'\n        });\n      }\n    }\n  } catch (error) {\n    console.error('Error checking password expiry:', error);\n  }\n}\n\nasync function sendPasswordExpiryReminder(user: any, daysRemaining: number) {\n  try {\n    const smtpHost = await storage.getSetting(\"smtpHost\");\n    const smtpPort = await storage.getSetting(\"smtpPort\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n    const smtpPassword = await storage.getSetting(\"smtpPassword\");\n    const smtpSecure = await storage.getSetting(\"smtpSecure\");\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n\n    if (!smtpHost?.value || !smtpPort?.value || !smtpUser?.value || !smtpPassword?.value) {\n      console.log('SMTP not configured, skipping email notification');\n      return;\n    }\n\n    const port = typeof smtpPort.value === 'string' ? parseInt(smtpPort.value) : smtpPort.value;\n    const secure = smtpSecure?.value === true || smtpSecure?.value === 'true';\n\n    const transporter = nodemailer.createTransport({\n      host: smtpHost.value as string,\n      port: port as number,\n      secure: secure,\n      auth: {\n        user: smtpUser.value as string,\n        pass: smtpPassword.value as string,\n      },\n      requireTLS: !secure,\n      connectionTimeout: 10000,\n      greetingTimeout: 10000,\n      socketTimeout: 10000,\n    });\n\n    const subject = `Password Expiry Reminder - ${daysRemaining} day${daysRemaining > 1 ? 's' : ''} remaining`;\n    const body = `\n      <h2>Password Expiry Reminder</h2>\n      <p>Hello ${user.name},</p>\n      <p>Your password will expire in <strong>${daysRemaining} day${daysRemaining > 1 ? 's' : ''}</strong>.</p>\n      <p>Please change your password before it expires to maintain access to your account.</p>\n      <p>You can change your password in your profile settings after logging in.</p>\n      <br>\n      <p>If you have any questions, please contact the administrator.</p>\n      <p>Best regards,<br>System Administrator</p>\n    `;\n\n    await transporter.sendMail({\n      from: `\"${emailFromName?.value || 'Portfolio'}\" <${emailFromAddress?.value || smtpUser.value}>`,\n      to: user.email,\n      subject,\n      html: body,\n    });\n\n    console.log(`Password expiry reminder sent to ${user.email}`);\n  } catch (error) {\n    console.error(`Failed to send password expiry reminder to ${user.email}:`, error);\n  }\n}\n\n// Run the check daily at midnight\nexport function startPasswordExpiryCron() {\n  // Run immediately on startup\n  checkPasswordExpiry();\n\n  // Then run every 24 hours\n  setInterval(() => {\n    checkPasswordExpiry();\n  }, 24 * 60 * 60 * 1000);\n\n  console.log('Password expiry cron job started');\n}\n","path":null,"size_bytes":4347,"size_tokens":null},"client/src/pages/admin/ForcePasswordReset.tsx":{"content":"\nimport { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Lock, Eye, EyeOff, Shield, AlertTriangle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function ForcePasswordReset() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  // Get userId from URL params\n  const urlParams = new URLSearchParams(window.location.search);\n  const userId = urlParams.get('userId');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"Password Mismatch\",\n        description: \"New password and confirmation don't match\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 8) {\n      toast({\n        title: \"Weak Password\",\n        description: \"Password must be at least 8 characters long\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/auth/force-password-reset\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId, currentPassword, newPassword }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        toast({\n          title: \"Success\",\n          description: \"Password reset successfully. You can now login.\",\n        });\n        setTimeout(() => {\n          setLocation(\"/admin/login\");\n        }, 1500);\n      } else {\n        toast({\n          title: \"Reset Failed\",\n          description: data.message || \"Failed to reset password\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to connect to server\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!userId) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-black\">\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>Invalid request. Missing user ID.</AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden bg-black\">\n      <div className=\"absolute inset-0 z-0\">\n        <img \n          src={loginBg} \n          alt=\"Background\" \n          className=\"w-full h-full object-cover opacity-50\"\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent\" />\n      </div>\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"relative z-10 w-full max-w-md px-4\"\n      >\n        <Card className=\"border-white/10 bg-black/40 backdrop-blur-xl shadow-2xl\">\n          <CardHeader className=\"text-center space-y-2 pb-6 border-b border-white/5\">\n            <div className=\"mx-auto w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center mb-2 ring-1 ring-amber-500/50\">\n              <AlertTriangle className=\"w-6 h-6 text-amber-500\" />\n            </div>\n            <CardTitle className=\"text-2xl font-bold tracking-tight text-white\">\n              Password Expired\n            </CardTitle>\n            <CardDescription className=\"text-white/50\">\n              Your password has expired. Please reset it to continue.\n            </CardDescription>\n          </CardHeader>\n          \n          <CardContent className=\"pt-6\">\n            <Alert className=\"mb-6 bg-amber-500/10 border-amber-500/20\">\n              <Shield className=\"h-4 w-4 text-amber-500\" />\n              <AlertDescription className=\"text-white/80\">\n                For security reasons, passwords must be changed every 90 days.\n              </AlertDescription>\n            </Alert>\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Current Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showCurrentPassword ? \"text\" : \"password\"} \n                    placeholder=\"Enter current password\"\n                    value={currentPassword}\n                    onChange={(e) => setCurrentPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowCurrentPassword(!showCurrentPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showCurrentPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">New Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showNewPassword ? \"text\" : \"password\"} \n                    placeholder=\"Enter new password\"\n                    value={newPassword}\n                    onChange={(e) => setNewPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowNewPassword(!showNewPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showNewPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Confirm New Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showConfirmPassword ? \"text\" : \"password\"} \n                    placeholder=\"Confirm new password\"\n                    value={confirmPassword}\n                    onChange={(e) => setConfirmPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showConfirmPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <Button \n                type=\"submit\" \n                className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2\"\n                disabled={isLoading}\n              >\n                {isLoading ? \"Resetting...\" : \"Reset Password\"}\n              </Button>\n            </form>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8540,"size_tokens":null},"client/src/pages/admin/content/services/ServicesEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Check, Plus, Edit, Trash2, X, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Service } from \"@shared/schema\";\n\ninterface ServiceFormData {\n  title: string;\n  description: string;\n  icon: string;\n  features: string[];\n  price: string;\n  order: number;\n  active: boolean;\n}\n\nconst getEmptyService = (): ServiceFormData => ({\n  title: \"\",\n  description: \"\",\n  icon: \"code\",\n  features: [],\n  price: \"\",\n  order: 0,\n  active: true,\n});\n\nexport default function AdminServicesEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingService, setEditingService] = useState<Service | null>(null);\n  const [formData, setFormData] = useState<ServiceFormData>(getEmptyService());\n  const [featureInput, setFeatureInput] = useState(\"\");\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n\n  const { data: services = [], isLoading } = useQuery({\n    queryKey: [\"/api/services\"],\n    queryFn: () => api.getServices(),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => api.createService(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: any }) =>\n      api.updateService(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteService(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Service deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyService());\n    setEditingService(null);\n    setFeatureInput(\"\");\n  };\n\n  const handleOpenDialog = (service?: Service) => {\n    if (service) {\n      setEditingService(service);\n      setFormData({\n        title: service.title,\n        description: service.description || \"\",\n        icon: service.icon || \"code\",\n        features: service.features || [],\n        price: service.price || \"\",\n        order: service.order,\n        active: service.active,\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim() && !formData.features.includes(featureInput.trim())) {\n      setFormData({\n        ...formData,\n        features: [...formData.features, featureInput.trim()],\n      });\n      setFeatureInput(\"\");\n    }\n  };\n\n  const removeFeature = (feature: string) => {\n    setFormData({\n      ...formData,\n      features: formData.features.filter((f) => f !== feature),\n    });\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Service title is required\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (editingService) {\n      updateMutation.mutate({ id: editingService.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Services</h1>\n            <p className=\"text-muted-foreground\">Manage services and pricing</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-create-service\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n          </Button>\n        </div>\n\n        {isLoading ? (\n          <Card>\n            <CardContent className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"w-6 h-6 animate-spin\" />\n            </CardContent>\n          </Card>\n        ) : services.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No services yet</p>\n              <Button onClick={() => handleOpenDialog()}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create first service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Service Comparison Table */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Service Comparison</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full text-sm\">\n                    <thead>\n                      <tr className=\"border-b\">\n                        <th className=\"text-left py-3 px-2\">Feature</th>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <th key={service.id} className=\"text-center py-3 px-2\">\n                              {service.title}\n                            </th>\n                          ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr className=\"border-b\">\n                        <td className=\"py-3 px-2 font-medium\">Price</td>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <td key={service.id} className=\"text-center py-3 px-2\">\n                              <span className=\"font-semibold\">{service.price}</span>\n                            </td>\n                          ))}\n                      </tr>\n                      {Array.from({\n                        length: Math.max(\n                          0,\n                          Math.max(...services.map((s) => (s.features || []).length))\n                        ),\n                      }).map((_, featureIdx) => (\n                        <tr key={featureIdx} className=\"border-b\">\n                          <td className=\"py-3 px-2 font-medium text-sm\">\n                            {services[0]?.features?.[featureIdx] || \"Feature\"}\n                          </td>\n                          {services\n                            .sort((a, b) => a.order - b.order)\n                            .map((service) => (\n                              <td key={service.id} className=\"text-center py-3 px-2\">\n                                {service.features && service.features[featureIdx] ? (\n                                  <Check className=\"w-4 h-4 text-green-500 mx-auto\" />\n                                ) : (\n                                  <span className=\"text-muted-foreground\">-</span>\n                                )}\n                              </td>\n                            ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Service Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {services\n                .sort((a, b) => a.order - b.order)\n                .map((service) => (\n                  <Card\n                    key={service.id}\n                    className=\"flex flex-col\"\n                    data-testid={`card-service-${service.id}`}\n                  >\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-lg\">{service.title}</CardTitle>\n                          {!service.active && (\n                            <Badge variant=\"outline\" className=\"mt-2\">\n                              Inactive\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-baseline gap-1 mt-2\">\n                        <span className=\"text-3xl font-bold\">{service.price}</span>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        {service.description}\n                      </p>\n                    </CardHeader>\n                    <CardContent className=\"flex-1 space-y-4\">\n                      {service.features && service.features.length > 0 && (\n                        <ul className=\"space-y-2\">\n                          {service.features.map((feature: string) => (\n                            <li key={feature} className=\"flex items-center gap-2 text-sm\">\n                              <Check className=\"w-4 h-4 text-green-500\" />\n                              {feature}\n                            </li>\n                          ))}\n                        </ul>\n                      )}\n                      <div className=\"flex gap-2 pt-4\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => handleOpenDialog(service)}\n                          className=\"flex-1\"\n                          data-testid={`button-edit-service-${service.id}`}\n                        >\n                          <Edit className=\"w-4 h-4 mr-1\" /> Edit\n                        </Button>\n                        <AlertDialog>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => setDeleteId(service.id)}\n                            data-testid={`button-delete-service-${service.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-red-500\" />\n                          </Button>\n                        </AlertDialog>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Create/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingService ? \"Edit Service\" : \"Create New Service\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingService\n                ? \"Update the service details below.\"\n                : \"Fill in the details to create a new service.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Service Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"e.g., Web Development\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                placeholder=\"Brief description of the service\"\n                value={formData.description}\n                onChange={(e) =>\n                  setFormData({ ...formData, description: e.target.value })\n                }\n                data-testid=\"input-description\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"price\">Price</Label>\n                <Input\n                  id=\"price\"\n                  placeholder=\"e.g., From $2,000\"\n                  value={formData.price}\n                  onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n                  data-testid=\"input-price\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"icon\">Icon</Label>\n                <Input\n                  id=\"icon\"\n                  placeholder=\"e.g., code, smartphone, palette\"\n                  value={formData.icon}\n                  onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                  data-testid=\"input-icon\"\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"order\">Order</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) =>\n                    setFormData({ ...formData, order: parseInt(e.target.value) || 0 })\n                  }\n                  data-testid=\"input-order\"\n                />\n              </div>\n\n              <div className=\"flex items-end gap-2\">\n                <div className=\"flex-1 space-y-2\">\n                  <Label htmlFor=\"active\">Active</Label>\n                  <div className=\"flex items-center gap-2 pt-1\">\n                    <Switch\n                      id=\"active\"\n                      checked={formData.active}\n                      onCheckedChange={(checked) =>\n                        setFormData({ ...formData, active: checked })\n                      }\n                      data-testid=\"switch-active\"\n                    />\n                    <span className=\"text-sm text-muted-foreground\">\n                      {formData.active ? \"Active\" : \"Inactive\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Features</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  placeholder=\"Add feature (e.g., Responsive Design)\"\n                  value={featureInput}\n                  onChange={(e) => setFeatureInput(e.target.value)}\n                  onKeyPress={(e) =>\n                    e.key === \"Enter\" && (e.preventDefault(), addFeature())\n                  }\n                  data-testid=\"input-feature\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={addFeature}\n                  data-testid=\"button-add-feature\"\n                >\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.features.map((feature) => (\n                  <Badge key={feature} variant=\"secondary\" className=\"gap-1\">\n                    {feature}\n                    <button\n                      onClick={() => removeFeature(feature)}\n                      className=\"ml-1 hover:text-destructive\"\n                      data-testid={`button-remove-feature-${feature}`}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setIsDialogOpen(false)}\n              data-testid=\"button-cancel\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={isPending}\n              data-testid=\"button-save-service\"\n            >\n              {isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : editingService ? (\n                \"Update Service\"\n              ) : (\n                \"Create Service\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Dialog */}\n      <AlertDialog open={deleteId !== null} onOpenChange={() => setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Service</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this service? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deleteId) {\n                  deleteMutation.mutate(deleteId);\n                }\n              }}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":18891,"size_tokens":null},"client/src/pages/admin/security/Security.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useState, useEffect } from \"react\";\nimport {\n  Shield, Key, Lock, Smartphone, Globe, AlertTriangle, Trash2,\n  ShieldAlert, RefreshCw, Eye, EyeOff, Clock, Users,\n  Monitor, LogOut, Ban, CheckCircle, XCircle,\n  Server, AlertCircle, Plus, Loader2, FileText, BarChart3,\n  Zap, Activity, Layers, QrCode, Copy, Check, ShieldCheck,\n  Fingerprint, Settings2, Radio, TrendingUp, Lock as LockIcon\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\nimport { EnhancedFirewall } from \"@/components/admin/EnhancedFirewall\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\ninterface SecuritySettings {\n  twoFactorEnabled?: boolean;\n  passwordExpiration?: boolean;\n  captchaType?: 'disabled' | 'local' | 'google' | 'cloudflare';\n  captchaSettings?: {\n    honeypotEnabled?: boolean;\n    timeValidation?: boolean;\n    ipRateLimit?: boolean;\n    googleSiteKey?: string;\n    googleSecretKey?: string;\n    googleMinScore?: number;\n    cloudflareSiteKey?: string;\n    cloudflareSecretKey?: string;\n    cloudflareManagedMode?: boolean;\n  };\n  protectionCoverage?: {\n    loginForm?: boolean;\n    contactForm?: boolean;\n    newsletterForm?: boolean;\n    commentForms?: boolean;\n    registrationForm?: boolean;\n  };\n  rateLimiting?: {\n    loginAttemptsLimit?: number;\n    apiRateLimit?: number;\n    lockoutDuration?: number;\n  };\n  ddosProtection?: {\n    enabled?: boolean;\n    threshold?: number;\n    blockDuration?: number;\n  };\n  sqlInjectionProtection?: {\n    enabled?: boolean;\n    logAttempts?: boolean;\n    blockRequests?: boolean;\n  };\n  xssProtection?: {\n    enabled?: boolean;\n    sanitizeInput?: boolean;\n    blockRequests?: boolean;\n  };\n  sessionSettings?: {\n    idleTimeout?: string;\n    maxDuration?: string;\n    forceLogoutInactive?: boolean;\n    concurrentSessionLimit?: string;\n  };\n  compliance?: {\n    gdprEnabled?: boolean;\n    dataRetentionDays?: number;\n    privacyPolicyUrl?: string;\n    cookieConsentEnabled?: boolean;\n  };\n  cspSettings?: {\n    enabled?: boolean;\n    strictMode?: boolean;\n    reportUri?: string;\n  };\n  scannerSettings?: {\n    vulnerabilityScanEnabled?: boolean;\n    sslScanEnabled?: boolean;\n    malwareScanEnabled?: boolean;\n    scanFrequency?: string;\n  };\n}\n\ninterface TrustedDevice {\n  id: number;\n  userId: number;\n  deviceName: string;\n  deviceFingerprint?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  trusted: boolean;\n  lastUsed?: string;\n  createdAt?: string;\n}\n\ninterface UserSession {\n  id: number;\n  sessionId: string;\n  userId: number;\n  ipAddress?: string;\n  userAgent?: string;\n  deviceInfo?: string;\n  location?: string;\n  active: boolean;\n  createdAt?: string;\n  expiresAt?: string;\n  lastActivity?: string;\n}\n\ninterface IpRule {\n  id: number;\n  ipAddress: string;\n  type: 'whitelist' | 'blacklist';\n  reason?: string;\n  createdBy?: number;\n  createdAt?: string;\n}\n\ninterface SecurityStats {\n  totalBlocked: number;\n  totalAllowed: number;\n  byEventType: { type: string; count: number }[];\n}\n\ninterface SecurityLog {\n  id: number;\n  eventType?: string;\n  action: string;\n  userId?: number;\n  userName?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  type: string;\n  blocked?: boolean;\n  createdAt?: string;\n}\n\nconst flattenSettings = (obj: Record<string, any>, prefix = ''): Record<string, any> => {\n  const result: Record<string, any> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    const newKey = prefix ? `${prefix}.${key}` : key;\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n      Object.assign(result, flattenSettings(value, newKey));\n    } else {\n      result[newKey] = value;\n    }\n  }\n  return result;\n};\n\nexport default function AdminSecurityEnhanced() {\n  const { toast } = useToast();\n  const [newWhitelistIp, setNewWhitelistIp] = useState(\"\");\n  const [newBlacklistIp, setNewBlacklistIp] = useState(\"\");\n  const [showGoogleSecret, setShowGoogleSecret] = useState(false);\n  const [showCloudflareSecret, setShowCloudflareSecret] = useState(false);\n  const [showLoginHistory, setShowLoginHistory] = useState(false);\n\n  const [show2FASetup, setShow2FASetup] = useState(false);\n  const [show2FAVerify, setShow2FAVerify] = useState(false);\n  const [show2FADisable, setShow2FADisable] = useState(false);\n  const [qrCode, setQrCode] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const [verifyCode, setVerifyCode] = useState(\"\");\n  const [disableCode, setDisableCode] = useState(\"\");\n  const [secretCopied, setSecretCopied] = useState(false);\n\n  const { data: settings = {}, isLoading: settingsLoading, refetch: refetchSettings } = useQuery<SecuritySettings>({\n    queryKey: ['/api/security/settings'],\n  });\n\n  const { data: devices = [], refetch: refetchDevices } = useQuery<TrustedDevice[]>({\n    queryKey: ['/api/security/devices'],\n  });\n\n  const { data: sessions = [], refetch: refetchSessions } = useQuery<UserSession[]>({\n    queryKey: ['/api/security/sessions'],\n    refetchInterval: 30000,\n  });\n\n  const { data: ipRules = [], refetch: refetchIpRules } = useQuery<IpRule[]>({\n    queryKey: ['/api/security/ip-rules'],\n  });\n\n  const { data: stats } = useQuery<SecurityStats>({\n    queryKey: ['/api/security/stats'],\n  });\n\n  const { data: loginHistory = [], refetch: refetchLoginHistory, isRefetching: isRefetchingLoginHistory } = useQuery<SecurityLog[]>({\n    queryKey: ['/api/security/login-history'],\n    refetchInterval: showLoginHistory ? 30000 : false,\n  });\n\n  const { data: user = null, refetch: refetchUser } = useQuery<any>({\n    queryKey: ['/api/auth/me'],\n  });\n\n  const [localSettings, setLocalSettings] = useState<SecuritySettings>({});\n\n  useEffect(() => {\n    if (settings && Object.keys(settings).length > 0) {\n      setLocalSettings(settings);\n    }\n  }, [settings]);\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (newSettings: SecuritySettings) => {\n      const flatSettings = flattenSettings(newSettings);\n      return apiRequest('POST', '/api/security/settings/bulk', flatSettings);\n    },\n    onSuccess: () => {\n      toast({ title: \"Settings saved successfully\" });\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Failed to save settings\", variant: \"destructive\" });\n    }\n  });\n\n  const deleteDeviceMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/devices/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Device removed\" });\n      refetchDevices();\n    }\n  });\n\n  const terminateSessionMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('POST', `/api/security/sessions/terminate/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Session terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const terminateAllSessionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/terminate-all');\n    },\n    onSuccess: () => {\n      toast({ title: \"All sessions terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const logoutAllDevicesMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/logout-all-devices');\n    },\n    onSuccess: () => {\n      toast({ title: \"Logged out from all devices\" });\n      refetchSessions();\n    }\n  });\n\n  const addIpRuleMutation = useMutation({\n    mutationFn: async ({ ipAddress, type }: { ipAddress: string; type: 'whitelist' | 'blacklist' }) => {\n      return apiRequest('POST', '/api/security/ip-rules', { ipAddress, type });\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule added\" });\n      setNewWhitelistIp(\"\");\n      setNewBlacklistIp(\"\");\n      refetchIpRules();\n    }\n  });\n\n  const deleteIpRuleMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/ip-rules/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule removed\" });\n      refetchIpRules();\n    }\n  });\n\n  const generate2FAMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest('POST', '/api/auth/2fa/generate');\n      return await res.json();\n    },\n    onSuccess: (data: any) => {\n      if (data?.secret && data?.qrCode) {\n        setSecret(data.secret);\n        setQrCode(data.qrCode);\n        setShow2FASetup(true);\n      } else {\n        toast({ title: \"Failed to generate 2FA setup\", description: \"Missing secret or QR code\", variant: \"destructive\" });\n      }\n    },\n    onError: (error: any) => {\n      toast({ title: \"Failed to generate 2FA setup\", description: error.message || \"Unknown error\", variant: \"destructive\" });\n    }\n  });\n\n  const verify2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/verify', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA enabled successfully\" });\n      setShow2FASetup(false);\n      setShow2FAVerify(false);\n      setVerifyCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const disable2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/disable', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA disabled successfully\" });\n      setShow2FADisable(false);\n      setDisableCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const updateLocalSetting = (key: string, value: any) => {\n    setLocalSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const updateNestedSetting = (parentKey: string, childKey: string, value: any) => {\n    setLocalSettings(prev => ({\n      ...prev,\n      [parentKey]: {\n        ...(prev[parentKey as keyof SecuritySettings] as Record<string, any> || {}),\n        [childKey]: value\n      }\n    }));\n  };\n\n  const saveAuthSettings = () => {\n    const authSettings = {\n      passwordExpiration: localSettings.passwordExpiration\n    };\n    updateSettingsMutation.mutate(authSettings);\n  };\n\n  const saveCaptchaSettings = () => {\n    const captchaSettings = {\n      captchaType: localSettings.captchaType,\n      captchaSettings: localSettings.captchaSettings,\n      protectionCoverage: localSettings.protectionCoverage\n    };\n    updateSettingsMutation.mutate(captchaSettings);\n  };\n\n  const saveThreatSettings = () => {\n    const threatSettings = {\n      ddosProtection: localSettings.ddosProtection,\n      sqlInjectionProtection: localSettings.sqlInjectionProtection,\n      xssProtection: localSettings.xssProtection\n    };\n    updateSettingsMutation.mutate(threatSettings);\n  };\n\n  const saveSessionSettings = () => {\n    const sessionSettings = {\n      sessionSettings: localSettings.sessionSettings\n    };\n    updateSettingsMutation.mutate(sessionSettings);\n  };\n\n  const saveComplianceSettings = () => {\n    const complianceSettings = {\n      compliance: localSettings.compliance\n    };\n    updateSettingsMutation.mutate(complianceSettings);\n  };\n\n  const saveCSPSettings = () => {\n    const cspSettings = {\n      cspSettings: localSettings.cspSettings\n    };\n    updateSettingsMutation.mutate(cspSettings);\n  };\n\n  const saveScannerSettings = () => {\n    const scannerSettings = {\n      scannerSettings: localSettings.scannerSettings\n    };\n    updateSettingsMutation.mutate(scannerSettings);\n  };\n\n  const handle2FAToggle = (enabled: boolean) => {\n    if (enabled) {\n      if (user?.twoFactorEnabled) {\n        toast({ title: \"2FA is already enabled\", variant: \"default\" });\n        return;\n      }\n      generate2FAMutation.mutate(undefined);\n    } else {\n      if (!user?.twoFactorEnabled) {\n        toast({ title: \"2FA is not enabled\", variant: \"default\" });\n        return;\n      }\n      setShow2FADisable(true);\n    }\n  };\n\n  const copySecret = async () => {\n    try {\n      await navigator.clipboard.writeText(secret);\n      setSecretCopied(true);\n      setTimeout(() => setSecretCopied(false), 2000);\n      toast({ title: \"Secret copied to clipboard\" });\n    } catch (err) {\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = secret;\n      document.body.appendChild(textArea);\n      textArea.select();\n      try {\n        document.execCommand('copy');\n        setSecretCopied(true);\n        setTimeout(() => setSecretCopied(false), 2000);\n        toast({ title: \"Secret copied to clipboard\" });\n      } catch (e) {\n        toast({ title: \"Failed to copy secret\", variant: \"destructive\" });\n      }\n      document.body.removeChild(textArea);\n    }\n  };\n\n  const whitelistIps = ipRules.filter(r => r.type === 'whitelist');\n  const blacklistIps = ipRules.filter(r => r.type === 'blacklist');\n\n  const securityScore = (() => {\n    let score = 60;\n    if (user?.twoFactorEnabled) score += 15;\n    if (localSettings.ddosProtection?.enabled) score += 5;\n    if (localSettings.sqlInjectionProtection?.enabled) score += 5;\n    if (localSettings.xssProtection?.enabled) score += 5;\n    if (localSettings.captchaType && localSettings.captchaType !== 'disabled') score += 5;\n    if (localSettings.compliance?.gdprEnabled) score += 5;\n    return Math.min(score, 100);\n  })();\n\n  const getScoreColor = (score: number) => {\n    if (score >= 80) return \"text-green-500\";\n    if (score >= 60) return \"text-yellow-500\";\n    return \"text-red-500\";\n  };\n\n  const getScoreBg = (score: number) => {\n    if (score >= 80) return \"bg-green-500\";\n    if (score >= 60) return \"bg-yellow-500\";\n    return \"bg-red-500\";\n  };\n\n  if (settingsLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-center\">\n            <Loader2 className=\"w-10 h-10 animate-spin text-primary mx-auto mb-4\" />\n            <p className=\"text-muted-foreground\">Loading security settings...</p>\n          </div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold flex items-center gap-3\" data-testid=\"text-security-title\">\n              <Shield className=\"w-8 h-8 text-primary\" />\n              Security Center\n            </h1>\n            <p className=\"text-muted-foreground mt-1\">Monitor threats, manage access, and configure security policies</p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Button variant=\"outline\" onClick={() => refetchSettings()} data-testid=\"button-refresh-security\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-4\">\n          <Card className=\"lg:col-span-1 bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-primary/20\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex flex-col items-center text-center\">\n                <div className=\"relative mb-4\">\n                  <svg className=\"w-24 h-24 transform -rotate-90\">\n                    <circle cx=\"48\" cy=\"48\" r=\"40\" stroke=\"currentColor\" strokeWidth=\"8\" fill=\"none\" className=\"text-muted/20\" />\n                    <circle cx=\"48\" cy=\"48\" r=\"40\" stroke=\"currentColor\" strokeWidth=\"8\" fill=\"none\" \n                      className={getScoreBg(securityScore)}\n                      strokeDasharray={`${(securityScore / 100) * 251.2} 251.2`}\n                      strokeLinecap=\"round\"\n                    />\n                  </svg>\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <span className={`text-2xl font-bold ${getScoreColor(securityScore)}`}>{securityScore}</span>\n                  </div>\n                </div>\n                <h3 className=\"font-semibold text-lg\">Security Score</h3>\n                <p className=\"text-sm text-muted-foreground mt-1\">\n                  {securityScore >= 80 ? \"Excellent protection\" : securityScore >= 60 ? \"Good, can improve\" : \"Needs attention\"}\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <div className=\"lg:col-span-3 grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <Card className=\"border-green-500/30 bg-green-500/5\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground mb-1\">System Status</p>\n                    <p className=\"text-xl font-bold text-green-500\">Secure</p>\n                  </div>\n                  <div className=\"p-2 rounded-lg bg-green-500/10\">\n                    <ShieldCheck className=\"w-5 h-5 text-green-500\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground mb-1\">SSL Certificate</p>\n                    <p className=\"text-xl font-bold\">Valid</p>\n                    <p className=\"text-xs text-muted-foreground\">Dec 2025</p>\n                  </div>\n                  <div className=\"p-2 rounded-lg bg-primary/10\">\n                    <LockIcon className=\"w-5 h-5 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground mb-1\">Blocked (24h)</p>\n                    <p className=\"text-xl font-bold text-yellow-600\">{stats?.totalBlocked || 0}</p>\n                    <p className=\"text-xs text-muted-foreground\">attempts</p>\n                  </div>\n                  <div className=\"p-2 rounded-lg bg-yellow-500/10\">\n                    <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground mb-1\">Active Sessions</p>\n                    <p className=\"text-xl font-bold\">{sessions.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">devices</p>\n                  </div>\n                  <div className=\"p-2 rounded-lg bg-blue-500/10\">\n                    <Smartphone className=\"w-5 h-5 text-blue-500\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"authentication\" className=\"space-y-6\">\n          <div className=\"bg-card border rounded-lg p-1.5\">\n            <TabsList className=\"flex flex-wrap gap-1 bg-transparent h-auto p-0\">\n              <TabsTrigger value=\"authentication\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-authentication\">\n                <Key className=\"w-4 h-4\" /> Authentication\n              </TabsTrigger>\n              <TabsTrigger value=\"recaptcha\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-recaptcha\">\n                <Radio className=\"w-4 h-4\" /> Bot Protection\n              </TabsTrigger>\n              <TabsTrigger value=\"firewall\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-firewall\">\n                <Shield className=\"w-4 h-4\" /> Firewall\n              </TabsTrigger>\n              <TabsTrigger value=\"threat\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-threat\">\n                <ShieldAlert className=\"w-4 h-4\" /> Threats\n              </TabsTrigger>\n              <TabsTrigger value=\"sessions\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-sessions\">\n                <Users className=\"w-4 h-4\" /> Sessions\n              </TabsTrigger>\n              <TabsTrigger value=\"compliance\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-compliance\">\n                <FileText className=\"w-4 h-4\" /> Compliance\n              </TabsTrigger>\n              <TabsTrigger value=\"advanced\" className=\"gap-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\" data-testid=\"tab-advanced\">\n                <Settings2 className=\"w-4 h-4\" /> Advanced\n              </TabsTrigger>\n            </TabsList>\n          </div>\n\n          <TabsContent value=\"authentication\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Fingerprint className=\"w-5 h-5 text-primary\" />\n                    Authentication Methods\n                  </CardTitle>\n                  <CardDescription>Configure how users authenticate</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-4 rounded-xl border transition-all ${user?.twoFactorEnabled ? 'bg-green-500/5 border-green-500/30' : 'bg-muted/30'}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`p-2 rounded-lg ${user?.twoFactorEnabled ? 'bg-green-500/10' : 'bg-muted'}`}>\n                        <Smartphone className={`w-5 h-5 ${user?.twoFactorEnabled ? 'text-green-500' : 'text-muted-foreground'}`} />\n                      </div>\n                      <div>\n                        <div className=\"font-medium flex items-center gap-2\">\n                          Two-Factor Authentication\n                          {user?.twoFactorEnabled && <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30 text-xs\">Active</Badge>}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">Secure with authenticator app</div>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={user?.twoFactorEnabled || settings.twoFactorEnabled || false}\n                      onCheckedChange={handle2FAToggle}\n                      disabled={generate2FAMutation.isPending}\n                      data-testid=\"switch-2fa\"\n                    />\n                  </div>\n\n                  <div className={`flex items-center justify-between p-4 rounded-xl border transition-all ${localSettings.passwordExpiration ? 'bg-blue-500/5 border-blue-500/30' : 'bg-muted/30'}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`p-2 rounded-lg ${localSettings.passwordExpiration ? 'bg-blue-500/10' : 'bg-muted'}`}>\n                        <Clock className={`w-5 h-5 ${localSettings.passwordExpiration ? 'text-blue-500' : 'text-muted-foreground'}`} />\n                      </div>\n                      <div>\n                        <div className=\"font-medium\">Password Expiration</div>\n                        <div className=\"text-sm text-muted-foreground\">Force reset every 90 days</div>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={localSettings.passwordExpiration ?? false}\n                      onCheckedChange={(v) => updateLocalSetting('passwordExpiration', v)}\n                      data-testid=\"switch-password-expiration\"\n                    />\n                  </div>\n\n                  <Button onClick={saveAuthSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-auth\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save Authentication Settings\n                  </Button>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Monitor className=\"w-5 h-5 text-primary\" />\n                    Trusted Devices\n                  </CardTitle>\n                  <CardDescription>Devices that can skip 2FA verification</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <ScrollArea className=\"h-[200px]\">\n                    {devices.length === 0 ? (\n                      <div className=\"flex flex-col items-center justify-center h-full text-center py-8\">\n                        <Monitor className=\"w-10 h-10 text-muted-foreground/30 mb-3\" />\n                        <p className=\"text-sm text-muted-foreground\">No trusted devices registered</p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        {devices.map((device) => (\n                          <div key={device.id} className=\"flex items-center justify-between p-3 rounded-lg border hover:bg-muted/50 transition-colors\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"p-2 rounded-lg bg-muted\">\n                                <Monitor className=\"w-4 h-4\" />\n                              </div>\n                              <div>\n                                <p className=\"font-medium text-sm\">{device.deviceName}</p>\n                                <p className=\"text-xs text-muted-foreground\">{device.ipAddress} â€¢ {device.lastUsed ? new Date(device.lastUsed).toLocaleDateString() : 'Never'}</p>\n                              </div>\n                            </div>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"text-destructive\"\n                              onClick={() => deleteDeviceMutation.mutate(device.id)}\n                              data-testid={`button-remove-device-${device.id}`}\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </ScrollArea>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <Clock className=\"w-5 h-5 text-primary\" />\n                      Login History\n                    </CardTitle>\n                    <CardDescription>Recent authentication attempts</CardDescription>\n                  </div>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => { setShowLoginHistory(!showLoginHistory); refetchLoginHistory(); }} data-testid=\"button-toggle-login-history\">\n                    {isRefetchingLoginHistory ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Eye className=\"w-4 h-4\" />}\n                    <span className=\"ml-2\">{showLoginHistory ? 'Hide' : 'Show'}</span>\n                  </Button>\n                </div>\n              </CardHeader>\n              {showLoginHistory && (\n                <CardContent>\n                  <ScrollArea className=\"h-[300px]\">\n                    {loginHistory.length === 0 ? (\n                      <div className=\"text-center py-8 text-muted-foreground\">\n                        <Clock className=\"w-10 h-10 mx-auto mb-3 opacity-30\" />\n                        <p>No login history available</p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        {loginHistory.slice(0, 20).map((log) => (\n                          <div key={log.id} className={`flex items-center justify-between p-3 rounded-lg border ${log.blocked ? 'border-red-500/30 bg-red-500/5' : 'border-green-500/30 bg-green-500/5'}`}>\n                            <div className=\"flex items-center gap-3\">\n                              {log.blocked ? (\n                                <XCircle className=\"w-5 h-5 text-red-500\" />\n                              ) : (\n                                <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                              )}\n                              <div>\n                                <p className=\"font-medium text-sm\">{log.userName || 'Unknown'}</p>\n                                <p className=\"text-xs text-muted-foreground\">{log.ipAddress} â€¢ {log.eventType}</p>\n                              </div>\n                            </div>\n                            <span className=\"text-xs text-muted-foreground\">\n                              {log.createdAt ? new Date(log.createdAt).toLocaleString() : ''}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </ScrollArea>\n                </CardContent>\n              )}\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"recaptcha\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <div className=\"lg:col-span-2 space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <Radio className=\"w-5 h-5 text-primary\" />\n                      Bot Protection Method\n                    </CardTitle>\n                    <CardDescription>Choose how to protect forms from automated submissions</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                      {[\n                        { value: 'disabled', label: 'Disabled', desc: 'No bot protection', icon: XCircle, color: 'text-red-500' },\n                        { value: 'local', label: 'Local Protection', desc: 'Honeypot + rate limiting', icon: Shield, color: 'text-blue-500' },\n                        { value: 'google', label: 'Google reCAPTCHA', desc: 'Invisible v3 protection', icon: Globe, color: 'text-green-500' },\n                        { value: 'cloudflare', label: 'Cloudflare Turnstile', desc: 'Privacy-focused CAPTCHA', icon: Zap, color: 'text-orange-500' },\n                      ].map((option) => (\n                        <label\n                          key={option.value}\n                          data-testid={`radio-captcha-${option.value}`}\n                          className={`flex items-start gap-3 p-4 rounded-xl border cursor-pointer transition-all ${\n                            localSettings.captchaType === option.value \n                              ? 'border-primary bg-primary/5 ring-2 ring-primary/20' \n                              : 'hover:bg-muted/50'\n                          }`}\n                        >\n                          <input\n                            type=\"radio\"\n                            name=\"captchaType\"\n                            value={option.value}\n                            checked={localSettings.captchaType === option.value}\n                            onChange={(e) => updateLocalSetting('captchaType', e.target.value)}\n                            className=\"sr-only\"\n                          />\n                          <div className={`p-2 rounded-lg bg-muted`}>\n                            <option.icon className={`w-5 h-5 ${option.color}`} />\n                          </div>\n                          <div>\n                            <div className=\"font-medium\">{option.label}</div>\n                            <div className=\"text-xs text-muted-foreground\">{option.desc}</div>\n                          </div>\n                        </label>\n                      ))}\n                    </div>\n\n                    {localSettings.captchaType === 'google' && (\n                      <div className=\"space-y-3 p-4 rounded-lg bg-muted/50 mt-4\">\n                        <div>\n                          <Label>Google Site Key</Label>\n                          <Input\n                            value={localSettings.captchaSettings?.googleSiteKey || ''}\n                            onChange={(e) => updateNestedSetting('captchaSettings', 'googleSiteKey', e.target.value)}\n                            placeholder=\"6L...\"\n                            className=\"mt-1\"\n                            data-testid=\"input-google-site-key\"\n                          />\n                        </div>\n                        <div>\n                          <Label>Google Secret Key</Label>\n                          <div className=\"relative mt-1\">\n                            <Input\n                              type={showGoogleSecret ? 'text' : 'password'}\n                              value={localSettings.captchaSettings?.googleSecretKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'googleSecretKey', e.target.value)}\n                              placeholder=\"6L...\"\n                              data-testid=\"input-google-secret-key\"\n                            />\n                            <Button\n                              type=\"button\"\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"absolute right-0 top-0\"\n                              onClick={() => setShowGoogleSecret(!showGoogleSecret)}\n                              data-testid=\"button-toggle-google-secret\"\n                            >\n                              {showGoogleSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    )}\n\n                    {localSettings.captchaType === 'cloudflare' && (\n                      <div className=\"space-y-3 p-4 rounded-lg bg-muted/50 mt-4\">\n                        <div>\n                          <Label>Cloudflare Site Key</Label>\n                          <Input\n                            value={localSettings.captchaSettings?.cloudflareSiteKey || ''}\n                            onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSiteKey', e.target.value)}\n                            placeholder=\"0x...\"\n                            className=\"mt-1\"\n                            data-testid=\"input-cloudflare-site-key\"\n                          />\n                        </div>\n                        <div>\n                          <Label>Cloudflare Secret Key</Label>\n                          <div className=\"relative mt-1\">\n                            <Input\n                              type={showCloudflareSecret ? 'text' : 'password'}\n                              value={localSettings.captchaSettings?.cloudflareSecretKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSecretKey', e.target.value)}\n                              placeholder=\"0x...\"\n                              data-testid=\"input-cloudflare-secret-key\"\n                            />\n                            <Button\n                              type=\"button\"\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"absolute right-0 top-0\"\n                              onClick={() => setShowCloudflareSecret(!showCloudflareSecret)}\n                              data-testid=\"button-toggle-cloudflare-secret\"\n                            >\n                              {showCloudflareSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    )}\n\n                    <Button onClick={saveCaptchaSettings} disabled={updateSettingsMutation.isPending} className=\"w-full mt-4\" data-testid=\"button-save-captcha\">\n                      {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                      Save Bot Protection Settings\n                    </Button>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <Layers className=\"w-5 h-5 text-primary\" />\n                      Protection Coverage\n                    </CardTitle>\n                    <CardDescription>Choose which forms to protect</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                      {[\n                        { key: 'loginForm', label: 'Login Form', desc: 'Admin login page' },\n                        { key: 'contactForm', label: 'Contact Form', desc: 'Public contact form' },\n                        { key: 'newsletterForm', label: 'Newsletter', desc: 'Email subscription' },\n                        { key: 'commentForms', label: 'Comments', desc: 'Blog comments' },\n                        { key: 'registrationForm', label: 'Registration', desc: 'User signup' },\n                      ].map((form) => (\n                        <div key={form.key} className=\"flex items-center justify-between p-3 rounded-lg border\">\n                          <div>\n                            <p className=\"font-medium text-sm\">{form.label}</p>\n                            <p className=\"text-xs text-muted-foreground\">{form.desc}</p>\n                          </div>\n                          <Switch\n                            checked={(localSettings.protectionCoverage as any)?.[form.key] ?? true}\n                            onCheckedChange={(v) => updateNestedSetting('protectionCoverage', form.key, v)}\n                            data-testid={`switch-protect-${form.key}`}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <div className=\"space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <BarChart3 className=\"w-5 h-5 text-primary\" />\n                      Bot Detection Stats\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div className=\"p-4 rounded-xl bg-green-500/10 border border-green-500/20 text-center\">\n                        <p className=\"text-3xl font-bold text-green-500\">{stats?.totalAllowed || 0}</p>\n                        <p className=\"text-xs text-muted-foreground mt-1\">Legitimate</p>\n                      </div>\n                      <div className=\"p-4 rounded-xl bg-red-500/10 border border-red-500/20 text-center\">\n                        <p className=\"text-3xl font-bold text-red-500\">{stats?.totalBlocked || 0}</p>\n                        <p className=\"text-xs text-muted-foreground mt-1\">Blocked Bots</p>\n                      </div>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between text-sm\">\n                        <span className=\"text-muted-foreground\">Protection Rate</span>\n                        <span className=\"font-medium\">\n                          {stats && stats.totalBlocked + stats.totalAllowed > 0\n                            ? ((stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100).toFixed(1)\n                            : 100}%\n                        </span>\n                      </div>\n                      <Progress \n                        value={stats && stats.totalBlocked + stats.totalAllowed > 0 \n                          ? (stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100 \n                          : 100} \n                        className=\"h-2\"\n                      />\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"firewall\" className=\"space-y-4\">\n            <EnhancedFirewall />\n          </TabsContent>\n\n          <TabsContent value=\"threat\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Zap className=\"w-5 h-5 text-yellow-500\" />\n                    DDoS Protection\n                  </CardTitle>\n                  <CardDescription>Mitigate denial-of-service attacks</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${localSettings.ddosProtection?.enabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <span className=\"font-medium text-sm\">Enable Protection</span>\n                    <Switch\n                      checked={localSettings.ddosProtection?.enabled ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('ddosProtection', 'enabled', v)}\n                      data-testid=\"switch-ddos-protection\"\n                    />\n                  </div>\n                  {localSettings.ddosProtection?.enabled !== false && (\n                    <>\n                      <div>\n                        <Label className=\"text-xs\">Request Threshold (per min)</Label>\n                        <Input\n                          value={localSettings.ddosProtection?.threshold ?? 100}\n                          onChange={(e) => updateNestedSetting('ddosProtection', 'threshold', parseInt(e.target.value) || 100)}\n                          type=\"number\"\n                          className=\"mt-1\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Block Duration (min)</Label>\n                        <Input\n                          value={localSettings.ddosProtection?.blockDuration ?? 30}\n                          onChange={(e) => updateNestedSetting('ddosProtection', 'blockDuration', parseInt(e.target.value) || 30)}\n                          type=\"number\"\n                          className=\"mt-1\"\n                        />\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <AlertTriangle className=\"w-5 h-5 text-orange-500\" />\n                    SQL Injection\n                  </CardTitle>\n                  <CardDescription>Block malicious SQL queries</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${localSettings.sqlInjectionProtection?.enabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <span className=\"font-medium text-sm\">Enable Detection</span>\n                    <Switch\n                      checked={localSettings.sqlInjectionProtection?.enabled ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'enabled', v)}\n                      data-testid=\"switch-sql-injection\"\n                    />\n                  </div>\n                  {localSettings.sqlInjectionProtection?.enabled !== false && (\n                    <>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm\">Log Attempts</span>\n                        <Switch\n                          checked={localSettings.sqlInjectionProtection?.logAttempts ?? true}\n                          onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'logAttempts', v)}\n                        />\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm\">Block Requests</span>\n                        <Switch\n                          checked={localSettings.sqlInjectionProtection?.blockRequests ?? true}\n                          onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'blockRequests', v)}\n                        />\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Shield className=\"w-5 h-5 text-red-500\" />\n                    XSS Protection\n                  </CardTitle>\n                  <CardDescription>Prevent cross-site scripting</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${localSettings.xssProtection?.enabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <span className=\"font-medium text-sm\">Enable Protection</span>\n                    <Switch\n                      checked={localSettings.xssProtection?.enabled ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('xssProtection', 'enabled', v)}\n                      data-testid=\"switch-xss-protection\"\n                    />\n                  </div>\n                  {localSettings.xssProtection?.enabled !== false && (\n                    <>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm\">Sanitize Input</span>\n                        <Switch\n                          checked={localSettings.xssProtection?.sanitizeInput ?? true}\n                          onCheckedChange={(v) => updateNestedSetting('xssProtection', 'sanitizeInput', v)}\n                        />\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm\">Block Requests</span>\n                        <Switch\n                          checked={localSettings.xssProtection?.blockRequests ?? true}\n                          onCheckedChange={(v) => updateNestedSetting('xssProtection', 'blockRequests', v)}\n                        />\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n            <Button onClick={saveThreatSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-threat\">\n              {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Save Threat Protection Settings\n            </Button>\n          </TabsContent>\n\n          <TabsContent value=\"sessions\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle className=\"flex items-center gap-2 text-lg\">\n                        <Users className=\"w-5 h-5 text-primary\" />\n                        Active Sessions\n                      </CardTitle>\n                      <CardDescription>{sessions.length} active session(s)</CardDescription>\n                    </div>\n                    <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">\n                      <div className=\"w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse\" />\n                      Live\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <ScrollArea className=\"h-[300px]\">\n                    {sessions.length === 0 ? (\n                      <div className=\"flex flex-col items-center justify-center h-full py-8\">\n                        <Users className=\"w-10 h-10 text-muted-foreground/30 mb-3\" />\n                        <p className=\"text-sm text-muted-foreground\">No active sessions</p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        {sessions.map((session) => (\n                          <div key={session.id} className=\"flex items-center justify-between p-3 rounded-lg border hover:bg-muted/50 transition-colors\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"relative\">\n                                <div className=\"p-2 rounded-lg bg-muted\">\n                                  <Monitor className=\"w-4 h-4\" />\n                                </div>\n                                <div className=\"absolute -top-1 -right-1 w-3 h-3 rounded-full bg-green-500 border-2 border-background\" />\n                              </div>\n                              <div>\n                                <p className=\"font-medium text-sm\">{session.deviceInfo || 'Unknown Device'}</p>\n                                <p className=\"text-xs text-muted-foreground\">\n                                  {session.ipAddress || 'Unknown IP'} â€¢ {session.location || 'Unknown'}\n                                </p>\n                              </div>\n                            </div>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              onClick={() => terminateSessionMutation.mutate(session.id)}\n                              disabled={terminateSessionMutation.isPending}\n                              data-testid={`button-terminate-session-${session.id}`}\n                            >\n                              <LogOut className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </ScrollArea>\n\n                  <div className=\"flex gap-2 mt-4 pt-4 border-t\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => logoutAllDevicesMutation.mutate()}\n                      disabled={logoutAllDevicesMutation.isPending}\n                      data-testid=\"button-logout-all-devices\"\n                    >\n                      {logoutAllDevicesMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                      Logout All\n                    </Button>\n                    <Button\n                      variant=\"destructive\"\n                      className=\"flex-1\"\n                      onClick={() => terminateAllSessionsMutation.mutate()}\n                      disabled={terminateAllSessionsMutation.isPending}\n                      data-testid=\"button-force-logout-all\"\n                    >\n                      {terminateAllSessionsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                      Force Terminate\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Clock className=\"w-5 h-5 text-primary\" />\n                    Session Policies\n                  </CardTitle>\n                  <CardDescription>Configure session timeouts and limits</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label className=\"text-xs\">Idle Timeout</Label>\n                      <select\n                        className=\"w-full p-2 rounded-md border border-input bg-background text-sm\"\n                        value={localSettings.sessionSettings?.idleTimeout || '30 minutes'}\n                        onChange={(e) => updateNestedSetting('sessionSettings', 'idleTimeout', e.target.value)}\n                        data-testid=\"select-idle-timeout\"\n                      >\n                        <option value=\"15 minutes\">15 minutes</option>\n                        <option value=\"30 minutes\">30 minutes</option>\n                        <option value=\"1 hour\">1 hour</option>\n                        <option value=\"4 hours\">4 hours</option>\n                        <option value=\"Never\">Never</option>\n                      </select>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label className=\"text-xs\">Max Duration</Label>\n                      <select\n                        className=\"w-full p-2 rounded-md border border-input bg-background text-sm\"\n                        value={localSettings.sessionSettings?.maxDuration || '24 hours'}\n                        onChange={(e) => updateNestedSetting('sessionSettings', 'maxDuration', e.target.value)}\n                        data-testid=\"select-max-duration\"\n                      >\n                        <option value=\"8 hours\">8 hours</option>\n                        <option value=\"24 hours\">24 hours</option>\n                        <option value=\"7 days\">7 days</option>\n                        <option value=\"30 days\">30 days</option>\n                      </select>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center justify-between p-3 rounded-lg border\">\n                    <div>\n                      <p className=\"font-medium text-sm\">Force Logout Inactive</p>\n                      <p className=\"text-xs text-muted-foreground\">Auto-logout after idle timeout</p>\n                    </div>\n                    <Switch\n                      checked={localSettings.sessionSettings?.forceLogoutInactive ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('sessionSettings', 'forceLogoutInactive', v)}\n                      data-testid=\"switch-force-logout-inactive\"\n                    />\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-xs\">Concurrent Sessions</Label>\n                    <select\n                      className=\"w-full p-2 rounded-md border border-input bg-background text-sm\"\n                      value={localSettings.sessionSettings?.concurrentSessionLimit || 'Unlimited'}\n                      onChange={(e) => updateNestedSetting('sessionSettings', 'concurrentSessionLimit', e.target.value)}\n                      data-testid=\"select-concurrent-sessions\"\n                    >\n                      <option value=\"Unlimited\">Unlimited</option>\n                      <option value=\"1 session per user\">1 session</option>\n                      <option value=\"3 sessions per user\">3 sessions</option>\n                      <option value=\"5 sessions per user\">5 sessions</option>\n                    </select>\n                  </div>\n\n                  <Button onClick={saveSessionSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-session-policies\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save Session Policies\n                  </Button>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"compliance\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <FileText className=\"w-5 h-5 text-primary\" />\n                    GDPR Compliance\n                  </CardTitle>\n                  <CardDescription>Data protection and privacy regulations</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${localSettings.compliance?.gdprEnabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <div>\n                      <p className=\"font-medium text-sm\">GDPR Mode</p>\n                      <p className=\"text-xs text-muted-foreground\">Enable compliance features</p>\n                    </div>\n                    <Switch\n                      checked={localSettings.compliance?.gdprEnabled ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('compliance', 'gdprEnabled', v)}\n                      data-testid=\"switch-gdpr\"\n                    />\n                  </div>\n\n                  <div>\n                    <Label className=\"text-xs\">Data Retention (days)</Label>\n                    <Input\n                      value={localSettings.compliance?.dataRetentionDays ?? 365}\n                      onChange={(e) => updateNestedSetting('compliance', 'dataRetentionDays', parseInt(e.target.value) || 365)}\n                      type=\"number\"\n                      className=\"mt-1\"\n                      data-testid=\"input-retention-days\"\n                    />\n                    <p className=\"text-xs text-muted-foreground mt-1\">Auto-delete data after this period</p>\n                  </div>\n\n                  <div>\n                    <Label className=\"text-xs\">Privacy Policy URL</Label>\n                    <Input\n                      value={localSettings.compliance?.privacyPolicyUrl || ''}\n                      onChange={(e) => updateNestedSetting('compliance', 'privacyPolicyUrl', e.target.value)}\n                      placeholder=\"https://example.com/privacy\"\n                      className=\"mt-1\"\n                      data-testid=\"input-privacy-url\"\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-between p-3 rounded-lg border\">\n                    <div>\n                      <p className=\"font-medium text-sm\">Cookie Consent</p>\n                      <p className=\"text-xs text-muted-foreground\">Require explicit consent</p>\n                    </div>\n                    <Switch\n                      checked={localSettings.compliance?.cookieConsentEnabled ?? true}\n                      onCheckedChange={(v) => updateNestedSetting('compliance', 'cookieConsentEnabled', v)}\n                      data-testid=\"switch-cookie-consent\"\n                    />\n                  </div>\n\n                  <Button onClick={saveComplianceSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-compliance\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save Compliance Settings\n                  </Button>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Layers className=\"w-5 h-5 text-primary\" />\n                    Content Security Policy\n                  </CardTitle>\n                  <CardDescription>Control allowed content sources</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${localSettings.cspSettings?.enabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <div>\n                      <p className=\"font-medium text-sm\">Enable CSP</p>\n                      <p className=\"text-xs text-muted-foreground\">Add security headers</p>\n                    </div>\n                    <Switch\n                      checked={localSettings.cspSettings?.enabled ?? false}\n                      onCheckedChange={(v) => updateNestedSetting('cspSettings', 'enabled', v)}\n                      data-testid=\"switch-csp\"\n                    />\n                  </div>\n\n                  {localSettings.cspSettings?.enabled && (\n                    <>\n                      <div className=\"flex items-center justify-between p-3 rounded-lg border\">\n                        <div>\n                          <p className=\"font-medium text-sm\">Strict Mode</p>\n                          <p className=\"text-xs text-muted-foreground\">Maximum security restrictions</p>\n                        </div>\n                        <Switch\n                          checked={localSettings.cspSettings?.strictMode ?? false}\n                          onCheckedChange={(v) => updateNestedSetting('cspSettings', 'strictMode', v)}\n                        />\n                      </div>\n\n                      <div>\n                        <Label className=\"text-xs\">Report URI</Label>\n                        <Input\n                          value={localSettings.cspSettings?.reportUri || ''}\n                          onChange={(e) => updateNestedSetting('cspSettings', 'reportUri', e.target.value)}\n                          placeholder=\"https://example.com/csp-report\"\n                          className=\"mt-1\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <Button onClick={saveCSPSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save CSP Settings\n                  </Button>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"advanced\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <Activity className=\"w-5 h-5 text-primary\" />\n                  Security Scanner\n                </CardTitle>\n                <CardDescription>Automated vulnerability scanning</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className={`flex items-center justify-between p-4 rounded-xl border ${localSettings.scannerSettings?.vulnerabilityScanEnabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-2 rounded-lg bg-muted\">\n                        <Shield className=\"w-5 h-5 text-blue-500\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-sm\">Vulnerability Scan</p>\n                        <p className=\"text-xs text-muted-foreground\">Check for weaknesses</p>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={localSettings.scannerSettings?.vulnerabilityScanEnabled ?? false}\n                      onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'vulnerabilityScanEnabled', v)}\n                    />\n                  </div>\n\n                  <div className={`flex items-center justify-between p-4 rounded-xl border ${localSettings.scannerSettings?.sslScanEnabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-2 rounded-lg bg-muted\">\n                        <Lock className=\"w-5 h-5 text-green-500\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-sm\">SSL Scan</p>\n                        <p className=\"text-xs text-muted-foreground\">Certificate health</p>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={localSettings.scannerSettings?.sslScanEnabled ?? false}\n                      onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'sslScanEnabled', v)}\n                    />\n                  </div>\n\n                  <div className={`flex items-center justify-between p-4 rounded-xl border ${localSettings.scannerSettings?.malwareScanEnabled ? 'bg-green-500/5 border-green-500/30' : ''}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-2 rounded-lg bg-muted\">\n                        <AlertCircle className=\"w-5 h-5 text-red-500\" />\n                      </div>\n                      <div>\n                        <p className=\"font-medium text-sm\">Malware Scan</p>\n                        <p className=\"text-xs text-muted-foreground\">Detect malicious code</p>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={localSettings.scannerSettings?.malwareScanEnabled ?? false}\n                      onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'malwareScanEnabled', v)}\n                    />\n                  </div>\n                </div>\n\n                <div className=\"mt-4 space-y-2\">\n                  <Label className=\"text-xs\">Scan Frequency</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background text-sm\"\n                    value={localSettings.scannerSettings?.scanFrequency || 'weekly'}\n                    onChange={(e) => updateNestedSetting('scannerSettings', 'scanFrequency', e.target.value)}\n                  >\n                    <option value=\"daily\">Daily</option>\n                    <option value=\"weekly\">Weekly</option>\n                    <option value=\"monthly\">Monthly</option>\n                  </select>\n                </div>\n\n                <Button onClick={saveScannerSettings} disabled={updateSettingsMutation.isPending} className=\"w-full mt-4\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Scanner Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n\n        <Dialog open={show2FASetup} onOpenChange={setShow2FASetup}>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <QrCode className=\"w-5 h-5\" />\n                Set Up Two-Factor Authentication\n              </DialogTitle>\n              <DialogDescription>\n                Scan this QR code with your authenticator app\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"flex flex-col items-center space-y-4 py-4\">\n              {qrCode && (\n                <div className=\"p-4 bg-white rounded-xl\">\n                  <img src={qrCode} alt=\"2FA QR Code\" className=\"w-48 h-48\" />\n                </div>\n              )}\n              <div className=\"w-full space-y-2\">\n                <Label className=\"text-xs text-muted-foreground\">Or enter this code manually:</Label>\n                <div className=\"flex items-center gap-2\">\n                  <code className=\"flex-1 p-2 bg-muted rounded text-xs font-mono break-all\">{secret}</code>\n                  <Button variant=\"outline\" size=\"icon\" onClick={copySecret}>\n                    {secretCopied ? <Check className=\"w-4 h-4 text-green-500\" /> : <Copy className=\"w-4 h-4\" />}\n                  </Button>\n                </div>\n              </div>\n            </div>\n            <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n              <Button variant=\"outline\" onClick={() => setShow2FASetup(false)} className=\"w-full sm:w-auto\">\n                Cancel\n              </Button>\n              <Button onClick={() => { setShow2FASetup(false); setShow2FAVerify(true); }} className=\"w-full sm:w-auto\">\n                Continue to Verify\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={show2FAVerify} onOpenChange={setShow2FAVerify}>\n          <DialogContent className=\"max-w-sm\">\n            <DialogHeader>\n              <DialogTitle>Verify 2FA Setup</DialogTitle>\n              <DialogDescription>\n                Enter the 6-digit code from your authenticator app\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"flex justify-center py-6\">\n              <InputOTP maxLength={6} value={verifyCode} onChange={setVerifyCode}>\n                <InputOTPGroup>\n                  <InputOTPSlot index={0} />\n                  <InputOTPSlot index={1} />\n                  <InputOTPSlot index={2} />\n                  <InputOTPSlot index={3} />\n                  <InputOTPSlot index={4} />\n                  <InputOTPSlot index={5} />\n                </InputOTPGroup>\n              </InputOTP>\n            </div>\n            <DialogFooter>\n              <Button\n                onClick={() => verify2FAMutation.mutate(verifyCode)}\n                disabled={verifyCode.length !== 6 || verify2FAMutation.isPending}\n                className=\"w-full\"\n              >\n                {verify2FAMutation.isPending ? <Loader2 className=\"w-4 h-4 animate-spin mr-2\" /> : null}\n                Verify and Enable\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={show2FADisable} onOpenChange={setShow2FADisable}>\n          <DialogContent className=\"max-w-sm\">\n            <DialogHeader>\n              <DialogTitle className=\"text-destructive\">Disable 2FA</DialogTitle>\n              <DialogDescription>\n                Enter your current 2FA code to disable two-factor authentication\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"flex justify-center py-6\">\n              <InputOTP maxLength={6} value={disableCode} onChange={setDisableCode}>\n                <InputOTPGroup>\n                  <InputOTPSlot index={0} />\n                  <InputOTPSlot index={1} />\n                  <InputOTPSlot index={2} />\n                  <InputOTPSlot index={3} />\n                  <InputOTPSlot index={4} />\n                  <InputOTPSlot index={5} />\n                </InputOTPGroup>\n              </InputOTP>\n            </div>\n            <DialogFooter>\n              <Button\n                variant=\"destructive\"\n                onClick={() => disable2FAMutation.mutate(disableCode)}\n                disabled={disableCode.length !== 6 || disable2FAMutation.isPending}\n                className=\"w-full\"\n              >\n                {disable2FAMutation.isPending ? <Loader2 className=\"w-4 h-4 animate-spin mr-2\" /> : null}\n                Disable 2FA\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":73122,"size_tokens":null},"client/src/pages/home/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"server/api/skills.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertSkillSchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const skills = await storage.getAllSkills();\n    res.json(skills);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const skill = await storage.getSkill(parseInt(req.params.id));\n    if (!skill) {\n      return res.status(404).json({ message: \"Skill not found\" });\n    }\n    res.json(skill);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertSkillSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const skill = await storage.createSkill(parsed.data);\n    res.status(201).json(skill);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const skill = await storage.updateSkill(parseInt(req.params.id), req.body);\n    if (!skill) {\n      return res.status(404).json({ message: \"Skill not found\" });\n    }\n    res.json(skill);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteSkill(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Skill not found\" });\n    }\n    res.json({ message: \"Skill deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1872,"size_tokens":null},"server/api/homepage.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/sections\", async (req: Request, res: Response) => {\n  try {\n    const sections = await storage.getAllHomepageSections();\n    res.json(sections);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/sections/:name\", async (req: Request, res: Response) => {\n  try {\n    const section = await storage.getHomepageSectionByName(req.params.name);\n    if (!section) {\n      return res.status(404).json({ message: \"Section not found\" });\n    }\n    res.json(section);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/sections/:name\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const updated = await storage.upsertHomepageSection(req.params.name, req.body);\n    res.json(updated);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1088,"size_tokens":null},"client/src/pages/admin/content/services/Services.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Check, Plus, Edit, Trash2, X, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Service } from \"@shared/schema\";\n\ninterface ServiceFormData {\n  title: string;\n  description: string;\n  icon: string;\n  features: string[];\n  price: string;\n  order: number;\n  active: boolean;\n}\n\nconst getEmptyService = (): ServiceFormData => ({\n  title: \"\",\n  description: \"\",\n  icon: \"code\",\n  features: [],\n  price: \"\",\n  order: 0,\n  active: true,\n});\n\nexport default function AdminServicesEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingService, setEditingService] = useState<Service | null>(null);\n  const [formData, setFormData] = useState<ServiceFormData>(getEmptyService());\n  const [featureInput, setFeatureInput] = useState(\"\");\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n\n  const { data: services = [], isLoading } = useQuery({\n    queryKey: [\"/api/services\"],\n    queryFn: () => api.getServices(),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: any) => api.createService(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: any }) =>\n      api.updateService(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Service updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteService(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Service deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyService());\n    setEditingService(null);\n    setFeatureInput(\"\");\n  };\n\n  const handleOpenDialog = (service?: Service) => {\n    if (service) {\n      setEditingService(service);\n      setFormData({\n        title: service.title,\n        description: service.description || \"\",\n        icon: service.icon || \"code\",\n        features: service.features || [],\n        price: service.price || \"\",\n        order: service.order,\n        active: service.active,\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim() && !formData.features.includes(featureInput.trim())) {\n      setFormData({\n        ...formData,\n        features: [...formData.features, featureInput.trim()],\n      });\n      setFeatureInput(\"\");\n    }\n  };\n\n  const removeFeature = (feature: string) => {\n    setFormData({\n      ...formData,\n      features: formData.features.filter((f) => f !== feature),\n    });\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Service title is required\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (editingService) {\n      updateMutation.mutate({ id: editingService.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Services</h1>\n            <p className=\"text-muted-foreground\">Manage services and pricing</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-create-service\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n          </Button>\n        </div>\n\n        {isLoading ? (\n          <Card>\n            <CardContent className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"w-6 h-6 animate-spin\" />\n            </CardContent>\n          </Card>\n        ) : services.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No services yet</p>\n              <Button onClick={() => handleOpenDialog()}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create first service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Service Comparison Table */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Service Comparison</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full text-sm\">\n                    <thead>\n                      <tr className=\"border-b\">\n                        <th className=\"text-left py-3 px-2\">Feature</th>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <th key={service.id} className=\"text-center py-3 px-2\">\n                              {service.title}\n                            </th>\n                          ))}\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr className=\"border-b\">\n                        <td className=\"py-3 px-2 font-medium\">Price</td>\n                        {services\n                          .sort((a, b) => a.order - b.order)\n                          .map((service) => (\n                            <td key={service.id} className=\"text-center py-3 px-2\">\n                              <span className=\"font-semibold\">{service.price}</span>\n                            </td>\n                          ))}\n                      </tr>\n                      {Array.from({\n                        length: Math.max(\n                          0,\n                          Math.max(...services.map((s) => (s.features || []).length))\n                        ),\n                      }).map((_, featureIdx) => (\n                        <tr key={featureIdx} className=\"border-b\">\n                          <td className=\"py-3 px-2 font-medium text-sm\">\n                            {services[0]?.features?.[featureIdx] || \"Feature\"}\n                          </td>\n                          {services\n                            .sort((a, b) => a.order - b.order)\n                            .map((service) => (\n                              <td key={service.id} className=\"text-center py-3 px-2\">\n                                {service.features && service.features[featureIdx] ? (\n                                  <Check className=\"w-4 h-4 text-green-500 mx-auto\" />\n                                ) : (\n                                  <span className=\"text-muted-foreground\">-</span>\n                                )}\n                              </td>\n                            ))}\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Service Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {services\n                .sort((a, b) => a.order - b.order)\n                .map((service) => (\n                  <Card\n                    key={service.id}\n                    className=\"flex flex-col\"\n                    data-testid={`card-service-${service.id}`}\n                  >\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-lg\">{service.title}</CardTitle>\n                          {!service.active && (\n                            <Badge variant=\"outline\" className=\"mt-2\">\n                              Inactive\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-baseline gap-1 mt-2\">\n                        <span className=\"text-3xl font-bold\">{service.price}</span>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        {service.description}\n                      </p>\n                    </CardHeader>\n                    <CardContent className=\"flex-1 space-y-4\">\n                      {service.features && service.features.length > 0 && (\n                        <ul className=\"space-y-2\">\n                          {service.features.map((feature: string) => (\n                            <li key={feature} className=\"flex items-center gap-2 text-sm\">\n                              <Check className=\"w-4 h-4 text-green-500\" />\n                              {feature}\n                            </li>\n                          ))}\n                        </ul>\n                      )}\n                      <div className=\"flex gap-2 pt-4\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => handleOpenDialog(service)}\n                          className=\"flex-1\"\n                          data-testid={`button-edit-service-${service.id}`}\n                        >\n                          <Edit className=\"w-4 h-4 mr-1\" /> Edit\n                        </Button>\n                        <AlertDialog>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => setDeleteId(service.id)}\n                            data-testid={`button-delete-service-${service.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-red-500\" />\n                          </Button>\n                        </AlertDialog>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Create/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingService ? \"Edit Service\" : \"Create New Service\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingService\n                ? \"Update the service details below.\"\n                : \"Fill in the details to create a new service.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Service Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"e.g., Web Development\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                placeholder=\"Brief description of the service\"\n                value={formData.description}\n                onChange={(e) =>\n                  setFormData({ ...formData, description: e.target.value })\n                }\n                data-testid=\"input-description\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"price\">Price</Label>\n                <Input\n                  id=\"price\"\n                  placeholder=\"e.g., From $2,000\"\n                  value={formData.price}\n                  onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n                  data-testid=\"input-price\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"icon\">Icon</Label>\n                <Input\n                  id=\"icon\"\n                  placeholder=\"e.g., code, smartphone, palette\"\n                  value={formData.icon}\n                  onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                  data-testid=\"input-icon\"\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"order\">Order</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) =>\n                    setFormData({ ...formData, order: parseInt(e.target.value) || 0 })\n                  }\n                  data-testid=\"input-order\"\n                />\n              </div>\n\n              <div className=\"flex items-end gap-2\">\n                <div className=\"flex-1 space-y-2\">\n                  <Label htmlFor=\"active\">Active</Label>\n                  <div className=\"flex items-center gap-2 pt-1\">\n                    <Switch\n                      id=\"active\"\n                      checked={formData.active}\n                      onCheckedChange={(checked) =>\n                        setFormData({ ...formData, active: checked })\n                      }\n                      data-testid=\"switch-active\"\n                    />\n                    <span className=\"text-sm text-muted-foreground\">\n                      {formData.active ? \"Active\" : \"Inactive\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Features</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  placeholder=\"Add feature (e.g., Responsive Design)\"\n                  value={featureInput}\n                  onChange={(e) => setFeatureInput(e.target.value)}\n                  onKeyPress={(e) =>\n                    e.key === \"Enter\" && (e.preventDefault(), addFeature())\n                  }\n                  data-testid=\"input-feature\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={addFeature}\n                  data-testid=\"button-add-feature\"\n                >\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.features.map((feature) => (\n                  <Badge key={feature} variant=\"secondary\" className=\"gap-1\">\n                    {feature}\n                    <button\n                      onClick={() => removeFeature(feature)}\n                      className=\"ml-1 hover:text-destructive\"\n                      data-testid={`button-remove-feature-${feature}`}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setIsDialogOpen(false)}\n              data-testid=\"button-cancel\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={isPending}\n              data-testid=\"button-save-service\"\n            >\n              {isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : editingService ? (\n                \"Update Service\"\n              ) : (\n                \"Create Service\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Dialog */}\n      <AlertDialog open={deleteId !== null} onOpenChange={() => setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Service</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this service? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => {\n                if (deleteId) {\n                  deleteMutation.mutate(deleteId);\n                }\n              }}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":18891,"size_tokens":null},"client/src/pages/admin/system/ExportImport.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Download, Upload, FileJson, Loader2, CheckCircle, AlertTriangle } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Exportable {\n  id: string;\n  name: string;\n  description: string;\n  endpoint: string;\n  icon: React.ReactNode;\n}\n\nexport default function AdminExportImport() {\n  const { toast } = useToast();\n  const [exportLoading, setExportLoading] = useState<string | null>(null);\n  const [importLoading, setImportLoading] = useState(false);\n  const [recentExports, setRecentExports] = useState<any[]>([]);\n\n  const exportables: Exportable[] = [\n    {\n      id: \"posts\",\n      name: \"Posts\",\n      description: \"All blog posts and articles\",\n      endpoint: \"/api/posts\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"projects\",\n      name: \"Projects\",\n      description: \"All portfolio projects\",\n      endpoint: \"/api/projects\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"skills\",\n      name: \"Skills\",\n      description: \"All technical skills\",\n      endpoint: \"/api/skills\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"services\",\n      name: \"Services\",\n      description: \"All offered services\",\n      endpoint: \"/api/services\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"testimonials\",\n      name: \"Testimonials\",\n      description: \"All client testimonials\",\n      endpoint: \"/api/testimonials\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n    {\n      id: \"settings\",\n      name: \"Settings\",\n      description: \"Site configuration and settings\",\n      endpoint: \"/api/settings\",\n      icon: <FileJson className=\"w-5 h-5\" />,\n    },\n  ];\n\n  const handleExport = async (exportable: Exportable) => {\n    setExportLoading(exportable.id);\n    try {\n      const res = await fetch(exportable.endpoint, { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch data\");\n      const data = await res.json();\n\n      const jsonString = JSON.stringify(data, null, 2);\n      const blob = new Blob([jsonString], { type: \"application/json\" });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `${exportable.id}_export_${new Date().toISOString().split(\"T\")[0]}.json`;\n      a.click();\n      window.URL.revokeObjectURL(url);\n\n      const newExport = {\n        name: a.download,\n        size: (blob.size / 1024).toFixed(2) + \" KB\",\n        date: new Date().toLocaleDateString(),\n        timestamp: new Date(),\n      };\n\n      setRecentExports((prev) => [newExport, ...prev].slice(0, 10));\n      toast({\n        title: \"Success\",\n        description: `Exported ${exportable.name} successfully`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to export\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setExportLoading(null);\n    }\n  };\n\n  const handleImport = async (file: File) => {\n    setImportLoading(true);\n    try {\n      const fileContent = await file.text();\n      const data = JSON.parse(fileContent);\n\n      const fileName = file.name.toLowerCase();\n      let endpoint = \"/api/posts\";\n\n      if (fileName.includes(\"project\")) endpoint = \"/api/projects\";\n      else if (fileName.includes(\"skill\")) endpoint = \"/api/skills\";\n      else if (fileName.includes(\"service\")) endpoint = \"/api/services\";\n      else if (fileName.includes(\"testimonial\")) endpoint = \"/api/testimonials\";\n      else if (fileName.includes(\"setting\")) endpoint = \"/api/settings\";\n\n      if (Array.isArray(data)) {\n        let successCount = 0;\n        for (const item of data) {\n          try {\n            const res = await fetch(endpoint, {\n              method: \"POST\",\n              headers: { \"Content-Type\": \"application/json\" },\n              credentials: \"include\",\n              body: JSON.stringify(item),\n            });\n            if (res.ok) successCount++;\n          } catch (e) {\n            console.error(\"Failed to import item:\", e);\n          }\n        }\n        toast({\n          title: \"Import Complete\",\n          description: `Successfully imported ${successCount} out of ${data.length} items`,\n        });\n      } else {\n        const res = await fetch(endpoint, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          credentials: \"include\",\n          body: JSON.stringify(data),\n        });\n        if (res.ok) {\n          toast({\n            title: \"Success\",\n            description: \"Data imported successfully\",\n          });\n        }\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to import file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setImportLoading(false);\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      if (!file.name.endsWith(\".json\")) {\n        toast({\n          title: \"Error\",\n          description: \"Please upload a JSON file\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n      handleImport(file);\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">Export & Import Data</h1>\n          <p className=\"text-muted-foreground\">\n            Backup and restore your content data\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          {/* Export Section */}\n          <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-semibold\">Export Data</h2>\n            <div className=\"space-y-3\">\n              {exportables.map((exportable) => (\n                <Card key={exportable.id}>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex items-start gap-3 flex-1 min-w-0\">\n                        <div className=\"p-2 bg-primary/10 rounded flex-shrink-0\">\n                          {exportable.icon}\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-semibold text-sm\">{exportable.name}</h3>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {exportable.description}\n                          </p>\n                        </div>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        disabled={exportLoading === exportable.id}\n                        onClick={() => handleExport(exportable)}\n                        data-testid={`button-export-${exportable.id}`}\n                        className=\"flex-shrink-0 gap-1\"\n                      >\n                        {exportLoading === exportable.id ? (\n                          <Loader2 className=\"w-3 h-3 animate-spin\" />\n                        ) : (\n                          <Download className=\"w-3 h-3\" />\n                        )}\n                        Export\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n\n          {/* Import Section */}\n          <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-semibold\">Import Data</h2>\n            <Card>\n              <CardContent className=\"p-6\">\n                <label className=\"cursor-pointer block\">\n                  <div className=\"border-2 border-dashed border-muted-foreground/20 rounded-lg p-8 flex flex-col items-center justify-center hover:border-primary/50 hover:bg-primary/5 transition-all\">\n                    {importLoading ? (\n                      <>\n                        <Loader2 className=\"w-12 h-12 text-primary mb-3 animate-spin\" />\n                        <h3 className=\"font-semibold mb-1\">Importing...</h3>\n                      </>\n                    ) : (\n                      <>\n                        <Upload className=\"w-12 h-12 text-muted-foreground mb-3\" />\n                        <h3 className=\"font-semibold mb-1\">Drop JSON file or click</h3>\n                        <p className=\"text-xs text-muted-foreground text-center\">\n                          Supported: JSON files from posts, projects, skills, services, or testimonials\n                        </p>\n                      </>\n                    )}\n                  </div>\n                  <input\n                    type=\"file\"\n                    accept=\".json\"\n                    onChange={handleFileSelect}\n                    disabled={importLoading}\n                    className=\"hidden\"\n                    data-testid=\"input-file-import\"\n                  />\n                </label>\n                <div className=\"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg\">\n                  <p className=\"text-xs text-muted-foreground\">\n                    ðŸ’¡ Export files automatically detect the data type and import to the correct location.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        {/* Recent Exports */}\n        {recentExports.length > 0 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>Recent Exports</CardTitle>\n              <CardDescription>\n                Last {recentExports.length} exported files\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2\">\n                {recentExports.map((file, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center justify-between p-3 border rounded-lg\"\n                  >\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                      <CheckCircle className=\"w-4 h-4 text-green-500 flex-shrink-0\" />\n                      <div className=\"min-w-0 flex-1\">\n                        <p className=\"font-medium text-sm truncate\">{file.name}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {file.date} â€¢ {file.size}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Info Section */}\n        <Card className=\"border-blue-500/20 bg-blue-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"w-5 h-5 text-blue-500\" />\n              Export & Import Guide\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2 text-sm text-muted-foreground\">\n            <p>\n              â€¢ Export your data as JSON format for backup or migration purposes\n            </p>\n            <p>â€¢ Import JSON files to add or update your content data</p>\n            <p>â€¢ Files are detected by name - use original export names when possible</p>\n            <p>\n              â€¢ Each export includes a timestamp for easy version control\n            </p>\n            <p>â€¢ All imports are validated before processing</p>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11855,"size_tokens":null},"client/src/pages/admin/content/posts/PostsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Pagination } from \"@/components/admin/pagination\";\nimport { useState, useRef } from \"react\";\nimport { Plus, Eye, Edit, Trash, Calendar, Save, X, Loader2 } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport type { Post, InsertPost } from \"@shared/schema\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\ninterface PostFormData {\n  title: string;\n  slug: string;\n  content: string;\n  excerpt: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  tags: string[];\n  featuredImage: string | null;\n  publishedAt: Date | null;\n}\n\nconst getDefaultFormData = (): PostFormData => ({\n  title: \"\",\n  slug: \"\",\n  content: \"\",\n  excerpt: \"\",\n  category: \"\",\n  author: \"Loi Developer\",\n  status: \"Draft\",\n  tags: [],\n  featuredImage: null,\n  publishedAt: null,\n});\n\nfunction generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/(^-|-$)/g, \"\");\n}\n\nexport default function AdminPostsEnhanced() {\n  const queryClient = useQueryClient();\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const [uploading, setUploading] = useState(false);\n\n  const handleImageUpload = async (file: File, setFeaturedImage: (url: string) => void) => {\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      setFeaturedImage(data.url);\n    } catch (error: any) {\n      console.error(\"Upload failed:\", error);\n    } finally {\n      setUploading(false);\n    }\n  };\n  const { data: posts = [], isLoading } = useQuery({\n    queryKey: [\"admin-posts\"],\n    queryFn: () => api.getPosts(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=post\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertPost) => api.createPost(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<Post> }) => \n      api.updatePost(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deletePost(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const addPost = async (data: InsertPost) => {\n    await createMutation.mutateAsync(data);\n  };\n\n  const updatePost = async (id: number, data: Partial<Post>) => {\n    await updateMutation.mutateAsync({ id, data });\n  };\n\n  const deletePost = async (id: number) => {\n    await deleteMutation.mutateAsync(id);\n  };\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"published\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [editingPost, setEditingPost] = useState<number | null>(null);\n  const [postToDelete, setPostToDelete] = useState<number | null>(null);\n  const [formData, setFormData] = useState<PostFormData>(getDefaultFormData());\n  const [tagsInput, setTagsInput] = useState(\"\");\n\n  const postsPerPage = 5;\n\n  const filteredPosts = posts.filter((p) => {\n    if (activeTab === \"published\") return p.status === \"Published\";\n    if (activeTab === \"draft\") return p.status === \"Draft\";\n    if (activeTab === \"archived\") return p.status === \"Archived\";\n    return true;\n  });\n\n  const totalPages = Math.ceil(filteredPosts.length / postsPerPage);\n  const paginatedPosts = filteredPosts.slice(\n    (currentPage - 1) * postsPerPage,\n    currentPage * postsPerPage\n  );\n\n  const handleOpenDialog = (postId?: number) => {\n    if (postId) {\n      const post = posts.find((p) => p.id === postId);\n      if (post) {\n        setEditingPost(postId);\n        let parsedPublishedAt: Date | null = null;\n        if (post.publishedAt) {\n          const date = new Date(post.publishedAt);\n          if (!isNaN(date.getTime())) {\n            parsedPublishedAt = date;\n          }\n        }\n        setFormData({\n          title: post.title,\n          slug: post.slug,\n          content: post.content || \"\",\n          excerpt: post.excerpt || \"\",\n          category: post.category,\n          author: post.author,\n          status: post.status,\n          tags: post.tags || [],\n          featuredImage: post.featuredImage,\n          publishedAt: parsedPublishedAt,\n        });\n        setTagsInput(post.tags?.join(\", \") || \"\");\n      }\n    } else {\n      setEditingPost(null);\n      setFormData(getDefaultFormData());\n      setTagsInput(\"\");\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPost(null);\n    setFormData(getDefaultFormData());\n    setTagsInput(\"\");\n  };\n\n  const handleTitleChange = (title: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      title,\n      slug: editingPost ? prev.slug : generateSlug(title),\n    }));\n  };\n\n  const validateForm = (): string | null => {\n    if (!formData.title.trim()) return \"Title is required\";\n    if (!formData.content.trim()) return \"Content is required\";\n    if (!formData.category.trim()) return \"Category is required\";\n    if (!formData.author.trim()) return \"Author is required\";\n    return null;\n  };\n\n  const [formError, setFormError] = useState<string | null>(null);\n\n  const isSaving = createMutation.isPending || updateMutation.isPending;\n\n  const getPublishedAtForSubmit = (): string | null => {\n    if (formData.status !== \"Published\") {\n      return null;\n    }\n\n    if (formData.publishedAt instanceof Date && !isNaN(formData.publishedAt.getTime())) {\n      return formData.publishedAt.toISOString();\n    }\n\n    if (formData.publishedAt && typeof formData.publishedAt === 'string') {\n      const date = new Date(formData.publishedAt);\n      if (!isNaN(date.getTime())) {\n        return date.toISOString();\n      }\n    }\n\n    return new Date().toISOString();\n  };\n\n  const handleSubmit = async () => {\n    const error = validateForm();\n    if (error) {\n      setFormError(error);\n      return;\n    }\n    setFormError(null);\n\n    try {\n      const tags = tagsInput\n        .split(\",\")\n        .map((t) => t.trim())\n        .filter(Boolean);\n\n      const publishedAt = getPublishedAtForSubmit();\n\n      const postData = {\n        title: formData.title.trim(),\n        slug: formData.slug.trim() || generateSlug(formData.title),\n        content: formData.content.trim(),\n        excerpt: formData.excerpt.trim() || null,\n        category: formData.category,\n        author: formData.author.trim(),\n        status: formData.status,\n        tags,\n        featuredImage: formData.featuredImage,\n        publishedAt,\n      };\n\n      if (editingPost) {\n        await updatePost(editingPost, postData as any);\n      } else {\n        await addPost(postData as any);\n      }\n      handleCloseDialog();\n    } catch (error: any) {\n      console.error(\"Error saving post:\", error);\n      setFormError(error.message || \"Failed to save post\");\n    }\n  };\n\n  const handleDeleteClick = (id: number) => {\n    setPostToDelete(id);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const handleConfirmDelete = async () => {\n    if (postToDelete) {\n      await deletePost(postToDelete);\n      setPostToDelete(null);\n    }\n    setIsDeleteDialogOpen(false);\n  };\n\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const bgImages = ['/images/blog/bg-1.png', '/images/blog/bg-2.png', '/images/blog/bg-3.png'];\n\n  const renderPostCard = (post: any) => {\n    const imageUrl = post.featuredImage || bgImages[post.id % bgImages.length];\n    return (\n    <Card key={post.id} data-testid={`card-post-${post.id}`} className=\"overflow-hidden\">\n      <div \n        className=\"h-32 bg-cover bg-center bg-no-repeat\"\n        style={{ backgroundImage: `url('${imageUrl}')` }}\n      >\n        <div className=\"w-full h-full bg-black/40\" />\n      </div>\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <h3 className=\"font-bold\" data-testid={`text-post-title-${post.id}`}>{post.title}</h3>\n              <Badge variant=\"secondary\">{post.category}</Badge>\n              <Badge\n                variant={post.status === \"Published\" ? \"default\" : \"outline\"}\n                className={post.status === \"Published\" ? \"bg-green-500\" : \"\"}\n              >\n                {post.status}\n              </Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground mb-2 line-clamp-2\">\n              {post.excerpt || post.content?.substring(0, 100) || \"No excerpt available\"}\n            </p>\n            <div className=\"flex gap-4 text-xs text-muted-foreground flex-wrap\">\n              <span className=\"flex items-center gap-1\">\n                <Calendar className=\"w-3 h-3\" /> {formatDate(post.publishedAt || post.createdAt)}\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <Eye className=\"w-3 h-3\" /> {post.views || 0} views\n              </span>\n              {post.tags && post.tags.length > 0 && (\n                <span className=\"text-primary\">\n                  {post.tags.slice(0, 3).join(\", \")}\n                  {post.tags.length > 3 && \"...\"}\n                </span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleOpenDialog(post.id)}\n              data-testid={`button-edit-post-${post.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-destructive hover:text-destructive\"\n              onClick={() => handleDeleteClick(post.id)}\n              data-testid={`button-delete-post-${post.id}`}\n            >\n              <Trash className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n    );\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Blog Posts</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your blog content ({posts.length} posts)\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-new-post\"\n          >\n            <Plus className=\"w-4 h-4\" /> New Post\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={(v) => { setActiveTab(v); setCurrentPage(1); }}>\n          <TabsList>\n            <TabsTrigger value=\"published\" data-testid=\"tab-published\">\n              Published ({posts.filter((p) => p.status === \"Published\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"draft\" data-testid=\"tab-draft\">\n              Drafts ({posts.filter((p) => p.status === \"Draft\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"archived\" data-testid=\"tab-archived\">\n              Archived ({posts.filter((p) => p.status === \"Archived\").length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value={activeTab} className=\"space-y-4 mt-4\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  Loading posts...\n                </CardContent>\n              </Card>\n            ) : paginatedPosts.length === 0 ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  No posts found. Click \"New Post\" to create one.\n                </CardContent>\n              </Card>\n            ) : (\n              <>\n                {paginatedPosts.map(renderPostCard)}\n                {totalPages > 1 && (\n                  <Pagination\n                    currentPage={currentPage}\n                    totalPages={totalPages}\n                    onPageChange={setCurrentPage}\n                  />\n                )}\n              </>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingPost ? \"Edit Post\" : \"Create New Post\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingPost\n                ? \"Update the post details below.\"\n                : \"Fill in the details to create a new blog post.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"Enter post title\"\n                value={formData.title}\n                onChange={(e) => handleTitleChange(e.target.value)}\n                data-testid=\"input-post-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"slug\">Slug</Label>\n              <Input\n                id=\"slug\"\n                placeholder=\"post-url-slug\"\n                value={formData.slug}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, slug: e.target.value }))\n                }\n                data-testid=\"input-post-slug\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(v) =>\n                    setFormData((prev) => ({ ...prev, category: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(v: \"Published\" | \"Draft\" | \"Archived\") =>\n                    setFormData((prev) => ({ ...prev, status: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-status\">\n                    <SelectValue placeholder=\"Select status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                    <SelectItem value=\"Archived\">Archived</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"content\">Content *</Label>\n              <RichTextEditor\n                value={formData.content}\n                onChange={(content) =>\n                  setFormData((prev) => ({ ...prev, content }))\n                }\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"excerpt\">Excerpt</Label>\n              <Textarea\n                id=\"excerpt\"\n                placeholder=\"Brief summary of the post\"\n                value={formData.excerpt}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, excerpt: e.target.value }))\n                }\n                rows={2}\n                data-testid=\"input-post-excerpt\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"image\">Featured Image</Label>\n              <div className=\"space-y-2\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"image\"\n                    placeholder=\"Image URL (e.g., /uploads/images/... or https://...)\"\n                    value={formData.featuredImage || ''}\n                    onChange={(e) =>\n                      setFormData((prev) => ({ ...prev, featuredImage: e.target.value || null }))\n                    }\n                    data-testid=\"input-post-image\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => imageInputRef.current?.click()}\n                    disabled={uploading}\n                    data-testid=\"button-upload-image\"\n                  >\n                    {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => setFormData((prev) => ({ ...prev, featuredImage: null }))}\n                    data-testid=\"button-clear-image\"\n                  >\n                    Clear\n                  </Button>\n                </div>\n                <input\n                  ref={imageInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  onChange={(e) => {\n                    const file = e.target.files?.[0];\n                    if (file) {\n                      handleImageUpload(file, (url) => setFormData((prev) => ({ ...prev, featuredImage: url })));\n                    }\n                  }}\n                  data-testid=\"input-file-upload\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Táº£i áº£nh tá»« thiáº¿t bá»‹ (JPG, PNG, GIF, WebP) - Ä‘Æ°á»£c lÆ°u vÃ o /uploads/images/\n                </p>\n              </div>\n              {formData.featuredImage && (\n                <div className=\"mt-2 border border-border rounded-md overflow-hidden\">\n                  <img\n                    src={formData.featuredImage}\n                    alt=\"Featured preview\"\n                    className=\"w-full h-40 object-cover\"\n                    onError={(e) => {\n                      // Fallback if image fails to load\n                      (e.target as HTMLImageElement).src = '/images/blog/bg-1.png';\n                    }}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">\n                Há»— trá»£: Táº£i tá»« thiáº¿t bá»‹ hoáº·c dÃ¡n link áº£nh. áº¢nh máº·c Ä‘á»‹nh: /images/blog/bg-1.png, bg-2.png, bg-3.png\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\n              <Input\n                id=\"tags\"\n                placeholder=\"react, javascript, web development\"\n                value={tagsInput}\n                onChange={(e) => setTagsInput(e.target.value)}\n                data-testid=\"input-post-tags\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"author\">Author</Label>\n              <Input\n                id=\"author\"\n                placeholder=\"Author name\"\n                value={formData.author}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, author: e.target.value }))\n                }\n                data-testid=\"input-post-author\"\n              />\n            </div>\n          </div>\n\n          <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n            {formError && (\n              <p className=\"text-destructive text-sm w-full sm:w-auto sm:flex-1\" data-testid=\"text-form-error\">\n                {formError}\n              </p>\n            )}\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={handleCloseDialog}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button\n                onClick={handleSubmit}\n                disabled={isSaving}\n                data-testid=\"button-save-post\"\n              >\n                <Save className=\"w-4 h-4 mr-2\" />\n                {isSaving ? \"Saving...\" : editingPost ? \"Update Post\" : \"Create Post\"}\n              </Button>\n            </div>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Are you sure?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. This will permanently delete the\n              post from the database.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":23859,"size_tokens":null},"client/src/pages/admin/settings/SettingsPerformance.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Zap, Globe, BarChart3, Activity, Server, HardDrive, RefreshCw } from \"lucide-react\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useState } from \"react\";\n\ninterface PerformanceMetrics {\n  pageLoadTime: string;\n  coreWebVitals: string;\n  cacheHitRate: string;\n  memoryUsage: string;\n  uptime: string;\n  requestsPerMinute: number;\n}\n\nexport function SettingsPerformance() {\n  const { toast } = useToast();\n  const { settings, updateSettings, saveSettings, isSaving } = useSiteSettings();\n  const [isClearing, setIsClearing] = useState(false);\n  const [metrics, setMetrics] = useState<PerformanceMetrics>({\n    pageLoadTime: \"1.2s\",\n    coreWebVitals: \"Good\",\n    cacheHitRate: \"87%\",\n    memoryUsage: \"45%\",\n    uptime: \"99.9%\",\n    requestsPerMinute: 12\n  });\n  \n  const handleClearCache = async () => {\n    setIsClearing(true);\n    try {\n      await api.clearCache();\n      toast({ \n        title: \"Success\", \n        description: \"Cache cleared successfully\" \n      });\n    } catch (error: any) {\n      toast({ \n        title: \"Error\", \n        description: error.message || \"Failed to clear cache\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsClearing(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BarChart3 className=\"w-5 h-5\" /> Performance Overview\n          </CardTitle>\n          <CardDescription>Real-time performance metrics for your portfolio</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Activity className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Page Load</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.pageLoadTime}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Zap className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Core Web Vitals</p>\n              </div>\n              <Badge variant={metrics.coreWebVitals === \"Good\" ? \"default\" : \"secondary\"} className=\"mt-1\">\n                {metrics.coreWebVitals}\n              </Badge>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <HardDrive className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Cache Hit Rate</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.cacheHitRate}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Server className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Memory Usage</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.memoryUsage}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <Globe className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Uptime</p>\n              </div>\n              <p className=\"font-bold text-lg text-green-600\">{metrics.uptime}</p>\n            </div>\n            <div className=\"p-3 bg-muted rounded-lg\">\n              <div className=\"flex items-center gap-2\">\n                <RefreshCw className=\"w-4 h-4 text-muted-foreground\" />\n                <p className=\"text-xs text-muted-foreground\">Requests/min</p>\n              </div>\n              <p className=\"font-bold text-lg\">{metrics.requestsPerMinute}</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Zap className=\"w-5 h-5\" /> Caching Configuration\n          </CardTitle>\n          <CardDescription>Optimize site performance with browser and server caching</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Browser Cache</Label>\n              <p className=\"text-xs text-muted-foreground\">Cache static assets on visitor's browser</p>\n            </div>\n            <Switch \n              checked={settings.enableBrowserCache !== false}\n              onCheckedChange={(checked) => updateSettings({ enableBrowserCache: checked })}\n              data-testid=\"switch-browser-cache\"\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm\">Static Assets TTL</Label>\n              <Input \n                type=\"number\" \n                value={settings.staticCacheTTL || 86400}\n                onChange={(e) => updateSettings({ staticCacheTTL: parseInt(e.target.value) || 86400 })}\n                data-testid=\"input-static-cache-ttl\"\n              />\n              <p className=\"text-xs text-muted-foreground\">Seconds (86400 = 1 day)</p>\n            </div>\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm\">API Response TTL</Label>\n              <Input \n                type=\"number\" \n                value={settings.apiCacheTTL || 300}\n                onChange={(e) => updateSettings({ apiCacheTTL: parseInt(e.target.value) || 300 })}\n                data-testid=\"input-api-cache-ttl\"\n              />\n              <p className=\"text-xs text-muted-foreground\">Seconds (300 = 5 minutes)</p>\n            </div>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Response Compression</Label>\n              <p className=\"text-xs text-muted-foreground\">Gzip compress API responses</p>\n            </div>\n            <Switch \n              checked={settings.enableCompression !== false}\n              onCheckedChange={(checked) => updateSettings({ enableCompression: checked })}\n              data-testid=\"switch-compression\"\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              className=\"flex-1\"\n              onClick={handleClearCache}\n              disabled={isClearing}\n              data-testid=\"button-clear-cache\"\n            >\n              {isClearing ? \"Clearing...\" : \"Clear All Cache\"}\n            </Button>\n          </div>\n          <p className=\"text-xs text-muted-foreground\">\n            Changes are automatically tracked and saved using the \"Save Changes\" button in the header.\n          </p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Globe className=\"w-5 h-5\" /> Asset Optimization\n          </CardTitle>\n          <CardDescription>Optimize images and static assets for faster loading</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Lazy Load Images</Label>\n              <p className=\"text-xs text-muted-foreground\">Load images only when visible</p>\n            </div>\n            <Switch \n              checked={settings.lazyLoadImages !== false}\n              onCheckedChange={(checked) => updateSettings({ lazyLoadImages: checked })}\n              data-testid=\"switch-lazy-load\"\n            />\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Auto-optimize Images</Label>\n              <p className=\"text-xs text-muted-foreground\">Automatically compress uploaded images</p>\n            </div>\n            <Switch \n              checked={settings.autoOptimizeImages === true}\n              onCheckedChange={(checked) => updateSettings({ autoOptimizeImages: checked })}\n              data-testid=\"switch-auto-optimize\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label className=\"text-sm\">Max Image Width (px)</Label>\n            <Input \n              type=\"number\" \n              value={settings.maxImageWidth || 1920}\n              onChange={(e) => updateSettings({ maxImageWidth: parseInt(e.target.value) || 1920 })}\n              data-testid=\"input-max-image-width\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Images larger than this will be resized</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":9443,"size_tokens":null},"server/api/performance.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.post(\"/clear-cache\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    await storage.createActivityLog({\n      action: \"Cache cleared\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n\n    res.json({ message: \"Cache cleared successfully\", success: true });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":612,"size_tokens":null},"server/api/posts.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertPostSchema } from \"@shared/schema\";\n\nconst router = Router();\n\n// Get all posts\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const posts = req.query.published === \"true\"\n      ? await storage.getPublishedPosts()\n      : await storage.getAllPosts();\n    res.json(posts);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Get post by ID or slug\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const post = isNaN(id) \n      ? await storage.getPostBySlug(req.params.id)\n      : await storage.getPost(id);\n    if (!post) {\n      return res.status(404).json({ message: \"Post not found\" });\n    }\n    res.json(post);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Create post\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertPostSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const post = await storage.createPost(parsed.data);\n    res.status(201).json(post);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Update post\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const post = await storage.updatePost(parseInt(req.params.id), req.body);\n    if (!post) {\n      return res.status(404).json({ message: \"Post not found\" });\n    }\n    res.json(post);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Delete post\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deletePost(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Post not found\" });\n    }\n    res.json({ message: \"Post deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Increment post views\nrouter.post(\"/:id/view\", async (req, res) => {\n  try {\n    await storage.incrementPostViews(parseInt(req.params.id));\n    res.json({ message: \"View counted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2382,"size_tokens":null},"server/api/messages.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { insertMessageSchema } from \"@shared/schema\";\nimport { broadcastNewMessage } from \"../websocket\";\nimport nodemailer from \"nodemailer\";\n\nconst router = Router();\n\nasync function getSmtpTransporter() {\n  const smtpHost = await storage.getSetting(\"smtpHost\");\n  const smtpPort = await storage.getSetting(\"smtpPort\");\n  const smtpUser = await storage.getSetting(\"smtpUser\");\n  const smtpPassword = await storage.getSetting(\"smtpPassword\");\n  const smtpSecure = await storage.getSetting(\"smtpSecure\");\n\n  if (!smtpHost?.value || !smtpPort?.value || !smtpUser?.value || !smtpPassword?.value) {\n    return null;\n  }\n\n  const port = typeof smtpPort.value === 'string' ? parseInt(smtpPort.value) : smtpPort.value;\n  const secure = smtpSecure?.value === true || smtpSecure?.value === 'true';\n\n  return nodemailer.createTransport({\n    host: smtpHost.value as string,\n    port: port as number,\n    secure: secure,\n    auth: {\n      user: smtpUser.value as string,\n      pass: smtpPassword.value as string,\n    },\n    requireTLS: !secure,\n    connectionTimeout: 10000,\n    greetingTimeout: 10000,\n    socketTimeout: 10000,\n  });\n}\n\nrouter.get(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const messages = req.query.unread === \"true\"\n      ? await storage.getUnreadMessages()\n      : await storage.getAllMessages();\n    res.json(messages);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/smtp/status\", requireAdmin, async (req, res) => {\n  try {\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.json({ configured: false, message: \"SMTP is not configured\" });\n    }\n    \n    try {\n      await transporter.verify();\n      res.json({ configured: true, active: true, message: \"SMTP is configured and active\" });\n    } catch (verifyError: any) {\n      res.json({ configured: true, active: false, message: `SMTP configured but not active: ${verifyError.message}` });\n    }\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", requireAdmin, async (req, res) => {\n  try {\n    const message = await storage.getMessage(parseInt(req.params.id));\n    if (!message) {\n      return res.status(404).json({ message: \"Message not found\" });\n    }\n    res.json(message);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", async (req, res) => {\n  try {\n    const { captchaToken, captchaType, ...messageData } = req.body;\n\n    const parsed = insertMessageSchema.safeParse(messageData);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const message = await storage.createMessage(parsed.data);\n\n    broadcastNewMessage(message);\n\n    res.status(201).json(message);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/read\", requireAdmin, async (req, res) => {\n  try {\n    const success = await storage.markMessageAsRead(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Message not found\" });\n    }\n    res.json({ message: \"Message marked as read\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/archive\", requireAdmin, async (req, res) => {\n  try {\n    const success = await storage.archiveMessage(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Message not found\" });\n    }\n    res.json({ message: \"Message archived\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAdmin, async (req, res) => {\n  try {\n    const success = await storage.deleteMessage(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Message not found\" });\n    }\n    res.json({ message: \"Message deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/:id/reply\", requireAdmin, async (req, res) => {\n  try {\n    const messageId = parseInt(req.params.id);\n    const { replyContent } = req.body;\n\n    if (!replyContent || replyContent.trim() === '') {\n      return res.status(400).json({ message: \"Reply content is required\" });\n    }\n\n    const message = await storage.getMessage(messageId);\n    if (!message) {\n      return res.status(404).json({ message: \"Message not found\" });\n    }\n\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.status(400).json({ message: \"SMTP is not configured. Please configure SMTP settings first.\" });\n    }\n\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n\n    const fromName = emailFromName?.value || siteTitle?.value || 'Portfolio';\n    const fromEmail = (emailFromAddress?.value || smtpUser?.value || '') as string;\n\n    const originalSubject = message.subject || 'No Subject';\n    const subject = originalSubject.startsWith('Re:') \n      ? originalSubject \n      : `Re: ${originalSubject}`;\n\n    const htmlBody = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; color: white; text-align: center;\">\n          <h2 style=\"margin: 0;\">${fromName}</h2>\n        </div>\n        <div style=\"padding: 30px; background: #f9fafb;\">\n          <p style=\"color: #374151;\">Hello ${message.sender},</p>\n          <div style=\"margin: 20px 0; padding: 20px; background: white; border-radius: 8px; border-left: 4px solid #667eea;\">\n            ${replyContent.replace(/\\n/g, '<br>')}\n          </div>\n          <hr style=\"border: none; border-top: 1px solid #e5e7eb; margin: 30px 0;\">\n          <p style=\"color: #6b7280; font-size: 14px;\">This is a reply to your message:</p>\n          <div style=\"padding: 15px; background: #f3f4f6; border-radius: 8px; font-size: 14px; color: #6b7280;\">\n            <p style=\"margin: 0 0 10px 0;\"><strong>Subject:</strong> ${message.subject}</p>\n            <p style=\"margin: 0; white-space: pre-wrap;\">${message.message}</p>\n          </div>\n        </div>\n        <div style=\"padding: 20px; text-align: center; background: #374151; color: #9ca3af; font-size: 12px;\">\n          <p style=\"margin: 0;\">Sent from ${fromName}</p>\n        </div>\n      </div>\n    `;\n\n    await transporter.sendMail({\n      from: `\"${fromName}\" <${fromEmail}>`,\n      to: message.email,\n      subject: subject,\n      html: htmlBody,\n      replyTo: fromEmail,\n    });\n\n    await storage.createActivityLog({\n      action: `Replied to message from ${message.sender} (${message.email})`,\n      userId: req.session.userId!,\n      userName: req.session.username || 'Admin',\n      type: 'info'\n    });\n\n    res.json({ success: true, message: \"Reply sent successfully\" });\n  } catch (error: any) {\n    console.error('Error sending reply:', error);\n    res.status(500).json({ message: `Failed to send reply: ${error.message}` });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":7411,"size_tokens":null},"client/src/pages/home/PageDetail.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { Loader2, ArrowLeft } from \"lucide-react\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { motion } from \"framer-motion\";\n\nexport default function PageDetail() {\n  const [match, params] = useRoute(\"/page/:slug\");\n  const [, setLocation] = useLocation();\n\n  const { data: page, isLoading } = useQuery({\n    queryKey: [\"/api/pages\", params?.slug],\n    queryFn: async () => {\n      const response = await fetch(`/api/pages/${params?.slug}`);\n      if (!response.ok) throw new Error(\"Page not found\");\n      return response.json();\n    },\n    enabled: !!params?.slug,\n  });\n\n  if (!match) return null;\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!page) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"pt-32 pb-16 text-center container mx-auto px-4\">\n          <h1 className=\"text-4xl font-bold mb-4\">Page Not Found</h1>\n          <p className=\"text-muted-foreground mb-8\">The page you're looking for doesn't exist.</p>\n          <Button onClick={() => setLocation(\"/pages\")}>\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Pages\n          </Button>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <motion.article\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        transition={{ duration: 0.5 }}\n        className=\"pt-24 pb-16\"\n      >\n        <div className=\"container mx-auto px-4 max-w-4xl\">\n          <Button \n            variant=\"ghost\" \n            className=\"mb-8\"\n            onClick={() => setLocation(\"/pages\")}\n            data-testid=\"button-back-to-pages\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Pages\n          </Button>\n\n          {page.featuredImage && (\n            <div className=\"mb-8 rounded-lg overflow-hidden h-96\">\n              <img\n                src={page.featuredImage}\n                alt={page.title}\n                className=\"w-full h-full object-cover\"\n              />\n            </div>\n          )}\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-8\"\n          >\n            <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">{page.title}</h1>\n            {page.excerpt && (\n              <p className=\"text-xl text-muted-foreground mb-4\">{page.excerpt}</p>\n            )}\n            <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n              <span>{new Date(page.updatedAt).toLocaleDateString()}</span>\n              <span>{page.views} views</span>\n            </div>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ duration: 0.5, delay: 0.2 }}\n            className=\"prose prose-sm dark:prose-invert max-w-none\"\n          >\n            <div\n              dangerouslySetInnerHTML={{ __html: page.content || \"\" }}\n              className=\"\n                [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mt-6 [&_h1]:mb-4\n                [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-5 [&_h2]:mb-3\n                [&_h3]:text-xl [&_h3]:font-bold [&_h3]:mt-4 [&_h3]:mb-2\n                [&_p]:mb-4 [&_p]:leading-relaxed\n                [&_ul]:list-disc [&_ul]:ml-6 [&_ul]:my-4\n                [&_ol]:list-decimal [&_ol]:ml-6 [&_ol]:my-4\n                [&_li]:my-2\n                [&_blockquote]:border-l-4 [&_blockquote]:border-primary [&_blockquote]:pl-4 [&_blockquote]:my-4 [&_blockquote]:text-muted-foreground [&_blockquote]:italic\n                [&_code]:bg-muted [&_code]:px-2 [&_code]:py-1 [&_code]:rounded [&_code]:font-mono\n                [&_pre]:bg-muted [&_pre]:p-4 [&_pre]:rounded-lg [&_pre]:overflow-x-auto [&_pre]:my-4\n                [&_a]:text-primary [&_a]:underline [&_a]:hover:text-primary/80\n                [&_img]:rounded-lg [&_img]:my-4 [&_img]:max-w-full [&_img]:h-auto\n                [&_table]:w-full [&_table]:border-collapse [&_table]:my-4\n                [&_th]:bg-muted [&_th]:px-4 [&_th]:py-2 [&_th]:text-left [&_th]:font-semibold\n                [&_td]:border [&_td]:border-border [&_td]:px-4 [&_td]:py-2\n              \"\n            />\n          </motion.div>\n        </div>\n      </motion.article>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":4795,"size_tokens":null},"client/src/pages/admin/communications/EmailTemplates.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Mail, Plus, Edit, Trash, Eye, Send } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface EmailTemplate {\n  id: number;\n  name: string;\n  subject: string;\n  description: string;\n  category: string;\n  status: \"active\" | \"draft\";\n}\n\nexport default function AdminEmailTemplates() {\n  const [templates, setTemplates] = useState<EmailTemplate[]>([\n    {\n      id: 1,\n      name: \"Welcome Email\",\n      subject: \"Welcome to Our Portfolio!\",\n      description: \"Sent to new newsletter subscribers\",\n      category: \"Newsletter\",\n      status: \"active\"\n    },\n    {\n      id: 2,\n      name: \"Contact Form Response\",\n      subject: \"Thank you for reaching out\",\n      description: \"Auto-reply for contact form submissions\",\n      category: \"Contact\",\n      status: \"active\"\n    },\n    {\n      id: 3,\n      name: \"Project Update\",\n      subject: \"Your project update\",\n      description: \"Send project progress updates to clients\",\n      category: \"Projects\",\n      status: \"draft\"\n    },\n  ]);\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this template?\")) {\n      setTemplates(templates.filter(t => t.id !== id));\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Email Templates</h1>\n            <p className=\"text-muted-foreground\">Create and manage email templates</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> New Template\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {templates.map((template) => (\n            <Card key={template.id}>\n              <CardHeader>\n                <div className=\"flex items-start justify-between\">\n                  <Mail className=\"w-8 h-8 text-primary\" />\n                  <Badge variant={template.status === \"active\" ? \"default\" : \"secondary\"}>\n                    {template.status}\n                  </Badge>\n                </div>\n                <CardTitle className=\"mt-3\">{template.name}</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">{template.description}</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Subject:</p>\n                    <p className=\"text-sm font-medium\">{template.subject}</p>\n                  </div>\n                  <div>\n                    <Badge variant=\"outline\">{template.category}</Badge>\n                  </div>\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                      <Eye className=\"w-3 h-3 mr-1\" /> Preview\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                      <Edit className=\"w-3 h-3 mr-1\" /> Edit\n                    </Button>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\"\n                      className=\"text-destructive\"\n                      onClick={() => handleDelete(template.id)}\n                    >\n                      <Trash className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                  <Button variant=\"secondary\" size=\"sm\" className=\"w-full gap-2\">\n                    <Send className=\"w-3 h-3\" /> Send Test Email\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4078,"size_tokens":null},"client/src/pages/admin/system/ActivityLog.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Filter, \n  Download, \n  Calendar, \n  User, \n  Activity, \n  AlertTriangle,\n  Search,\n  RefreshCw,\n  ChevronLeft,\n  ChevronRight,\n  FileText,\n  Settings,\n  MessageSquare,\n  LogIn,\n  LogOut,\n  Trash2,\n  Edit,\n  Plus,\n  Eye,\n  Shield,\n  Info,\n  Bug,\n  Globe,\n  Clock,\n  AlertCircle,\n  CheckCircle,\n  XCircle,\n  Lock\n} from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { formatDistanceToNow, format } from \"date-fns\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\n\ntype ActivityLog = {\n  id: number;\n  action: string;\n  userId: number | null;\n  userName: string | null;\n  type: string;\n  metadata: any;\n  createdAt: string;\n};\n\ntype SecurityLog = {\n  id: number;\n  eventType: string;\n  action: string | null;\n  userId: number | null;\n  userName: string | null;\n  ipAddress: string | null;\n  userAgent: string | null;\n  requestPath: string | null;\n  blocked: boolean;\n  metadata: any;\n  createdAt: string;\n};\n\nconst getActionIcon = (action: string) => {\n  const lowerAction = action.toLowerCase();\n  if (lowerAction.includes('login')) return <LogIn className=\"w-4 h-4\" />;\n  if (lowerAction.includes('logout')) return <LogOut className=\"w-4 h-4\" />;\n  if (lowerAction.includes('delete')) return <Trash2 className=\"w-4 h-4\" />;\n  if (lowerAction.includes('update') || lowerAction.includes('edit')) return <Edit className=\"w-4 h-4\" />;\n  if (lowerAction.includes('create') || lowerAction.includes('add') || lowerAction.includes('publish')) return <Plus className=\"w-4 h-4\" />;\n  if (lowerAction.includes('view')) return <Eye className=\"w-4 h-4\" />;\n  if (lowerAction.includes('comment')) return <MessageSquare className=\"w-4 h-4\" />;\n  if (lowerAction.includes('setting')) return <Settings className=\"w-4 h-4\" />;\n  if (lowerAction.includes('security') || lowerAction.includes('password')) return <Shield className=\"w-4 h-4\" />;\n  return <FileText className=\"w-4 h-4\" />;\n};\n\nconst getTypeBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n  switch (type) {\n    case 'error': return 'destructive';\n    case 'warning': return 'secondary';\n    case 'success': return 'default';\n    default: return 'outline';\n  }\n};\n\nconst getTypeLabel = (type: string) => {\n  switch (type) {\n    case 'error': return 'Error';\n    case 'warning': return 'Warning';\n    case 'success': return 'Success';\n    case 'info': return 'Info';\n    default: return type;\n  }\n};\n\nconst getSecurityEventIcon = (eventType: string) => {\n  const type = eventType.toLowerCase();\n  if (type.includes('login_success')) return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n  if (type.includes('login_failed')) return <XCircle className=\"w-4 h-4 text-red-500\" />;\n  if (type.includes('blocked') || type.includes('ip_blocked')) return <Lock className=\"w-4 h-4 text-red-500\" />;\n  if (type.includes('bot')) return <Bug className=\"w-4 h-4 text-yellow-500\" />;\n  if (type.includes('ddos') || type.includes('injection') || type.includes('xss')) return <AlertTriangle className=\"w-4 h-4 text-red-500\" />;\n  if (type.includes('2fa') || type.includes('password')) return <Shield className=\"w-4 h-4 text-blue-500\" />;\n  return <Info className=\"w-4 h-4 text-muted-foreground\" />;\n};\n\nconst getSecurityEventBadge = (eventType: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n  const type = eventType.toLowerCase();\n  if (type.includes('success')) return 'default';\n  if (type.includes('failed') || type.includes('blocked') || type.includes('ddos') || type.includes('injection') || type.includes('xss')) return 'destructive';\n  if (type.includes('attempt') || type.includes('warning') || type.includes('bot')) return 'secondary';\n  return 'outline';\n};\n\nconst formatEventType = (eventType: string) => {\n  return eventType\n    .replace(/_/g, ' ')\n    .replace(/\\b\\w/g, c => c.toUpperCase());\n};\n\nexport default function AdminActivityLog() {\n  const [activeTab, setActiveTab] = useState(\"activity\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [page, setPage] = useState(1);\n  const [securitySearch, setSecuritySearch] = useState(\"\");\n  const [securityFilter, setSecurityFilter] = useState(\"all\");\n  const [loginSearch, setLoginSearch] = useState(\"\");\n  const pageSize = 20;\n  const { toast } = useToast();\n\n  const { data: logs = [], isLoading, refetch } = useQuery<ActivityLog[]>({\n    queryKey: ['/api/activity-logs'],\n  });\n\n  const { data: securityLogs = [], isLoading: isLoadingSecurityLogs, refetch: refetchSecurityLogs } = useQuery<SecurityLog[]>({\n    queryKey: ['/api/security/logs'],\n  });\n\n  const { data: loginHistory = [], isLoading: isLoadingLoginHistory, refetch: refetchLoginHistory } = useQuery<SecurityLog[]>({\n    queryKey: ['/api/security/login-history'],\n  });\n\n  const filteredLogs = logs.filter(log => {\n    const matchesSearch = searchQuery === \"\" ||\n      log.action.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (log.userName && log.userName.toLowerCase().includes(searchQuery.toLowerCase()));\n    \n    const matchesType = filterType === \"all\" || log.type === filterType;\n    \n    return matchesSearch && matchesType;\n  });\n\n  const paginatedLogs = filteredLogs.slice((page - 1) * pageSize, page * pageSize);\n  const totalPages = Math.ceil(filteredLogs.length / pageSize);\n\n  const todayLogs = logs.filter(log => {\n    const logDate = new Date(log.createdAt);\n    const today = new Date();\n    return logDate.toDateString() === today.toDateString();\n  });\n\n  const errorLogs = logs.filter(log => log.type === 'error');\n  const uniqueUsers = new Set(logs.map(log => log.userName).filter(Boolean));\n\n  const filteredSecurityLogs = securityLogs.filter(log => {\n    const matchesSearch = securitySearch === \"\" ||\n      (log.action && log.action.toLowerCase().includes(securitySearch.toLowerCase())) ||\n      log.eventType.toLowerCase().includes(securitySearch.toLowerCase()) ||\n      (log.ipAddress && log.ipAddress.toLowerCase().includes(securitySearch.toLowerCase()));\n    \n    const matchesFilter = securityFilter === \"all\" || log.eventType.toLowerCase().includes(securityFilter.toLowerCase());\n    \n    return matchesSearch && matchesFilter;\n  });\n\n  const filteredLoginHistory = loginHistory.filter(log => {\n    return loginSearch === \"\" ||\n      (log.userName && log.userName.toLowerCase().includes(loginSearch.toLowerCase())) ||\n      (log.ipAddress && log.ipAddress.toLowerCase().includes(loginSearch.toLowerCase()));\n  });\n\n  const loginSuccessCount = loginHistory.filter(l => l.eventType === 'login_success').length;\n  const loginFailedCount = loginHistory.filter(l => l.eventType === 'login_failed').length;\n  const blockedCount = securityLogs.filter(l => l.blocked).length;\n\n  const handleExport = (type: 'activity' | 'security' | 'login') => {\n    let data: any[];\n    let filename: string;\n    \n    if (type === 'activity') {\n      data = filteredLogs;\n      filename = `activity-log-${format(new Date(), 'yyyy-MM-dd')}.csv`;\n    } else if (type === 'security') {\n      data = filteredSecurityLogs;\n      filename = `security-log-${format(new Date(), 'yyyy-MM-dd')}.csv`;\n    } else {\n      data = filteredLoginHistory;\n      filename = `login-history-${format(new Date(), 'yyyy-MM-dd')}.csv`;\n    }\n\n    const csvContent = type === 'activity' \n      ? [\n          ['ID', 'Action', 'User', 'Type', 'Timestamp'].join(','),\n          ...data.map((log: any) => [\n            log.id,\n            `\"${log.action}\"`,\n            log.userName || 'System',\n            log.type,\n            format(new Date(log.createdAt), 'yyyy-MM-dd HH:mm:ss'),\n          ].join(','))\n        ].join('\\n')\n      : [\n          ['ID', 'Event', 'User', 'IP Address', 'Status', 'Timestamp'].join(','),\n          ...data.map((log: any) => [\n            log.id,\n            `\"${log.eventType}\"`,\n            log.userName || 'Unknown',\n            log.ipAddress || 'N/A',\n            log.blocked ? 'Blocked' : 'Allowed',\n            format(new Date(log.createdAt), 'yyyy-MM-dd HH:mm:ss'),\n          ].join(','))\n        ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    \n    toast({ title: \"Exported\", description: `${filename} downloaded` });\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">System Logs</h1>\n            <p className=\"text-muted-foreground\">Monitor user activities, login history and security events</p>\n          </div>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3 max-w-lg\">\n            <TabsTrigger value=\"activity\" className=\"gap-2\" data-testid=\"tab-activity\">\n              <Activity className=\"w-4 h-4\" /> Activity\n            </TabsTrigger>\n            <TabsTrigger value=\"login\" className=\"gap-2\" data-testid=\"tab-login\">\n              <LogIn className=\"w-4 h-4\" /> Login\n            </TabsTrigger>\n            <TabsTrigger value=\"security\" className=\"gap-2\" data-testid=\"tab-security\">\n              <Shield className=\"w-4 h-4\" /> Security\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Activity Logs Tab */}\n          <TabsContent value=\"activity\" className=\"space-y-6 mt-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-primary/10\">\n                      <Activity className=\"w-5 h-5 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Total Activities</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-total-activities\">{logs.length}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-blue-500/10\">\n                      <Calendar className=\"w-5 h-5 text-blue-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Today</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-today-activities\">{todayLogs.length}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-green-500/10\">\n                      <User className=\"w-5 h-5 text-green-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Active Users</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-active-users\">{uniqueUsers.size}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-red-500/10\">\n                      <AlertTriangle className=\"w-5 h-5 text-red-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Errors</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-error-count\">{errorLogs.length}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 space-y-0\">\n                <CardTitle>Activity Timeline</CardTitle>\n                <div className=\"flex flex-wrap gap-2 items-center\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      type=\"search\"\n                      placeholder=\"Search...\"\n                      className=\"pl-9 w-[180px]\"\n                      value={searchQuery}\n                      onChange={(e) => { setSearchQuery(e.target.value); setPage(1); }}\n                      data-testid=\"input-search-activity\"\n                    />\n                  </div>\n                  <Select value={filterType} onValueChange={(value) => { setFilterType(value); setPage(1); }}>\n                    <SelectTrigger className=\"w-[120px]\" data-testid=\"select-filter-type\">\n                      <Filter className=\"w-4 h-4 mr-2\" />\n                      <SelectValue placeholder=\"Type\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All</SelectItem>\n                      <SelectItem value=\"info\">Info</SelectItem>\n                      <SelectItem value=\"success\">Success</SelectItem>\n                      <SelectItem value=\"warning\">Warning</SelectItem>\n                      <SelectItem value=\"error\">Error</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <Button variant=\"outline\" size=\"icon\" onClick={() => refetch()} disabled={isLoading} data-testid=\"button-refresh-activity\">\n                    <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"gap-2\" onClick={() => handleExport('activity')} disabled={filteredLogs.length === 0} data-testid=\"button-export-activity\">\n                    <Download className=\"w-4 h-4\" /> Export\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"space-y-4\">\n                    {[1, 2, 3, 4, 5].map((i) => (\n                      <div key={i} className=\"animate-pulse flex gap-4 p-3 border rounded-lg\">\n                        <div className=\"w-10 h-10 bg-muted rounded-lg\" />\n                        <div className=\"flex-1 space-y-2\">\n                          <div className=\"h-4 bg-muted rounded w-1/3\" />\n                          <div className=\"h-3 bg-muted rounded w-1/2\" />\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : paginatedLogs.length === 0 ? (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Activity className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p className=\"text-lg font-medium\">No activity logs found</p>\n                    <p className=\"text-sm mt-1\">\n                      {searchQuery || filterType !== \"all\" ? \"Try adjusting your filters\" : \"Activity will appear here\"}\n                    </p>\n                  </div>\n                ) : (\n                  <ScrollArea className=\"h-[500px]\">\n                    <div className=\"space-y-3\">\n                      {paginatedLogs.map((log) => (\n                        <div \n                          key={log.id} \n                          className={`flex items-start gap-4 p-3 rounded-lg border transition-colors hover:bg-muted/50 ${\n                            log.type === 'error' ? 'border-red-500/30 bg-red-500/5' \n                            : log.type === 'warning' ? 'border-yellow-500/30 bg-yellow-500/5'\n                            : log.type === 'success' ? 'border-green-500/30 bg-green-500/5'\n                            : ''\n                          }`}\n                          data-testid={`activity-log-${log.id}`}\n                        >\n                          <div className={`p-2 rounded-lg ${\n                            log.type === 'error' ? 'bg-red-500/10 text-red-500' \n                            : log.type === 'warning' ? 'bg-yellow-500/10 text-yellow-500'\n                            : log.type === 'success' ? 'bg-green-500/10 text-green-500'\n                            : 'bg-primary/10 text-primary'\n                          }`}>\n                            {getActionIcon(log.action)}\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <h4 className=\"font-semibold text-sm\">{log.action}</h4>\n                              <Badge variant={getTypeBadgeVariant(log.type)} className=\"text-xs\">\n                                {getTypeLabel(log.type)}\n                              </Badge>\n                            </div>\n                            {log.metadata && (\n                              <p className=\"text-xs text-muted-foreground mt-1 truncate\">\n                                {typeof log.metadata === 'object' \n                                  ? (log.metadata.details || log.metadata.description || JSON.stringify(log.metadata))\n                                  : log.metadata\n                                }\n                              </p>\n                            )}\n                            <div className=\"flex gap-3 mt-2 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <User className=\"w-3 h-3\" />\n                                {log.userName || 'System'}\n                              </span>\n                              <span className=\"flex items-center gap-1\">\n                                <Clock className=\"w-3 h-3\" />\n                                {formatDistanceToNow(new Date(log.createdAt), { addSuffix: true })}\n                              </span>\n                            </div>\n                          </div>\n                          <div className=\"text-right text-xs text-muted-foreground/70 flex-shrink-0\">\n                            {format(new Date(log.createdAt), 'MMM d')}\n                            <br />\n                            {format(new Date(log.createdAt), 'h:mm a')}\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </ScrollArea>\n                )}\n\n                {totalPages > 1 && (\n                  <div className=\"flex items-center justify-between mt-4 pt-4 border-t\">\n                    <p className=\"text-sm text-muted-foreground\">\n                      {((page - 1) * pageSize) + 1} - {Math.min(page * pageSize, filteredLogs.length)} of {filteredLogs.length}\n                    </p>\n                    <div className=\"flex items-center gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setPage(p => Math.max(1, p - 1))} disabled={page === 1}>\n                        <ChevronLeft className=\"w-4 h-4\" />\n                      </Button>\n                      <span className=\"text-sm px-2\">Page {page} / {totalPages}</span>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setPage(p => Math.min(totalPages, p + 1))} disabled={page === totalPages}>\n                        <ChevronRight className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Login History Tab */}\n          <TabsContent value=\"login\" className=\"space-y-6 mt-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-green-500/10\">\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Successful Logins</p>\n                      <h3 className=\"text-2xl font-bold text-green-600\" data-testid=\"text-login-success\">{loginSuccessCount}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-red-500/10\">\n                      <XCircle className=\"w-5 h-5 text-red-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Failed Attempts</p>\n                      <h3 className=\"text-2xl font-bold text-red-600\" data-testid=\"text-login-failed\">{loginFailedCount}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-blue-500/10\">\n                      <Activity className=\"w-5 h-5 text-blue-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Total Events</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-login-total\">{loginHistory.length}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 space-y-0\">\n                <div>\n                  <CardTitle>Login History</CardTitle>\n                  <CardDescription>Track all authentication attempts</CardDescription>\n                </div>\n                <div className=\"flex flex-wrap gap-2 items-center\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      type=\"search\"\n                      placeholder=\"Search user or IP...\"\n                      className=\"pl-9 w-[200px]\"\n                      value={loginSearch}\n                      onChange={(e) => setLoginSearch(e.target.value)}\n                      data-testid=\"input-search-login\"\n                    />\n                  </div>\n                  <Button variant=\"outline\" size=\"icon\" onClick={() => refetchLoginHistory()} disabled={isLoadingLoginHistory}>\n                    <RefreshCw className={`w-4 h-4 ${isLoadingLoginHistory ? 'animate-spin' : ''}`} />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"gap-2\" onClick={() => handleExport('login')}>\n                    <Download className=\"w-4 h-4\" /> Export\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {isLoadingLoginHistory ? (\n                  <div className=\"space-y-2\">\n                    {[1, 2, 3].map(i => <div key={i} className=\"h-12 bg-muted rounded animate-pulse\" />)}\n                  </div>\n                ) : filteredLoginHistory.length === 0 ? (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <LogIn className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p className=\"text-lg font-medium\">No login history</p>\n                  </div>\n                ) : (\n                  <div className=\"rounded-md border\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead>Status</TableHead>\n                          <TableHead>User</TableHead>\n                          <TableHead>IP Address</TableHead>\n                          <TableHead className=\"hidden md:table-cell\">User Agent</TableHead>\n                          <TableHead>Time</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {filteredLoginHistory.slice(0, 50).map((log) => (\n                          <TableRow key={log.id}>\n                            <TableCell>\n                              <div className=\"flex items-center gap-2\">\n                                {log.eventType === 'login_success' ? (\n                                  <Badge variant=\"default\" className=\"gap-1 bg-green-600\">\n                                    <CheckCircle className=\"w-3 h-3\" />\n                                    Success\n                                  </Badge>\n                                ) : (\n                                  <Badge variant=\"destructive\" className=\"gap-1\">\n                                    <XCircle className=\"w-3 h-3\" />\n                                    Failed\n                                  </Badge>\n                                )}\n                              </div>\n                            </TableCell>\n                            <TableCell className=\"font-medium\">{log.userName || 'Unknown'}</TableCell>\n                            <TableCell>\n                              <div className=\"flex items-center gap-1\">\n                                <Globe className=\"w-3 h-3 text-muted-foreground\" />\n                                <code className=\"text-xs bg-muted px-1 py-0.5 rounded\">{log.ipAddress || 'N/A'}</code>\n                              </div>\n                            </TableCell>\n                            <TableCell className=\"hidden md:table-cell max-w-[200px]\">\n                              <Tooltip>\n                                <TooltipTrigger asChild>\n                                  <span className=\"text-xs text-muted-foreground truncate block cursor-help\">\n                                    {log.userAgent ? log.userAgent.substring(0, 50) + '...' : 'N/A'}\n                                  </span>\n                                </TooltipTrigger>\n                                <TooltipContent className=\"max-w-sm\">\n                                  <p className=\"text-xs\">{log.userAgent || 'N/A'}</p>\n                                </TooltipContent>\n                              </Tooltip>\n                            </TableCell>\n                            <TableCell>\n                              <div className=\"text-xs\">\n                                <div>{format(new Date(log.createdAt), 'MMM d, yyyy')}</div>\n                                <div className=\"text-muted-foreground\">{format(new Date(log.createdAt), 'h:mm:ss a')}</div>\n                              </div>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Security Logs Tab */}\n          <TabsContent value=\"security\" className=\"space-y-6 mt-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-primary/10\">\n                      <Shield className=\"w-5 h-5 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Total Events</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-security-total\">{securityLogs.length}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-red-500/10\">\n                      <Lock className=\"w-5 h-5 text-red-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Blocked</p>\n                      <h3 className=\"text-2xl font-bold text-red-600\" data-testid=\"text-blocked-count\">{blockedCount}</h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-yellow-500/10\">\n                      <Bug className=\"w-5 h-5 text-yellow-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Bot Attempts</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-bot-count\">\n                        {securityLogs.filter(l => l.eventType.toLowerCase().includes('bot')).length}\n                      </h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 rounded-lg bg-orange-500/10\">\n                      <AlertTriangle className=\"w-5 h-5 text-orange-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Threats</p>\n                      <h3 className=\"text-2xl font-bold\" data-testid=\"text-threat-count\">\n                        {securityLogs.filter(l => \n                          l.eventType.toLowerCase().includes('ddos') || \n                          l.eventType.toLowerCase().includes('injection') ||\n                          l.eventType.toLowerCase().includes('xss')\n                        ).length}\n                      </h3>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 space-y-0\">\n                <div>\n                  <CardTitle>Security Events</CardTitle>\n                  <CardDescription>Monitor security threats and blocked attempts</CardDescription>\n                </div>\n                <div className=\"flex flex-wrap gap-2 items-center\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      type=\"search\"\n                      placeholder=\"Search...\"\n                      className=\"pl-9 w-[180px]\"\n                      value={securitySearch}\n                      onChange={(e) => setSecuritySearch(e.target.value)}\n                      data-testid=\"input-search-security\"\n                    />\n                  </div>\n                  <Select value={securityFilter} onValueChange={setSecurityFilter}>\n                    <SelectTrigger className=\"w-[140px]\">\n                      <Filter className=\"w-4 h-4 mr-2\" />\n                      <SelectValue placeholder=\"Filter\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Events</SelectItem>\n                      <SelectItem value=\"login\">Login</SelectItem>\n                      <SelectItem value=\"blocked\">Blocked</SelectItem>\n                      <SelectItem value=\"bot\">Bot</SelectItem>\n                      <SelectItem value=\"ddos\">DDoS</SelectItem>\n                      <SelectItem value=\"injection\">SQL Injection</SelectItem>\n                      <SelectItem value=\"xss\">XSS</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <Button variant=\"outline\" size=\"icon\" onClick={() => refetchSecurityLogs()} disabled={isLoadingSecurityLogs}>\n                    <RefreshCw className={`w-4 h-4 ${isLoadingSecurityLogs ? 'animate-spin' : ''}`} />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"gap-2\" onClick={() => handleExport('security')}>\n                    <Download className=\"w-4 h-4\" /> Export\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {isLoadingSecurityLogs ? (\n                  <div className=\"space-y-2\">\n                    {[1, 2, 3].map(i => <div key={i} className=\"h-16 bg-muted rounded animate-pulse\" />)}\n                  </div>\n                ) : filteredSecurityLogs.length === 0 ? (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Shield className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p className=\"text-lg font-medium\">No security events</p>\n                    <p className=\"text-sm mt-1\">Your system is secure</p>\n                  </div>\n                ) : (\n                  <ScrollArea className=\"h-[500px]\">\n                    <div className=\"space-y-3\">\n                      {filteredSecurityLogs.map((log) => (\n                        <div \n                          key={log.id}\n                          className={`p-4 rounded-lg border transition-colors ${\n                            log.blocked ? 'border-red-500/30 bg-red-500/5' : 'hover:bg-muted/50'\n                          }`}\n                        >\n                          <div className=\"flex items-start justify-between gap-4\">\n                            <div className=\"flex items-start gap-3\">\n                              <div className={`p-2 rounded-lg ${\n                                log.blocked ? 'bg-red-500/10' : \n                                log.eventType.includes('success') ? 'bg-green-500/10' : 'bg-muted'\n                              }`}>\n                                {getSecurityEventIcon(log.eventType)}\n                              </div>\n                              <div className=\"space-y-1\">\n                                <div className=\"flex items-center gap-2 flex-wrap\">\n                                  <span className=\"font-semibold text-sm\">{formatEventType(log.eventType)}</span>\n                                  <Badge variant={getSecurityEventBadge(log.eventType)} className=\"text-xs\">\n                                    {log.blocked ? 'Blocked' : 'Logged'}\n                                  </Badge>\n                                </div>\n                                {log.action && (\n                                  <p className=\"text-sm text-muted-foreground\">{log.action}</p>\n                                )}\n                                <div className=\"flex flex-wrap gap-3 text-xs text-muted-foreground\">\n                                  {log.userName && (\n                                    <span className=\"flex items-center gap-1\">\n                                      <User className=\"w-3 h-3\" />\n                                      {log.userName}\n                                    </span>\n                                  )}\n                                  {log.ipAddress && (\n                                    <span className=\"flex items-center gap-1\">\n                                      <Globe className=\"w-3 h-3\" />\n                                      <code className=\"bg-muted px-1 rounded\">{log.ipAddress}</code>\n                                    </span>\n                                  )}\n                                  {log.requestPath && (\n                                    <span className=\"flex items-center gap-1\">\n                                      <FileText className=\"w-3 h-3\" />\n                                      {log.requestPath}\n                                    </span>\n                                  )}\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"text-right text-xs text-muted-foreground flex-shrink-0\">\n                              <div>{format(new Date(log.createdAt), 'MMM d, yyyy')}</div>\n                              <div>{format(new Date(log.createdAt), 'h:mm:ss a')}</div>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </ScrollArea>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":37853,"size_tokens":null},"client/src/pages/admin/security/ForcePasswordReset.tsx":{"content":"\nimport { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Lock, Eye, EyeOff, Shield, AlertTriangle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function ForcePasswordReset() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  // Get userId from URL params\n  const urlParams = new URLSearchParams(window.location.search);\n  const userId = urlParams.get('userId');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"Password Mismatch\",\n        description: \"New password and confirmation don't match\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 8) {\n      toast({\n        title: \"Weak Password\",\n        description: \"Password must be at least 8 characters long\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/auth/force-password-reset\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId, currentPassword, newPassword }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        toast({\n          title: \"Success\",\n          description: \"Password reset successfully. You can now login.\",\n        });\n        setTimeout(() => {\n          setLocation(\"/admin/login\");\n        }, 1500);\n      } else {\n        toast({\n          title: \"Reset Failed\",\n          description: data.message || \"Failed to reset password\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to connect to server\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!userId) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-black\">\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>Invalid request. Missing user ID.</AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden bg-black\">\n      <div className=\"absolute inset-0 z-0\">\n        <img \n          src={loginBg} \n          alt=\"Background\" \n          className=\"w-full h-full object-cover opacity-50\"\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent\" />\n      </div>\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"relative z-10 w-full max-w-md px-4\"\n      >\n        <Card className=\"border-white/10 bg-black/40 backdrop-blur-xl shadow-2xl\">\n          <CardHeader className=\"text-center space-y-2 pb-6 border-b border-white/5\">\n            <div className=\"mx-auto w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center mb-2 ring-1 ring-amber-500/50\">\n              <AlertTriangle className=\"w-6 h-6 text-amber-500\" />\n            </div>\n            <CardTitle className=\"text-2xl font-bold tracking-tight text-white\">\n              Password Expired\n            </CardTitle>\n            <CardDescription className=\"text-white/50\">\n              Your password has expired. Please reset it to continue.\n            </CardDescription>\n          </CardHeader>\n          \n          <CardContent className=\"pt-6\">\n            <Alert className=\"mb-6 bg-amber-500/10 border-amber-500/20\">\n              <Shield className=\"h-4 w-4 text-amber-500\" />\n              <AlertDescription className=\"text-white/80\">\n                For security reasons, passwords must be changed every 90 days.\n              </AlertDescription>\n            </Alert>\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Current Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showCurrentPassword ? \"text\" : \"password\"} \n                    placeholder=\"Enter current password\"\n                    value={currentPassword}\n                    onChange={(e) => setCurrentPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowCurrentPassword(!showCurrentPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showCurrentPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">New Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showNewPassword ? \"text\" : \"password\"} \n                    placeholder=\"Enter new password\"\n                    value={newPassword}\n                    onChange={(e) => setNewPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowNewPassword(!showNewPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showNewPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Confirm New Password</Label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showConfirmPassword ? \"text\" : \"password\"} \n                    placeholder=\"Confirm new password\"\n                    value={confirmPassword}\n                    onChange={(e) => setConfirmPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20\"\n                    required \n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                  >\n                    {showConfirmPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              <Button \n                type=\"submit\" \n                className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2\"\n                disabled={isLoading}\n              >\n                {isLoading ? \"Resetting...\" : \"Reset Password\"}\n              </Button>\n            </form>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8540,"size_tokens":null},"client/src/pages/admin/content/skills/Skills.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Label } from \"@/components/ui/label\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash,\n  Code,\n  Database,\n  Server,\n  Wrench,\n  Loader2,\n  Save,\n  X\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Skill {\n  id: number;\n  name: string;\n  category: string;\n  level: number;\n  icon: string | null;\n  order: number;\n  createdAt: Date | null;\n}\n\nconst skillCategories = [\"Frontend\", \"Backend\", \"Database\", \"DevOps\", \"Tools\", \"Other\"];\n\nconst getCategoryIcon = (category: string) => {\n  switch (category.toLowerCase()) {\n    case 'frontend':\n      return <Code className=\"w-6 h-6 text-blue-500\" />;\n    case 'backend':\n      return <Server className=\"w-6 h-6 text-green-500\" />;\n    case 'database':\n      return <Database className=\"w-6 h-6 text-yellow-500\" />;\n    case 'devops':\n    case 'tools':\n    default:\n      return <Wrench className=\"w-6 h-6 text-purple-500\" />;\n  }\n};\n\nconst getLevelLabel = (level: number) => {\n  if (level >= 90) return \"Expert\";\n  if (level >= 70) return \"Advanced\";\n  if (level >= 50) return \"Intermediate\";\n  if (level >= 30) return \"Beginner\";\n  return \"Learning\";\n};\n\nconst getLevelColor = (level: number) => {\n  if (level >= 90) return \"bg-green-500/10 text-green-500 border-green-500/20\";\n  if (level >= 70) return \"bg-blue-500/10 text-blue-500 border-blue-500/20\";\n  if (level >= 50) return \"bg-yellow-500/10 text-yellow-600 border-yellow-500/20\";\n  return \"bg-gray-500/10 text-gray-500 border-gray-500/20\";\n};\n\nexport default function AdminSkills() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"all\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [editingSkill, setEditingSkill] = useState<Skill | null>(null);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    category: \"Frontend\",\n    level: 50,\n    icon: \"\",\n    order: 0,\n  });\n\n  const { data: skills = [], isLoading, refetch } = useQuery<Skill[]>({\n    queryKey: ['/api/skills'],\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createSkill(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill created successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: typeof formData }) => api.updateSkill(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill updated successfully\" });\n      setDialogOpen(false);\n      resetForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteSkill(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/skills'] });\n      queryClient.invalidateQueries({ queryKey: ['skills'] });\n      toast({ title: \"Success\", description: \"Skill deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData({ name: \"\", category: \"Frontend\", level: 50, icon: \"\", order: 0 });\n    setEditingSkill(null);\n  };\n\n  const handleOpenCreate = () => {\n    resetForm();\n    setDialogOpen(true);\n  };\n\n  const handleOpenEdit = (skill: Skill) => {\n    setEditingSkill(skill);\n    setFormData({\n      name: skill.name,\n      category: skill.category,\n      level: skill.level,\n      icon: skill.icon || \"\",\n      order: skill.order,\n    });\n    setDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim()) {\n      toast({ title: \"Error\", description: \"Skill name is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingSkill) {\n      updateMutation.mutate({ id: editingSkill.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete skill \"${name}\"? This action cannot be undone.`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredSkills = skills.filter(skill => {\n    const matchesSearch = searchQuery === \"\" || \n      skill.name.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesCategory = activeTab === \"all\" || \n      skill.category.toLowerCase() === activeTab.toLowerCase();\n    return matchesSearch && matchesCategory;\n  });\n\n  const groupedSkills: Record<string, Skill[]> = {};\n  filteredSkills.forEach(skill => {\n    const cat = skill.category || 'Other';\n    if (!groupedSkills[cat]) groupedSkills[cat] = [];\n    groupedSkills[cat].push(skill);\n  });\n\n  const availableCategories = Array.from(new Set(skills.map(s => s.category))).filter(Boolean) as string[];\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Skills & Technologies</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your technical expertise ({skills.length} skills)\n            </p>\n          </div>\n          <Button onClick={handleOpenCreate} data-testid=\"button-add-skill\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add New Skill\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6\">\n            <TabsList className=\"flex-wrap h-auto\">\n              <TabsTrigger value=\"all\">All ({skills.length})</TabsTrigger>\n              {availableCategories.map(cat => (\n                <TabsTrigger key={cat} value={cat.toLowerCase()}>\n                  {cat} ({skills.filter(s => s.category === cat).length})\n                </TabsTrigger>\n              ))}\n            </TabsList>\n             \n            <div className=\"relative w-full sm:w-64\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input \n                placeholder=\"Search skills...\" \n                className=\"pl-9\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                data-testid=\"input-search-skills\"\n              />\n            </div>\n          </div>\n\n          <TabsContent value={activeTab} className=\"mt-0\">\n            {filteredSkills.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Wrench className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No skills found</h3>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    {searchQuery ? \"Try adjusting your search\" : \"Start by adding your first skill\"}\n                  </p>\n                  <Button onClick={handleOpenCreate}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Skill\n                  </Button>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {filteredSkills.map((skill) => (\n                  <Card key={skill.id} className=\"group hover:border-primary/50 transition-colors\" data-testid={`card-skill-${skill.id}`}>\n                    <CardContent className=\"p-4 flex items-center justify-between gap-4\">\n                      <div className=\"flex items-center gap-4 min-w-0\">\n                        <div className=\"w-12 h-12 rounded-lg bg-muted flex items-center justify-center flex-shrink-0\">\n                          {getCategoryIcon(skill.category)}\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-bold truncate\">{skill.name}</h3>\n                          <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n                            <Badge variant=\"secondary\" className={`text-[10px] ${getLevelColor(skill.level)}`}>\n                              {getLevelLabel(skill.level)}\n                            </Badge>\n                            <span className=\"text-xs text-muted-foreground\">{skill.level}%</span>\n                          </div>\n                        </div>\n                      </div>\n                       \n                      <div className=\"flex gap-1 invisible group-hover:visible transition-all flex-shrink-0\">\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          onClick={() => handleOpenEdit(skill)}\n                          data-testid={`button-edit-skill-${skill.id}`}\n                        >\n                          <Edit className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          className=\"text-destructive\"\n                          onClick={() => handleDelete(skill.id, skill.name)}\n                          data-testid={`button-delete-skill-${skill.id}`}\n                        >\n                          <Trash className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n                 \n                <div \n                  onClick={handleOpenCreate}\n                  className=\"border-2 border-dashed border-muted-foreground/20 rounded-xl flex flex-col items-center justify-center p-6 cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all h-full min-h-[88px]\"\n                  data-testid=\"button-add-skill-card\"\n                >\n                  <Plus className=\"w-6 h-6 text-muted-foreground mb-2\" />\n                  <span className=\"text-sm font-medium text-muted-foreground\">Add new skill</span>\n                </div>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n\n        <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>{editingSkill ? \"Edit Skill\" : \"Add New Skill\"}</DialogTitle>\n              <DialogDescription>\n                {editingSkill ? \"Update the skill details below\" : \"Fill in the details for your new skill\"}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-5 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-name\">Skill Name *</Label>\n                <Input\n                  id=\"skill-name\"\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., React.js, Node.js, PostgreSQL\"\n                  data-testid=\"input-skill-name\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-skill-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {skillCategories.map(cat => (\n                      <SelectItem key={cat} value={cat}>{cat}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <Label>Proficiency Level</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <Badge variant=\"secondary\" className={getLevelColor(formData.level)}>\n                      {getLevelLabel(formData.level)}\n                    </Badge>\n                    <span className=\"text-sm font-mono text-muted-foreground\">{formData.level}%</span>\n                  </div>\n                </div>\n                <Slider\n                  value={[formData.level]}\n                  onValueChange={(value) => setFormData({ ...formData, level: value[0] })}\n                  min={0}\n                  max={100}\n                  step={5}\n                  className=\"w-full\"\n                  data-testid=\"slider-skill-level\"\n                />\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\n                  <span>Beginner</span>\n                  <span>Intermediate</span>\n                  <span>Expert</span>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-icon\">Icon (optional)</Label>\n                <Input\n                  id=\"skill-icon\"\n                  value={formData.icon}\n                  onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                  placeholder=\"Icon name or URL\"\n                  data-testid=\"input-skill-icon\"\n                />\n                <p className=\"text-xs text-muted-foreground\">Leave empty to use default category icon</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"skill-order\">Display Order</Label>\n                <Input\n                  id=\"skill-order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) => setFormData({ ...formData, order: parseInt(e.target.value) || 0 })}\n                  placeholder=\"0\"\n                  data-testid=\"input-skill-order\"\n                />\n                <p className=\"text-xs text-muted-foreground\">Lower numbers appear first</p>\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button \n                onClick={handleSubmit} \n                disabled={createMutation.isPending || updateMutation.isPending}\n                data-testid=\"button-save-skill\"\n              >\n                {(createMutation.isPending || updateMutation.isPending) ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Save className=\"w-4 h-4 mr-2\" />\n                )}\n                {editingSkill ? \"Update\" : \"Create\"} Skill\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":16433,"size_tokens":null},"server/api/index.ts":{"content":"import { Express } from \"express\";\n\nimport authRouter from \"./auth\";\nimport usersRouter from \"./users\";\nimport projectsRouter from \"./projects\";\nimport postsRouter from \"./posts\";\nimport pagesRouter from \"./pages\";\nimport skillsRouter from \"./skills\";\nimport servicesRouter from \"./services\";\nimport testimonialsRouter from \"./testimonials\";\nimport categoriesRouter from \"./categories\";\nimport messagesRouter from \"./messages\";\nimport commentsRouter from \"./comments\";\nimport reviewsRouter from \"./reviews\";\nimport mediaRouter from \"./media\";\nimport settingsRouter from \"./settings\";\nimport dashboardRouter from \"./dashboard\";\nimport activityLogsRouter from \"./activity-logs\";\nimport notificationsRouter from \"./notifications\";\nimport securityRouter from \"./security\";\nimport storageRouter from \"./storage\";\nimport logsRouter from \"./logs\";\nimport databaseRouter from \"./database\";\nimport newsletterRouter from \"./newsletter\";\nimport homepageRouter from \"./homepage\";\nimport faqsRouter from \"./faqs\";\nimport performanceRouter from \"./performance\";\nimport searchRouter from \"./search\";\nimport passwordResetRouter from \"./password-reset\";\nimport subscribersRouter from \"./subscribers\";\nimport emailCampaignsRouter from \"./email-campaigns\";\nimport emailRouter from \"./email\";\nimport contentManagementRouter from \"./content-management\";\nimport analyticsRouter from \"./analytics\";\nimport sitemapRouter from \"./sitemap\";\nimport commentsExtendedRouter from \"./comments-extended\";\nimport translationsRouter from \"./translations\";\nimport scheduledTasksRouter from \"./scheduled-tasks\";\nimport webhooksRouter from \"./webhooks\";\nimport cacheRouter from \"./cache\";\nimport imageOptimizerRouter from \"./image-optimizer\";\n\nexport function registerApiRoutes(app: Express) {\n  app.use(\"/api/auth\", authRouter);\n  app.use(\"/api/users\", usersRouter);\n  app.use(\"/api/projects\", projectsRouter);\n  app.use(\"/api/posts\", postsRouter);\n  app.use(\"/api/pages\", pagesRouter);\n  app.use(\"/api/skills\", skillsRouter);\n  app.use(\"/api/services\", servicesRouter);\n  app.use(\"/api/testimonials\", testimonialsRouter);\n  app.use(\"/api/categories\", categoriesRouter);\n  app.use(\"/api/messages\", messagesRouter);\n  app.use(\"/api/comments\", commentsRouter);\n  app.use(\"/api/reviews\", reviewsRouter);\n  app.use(\"/api/media\", mediaRouter);\n  app.use(\"/api/upload\", mediaRouter);\n  app.use(\"/api/settings\", settingsRouter);\n  app.use(\"/api/dashboard\", dashboardRouter);\n  app.use(\"/api/activity-logs\", activityLogsRouter);\n  app.use(\"/api/notifications\", notificationsRouter);\n  app.use(\"/api/security\", securityRouter);\n  app.use(\"/api/storage\", storageRouter);\n  app.use(\"/api/logs\", logsRouter);\n  app.use(\"/api/database\", databaseRouter);\n  app.use(\"/api/newsletter\", newsletterRouter);\n  app.use(\"/api/homepage\", homepageRouter);\n  app.use(\"/api/faqs\", faqsRouter);\n  app.use(\"/api/performance\", performanceRouter);\n  app.use(\"/api/search\", searchRouter);\n  \n  app.use(\"/api/password-reset\", passwordResetRouter);\n  app.use(\"/api/subscribers\", subscribersRouter);\n  app.use(\"/api/email-campaigns\", emailCampaignsRouter);\n  app.use(\"/api/email\", emailRouter);\n  app.use(\"/api/content\", contentManagementRouter);\n  app.use(\"/api/analytics\", analyticsRouter);\n  app.use(\"/api/comments-extended\", commentsExtendedRouter);\n  app.use(\"/api/translations\", translationsRouter);\n  app.use(\"/api/scheduled-tasks\", scheduledTasksRouter);\n  app.use(\"/api/webhooks\", webhooksRouter);\n  app.use(\"/api/cache\", cacheRouter);\n  app.use(\"/api/image-optimizer\", imageOptimizerRouter);\n  \n  app.use(\"/\", sitemapRouter);\n}\n","path":null,"size_bytes":3569,"size_tokens":null},"server/api/reviews.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth, requireAdmin } from \"../middleware/auth\";\nimport { insertReviewSchema } from \"@shared/schema\";\nimport { broadcastNotification } from \"../websocket\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const projectId = req.query.projectId ? parseInt(req.query.projectId as string) : undefined;\n    const pending = req.query.pending === \"true\";\n    const approved = req.query.approved === \"true\";\n\n    let reviews;\n    if (pending) {\n      reviews = await storage.getPendingReviews();\n    } else if (projectId && approved) {\n      reviews = await storage.getApprovedReviewsByProject(projectId);\n    } else if (projectId) {\n      reviews = await storage.getReviewsByProject(projectId);\n    } else {\n      reviews = await storage.getAllReviews();\n    }\n    res.json(reviews);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/unread\", requireAdmin, async (req, res) => {\n  try {\n    const reviews = await storage.getUnreadReviews();\n    res.json(reviews);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const review = await storage.getReview(parseInt(req.params.id));\n    if (!review) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json(review);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", async (req, res) => {\n  try {\n    const parsed = insertReviewSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const review = await storage.createReview(parsed.data);\n\n    const project = await storage.getProject(review.projectId);\n\n    await storage.createNotification({\n      message: `New ${review.rating}-star review from ${review.authorName} on \"${project?.title || \"Unknown\"}\"`,\n      type: \"review\"\n    });\n\n    broadcastNotification({\n      type: \"NEW_REVIEW\",\n      message: `New ${review.rating}-star review from ${review.authorName}`,\n      data: review\n    });\n\n    res.status(201).json(review);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const review = await storage.updateReview(parseInt(req.params.id), req.body);\n    if (!review) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json(review);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/approve\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.approveReview(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json({ message: \"Review approved\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/read\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.markReviewAsRead(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json({ message: \"Review marked as read\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/archive\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.archiveReview(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json({ message: \"Review archived\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteReview(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Review not found\" });\n    }\n    res.json({ message: \"Review deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":4210,"size_tokens":null},"client/src/pages/admin/content/posts/PostCategories.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description: string | null;\n  createdAt: string;\n}\n\nconst getEmptyCategory = () => ({\n  name: \"\",\n  slug: \"\",\n  type: \"post\",\n  description: \"\",\n});\n\nexport default function AdminPostCategories() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\n  const [formData, setFormData] = useState(getEmptyCategory());\n\n  const { data: categories = [], isLoading } = useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () => \n      fetch(\"/api/categories?type=post\", { credentials: \"include\" }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to fetch categories\");\n        return res.json();\n      }),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(\"/api/categories\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to create category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category created\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create category\", variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(`/api/categories/${editingCategory?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to update category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update category\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) =>\n      fetch(`/api/categories/${id}`, { \n        method: \"DELETE\",\n        credentials: \"include\"\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to delete category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"post\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Category deleted\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete category\", variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyCategory());\n    setEditingCategory(null);\n  };\n\n  const handleOpenDialog = (category?: Category) => {\n    if (category) {\n      setEditingCategory(category);\n      setFormData({\n        name: category.name,\n        slug: category.slug,\n        type: category.type,\n        description: category.description || \"\",\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim() || !formData.slug.trim()) {\n      toast({ title: \"Error\", description: \"Name and slug are required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingCategory) {\n      updateMutation.mutate(formData);\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const generateSlug = (name: string) => {\n    const slug = name\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n    return slug;\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-6 space-y-6 max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Post Categories</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage your blog post categories</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-new-category\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            New Category\n          </Button>\n        </div>\n\n        {/* Categories List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Categories ({categories.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"flex justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin\" />\n              </div>\n            ) : categories.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No categories yet. Create your first one!\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {categories.map((category: Category) => (\n                  <div\n                    key={category.id}\n                    className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\n                    data-testid={`category-item-${category.id}`}\n                  >\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-foreground\">{category.name}</h3>\n                      <p className=\"text-sm text-muted-foreground\">/{category.slug}</p>\n                      {category.description && (\n                        <p className=\"text-sm text-muted-foreground mt-1\">{category.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2 ml-4\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleOpenDialog(category)}\n                        data-testid={`button-edit-category-${category.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setDeleteId(category.id)}\n                        data-testid={`button-delete-category-${category.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4 text-red-500\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{editingCategory ? \"Edit Category\" : \"New Category\"}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"name\">Category Name *</Label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => {\n                  const newName = e.target.value;\n                  const newSlug = generateSlug(newName);\n                  setFormData({ ...formData, name: newName, slug: newSlug });\n                }}\n                placeholder=\"e.g., Web Development\"\n                data-testid=\"input-category-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"slug\">Slug *</Label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                placeholder=\"e.g., web-development\"\n                data-testid=\"input-category-slug\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description}\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                placeholder=\"Category description (optional)\"\n                data-testid=\"textarea-category-description\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-save-category\"\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                \"Save Category\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation */}\n      <AlertDialog open={deleteId !== null} onOpenChange={(open) => !open && setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Category</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. Are you sure you want to delete this category?\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deleteId && deleteMutation.mutate(deleteId)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11218,"size_tokens":null},"server/api/activity-logs.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { insertActivityLogSchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n    const offset = req.query.offset ? parseInt(req.query.offset as string) : 0;\n    const logs = await storage.getAllActivityLogs(limit, offset);\n    res.json(logs);\n  } catch (error: any) {\n    console.error('Error fetching activity logs:', error);\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const parsed = insertActivityLogSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const log = await storage.createActivityLog(parsed.data);\n    res.status(201).json(log);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1114,"size_tokens":null},"client/src/pages/admin/security/SecurityEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useState, useEffect } from \"react\";\nimport { \n  Shield, Key, Lock, Smartphone, Globe, AlertTriangle, Trash2,\n  ShieldAlert, RefreshCw, Eye, EyeOff, Clock, Users,\n  Monitor, LogOut, Ban, CheckCircle, XCircle,\n  Server, AlertCircle, Plus, Loader2, FileText, BarChart3, \n  Zap, Activity, Layers, QrCode, Copy, Check\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\n\ninterface SecuritySettings {\n  twoFactorEnabled?: boolean;\n  passwordExpiration?: boolean;\n  captchaType?: 'disabled' | 'local' | 'google' | 'cloudflare';\n  captchaSettings?: {\n    honeypotEnabled?: boolean;\n    timeValidation?: boolean;\n    ipRateLimit?: boolean;\n    googleSiteKey?: string;\n    googleSecretKey?: string;\n    googleMinScore?: number;\n    cloudflareSiteKey?: string;\n    cloudflareSecretKey?: string;\n    cloudflareManagedMode?: boolean;\n  };\n  protectionCoverage?: {\n    loginForm?: boolean;\n    contactForm?: boolean;\n    newsletterForm?: boolean;\n    commentForms?: boolean;\n    registrationForm?: boolean;\n  };\n  rateLimiting?: {\n    loginAttemptsLimit?: number;\n    apiRateLimit?: number;\n    lockoutDuration?: number;\n  };\n  ddosProtection?: {\n    enabled?: boolean;\n    threshold?: number;\n    blockDuration?: number;\n  };\n  sqlInjectionProtection?: {\n    enabled?: boolean;\n    logAttempts?: boolean;\n    blockRequests?: boolean;\n  };\n  xssProtection?: {\n    enabled?: boolean;\n    sanitizeInput?: boolean;\n    blockRequests?: boolean;\n  };\n  sessionSettings?: {\n    idleTimeout?: string;\n    maxDuration?: string;\n    forceLogoutInactive?: boolean;\n    concurrentSessionLimit?: string;\n  };\n  compliance?: {\n    gdprEnabled?: boolean;\n    dataRetentionDays?: number;\n    privacyPolicyUrl?: string;\n    cookieConsentEnabled?: boolean;\n  };\n  cspSettings?: {\n    enabled?: boolean;\n    strictMode?: boolean;\n    reportUri?: string;\n  };\n  scannerSettings?: {\n    vulnerabilityScanEnabled?: boolean;\n    sslScanEnabled?: boolean;\n    malwareScanEnabled?: boolean;\n    scanFrequency?: string;\n  };\n}\n\ninterface TrustedDevice {\n  id: number;\n  userId: number;\n  deviceName: string;\n  deviceFingerprint?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  trusted: boolean;\n  lastUsed?: string;\n  createdAt?: string;\n}\n\ninterface UserSession {\n  id: number;\n  sessionId: string;\n  userId: number;\n  ipAddress?: string;\n  userAgent?: string;\n  deviceInfo?: string;\n  location?: string;\n  active: boolean;\n  createdAt?: string;\n  expiresAt?: string;\n  lastActivity?: string;\n}\n\ninterface IpRule {\n  id: number;\n  ipAddress: string;\n  type: 'whitelist' | 'blacklist';\n  reason?: string;\n  createdBy?: number;\n  createdAt?: string;\n}\n\ninterface SecurityStats {\n  totalBlocked: number;\n  totalAllowed: number;\n  byEventType: { type: string; count: number }[];\n}\n\ninterface SecurityLog {\n  id: number;\n  eventType?: string;\n  action: string;\n  userId?: number;\n  userName?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  type: string;\n  blocked?: boolean;\n  createdAt?: string;\n}\n\nconst flattenSettings = (obj: Record<string, any>, prefix = ''): Record<string, any> => {\n  const result: Record<string, any> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    const newKey = prefix ? `${prefix}.${key}` : key;\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n      Object.assign(result, flattenSettings(value, newKey));\n    } else {\n      result[newKey] = value;\n    }\n  }\n  return result;\n};\n\nexport default function AdminSecurityEnhanced() {\n  const { toast } = useToast();\n  const [newWhitelistIp, setNewWhitelistIp] = useState(\"\");\n  const [newBlacklistIp, setNewBlacklistIp] = useState(\"\");\n  const [showGoogleSecret, setShowGoogleSecret] = useState(false);\n  const [showCloudflareSecret, setShowCloudflareSecret] = useState(false);\n  const [showLoginHistory, setShowLoginHistory] = useState(false);\n  \n  // 2FA Modal\n  const [show2FASetup, setShow2FASetup] = useState(false);\n  const [show2FAVerify, setShow2FAVerify] = useState(false);\n  const [show2FADisable, setShow2FADisable] = useState(false);\n  const [qrCode, setQrCode] = useState(\"\");\n  const [secret, setSecret] = useState(\"\");\n  const [verifyCode, setVerifyCode] = useState(\"\");\n  const [disableCode, setDisableCode] = useState(\"\");\n  const [secretCopied, setSecretCopied] = useState(false);\n  \n\n  const { data: settings = {}, isLoading: settingsLoading, refetch: refetchSettings } = useQuery<SecuritySettings>({\n    queryKey: ['/api/security/settings'],\n  });\n\n  const { data: devices = [], refetch: refetchDevices } = useQuery<TrustedDevice[]>({\n    queryKey: ['/api/security/devices'],\n  });\n\n  const { data: sessions = [], refetch: refetchSessions } = useQuery<UserSession[]>({\n    queryKey: ['/api/security/sessions'],\n    refetchInterval: 30000, // Auto refresh every 30 seconds\n  });\n\n  const { data: ipRules = [], refetch: refetchIpRules } = useQuery<IpRule[]>({\n    queryKey: ['/api/security/ip-rules'],\n  });\n\n  const { data: stats } = useQuery<SecurityStats>({\n    queryKey: ['/api/security/stats'],\n  });\n\n  const { data: loginHistory = [], refetch: refetchLoginHistory, isRefetching: isRefetchingLoginHistory } = useQuery<SecurityLog[]>({\n    queryKey: ['/api/security/login-history'],\n    refetchInterval: showLoginHistory ? 30000 : false, // Auto refresh every 30s when viewing\n  });\n\n  const { data: user = null, refetch: refetchUser } = useQuery<any>({\n    queryKey: ['/api/auth/me'],\n  });\n\n  const [localSettings, setLocalSettings] = useState<SecuritySettings>({});\n\n  useEffect(() => {\n    if (settings && Object.keys(settings).length > 0) {\n      setLocalSettings(settings);\n    }\n  }, [settings]);\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (newSettings: SecuritySettings) => {\n      const flatSettings = flattenSettings(newSettings);\n      return apiRequest('POST', '/api/security/settings/bulk', flatSettings);\n    },\n    onSuccess: () => {\n      toast({ title: \"Settings saved successfully\" });\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Failed to save settings\", variant: \"destructive\" });\n    }\n  });\n\n  const deleteDeviceMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/devices/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Device removed\" });\n      refetchDevices();\n    }\n  });\n\n  const terminateSessionMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('POST', `/api/security/sessions/terminate/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"Session terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const terminateAllSessionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/terminate-all');\n    },\n    onSuccess: () => {\n      toast({ title: \"All sessions terminated\" });\n      refetchSessions();\n    }\n  });\n\n  const logoutAllDevicesMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest('POST', '/api/security/sessions/logout-all-devices');\n    },\n    onSuccess: () => {\n      toast({ title: \"Logged out from all devices\" });\n      refetchSessions();\n    }\n  });\n\n  const addIpRuleMutation = useMutation({\n    mutationFn: async ({ ipAddress, type }: { ipAddress: string; type: 'whitelist' | 'blacklist' }) => {\n      return apiRequest('POST', '/api/security/ip-rules', { ipAddress, type });\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule added\" });\n      setNewWhitelistIp(\"\");\n      setNewBlacklistIp(\"\");\n      refetchIpRules();\n    }\n  });\n\n  const deleteIpRuleMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest('DELETE', `/api/security/ip-rules/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"IP rule removed\" });\n      refetchIpRules();\n    }\n  });\n\n  // 2FA Mutations\n  const generate2FAMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest('POST', '/api/auth/2fa/generate');\n      return await res.json();\n    },\n    onSuccess: (data: any) => {\n      if (data?.secret && data?.qrCode) {\n        setSecret(data.secret);\n        setQrCode(data.qrCode);\n        setShow2FASetup(true);\n      } else {\n        toast({ title: \"Failed to generate 2FA setup\", description: \"Missing secret or QR code\", variant: \"destructive\" });\n      }\n    },\n    onError: (error: any) => {\n      toast({ title: \"Failed to generate 2FA setup\", description: error.message || \"Unknown error\", variant: \"destructive\" });\n    }\n  });\n\n  const verify2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/verify', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA enabled successfully\" });\n      setShow2FASetup(false);\n      setShow2FAVerify(false);\n      setVerifyCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const disable2FAMutation = useMutation({\n    mutationFn: async (token: string) => {\n      const res = await apiRequest('POST', '/api/auth/2fa/disable', { token });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"2FA disabled successfully\" });\n      setShow2FADisable(false);\n      setDisableCode(\"\");\n      refetchUser();\n      refetchSettings();\n    },\n    onError: () => {\n      toast({ title: \"Invalid verification code\", variant: \"destructive\" });\n    }\n  });\n\n  const updateLocalSetting = (key: string, value: any) => {\n    setLocalSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const updateNestedSetting = (parentKey: string, childKey: string, value: any) => {\n    setLocalSettings(prev => ({\n      ...prev,\n      [parentKey]: {\n        ...(prev[parentKey as keyof SecuritySettings] as Record<string, any> || {}),\n        [childKey]: value\n      }\n    }));\n  };\n\n  const saveAllSettings = () => {\n    updateSettingsMutation.mutate(localSettings);\n  };\n\n  const saveAuthSettings = () => {\n    const authSettings = {\n      passwordExpiration: localSettings.passwordExpiration\n    };\n    updateSettingsMutation.mutate(authSettings);\n  };\n\n  const saveCaptchaSettings = () => {\n    const captchaSettings = {\n      captchaType: localSettings.captchaType,\n      captchaSettings: localSettings.captchaSettings,\n      protectionCoverage: localSettings.protectionCoverage\n    };\n    updateSettingsMutation.mutate(captchaSettings);\n  };\n\n  const saveFirewallSettings = () => {\n    const firewallSettings = {\n      rateLimiting: localSettings.rateLimiting\n    };\n    updateSettingsMutation.mutate(firewallSettings);\n  };\n\n  const saveThreatSettings = () => {\n    const threatSettings = {\n      ddosProtection: localSettings.ddosProtection,\n      sqlInjectionProtection: localSettings.sqlInjectionProtection,\n      xssProtection: localSettings.xssProtection\n    };\n    updateSettingsMutation.mutate(threatSettings);\n  };\n\n  const saveSessionSettings = () => {\n    const sessionSettings = {\n      sessionSettings: localSettings.sessionSettings\n    };\n    updateSettingsMutation.mutate(sessionSettings);\n  };\n\n  const saveComplianceSettings = () => {\n    const complianceSettings = {\n      compliance: localSettings.compliance\n    };\n    updateSettingsMutation.mutate(complianceSettings);\n  };\n\n  const saveCSPSettings = () => {\n    const cspSettings = {\n      cspSettings: localSettings.cspSettings\n    };\n    updateSettingsMutation.mutate(cspSettings);\n  };\n\n  const saveScannerSettings = () => {\n    const scannerSettings = {\n      scannerSettings: localSettings.scannerSettings\n    };\n    updateSettingsMutation.mutate(scannerSettings);\n  };\n\n  const handle2FAToggle = (enabled: boolean) => {\n    if (enabled) {\n      if (user?.twoFactorEnabled) {\n        toast({ title: \"2FA is already enabled\", variant: \"default\" });\n        return;\n      }\n      generate2FAMutation.mutate(undefined, {\n        onSuccess: () => {\n          // Modal sáº½ tá»± Ä‘á»™ng hiá»‡n\n        },\n        onError: () => {\n          toast({ title: \"Failed to generate 2FA setup\", variant: \"destructive\" });\n        }\n      });\n    } else {\n      if (!user?.twoFactorEnabled) {\n        toast({ title: \"2FA is not enabled\", variant: \"default\" });\n        return;\n      }\n      setShow2FADisable(true);\n    }\n  };\n\n  const copySecret = async () => {\n    try {\n      await navigator.clipboard.writeText(secret);\n      setSecretCopied(true);\n      setTimeout(() => setSecretCopied(false), 2000);\n      toast({ title: \"Secret copied to clipboard\" });\n    } catch (err) {\n      // Fallback cho trÃ¬nh duyá»‡t cÅ©\n      const textArea = document.createElement(\"textarea\");\n      textArea.value = secret;\n      document.body.appendChild(textArea);\n      textArea.select();\n      try {\n        document.execCommand('copy');\n        setSecretCopied(true);\n        setTimeout(() => setSecretCopied(false), 2000);\n        toast({ title: \"Secret copied to clipboard\" });\n      } catch (e) {\n        toast({ title: \"Failed to copy secret\", variant: \"destructive\" });\n      }\n      document.body.removeChild(textArea);\n    }\n  };\n\n  const whitelistIps = ipRules.filter(r => r.type === 'whitelist');\n  const blacklistIps = ipRules.filter(r => r.type === 'blacklist');\n\n  if (settingsLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-security-title\">Security Center</h1>\n          <p className=\"text-muted-foreground\">Monitor and configure security settings</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n          <Card className=\"border-green-500/50 bg-green-500/5\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"w-6 h-6 text-green-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">System Status</p>\n                  <p className=\"font-bold\">Secure</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Lock className=\"w-6 h-6 text-primary\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">SSL Certificate</p>\n                  <p className=\"font-bold text-sm\">Valid (Dec 2025)</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <AlertTriangle className=\"w-6 h-6 text-yellow-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Blocked (24h)</p>\n                  <p className=\"font-bold\">{stats?.totalBlocked || 0} attempts</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Smartphone className=\"w-6 h-6 text-primary\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">Active Sessions</p>\n                  <p className=\"font-bold\">{sessions.length} devices</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"border-blue-500/50 bg-blue-500/5\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"w-6 h-6 text-blue-500\" />\n                <div>\n                  <p className=\"text-xs text-muted-foreground\">IP Rules</p>\n                  <p className=\"font-bold text-sm\">{ipRules.length} active</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Tabs defaultValue=\"authentication\" className=\"space-y-6\">\n          <TabsList className=\"flex flex-wrap gap-1 h-auto p-1\">\n            <TabsTrigger value=\"authentication\" data-testid=\"tab-authentication\">Authentication</TabsTrigger>\n            <TabsTrigger value=\"recaptcha\" data-testid=\"tab-recaptcha\">Recaptcha</TabsTrigger>\n            <TabsTrigger value=\"firewall\" data-testid=\"tab-firewall\">Firewall</TabsTrigger>\n            <TabsTrigger value=\"threat\" data-testid=\"tab-threat\">Threat Protection</TabsTrigger>\n            <TabsTrigger value=\"sessions\" data-testid=\"tab-sessions\">Sessions</TabsTrigger>\n            <TabsTrigger value=\"compliance\" data-testid=\"tab-compliance\">Compliance</TabsTrigger>\n            <TabsTrigger value=\"csp\" data-testid=\"tab-csp\">CSP</TabsTrigger>\n            <TabsTrigger value=\"scanner\" data-testid=\"tab-scanner\">Scanner</TabsTrigger>\n            <TabsTrigger value=\"activity\" data-testid=\"tab-activity\">Activity</TabsTrigger>\n          </TabsList>\n\n          {/* AUTHENTICATION TAB */}\n          <TabsContent value=\"authentication\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Key className=\"w-5 h-5\" />\n                  Authentication Methods\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Smartphone className=\"w-5 h-5 text-muted-foreground\" />\n                    <div>\n                      <div className=\"font-medium\">Two-Factor Authentication (2FA)</div>\n                      <div className=\"text-sm text-muted-foreground\">Secure with authenticator app</div>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={user?.twoFactorEnabled || settings.twoFactorEnabled || false}\n                    onCheckedChange={handle2FAToggle}\n                    disabled={generate2FAMutation.isPending}\n                    data-testid=\"switch-2fa\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <Lock className=\"w-5 h-5 text-muted-foreground\" />\n                    <div>\n                      <div className=\"font-medium\">Password Expiration</div>\n                      <div className=\"text-sm text-muted-foreground\">Force reset every 90 days</div>\n                    </div>\n                  </div>\n                  <Switch \n                    checked={localSettings.passwordExpiration ?? true}\n                    onCheckedChange={(v) => updateLocalSetting('passwordExpiration', v)}\n                    data-testid=\"switch-password-expiration\"\n                  />\n                </div>\n                <Button onClick={saveAuthSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-auth\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Authentication Settings\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Monitor className=\"w-5 h-5\" />\n                  Trusted Devices\n                </CardTitle>\n                <CardDescription>Manage devices that can skip 2FA</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {devices.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground\">No trusted devices registered</p>\n                ) : (\n                  devices.map((device) => (\n                    <div key={device.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">{device.deviceName}</p>\n                        <p className=\"text-xs text-muted-foreground\">{device.ipAddress} â€¢ {device.lastUsed ? new Date(device.lastUsed).toLocaleDateString() : 'Never'}</p>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        {device.trusted && <Badge variant=\"secondary\">Trusted</Badge>}\n                        <Button \n                          variant=\"ghost\" \n                          size=\"sm\" \n                          className=\"text-destructive\"\n                          onClick={() => deleteDeviceMutation.mutate(device.id)}\n                          data-testid={`button-remove-device-${device.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5\" />\n                  Login History\n                </CardTitle>\n                <CardDescription>View recent login activity and security events</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <Button \n                  variant=\"outline\" \n                  className=\"w-full\" \n                  onClick={() => setShowLoginHistory(!showLoginHistory)}\n                  data-testid=\"button-view-login-history\"\n                >\n                  <Eye className=\"w-4 h-4 mr-2\" />\n                  {showLoginHistory ? 'Hide' : 'View'} Login History\n                </Button>\n                \n                {showLoginHistory && (\n                  <div className=\"mt-4 space-y-2 max-h-96 overflow-y-auto border rounded-lg p-3\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <p className=\"text-sm font-medium\">Recent Login Activity</p>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\"\n                        onClick={() => refetchLoginHistory()}\n                        disabled={isRefetchingLoginHistory}\n                      >\n                        <RefreshCw className={`w-3 h-3 ${isRefetchingLoginHistory ? 'animate-spin' : ''}`} />\n                      </Button>\n                    </div>\n                    {loginHistory.length === 0 ? (\n                      <p className=\"text-xs text-muted-foreground text-center py-4\">No login history found</p>\n                    ) : (\n                      loginHistory.map((log) => (\n                        <div key={log.id} className=\"p-2 text-xs border rounded bg-muted/50\">\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <span className=\"font-medium flex items-center gap-1\">\n                              {log.type === 'success' ? (\n                                <CheckCircle className=\"w-3 h-3 text-green-500\" />\n                              ) : log.type === 'error' ? (\n                                <XCircle className=\"w-3 h-3 text-red-500\" />\n                              ) : (\n                                <AlertCircle className=\"w-3 h-3 text-yellow-500\" />\n                              )}\n                              {log.userName || 'Unknown User'}\n                            </span>\n                            <Badge variant={log.type === 'success' ? 'default' : 'destructive'} className=\"text-[10px]\">\n                              {log.type}\n                            </Badge>\n                          </div>\n                          <p className=\"text-muted-foreground mb-1\">{log.action}</p>\n                          <p className=\"text-muted-foreground/70\">\n                            {log.createdAt ? new Date(log.createdAt).toLocaleString() : 'N/A'}\n                          </p>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* RECAPTCHA TAB */}\n          <TabsContent value=\"recaptcha\" className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <ShieldAlert className=\"w-5 h-5\" />\n                    Bot Protection Settings\n                  </CardTitle>\n                  <CardDescription>Configure CAPTCHA protection for forms and login</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"space-y-4\">\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'disabled' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"disabled\"\n                          checked={localSettings.captchaType === 'disabled'}\n                          onChange={() => updateLocalSetting('captchaType', 'disabled')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-disabled\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <XCircle className=\"w-4 h-4 text-muted-foreground\" />\n                            Disabled\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">No bot protection (not recommended)</div>\n                        </div>\n                      </label>\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'local' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"local\"\n                          checked={localSettings.captchaType === 'local' || !localSettings.captchaType}\n                          onChange={() => updateLocalSetting('captchaType', 'local')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-local\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Server className=\"w-4 h-4 text-muted-foreground\" />\n                            Local Verification\n                            {(localSettings.captchaType === 'local' || !localSettings.captchaType) && <Badge variant=\"secondary\" className=\"text-[10px]\">Active</Badge>}\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Server-side honeypot + rate limiting</div>\n                        </div>\n                      </label>\n                      {(localSettings.captchaType === 'local' || !localSettings.captchaType) && (\n                        <div className=\"ml-7 space-y-2\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">Honeypot Fields</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.honeypotEnabled ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'honeypotEnabled', v)}\n                              data-testid=\"switch-honeypot\"\n                            />\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">Time-based Validation</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.timeValidation ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'timeValidation', v)}\n                              data-testid=\"switch-time-validation\"\n                            />\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-xs\">IP Rate Limiting</span>\n                            <Switch \n                              checked={localSettings.captchaSettings?.ipRateLimit ?? true}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'ipRateLimit', v)}\n                              data-testid=\"switch-ip-rate-limit\"\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'google' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"google\"\n                          checked={localSettings.captchaType === 'google'}\n                          onChange={() => updateLocalSetting('captchaType', 'google')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-google\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Globe className=\"w-4 h-4 text-muted-foreground\" />\n                            Google reCAPTCHA v3\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Invisible, score-based protection</div>\n                        </div>\n                      </label>\n                      {localSettings.captchaType === 'google' && (\n                        <div className=\"ml-7 space-y-3 pt-2\">\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Site Key</Label>\n                            <Input \n                              placeholder=\"Enter Google reCAPTCHA site key\" \n                              className=\"text-sm\"\n                              value={localSettings.captchaSettings?.googleSiteKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'googleSiteKey', e.target.value)}\n                              data-testid=\"input-google-site-key\"\n                            />\n                            {localSettings.captchaType === 'google' && !localSettings.captchaSettings?.googleSiteKey && (\n                              <p className=\"text-xs text-yellow-600 dark:text-yellow-500 flex items-center gap-1\">\n                                <AlertTriangle className=\"w-3 h-3\" />\n                                Site key is required for Google reCAPTCHA to work\n                              </p>\n                            )}\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Secret Key</Label>\n                            <div className=\"relative\">\n                              <Input \n                                type={showGoogleSecret ? \"text\" : \"password\"} \n                                placeholder=\"Enter secret key\" \n                                className=\"text-sm pr-10\"\n                                value={localSettings.captchaSettings?.googleSecretKey || ''}\n                                onChange={(e) => updateNestedSetting('captchaSettings', 'googleSecretKey', e.target.value)}\n                                data-testid=\"input-google-secret-key\"\n                              />\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"absolute right-0 top-0 h-full\"\n                                onClick={() => setShowGoogleSecret(!showGoogleSecret)}\n                              >\n                                {showGoogleSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                              </Button>\n                            </div>\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Minimum Score (0.0 - 1.0)</Label>\n                            <Input \n                              type=\"number\" \n                              value={localSettings.captchaSettings?.googleMinScore ?? 0.5}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'googleMinScore', parseFloat(e.target.value))}\n                              step=\"0.1\" \n                              min=\"0\" \n                              max=\"1\" \n                              className=\"text-sm\"\n                              data-testid=\"input-google-min-score\"\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className={`p-4 border rounded-lg space-y-3 ${localSettings.captchaType === 'cloudflare' ? 'border-primary/50 bg-primary/5' : ''}`}>\n                      <label className=\"flex items-center gap-3 cursor-pointer\">\n                        <input \n                          type=\"radio\" \n                          name=\"captcha\" \n                          value=\"cloudflare\"\n                          checked={localSettings.captchaType === 'cloudflare'}\n                          onChange={() => updateLocalSetting('captchaType', 'cloudflare')}\n                          className=\"w-4 h-4 text-primary\"\n                          data-testid=\"radio-captcha-cloudflare\"\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium text-sm flex items-center gap-2\">\n                            <Shield className=\"w-4 h-4 text-muted-foreground\" />\n                            Cloudflare Turnstile\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">Privacy-friendly, works with adblockers</div>\n                        </div>\n                      </label>\n                      {localSettings.captchaType === 'cloudflare' && (\n                        <div className=\"ml-7 space-y-3 pt-2\">\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Site Key</Label>\n                            <Input \n                              placeholder=\"Enter Cloudflare site key\" \n                              className=\"text-sm\"\n                              value={localSettings.captchaSettings?.cloudflareSiteKey || ''}\n                              onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSiteKey', e.target.value)}\n                              data-testid=\"input-cloudflare-site-key\"\n                            />\n                            {localSettings.captchaType === 'cloudflare' && !localSettings.captchaSettings?.cloudflareSiteKey && (\n                              <p className=\"text-xs text-yellow-600 dark:text-yellow-500 flex items-center gap-1\">\n                                <AlertTriangle className=\"w-3 h-3\" />\n                                Site key is required for Cloudflare Turnstile to work\n                              </p>\n                            )}\n                          </div>\n                          <div className=\"space-y-1\">\n                            <Label className=\"text-xs\">Secret Key</Label>\n                            <div className=\"relative\">\n                              <Input \n                                type={showCloudflareSecret ? \"text\" : \"password\"} \n                                placeholder=\"Enter secret key\" \n                                className=\"text-sm pr-10\"\n                                value={localSettings.captchaSettings?.cloudflareSecretKey || ''}\n                                onChange={(e) => updateNestedSetting('captchaSettings', 'cloudflareSecretKey', e.target.value)}\n                                data-testid=\"input-cloudflare-secret-key\"\n                              />\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"absolute right-0 top-0 h-full\"\n                                onClick={() => setShowCloudflareSecret(!showCloudflareSecret)}\n                              >\n                                {showCloudflareSecret ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                              </Button>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <Switch \n                              checked={localSettings.captchaSettings?.cloudflareManagedMode || false}\n                              onCheckedChange={(v) => updateNestedSetting('captchaSettings', 'cloudflareManagedMode', v)}\n                              data-testid=\"switch-cloudflare-managed\"\n                            />\n                            <Label className=\"text-xs\">Managed Challenge Mode</Label>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  <Button className=\"w-full\" onClick={saveCaptchaSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-captcha\">\n                    {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    Save Captcha Settings\n                  </Button>\n                </CardContent>\n              </Card>\n\n              <div className=\"space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5\" />\n                      Protection Coverage\n                    </CardTitle>\n                    <CardDescription>Choose which forms to protect</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Login Form</p>\n                        <p className=\"text-xs text-muted-foreground\">Admin login page</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.loginForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'loginForm', v)}\n                        data-testid=\"switch-protect-login\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Contact Form</p>\n                        <p className=\"text-xs text-muted-foreground\">Public contact form</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.contactForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'contactForm', v)}\n                        data-testid=\"switch-protect-contact\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Newsletter Signup</p>\n                        <p className=\"text-xs text-muted-foreground\">Email subscription form</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.newsletterForm ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'newsletterForm', v)}\n                        data-testid=\"switch-protect-newsletter\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Comment Forms</p>\n                        <p className=\"text-xs text-muted-foreground\">Blog post comments</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.commentForms ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'commentForms', v)}\n                        data-testid=\"switch-protect-comments\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Registration Form</p>\n                        <p className=\"text-xs text-muted-foreground\">User registration (if enabled)</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.protectionCoverage?.registrationForm || false}\n                        onCheckedChange={(v) => updateNestedSetting('protectionCoverage', 'registrationForm', v)}\n                        data-testid=\"switch-protect-registration\"\n                      />\n                    </div>\n                    <Button className=\"w-full\" onClick={saveCaptchaSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-coverage\">\n                      Save Coverage Settings\n                    </Button>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <AlertCircle className=\"w-5 h-5\" />\n                      Bot Detection Stats\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"p-3 bg-green-500/10 border border-green-500/20 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-green-500\" data-testid=\"text-allowed-count\">{stats?.totalAllowed || 0}</p>\n                        <p className=\"text-xs text-muted-foreground\">Legitimate Submissions</p>\n                      </div>\n                      <div className=\"p-3 bg-red-500/10 border border-red-500/20 rounded-lg\">\n                        <p className=\"text-2xl font-bold text-red-500\" data-testid=\"text-blocked-count\">{stats?.totalBlocked || 0}</p>\n                        <p className=\"text-xs text-muted-foreground\">Blocked Bots</p>\n                      </div>\n                    </div>\n                    <div className=\"p-3 bg-muted/50 rounded-lg\">\n                      <div className=\"flex justify-between items-center mb-2\">\n                        <span className=\"text-xs text-muted-foreground\">Protection Rate</span>\n                        <span className=\"text-sm font-medium\">\n                          {stats && stats.totalBlocked + stats.totalAllowed > 0 \n                            ? ((stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100).toFixed(1) \n                            : 100}%\n                        </span>\n                      </div>\n                      <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                        <div \n                          className=\"h-full bg-green-500 rounded-full\" \n                          style={{ width: `${stats && stats.totalBlocked + stats.totalAllowed > 0 ? (stats.totalAllowed / (stats.totalBlocked + stats.totalAllowed)) * 100 : 100}%` }} \n                        />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n\n          {/* FIREWALL TAB */}\n          <TabsContent value=\"firewall\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"w-5 h-5\" /> IP Whitelist / Blacklist\n                </CardTitle>\n                <CardDescription>Control which IP addresses can access admin panel</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-medium mb-2\">IP Whitelist (Allow only these IPs)</h4>\n                  <div className=\"space-y-2 mb-3\">\n                    {whitelistIps.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No whitelisted IPs</p>\n                    ) : (\n                      whitelistIps.map((rule) => (\n                        <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-green-500/5 border-green-500/20\">\n                          <span className=\"text-sm\">{rule.ipAddress}</span>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                            data-testid={`button-remove-whitelist-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex gap-2\">\n                      <Input \n                        placeholder=\"Add IP address (e.g., 192.168.1.1)\" \n                        value={newWhitelistIp}\n                        onChange={(e) => setNewWhitelistIp(e.target.value)}\n                        data-testid=\"input-whitelist-ip\"\n                        className={newWhitelistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(newWhitelistIp) ? 'border-red-500' : ''}\n                      />\n                      <Button \n                        onClick={() => {\n                          // More comprehensive IP validation\n                          const validateIP = (ip: string) => {\n                            // IPv4 with optional CIDR\n                            const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/;\n                            // IPv6 with optional CIDR\n                            const ipv6Regex = /^(?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/;\n                            \n                            if (ipv4Regex.test(ip)) {\n                              // Validate CIDR range if present\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 32;\n                              }\n                              return true;\n                            }\n                            \n                            if (ipv6Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 128;\n                              }\n                              return true;\n                            }\n                            \n                            return false;\n                          };\n                          \n                          if (newWhitelistIp && validateIP(newWhitelistIp)) {\n                            addIpRuleMutation.mutate({ ipAddress: newWhitelistIp, type: 'whitelist' });\n                          } else {\n                            toast({ title: \"Invalid IP address format. Use IPv4/IPv6 with optional CIDR notation\", variant: \"destructive\" });\n                          }\n                        }}\n                        disabled={!newWhitelistIp || addIpRuleMutation.isPending}\n                        data-testid=\"button-add-whitelist\"\n                      >\n                        <Plus className=\"w-4 h-4 mr-1\" /> Add\n                      </Button>\n                    </div>\n                    {newWhitelistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/.test(newWhitelistIp) && \n                     !/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/.test(newWhitelistIp) && (\n                      <p className=\"text-xs text-red-500\">Please enter a valid IPv4/IPv6 address (CIDR notation supported)</p>\n                    )}\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h4 className=\"font-medium mb-2\">IP Blacklist (Block these IPs)</h4>\n                  <div className=\"space-y-2 mb-3\">\n                    {blacklistIps.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No blacklisted IPs</p>\n                    ) : (\n                      blacklistIps.map((rule) => (\n                        <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-red-500/5 border-red-500/20\">\n                          <span className=\"text-sm\">{rule.ipAddress}</span>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                            data-testid={`button-remove-blacklist-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex gap-2\">\n                      <Input \n                        placeholder=\"Add IP to block...\" \n                        value={newBlacklistIp}\n                        onChange={(e) => setNewBlacklistIp(e.target.value)}\n                        data-testid=\"input-blacklist-ip\"\n                        className={newBlacklistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(newBlacklistIp) ? 'border-red-500' : ''}\n                      />\n                      <Button \n                        onClick={() => {\n                          const validateIP = (ip: string) => {\n                            const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/;\n                            const ipv6Regex = /^(?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/;\n                            \n                            if (ipv4Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 32;\n                              }\n                              return true;\n                            }\n                            \n                            if (ipv6Regex.test(ip)) {\n                              const parts = ip.split('/');\n                              if (parts.length === 2) {\n                                const cidr = parseInt(parts[1]);\n                                return cidr >= 0 && cidr <= 128;\n                              }\n                              return true;\n                            }\n                            \n                            return false;\n                          };\n                          \n                          if (newBlacklistIp && validateIP(newBlacklistIp)) {\n                            addIpRuleMutation.mutate({ ipAddress: newBlacklistIp, type: 'blacklist' });\n                          } else {\n                            toast({ title: \"Invalid IP address format. Use IPv4/IPv6 with optional CIDR notation\", variant: \"destructive\" });\n                          }\n                        }}\n                        disabled={!newBlacklistIp || addIpRuleMutation.isPending}\n                        data-testid=\"button-add-blacklist\"\n                      >\n                        <Ban className=\"w-4 h-4 mr-1\" /> Block\n                      </Button>\n                    </div>\n                    {newBlacklistIp && !/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/.test(newBlacklistIp) && \n                     !/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/.test(newBlacklistIp) && (\n                      <p className=\"text-xs text-red-500\">Please enter a valid IPv4/IPv6 address (CIDR notation supported)</p>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Rate Limiting</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Login Attempts Limit</label>\n                  <Input \n                    value={localSettings.rateLimiting?.loginAttemptsLimit ?? 5}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'loginAttemptsLimit', parseInt(e.target.value) || 5)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-login-attempts-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Max attempts before lockout</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">API Rate Limit</label>\n                  <Input \n                    value={localSettings.rateLimiting?.apiRateLimit ?? 1000}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'apiRateLimit', parseInt(e.target.value) || 1000)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-api-rate-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Requests per hour per IP</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Lockout Duration (minutes)</label>\n                  <Input \n                    value={localSettings.rateLimiting?.lockoutDuration ?? 15}\n                    onChange={(e) => updateNestedSetting('rateLimiting', 'lockoutDuration', parseInt(e.target.value) || 15)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-lockout-duration\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Time before locked out user can try again</p>\n                </div>\n                <Button onClick={saveFirewallSettings} disabled={updateSettingsMutation.isPending} data-testid=\"button-save-rate-limiting\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Rate Limiting Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* THREAT PROTECTION TAB */}\n          <TabsContent value=\"threat\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <ShieldAlert className=\"w-5 h-5\" /> DDoS Protection\n                </CardTitle>\n                <CardDescription>Protect against distributed denial-of-service attacks</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.ddosProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">DDoS Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Automatically detect and mitigate attacks</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.ddosProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('ddosProtection', 'enabled', v)}\n                    data-testid=\"switch-ddos-protection\"\n                  />\n                </div>\n                {localSettings.ddosProtection?.enabled !== false && (\n                  <>\n                    <div>\n                      <label className=\"text-sm font-medium\">Request Threshold (per minute)</label>\n                      <Input \n                        value={localSettings.ddosProtection?.threshold ?? 100}\n                        onChange={(e) => updateNestedSetting('ddosProtection', 'threshold', parseInt(e.target.value) || 100)}\n                        type=\"number\" \n                        className=\"mt-1\"\n                        data-testid=\"input-ddos-threshold\"\n                      />\n                      <p className=\"text-xs text-muted-foreground mt-1\">Trigger protection when requests exceed this limit</p>\n                    </div>\n                    <div>\n                      <label className=\"text-sm font-medium\">Block Duration (minutes)</label>\n                      <Input \n                        value={localSettings.ddosProtection?.blockDuration ?? 30}\n                        onChange={(e) => updateNestedSetting('ddosProtection', 'blockDuration', parseInt(e.target.value) || 30)}\n                        type=\"number\" \n                        className=\"mt-1\"\n                        data-testid=\"input-ddos-block-duration\"\n                      />\n                      <p className=\"text-xs text-muted-foreground mt-1\">How long to block suspicious IPs</p>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5\" /> SQL Injection Detection\n                </CardTitle>\n                <CardDescription>Detect and block SQL injection attempts</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.sqlInjectionProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">SQL Injection Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan requests for malicious SQL patterns</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.sqlInjectionProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'enabled', v)}\n                    data-testid=\"switch-sql-injection\"\n                  />\n                </div>\n                {localSettings.sqlInjectionProtection?.enabled !== false && (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Log Attempts</p>\n                        <p className=\"text-xs text-muted-foreground\">Record all detected injection attempts</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.sqlInjectionProtection?.logAttempts ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'logAttempts', v)}\n                        data-testid=\"switch-sql-log\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Block Requests</p>\n                        <p className=\"text-xs text-muted-foreground\">Automatically block suspicious requests</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.sqlInjectionProtection?.blockRequests ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('sqlInjectionProtection', 'blockRequests', v)}\n                        data-testid=\"switch-sql-block\"\n                      />\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Shield className=\"w-5 h-5\" /> XSS Protection\n                </CardTitle>\n                <CardDescription>Protect against cross-site scripting attacks</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className={`flex items-center justify-between p-3 border rounded-lg ${localSettings.xssProtection?.enabled ? 'bg-green-500/5 border-green-500/20' : ''}`}>\n                  <div>\n                    <p className=\"font-medium text-sm\">XSS Protection</p>\n                    <p className=\"text-xs text-muted-foreground\">Detect and sanitize malicious scripts</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.xssProtection?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('xssProtection', 'enabled', v)}\n                    data-testid=\"switch-xss-protection\"\n                  />\n                </div>\n                {localSettings.xssProtection?.enabled !== false && (\n                  <>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Sanitize Input</p>\n                        <p className=\"text-xs text-muted-foreground\">Automatically clean user input</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.xssProtection?.sanitizeInput ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('xssProtection', 'sanitizeInput', v)}\n                        data-testid=\"switch-xss-sanitize\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Block Requests</p>\n                        <p className=\"text-xs text-muted-foreground\">Block requests with malicious content</p>\n                      </div>\n                      <Switch \n                        checked={localSettings.xssProtection?.blockRequests ?? true}\n                        onCheckedChange={(v) => updateNestedSetting('xssProtection', 'blockRequests', v)}\n                        data-testid=\"switch-xss-block\"\n                      />\n                    </div>\n                  </>\n                )}\n                <Button onClick={saveThreatSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-threat\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Threat Protection Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SESSIONS TAB */}\n          <TabsContent value=\"sessions\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Users className=\"w-5 h-5\" /> Active Sessions\n                </CardTitle>\n                <CardDescription>Manage active user sessions</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {sessions.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground\">No active sessions</p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {sessions.map((session) => (\n                      <div key={session.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\" />\n                          <div>\n                            <p className=\"font-medium text-sm\">{session.deviceInfo || 'Unknown Device'}</p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {session.ipAddress || 'Unknown IP'} â€¢ {session.location || 'Unknown Location'}\n                              {session.lastActivity && ` â€¢ ${new Date(session.lastActivity).toLocaleString()}`}\n                            </p>\n                          </div>\n                        </div>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"sm\"\n                          onClick={() => terminateSessionMutation.mutate(session.id)}\n                          disabled={terminateSessionMutation.isPending}\n                          data-testid={`button-terminate-session-${session.id}`}\n                        >\n                          <LogOut className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                <div className=\"flex gap-2\">\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      logoutAllDevicesMutation.mutate();\n                    }}\n                    disabled={logoutAllDevicesMutation.isPending}\n                    data-testid=\"button-logout-all-devices\"\n                  >\n                    {logoutAllDevicesMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    <LogOut className=\"w-4 h-4 mr-2\" /> Logout All Devices\n                  </Button>\n                  <Button \n                    variant=\"destructive\" \n                    className=\"flex-1\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      terminateAllSessionsMutation.mutate();\n                    }}\n                    disabled={terminateAllSessionsMutation.isPending}\n                    data-testid=\"button-force-logout-all\"\n                  >\n                    {terminateAllSessionsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                    <LogOut className=\"w-4 h-4 mr-2\" /> Force Logout All Users\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5\" /> Session Policies\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Session Timeout (Idle)</Label>\n                    <select \n                      className=\"w-full p-2 rounded-md border border-input bg-background\"\n                      value={localSettings.sessionSettings?.idleTimeout || '30 minutes'}\n                      onChange={(e) => updateNestedSetting('sessionSettings', 'idleTimeout', e.target.value)}\n                      data-testid=\"select-idle-timeout\"\n                    >\n                      <option value=\"15 minutes\">15 minutes</option>\n                      <option value=\"30 minutes\">30 minutes</option>\n                      <option value=\"1 hour\">1 hour</option>\n                      <option value=\"4 hours\">4 hours</option>\n                      <option value=\"Never\">Never</option>\n                    </select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Max Session Duration</Label>\n                    <select \n                      className=\"w-full p-2 rounded-md border border-input bg-background\"\n                      value={localSettings.sessionSettings?.maxDuration || '24 hours'}\n                      onChange={(e) => updateNestedSetting('sessionSettings', 'maxDuration', e.target.value)}\n                      data-testid=\"select-max-duration\"\n                    >\n                      <option value=\"8 hours\">8 hours</option>\n                      <option value=\"24 hours\">24 hours</option>\n                      <option value=\"7 days\">7 days</option>\n                      <option value=\"30 days\">30 days</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Force Logout Inactive Users</p>\n                    <p className=\"text-xs text-muted-foreground\">Auto-logout users after idle timeout</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.sessionSettings?.forceLogoutInactive ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('sessionSettings', 'forceLogoutInactive', v)}\n                    data-testid=\"switch-force-logout-inactive\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Concurrent Session Limit</Label>\n                  <select \n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={localSettings.sessionSettings?.concurrentSessionLimit || 'Unlimited'}\n                    onChange={(e) => updateNestedSetting('sessionSettings', 'concurrentSessionLimit', e.target.value)}\n                    data-testid=\"select-concurrent-sessions\"\n                  >\n                    <option value=\"Unlimited\">Unlimited</option>\n                    <option value=\"1 session per user\">1 session per user</option>\n                    <option value=\"3 sessions per user\">3 sessions per user</option>\n                    <option value=\"5 sessions per user\">5 sessions per user</option>\n                  </select>\n                </div>\n\n                <Button onClick={saveSessionSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-session-policies\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Session Policies\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* COMPLIANCE TAB */}\n          <TabsContent value=\"compliance\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <FileText className=\"w-5 h-5\" /> GDPR Compliance\n                </CardTitle>\n                <CardDescription>Manage data protection and privacy regulations</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">GDPR Enabled</p>\n                    <p className=\"text-xs text-muted-foreground\">Enable GDPR compliance features</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.compliance?.gdprEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('compliance', 'gdprEnabled', v)}\n                    data-testid=\"switch-gdpr\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Data Retention Period (days)</label>\n                  <Input \n                    value={localSettings.compliance?.dataRetentionDays ?? 365}\n                    onChange={(e) => updateNestedSetting('compliance', 'dataRetentionDays', parseInt(e.target.value) || 365)}\n                    type=\"number\" \n                    className=\"mt-1\"\n                    data-testid=\"input-retention-days\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Automatically delete user data after this period</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Privacy Policy URL</label>\n                  <Input \n                    value={localSettings.compliance?.privacyPolicyUrl || ''}\n                    onChange={(e) => updateNestedSetting('compliance', 'privacyPolicyUrl', e.target.value)}\n                    placeholder=\"https://example.com/privacy\"\n                    className=\"mt-1\"\n                    data-testid=\"input-privacy-url\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Cookie Consent</p>\n                    <p className=\"text-xs text-muted-foreground\">Require explicit cookie consent from users</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.compliance?.cookieConsentEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('compliance', 'cookieConsentEnabled', v)}\n                    data-testid=\"switch-cookie-consent\"\n                  />\n                </div>\n                <Button onClick={saveComplianceSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-compliance\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Compliance Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* CSP TAB */}\n          <TabsContent value=\"csp\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Layers className=\"w-5 h-5\" /> Content Security Policy\n                </CardTitle>\n                <CardDescription>Control resource loading and execution</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">CSP Enabled</p>\n                    <p className=\"text-xs text-muted-foreground\">Apply content security policy headers</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.cspSettings?.enabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('cspSettings', 'enabled', v)}\n                    data-testid=\"switch-csp-enabled\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Strict Mode</p>\n                    <p className=\"text-xs text-muted-foreground\">Enforce strict CSP violations</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.cspSettings?.strictMode ?? false}\n                    onCheckedChange={(v) => updateNestedSetting('cspSettings', 'strictMode', v)}\n                    data-testid=\"switch-csp-strict\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Report URI</label>\n                  <Input \n                    value={localSettings.cspSettings?.reportUri || ''}\n                    onChange={(e) => updateNestedSetting('cspSettings', 'reportUri', e.target.value)}\n                    placeholder=\"https://example.com/csp-report\"\n                    className=\"mt-1\"\n                    data-testid=\"input-csp-report-uri\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Endpoint to receive CSP violation reports</p>\n                </div>\n                <Button onClick={saveCSPSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-csp\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save CSP Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SCANNER TAB */}\n          <TabsContent value=\"scanner\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Zap className=\"w-5 h-5\" /> Security Scanning\n                </CardTitle>\n                <CardDescription>Automated security vulnerability scanning</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Vulnerability Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan for known vulnerabilities</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.vulnerabilityScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'vulnerabilityScanEnabled', v)}\n                    data-testid=\"switch-vuln-scan\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">SSL Certificate Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Monitor SSL certificate validity</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.sslScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'sslScanEnabled', v)}\n                    data-testid=\"switch-ssl-scan\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Malware Scanning</p>\n                    <p className=\"text-xs text-muted-foreground\">Scan uploaded files for malware</p>\n                  </div>\n                  <Switch \n                    checked={localSettings.scannerSettings?.malwareScanEnabled ?? true}\n                    onCheckedChange={(v) => updateNestedSetting('scannerSettings', 'malwareScanEnabled', v)}\n                    data-testid=\"switch-malware-scan\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Scan Frequency</label>\n                  <select \n                    className=\"w-full p-2 rounded-md border border-input bg-background mt-1\"\n                    value={localSettings.scannerSettings?.scanFrequency || 'weekly'}\n                    onChange={(e) => updateNestedSetting('scannerSettings', 'scanFrequency', e.target.value)}\n                    data-testid=\"select-scan-frequency\"\n                  >\n                    <option value=\"daily\">Daily</option>\n                    <option value=\"weekly\">Weekly</option>\n                    <option value=\"monthly\">Monthly</option>\n                  </select>\n                </div>\n                <Button onClick={saveScannerSettings} disabled={updateSettingsMutation.isPending} className=\"w-full\" data-testid=\"button-save-scanner\">\n                  {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Save Scanner Settings\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* ACTIVITY TAB */}\n          <TabsContent value=\"activity\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Activity className=\"w-5 h-5\" /> Security Activity\n                </CardTitle>\n                <CardDescription>Monitor user actions and security events</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <select className=\"text-sm border rounded px-3 py-2\" defaultValue=\"all\">\n                    <option value=\"all\">All Events</option>\n                    <option value=\"login_success\">Successful Logins</option>\n                    <option value=\"login_failed\">Failed Logins</option>\n                    <option value=\"two_factor\">2FA Events</option>\n                  </select>\n                  <select className=\"text-sm border rounded px-3 py-2\" defaultValue=\"24h\">\n                    <option value=\"24h\">Last 24 Hours</option>\n                    <option value=\"7d\">Last 7 Days</option>\n                    <option value=\"30d\">Last 30 Days</option>\n                  </select>\n                </div>\n                <div className=\"space-y-3\">\n                  <div className=\"p-3 border rounded-lg bg-blue-500/5\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Last Login Activity</p>\n                        <p className=\"text-xs text-muted-foreground\">Security events from last 24 hours</p>\n                      </div>\n                      <Badge variant=\"secondary\">Active</Badge>\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Successful Logins</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.filter(l => l.eventType === 'login_success').length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-green-500 rounded-full transition-all\" \n                        style={{ width: `${loginHistory.length > 0 ? (loginHistory.filter(l => l.eventType === 'login_success').length / loginHistory.length * 100) : 0}%` }} \n                      />\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Failed Login Attempts</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.filter(l => l.eventType === 'login_failed' || l.blocked).length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-red-500 rounded-full transition-all\" \n                        style={{ width: `${loginHistory.length > 0 ? (loginHistory.filter(l => l.eventType === 'login_failed' || l.blocked).length / loginHistory.length * 100) : 0}%` }} \n                      />\n                    </div>\n                  </div>\n                  <div className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-medium\">Total Events (Last 24h)</p>\n                      <span className=\"text-lg font-bold\">{loginHistory.length}</span>\n                    </div>\n                    <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-blue-500 rounded-full transition-all\" \n                        style={{ width: `${Math.min(100, loginHistory.length * 10)}%` }} \n                      />\n                    </div>\n                  </div>\n                </div>\n                <Button \n                  onClick={() => setShowLoginHistory(!showLoginHistory)} \n                  className=\"w-full\" \n                  data-testid=\"button-view-login-history\"\n                >\n                  <FileText className=\"w-4 h-4 mr-2\" /> {showLoginHistory ? 'Hide' : 'View'} Login History\n                </Button>\n                {showLoginHistory && (\n                  <div className=\"mt-4 space-y-2 max-h-96 overflow-y-auto\">\n                    <p className=\"text-sm font-medium\">Recent Login Activity</p>\n                    {loginHistory.length === 0 ? (\n                      <p className=\"text-xs text-muted-foreground\">No login history found</p>\n                    ) : (\n                      loginHistory.map((log) => (\n                        <div key={log.id} className={`p-3 text-xs border rounded ${log.blocked ? 'bg-red-500/5 border-red-500/30' : log.eventType === 'login_success' ? 'bg-green-500/5 border-green-500/30' : 'bg-muted/50'}`}>\n                          <div className=\"flex items-center justify-between mb-1\">\n                            <div className=\"flex items-center gap-2\">\n                              {log.eventType === 'login_success' ? (\n                                <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                              ) : log.blocked ? (\n                                <Ban className=\"w-4 h-4 text-red-500\" />\n                              ) : (\n                                <AlertCircle className=\"w-4 h-4 text-yellow-500\" />\n                              )}\n                              <span className=\"font-medium\">{log.userName || 'Unknown User'}</span>\n                              <Badge variant={log.eventType === 'login_success' ? 'secondary' : 'destructive'} className=\"text-[10px]\">\n                                {log.eventType === 'login_success' ? 'Success' : log.eventType === 'login_failed' ? 'Failed' : log.eventType || 'Unknown'}\n                              </Badge>\n                            </div>\n                            <span className=\"text-muted-foreground\">{log.createdAt ? new Date(log.createdAt).toLocaleString() : 'N/A'}</span>\n                          </div>\n                          <p className=\"text-muted-foreground mb-1\">{log.action}</p>\n                          <div className=\"flex items-center gap-3 text-muted-foreground\">\n                            {log.ipAddress && (\n                              <span className=\"flex items-center gap-1\">\n                                <Globe className=\"w-3 h-3\" /> {log.ipAddress}\n                              </span>\n                            )}\n                            {log.userAgent && (\n                              <span className=\"flex items-center gap-1 truncate max-w-[200px]\" title={log.userAgent}>\n                                <Monitor className=\"w-3 h-3\" /> {log.userAgent.split(' ')[0]}\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                )}\n                <Button \n                  onClick={() => {\n                    refetchLoginHistory();\n                    refetchSessions();\n                  }} \n                  disabled={false} \n                  className=\"w-full\" \n                  data-testid=\"button-refresh-activity\"\n                >\n                  <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh Activity Log\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* 2FA Setup Modal */}\n      <Dialog open={show2FASetup} onOpenChange={setShow2FASetup}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Set up Two-Factor Authentication</DialogTitle>\n            <DialogDescription>\n              Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            {qrCode && (\n              <div className=\"flex justify-center p-4 bg-white rounded-lg\">\n                <img src={qrCode} alt=\"2FA QR Code\" className=\"w-48 h-48\" />\n              </div>\n            )}\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm font-medium\">Or enter this code manually:</Label>\n              <div className=\"flex gap-2\">\n                <Input value={secret} readOnly className=\"font-mono text-sm\" />\n                <Button \n                  variant=\"outline\" \n                  size=\"icon\"\n                  onClick={copySecret}\n                >\n                  {secretCopied ? <Check className=\"w-4 h-4\" /> : <Copy className=\"w-4 h-4\" />}\n                </Button>\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button \n              onClick={() => {\n                setShow2FASetup(false);\n                setShow2FAVerify(true);\n              }}\n            >\n              Continue to Verification\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* 2FA Verify Modal */}\n      <Dialog open={show2FAVerify} onOpenChange={setShow2FAVerify}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Verify 2FA Setup</DialogTitle>\n            <DialogDescription>\n              Enter the 6-digit code from your authenticator app\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-center py-6\">\n            <InputOTP maxLength={6} value={verifyCode} onChange={setVerifyCode}>\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => {\n                setShow2FAVerify(false);\n                setVerifyCode(\"\");\n              }}\n            >\n              Cancel\n            </Button>\n            <Button \n              onClick={() => verify2FAMutation.mutate(verifyCode)}\n              disabled={verifyCode.length !== 6 || verify2FAMutation.isPending}\n            >\n              {verify2FAMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Verify & Enable\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* 2FA Disable Modal */}\n      <Dialog open={show2FADisable} onOpenChange={setShow2FADisable}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Disable Two-Factor Authentication</DialogTitle>\n            <DialogDescription>\n              Enter your 6-digit code to confirm disabling 2FA\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"flex justify-center py-6\">\n            <InputOTP maxLength={6} value={disableCode} onChange={setDisableCode}>\n              <InputOTPGroup>\n                <InputOTPSlot index={0} />\n                <InputOTPSlot index={1} />\n                <InputOTPSlot index={2} />\n                <InputOTPSlot index={3} />\n                <InputOTPSlot index={4} />\n                <InputOTPSlot index={5} />\n              </InputOTPGroup>\n            </InputOTP>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => {\n                setShow2FADisable(false);\n                setDisableCode(\"\");\n              }}\n            >\n              Cancel\n            </Button>\n            <Button \n              variant=\"destructive\"\n              onClick={() => disable2FAMutation.mutate(disableCode)}\n              disabled={disableCode.length !== 6 || disable2FAMutation.isPending}\n            >\n              {disable2FAMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Disable 2FA\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":96115,"size_tokens":null},"client/src/pages/admin/tools/Tools.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { \n  FileText, \n  Database, \n  Mail, \n  TestTube, \n  Wrench,\n  Code,\n  Sparkles,\n  Zap,\n  Globe,\n  Image,\n  MessageSquare,\n  Star,\n  HelpCircle,\n  FolderTree,\n  Clock,\n  FileCode,\n  Webhook,\n  Bell,\n  Calculator,\n  Palette,\n  Monitor\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function AdminTools() {\n  const tools = [\n    {\n      category: \"Content Management\",\n      items: [\n        { \n          name: \"Testimonials Manager\", \n          description: \"Manage customer reviews and testimonials\",\n          icon: Star,\n          href: \"/admin/testimonials\",\n          color: \"text-yellow-500\"\n        },\n        { \n          name: \"FAQ Manager\", \n          description: \"Manage frequently asked questions\",\n          icon: HelpCircle,\n          href: \"/admin/faqs\",\n          color: \"text-blue-500\"\n        },\n        { \n          name: \"Categories\", \n          description: \"Organize content with categories and tags\",\n          icon: FolderTree,\n          href: \"/admin/categories\",\n          color: \"text-green-500\"\n        },\n      ]\n    },\n    {\n      category: \"Communication\",\n      items: [\n        { \n          name: \"Email Templates\", \n          description: \"Create and manage email templates\",\n          icon: Mail,\n          href: \"/admin/email-templates\",\n          color: \"text-purple-500\"\n        },\n        { \n          name: \"Notifications\", \n          description: \"Push notifications and alerts\",\n          icon: Bell,\n          href: \"/admin/notifications\",\n          color: \"text-orange-500\"\n        },\n        { \n          name: \"Webhooks\", \n          description: \"Configure webhook integrations\",\n          icon: Webhook,\n          href: \"/admin/webhooks\",\n          color: \"text-pink-500\"\n        },\n      ]\n    },\n    {\n      category: \"System Tools\",\n      items: [\n        { \n          name: \"Backup Manager\", \n          description: \"Database backup and restore\",\n          icon: Database,\n          href: \"/admin/system\",\n          color: \"text-cyan-500\"\n        },\n        { \n          name: \"Audit Trail\", \n          description: \"View complete system activity log\",\n          icon: Clock,\n          href: \"/admin/activity\",\n          color: \"text-indigo-500\"\n        },\n        { \n          name: \"Cache Manager\", \n          description: \"Clear and manage application cache\",\n          icon: Zap,\n          href: \"/admin/cache\",\n          color: \"text-yellow-500\"\n        },\n      ]\n    },\n    {\n      category: \"Developer Tools\",\n      items: [\n        { \n          name: \"API Documentation\", \n          description: \"Test and explore API endpoints\",\n          icon: Code,\n          href: \"/admin/api-docs\",\n          color: \"text-red-500\"\n        },\n        { \n          name: \"Scheduled Tasks\", \n          description: \"Manage cron jobs and automation\",\n          icon: Clock,\n          href: \"/admin/scheduler\",\n          color: \"text-green-500\"\n        },\n        { \n          name: \"SEO Tools\", \n          description: \"SEO optimization and meta tags\",\n          icon: Globe,\n          href: \"/admin/seo\",\n          color: \"text-blue-500\"\n        },\n      ]\n    },\n    {\n      category: \"Design & Customization\",\n      items: [\n        { \n          name: \"Theme Customizer\", \n          description: \"Advanced theme customization\",\n          icon: Palette,\n          href: \"/admin/theme\",\n          color: \"text-purple-500\"\n        },\n        { \n          name: \"Page Builder\", \n          description: \"Drag & drop page builder\",\n          icon: Monitor,\n          href: \"/admin/page-builder\",\n          color: \"text-pink-500\"\n        },\n        { \n          name: \"Image Optimizer\", \n          description: \"Optimize and compress images\",\n          icon: Image,\n          href: \"/admin/image-optimizer\",\n          color: \"text-orange-500\"\n        },\n      ]\n    },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div>\n          <h1 className=\"text-3xl font-heading font-bold\">Admin Tools</h1>\n          <p className=\"text-muted-foreground\">Powerful tools to manage your portfolio</p>\n        </div>\n\n        {tools.map((category, idx) => (\n          <div key={idx} className=\"space-y-4\">\n            <div className=\"flex items-center gap-2\">\n              <h2 className=\"text-xl font-semibold\">{category.category}</h2>\n              <div className=\"h-px flex-1 bg-border\" />\n            </div>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {category.items.map((tool, i) => (\n                <Link key={i} href={tool.href}>\n                  <Card className=\"cursor-pointer hover:border-primary/50 transition-all hover:-translate-y-1 duration-300 group\">\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className={`p-3 rounded-lg bg-muted group-hover:bg-primary/10 transition-colors`}>\n                          <tool.icon className={`w-6 h-6 ${tool.color}`} />\n                        </div>\n                      </div>\n                      <CardTitle className=\"text-lg mt-3\">{tool.name}</CardTitle>\n                      <CardDescription>{tool.description}</CardDescription>\n                    </CardHeader>\n                  </Card>\n                </Link>\n              ))}\n            </div>\n          </div>\n        ))}\n\n        {/* Quick Actions */}\n        <Card className=\"bg-gradient-to-br from-primary/5 to-secondary/5 border-primary/20\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-5 h-5 text-primary\" />\n              Quick Actions\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Database className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Backup Now</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Zap className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Clear Cache</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Code className=\"w-5 h-5\" />\n                <span className=\"text-xs\">Export Data</span>\n              </Button>\n              <Button variant=\"outline\" className=\"h-auto flex-col gap-2 py-4\">\n                <Wrench className=\"w-5 h-5\" />\n                <span className=\"text-xs\">System Check</span>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":6965,"size_tokens":null},"client/src/pages/admin/users/Profile.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Camera, Save, Mail, User as UserIcon, Shield, Clock, AlertCircle, Check } from \"lucide-react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { api } from \"@/lib/api\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { z } from \"zod\";\n\nconst passwordSchema = z.object({\n  currentPassword: z.string().min(1, \"Current password is required\"),\n  newPassword: z.string().min(8, \"Password must be at least 8 characters\"),\n  confirmPassword: z.string(),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype PasswordForm = z.infer<typeof passwordSchema>;\n\nexport default function AdminProfile() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [isEditing, setIsEditing] = useState(false);\n  const [avatarPreview, setAvatarPreview] = useState<string>(\"\");\n  const [isUploadingImage, setIsUploadingImage] = useState(false);\n  const [isPasswordModalOpen, setIsPasswordModalOpen] = useState(false);\n  const [passwordForm, setPasswordForm] = useState({\n    currentPassword: \"\",\n    newPassword: \"\",\n    confirmPassword: \"\",\n  });\n  const [passwordErrors, setPasswordErrors] = useState<Partial<PasswordForm>>({});\n  const [formData, setFormData] = useState({\n    name: \"\",\n    email: \"\",\n    username: \"\",\n    avatar: \"\",\n  });\n\n  const { data: currentUser, isLoading } = useQuery({\n    queryKey: [\"currentUser\"],\n    queryFn: api.getCurrentUser,\n  });\n\n  useEffect(() => {\n    if (currentUser) {\n      setFormData({\n        name: currentUser.name || \"\",\n        email: currentUser.email || \"\",\n        username: currentUser.username || \"\",\n        avatar: currentUser.avatar || \"\",\n      });\n      setAvatarPreview(currentUser.avatar || \"/avatars/01.png\");\n    }\n  }, [currentUser]);\n\n  const updateMutation = useMutation({\n    mutationFn: (data: any) => api.updateProfile(data),\n    onSuccess: (response: any) => {\n      queryClient.setQueryData([\"currentUser\"], response);\n      queryClient.invalidateQueries({ queryKey: [\"currentUser\"] });\n      setFormData({\n        name: response.name || \"\",\n        email: response.email || \"\",\n        username: response.username || \"\",\n        avatar: response.avatar || \"\",\n      });\n      setAvatarPreview(response.avatar || \"/avatars/01.png\");\n      setIsEditing(false);\n      toast({\n        title: \"Profile Updated\",\n        description: \"Your profile has been updated successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update profile.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const passwordMutation = useMutation({\n    mutationFn: (data: PasswordForm) => api.changePassword(data.currentPassword, data.newPassword),\n    onSuccess: () => {\n      setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n      setPasswordErrors({});\n      setIsPasswordModalOpen(false);\n      toast({\n        title: \"Success\",\n        description: \"Your password has been changed successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to change password.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSave = async () => {\n    if (!currentUser) return;\n    updateMutation.mutate(formData);\n  };\n\n  const handleCancel = () => {\n    setFormData({\n      name: currentUser?.name || \"\",\n      email: currentUser?.email || \"\",\n      username: currentUser?.username || \"\",\n      avatar: currentUser?.avatar || \"\",\n    });\n    setAvatarPreview(currentUser?.avatar || \"/avatars/01.png\");\n    setIsEditing(false);\n  };\n\n  const handleChangePassword = () => {\n    setPasswordErrors({});\n    const result = passwordSchema.safeParse(passwordForm);\n    if (!result.success) {\n      const errors: Partial<PasswordForm> = {};\n      result.error.errors.forEach((err) => {\n        if (err.path[0]) {\n          errors[err.path[0] as keyof PasswordForm] = { message: err.message } as any;\n        }\n      });\n      setPasswordErrors(errors);\n      return;\n    }\n    passwordMutation.mutate(result.data);\n  };\n\n  const handleClosePasswordModal = () => {\n    setIsPasswordModalOpen(false);\n    setPasswordForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\n    setPasswordErrors({});\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Invalid file\",\n        description: \"Please select an image file.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"File too large\",\n        description: \"Image size must be less than 5MB.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        try {\n          const base64 = event.target?.result as string;\n          const result = await api.uploadImage(base64);\n          setFormData({ ...formData, avatar: result.url });\n          setAvatarPreview(result.url);\n          toast({\n            title: \"Success\",\n            description: \"Image uploaded successfully.\",\n          });\n        } catch (error: any) {\n          toast({\n            title: \"Upload failed\",\n            description: error.message || \"Failed to upload image.\",\n            variant: \"destructive\",\n          });\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to process image.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploadingImage(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"text-muted-foreground\">Loading...</div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  if (!currentUser) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-96\">\n          <div className=\"text-muted-foreground\">Please log in to view your profile</div>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6 max-w-4xl mx-auto\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">My Profile</h1>\n            <p className=\"text-muted-foreground\">Manage your account information</p>\n          </div>\n          {!isEditing ? (\n            <Button onClick={() => setIsEditing(true)}>Edit Profile</Button>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={handleCancel}>Cancel</Button>\n              <Button onClick={handleSave} disabled={updateMutation.isPending}>\n                <Save className=\"w-4 h-4 mr-2\" />\n                {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid gap-6\">\n          {/* Profile Header Card */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex flex-col sm:flex-row items-center sm:items-start gap-6\">\n                <div className=\"relative\">\n                  <Avatar className=\"h-24 w-24\">\n                    <AvatarImage src={avatarPreview} alt={currentUser.name} />\n                    <AvatarFallback className=\"text-2xl\">\n                      {currentUser.name.charAt(0).toUpperCase()}\n                    </AvatarFallback>\n                  </Avatar>\n                  {isEditing && (\n                    <>\n                      <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        onChange={handleImageUpload}\n                        disabled={isUploadingImage}\n                        data-testid=\"input-avatar-upload\"\n                      />\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\" \n                        className=\"absolute bottom-0 right-0 h-8 w-8 rounded-full\"\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={isUploadingImage}\n                        type=\"button\"\n                        data-testid=\"button-upload-avatar\"\n                      >\n                        <Camera className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  )}\n                </div>\n                <div className=\"flex-1 text-center sm:text-left space-y-1\">\n                  <h2 className=\"text-2xl font-bold\">{currentUser.name}</h2>\n                  <p className=\"text-muted-foreground\">@{currentUser.username}</p>\n                  <div className=\"flex flex-wrap gap-2 justify-center sm:justify-start pt-2\">\n                    <div className=\"flex items-center gap-1 px-3 py-1 bg-primary/10 text-primary rounded-full text-sm\">\n                      <Shield className=\"w-3 h-3\" />\n                      {currentUser.role}\n                    </div>\n                    <div className={`flex items-center gap-1 px-3 py-1 rounded-full text-sm ${\n                      currentUser.status === \"Active\" \n                        ? \"bg-green-500/10 text-green-500\" \n                        : \"bg-red-500/10 text-red-500\"\n                    }`}>\n                      <div className=\"w-2 h-2 rounded-full bg-current\" />\n                      {currentUser.status}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Personal Information Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Personal Information</CardTitle>\n              <CardDescription>Update your personal details</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid sm:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Full Name</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <UserIcon className=\"w-4 h-4 text-muted-foreground\" />\n                    <Input\n                      id=\"name\"\n                      value={formData.name}\n                      onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                      disabled={!isEditing}\n                      className={!isEditing ? \"bg-muted\" : \"\"}\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"username\">Username</Label>\n                  <div className=\"flex items-center gap-2\">\n                    <UserIcon className=\"w-4 h-4 text-muted-foreground\" />\n                    <Input\n                      id=\"username\"\n                      value={formData.username}\n                      onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                      disabled={!isEditing}\n                      className={!isEditing ? \"bg-muted\" : \"\"}\n                    />\n                  </div>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email Address</Label>\n                <div className=\"flex items-center gap-2\">\n                  <Mail className=\"w-4 h-4 text-muted-foreground\" />\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                    disabled={!isEditing}\n                    className={!isEditing ? \"bg-muted\" : \"\"}\n                  />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Account Information Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Account Information</CardTitle>\n              <CardDescription>View your account details</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid sm:grid-cols-2 gap-6\">\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Account Role</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Shield className=\"w-4 h-4 text-primary\" />\n                    <span className=\"font-medium\">{currentUser.role}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Account Status</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <div className={`w-2 h-2 rounded-full ${\n                      currentUser.status === \"Active\" ? \"bg-green-500\" : \"bg-red-500\"\n                    }`} />\n                    <span className=\"font-medium\">{currentUser.status}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Member Since</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                    <span className=\"font-medium\">\n                      {currentUser.createdAt \n                        ? new Date(currentUser.createdAt).toLocaleDateString()\n                        : \"N/A\"}\n                    </span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label className=\"text-muted-foreground\">Last Active</Label>\n                  <div className=\"flex items-center gap-2 p-3 bg-muted rounded-lg\">\n                    <Clock className=\"w-4 h-4 text-muted-foreground\" />\n                    <span className=\"font-medium\">\n                      {currentUser.lastActive \n                        ? formatDistanceToNow(new Date(currentUser.lastActive), { addSuffix: true })\n                        : \"Never\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Security Settings Card */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Security Settings</CardTitle>\n              <CardDescription>Manage your password and security preferences</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <Button \n                variant=\"outline\" \n                className=\"w-full sm:w-auto\"\n                onClick={() => setIsPasswordModalOpen(true)}\n                data-testid=\"button-change-password\"\n              >\n                Change Password\n              </Button>\n              <Separator />\n              <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                <div>\n                  <p className=\"font-medium\">Two-Factor Authentication</p>\n                  <p className=\"text-sm text-muted-foreground\">Add an extra layer of security</p>\n                </div>\n                <Button variant=\"outline\" size=\"sm\">Enable</Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* Change Password Dialog */}\n      <Dialog open={isPasswordModalOpen} onOpenChange={handleClosePasswordModal}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Change Password</DialogTitle>\n            <DialogDescription>\n              Enter your current password and a new password to change it.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"current-password\">Current Password</Label>\n              <Input\n                id=\"current-password\"\n                type=\"password\"\n                value={passwordForm.currentPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, currentPassword: e.target.value })}\n                placeholder=\"Enter your current password\"\n                data-testid=\"input-current-password\"\n              />\n              {passwordErrors.currentPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.currentPassword as any).message}\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"new-password\">New Password</Label>\n              <Input\n                id=\"new-password\"\n                type=\"password\"\n                value={passwordForm.newPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, newPassword: e.target.value })}\n                placeholder=\"Enter your new password (minimum 8 characters)\"\n                data-testid=\"input-new-password\"\n              />\n              {passwordErrors.newPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.newPassword as any).message}\n                </p>\n              )}\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirm-password\">Confirm New Password</Label>\n              <Input\n                id=\"confirm-password\"\n                type=\"password\"\n                value={passwordForm.confirmPassword}\n                onChange={(e) => setPasswordForm({ ...passwordForm, confirmPassword: e.target.value })}\n                placeholder=\"Confirm your new password\"\n                data-testid=\"input-confirm-password\"\n              />\n              {passwordErrors.confirmPassword && (\n                <p className=\"text-sm text-destructive flex items-center gap-1\">\n                  <AlertCircle className=\"w-3 h-3\" />\n                  {(passwordErrors.confirmPassword as any).message}\n                </p>\n              )}\n            </div>\n          </div>\n          <DialogFooter className=\"flex gap-2 justify-end\">\n            <Button \n              variant=\"outline\" \n              onClick={handleClosePasswordModal}\n              data-testid=\"button-cancel-password\"\n            >\n              Cancel\n            </Button>\n            <Button \n              onClick={handleChangePassword}\n              disabled={passwordMutation.isPending}\n              data-testid=\"button-save-password\"\n            >\n              {passwordMutation.isPending ? \"Saving...\" : \"Change Password\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":20071,"size_tokens":null},"server/api/dashboard.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/stats\", requireAuth, async (req, res) => {\n  try {\n    const [projects, posts, messages, users, comments, reviews] = await Promise.all([\n      storage.getAllProjects(),\n      storage.getAllPosts(),\n      storage.getAllMessages(),\n      storage.getAllUsers(),\n      storage.getAllComments(),\n      storage.getAllReviews()\n    ]);\n\n    const totalViews = projects.reduce((sum, p) => sum + (p.views || 0), 0) +\n                      posts.reduce((sum, p) => sum + (p.views || 0), 0);\n\n    res.json({\n      totalProjects: projects.length,\n      publishedProjects: projects.filter(p => p.status === \"Published\").length,\n      totalPosts: posts.length,\n      publishedPosts: posts.filter(p => p.status === \"Published\").length,\n      totalMessages: messages.length,\n      unreadMessages: messages.filter(m => !m.read).length,\n      totalUsers: users.length,\n      activeUsers: users.filter(u => u.status === \"Active\").length,\n      totalViews,\n      totalComments: comments.length,\n      pendingComments: comments.filter(c => c.status === \"Pending\").length,\n      totalReviews: reviews.length,\n      pendingReviews: reviews.filter(r => r.status === \"Pending\").length\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1441,"size_tokens":null},"client/src/pages/admin/security/APIKeys.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Plus, Copy, Eye, EyeOff, Trash, Calendar } from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminAPIKeys() {\n  const [visibility, setVisibility] = useState<Record<number, boolean>>({});\n\n  const keys = [\n    { id: 1, name: \"Production API Key\", key: \"sk_live_abcd1234efgh5678ijkl\", created: \"Mar 15, 2024\", lastUsed: \"Today at 2:30 PM\", status: \"Active\" },\n    { id: 2, name: \"Development Key\", key: \"sk_test_xyz9876543210abcd\", created: \"Mar 10, 2024\", lastUsed: \"Mar 19 at 10:45 AM\", status: \"Active\" },\n    { id: 3, name: \"Staging Environment\", key: \"sk_stage_abcdefg123456789\", created: \"Feb 28, 2024\", lastUsed: \"Never\", status: \"Inactive\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">API Keys</h1>\n            <p className=\"text-muted-foreground\">Manage API authentication tokens</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Create New Key\n          </Button>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Active API Keys</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {keys.map((key) => (\n              <div key={key.id} className=\"border border-border rounded-lg p-4 hover:bg-muted/50 transition-colors group\">\n                <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-3\">\n                  <div>\n                    <h3 className=\"font-bold\">{key.name}</h3>\n                    <Badge variant={key.status === \"Active\" ? \"default\" : \"secondary\"}>{key.status}</Badge>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                      {visibility[key.id] ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                      {visibility[key.id] ? \"Hide\" : \"Show\"}\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                      <Copy className=\"w-4 h-4\" /> Copy\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" className=\"gap-2 text-destructive\">\n                      <Trash className=\"w-4 h-4\" /> Delete\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"bg-muted/50 p-3 rounded font-mono text-sm break-all mb-3\">\n                  {visibility[key.id] ? key.key : \"â€¢\".repeat(key.key.length)}\n                </div>\n                <div className=\"flex flex-col sm:flex-row gap-4 text-xs text-muted-foreground\">\n                  <div className=\"flex items-center gap-1\">\n                    <Calendar className=\"w-3 h-3\" /> Created: {key.created}\n                  </div>\n                  <div>Last Used: {key.lastUsed}</div>\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>API Key Security</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>API keys are stored securely and never displayed again after creation</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>Rotate keys regularly for enhanced security</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <div className=\"w-2 h-2 bg-yellow-500 rounded-full mt-1 flex-shrink-0\" />\n              <p>Never commit API keys to version control</p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4272,"size_tokens":null},"client/src/pages/admin/security/Webhooks.tsx":{"content":"// This file has been removed as part of cleanup\nexport default function AdminWebhooks() {\n  return null;\n}","path":null,"size_bytes":107,"size_tokens":null},"client/src/pages/admin/content/projects/ProjectsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Eye, Star, ExternalLink, Github, Image as ImageIcon, X, Loader2 } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ProjectEditor } from \"@/components/admin/project-editor\";\n\ninterface Project {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  shortDescription: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: string;\n  views: number;\n  featured: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\nconst emptyProject = {\n  title: \"\",\n  category: \"full-stack\",\n  image: \"\",\n  shortDescription: \"\",\n  description: \"\",\n  tech: [] as string[],\n  link: \"\",\n  github: \"\",\n  status: \"Draft\",\n  featured: false,\n};\n\nconst defaultCategory = \"full-stack\";\n\nexport default function AdminProjectsEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProject, setEditingProject] = useState<Project | null>(null);\n  const [formData, setFormData] = useState(emptyProject);\n  const [techInput, setTechInput] = useState(\"\");\n  const [filter, setFilter] = useState(\"all\");\n  const [uploadingImage, setUploadingImage] = useState(false);\n\n  const { data: projects = [], isLoading } = useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: () => api.getProjects(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createProject(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<typeof formData> }) => \n      api.updateProject(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteProject(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleFeaturedMutation = useMutation({\n    mutationFn: ({ id, featured }: { id: number; featured: boolean }) =>\n      api.updateProject(id, { featured }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: ({ id, status }: { id: number; status: string }) =>\n      api.updateProject(id, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(emptyProject);\n    setEditingProject(null);\n    setTechInput(\"\");\n  };\n\n  const openCreateDialog = () => {\n    resetForm();\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (project: Project) => {\n    setEditingProject(project);\n    setFormData({\n      title: project.title,\n      category: project.category,\n      image: project.image || \"\",\n      shortDescription: project.shortDescription || \"\",\n      description: project.description || \"\",\n      tech: project.tech || [],\n      link: project.link || \"\",\n      github: project.github || \"\",\n      status: project.status,\n      featured: project.featured,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Error\", description: \"Title is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingProject) {\n      updateMutation.mutate({ id: editingProject.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const addTech = () => {\n    if (techInput.trim() && !formData.tech.includes(techInput.trim())) {\n      setFormData({ ...formData, tech: [...formData.tech, techInput.trim()] });\n      setTechInput(\"\");\n    }\n  };\n\n  const removeTech = (tech: string) => {\n    setFormData({ ...formData, tech: formData.tech.filter(t => t !== tech) });\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({ title: \"Error\", description: \"Image size must be less than 5MB\", variant: \"destructive\" });\n      return;\n    }\n\n    setUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const base64 = reader.result as string;\n        try {\n          const result = await api.uploadImage(base64, file.name);\n          setFormData({ ...formData, image: result.url });\n          toast({ title: \"Success\", description: \"Image uploaded successfully\" });\n        } catch (error: any) {\n          toast({ title: \"Error\", description: error.message || \"Failed to upload image\", variant: \"destructive\" });\n        } finally {\n          setUploadingImage(false);\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      setUploadingImage(false);\n      toast({ title: \"Error\", description: \"Failed to read image file\", variant: \"destructive\" });\n    }\n  };\n\n  const filteredProjects = projects.filter((project: Project) => {\n    if (filter === \"all\") return true;\n    if (filter === \"featured\") return project.featured;\n    if (filter === \"published\") return project.status === \"Published\";\n    if (filter === \"draft\") return project.status === \"Draft\";\n    return project.category === filter;\n  });\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"page-title\">Projects</h1>\n            <p className=\"text-muted-foreground\">Manage your portfolio projects</p>\n          </div>\n          <Button onClick={openCreateDialog} data-testid=\"button-create-project\">\n            <Plus className=\"w-4 h-4 mr-2\" /> New Project\n          </Button>\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          {[\"all\", \"featured\", \"published\", \"draft\", ...categories.map(c => c.slug)].map((f) => (\n            <Button\n              key={f}\n              variant={filter === f ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setFilter(f)}\n              data-testid={`filter-${f}`}\n            >\n              {f === \"all\" ? \"All\" : \n               f === \"featured\" ? \"Featured\" :\n               f === \"published\" ? \"Published\" :\n               f === \"draft\" ? \"Draft\" :\n               categories.find(c => c.slug === f)?.name || f}\n            </Button>\n          ))}\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No projects found</p>\n              <Button onClick={openCreateDialog}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create your first project\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project: Project) => (\n              <Card key={project.id} className=\"overflow-hidden group\" data-testid={`card-project-${project.id}`}>\n                <div className=\"aspect-video relative bg-muted overflow-hidden\">\n                  {project.image ? (\n                    <img\n                      src={project.image}\n                      alt={project.title}\n                      className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <ImageIcon className=\"w-12 h-12 text-muted-foreground/50\" />\n                    </div>\n                  )}\n                  <div className=\"absolute top-2 left-2 flex gap-1\">\n                    <Badge variant={project.status === \"Published\" ? \"default\" : \"secondary\"}>\n                      {project.status}\n                    </Badge>\n                    {project.featured && (\n                      <Badge variant=\"default\" className=\"bg-yellow-500\">\n                        <Star className=\"w-3 h-3 mr-1\" /> Featured\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-lg line-clamp-1\">{project.title}</CardTitle>\n                  <CardDescription className=\"line-clamp-2\">\n                    {project.description || \"No description\"}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex flex-wrap gap-1\">\n                    {(project.tech || []).slice(0, 4).map((tech) => (\n                      <Badge key={tech} variant=\"outline\" className=\"text-xs\">\n                        {tech}\n                      </Badge>\n                    ))}\n                    {(project.tech || []).length > 4 && (\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        +{project.tech.length - 4}\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                    <span className=\"flex items-center gap-1\">\n                      <Eye className=\"w-4 h-4\" /> {project.views}\n                    </span>\n                    <span>{categories.find(c => c.slug === project.category)?.name || project.category}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between pt-2 border-t\">\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={project.featured}\n                        onCheckedChange={(checked) => \n                          toggleFeaturedMutation.mutate({ id: project.id, featured: checked })\n                        }\n                        data-testid={`switch-featured-${project.id}`}\n                      />\n                      <span className=\"text-sm text-muted-foreground\">Featured</span>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      {project.link && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.link} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <ExternalLink className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      {project.github && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.github} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <Github className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      <Button \n                        size=\"icon\" \n                        variant=\"ghost\" \n                        onClick={() => openEditDialog(project)}\n                        data-testid={`button-edit-${project.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <AlertDialog>\n                        <AlertDialogTrigger asChild>\n                          <Button size=\"icon\" variant=\"ghost\" data-testid={`button-delete-${project.id}`}>\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </AlertDialogTrigger>\n                        <AlertDialogContent>\n                          <AlertDialogHeader>\n                            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n                            <AlertDialogDescription>\n                              Are you sure you want to delete \"{project.title}\"? This action cannot be undone.\n                            </AlertDialogDescription>\n                          </AlertDialogHeader>\n                          <AlertDialogFooter>\n                            <AlertDialogCancel>Cancel</AlertDialogCancel>\n                            <AlertDialogAction\n                              onClick={() => deleteMutation.mutate(project.id)}\n                              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                            >\n                              Delete\n                            </AlertDialogAction>\n                          </AlertDialogFooter>\n                        </AlertDialogContent>\n                      </AlertDialog>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{editingProject ? \"Edit Project\" : \"Create New Project\"}</DialogTitle>\n            <DialogDescription>\n              {editingProject ? \"Update your project details\" : \"Add a new project to your portfolio\"}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-6 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                placeholder=\"Project title\"\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-category\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value) => setFormData({ ...formData, status: value })}\n                >\n                  <SelectTrigger data-testid=\"select-status\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"shortDescription\">Short Description</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                A brief summary shown in featured project cards (max 150 characters)\n              </p>\n              <Input\n                id=\"shortDescription\"\n                value={formData.shortDescription}\n                onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}\n                placeholder=\"Brief project summary for featured display...\"\n                maxLength={150}\n                data-testid=\"input-short-description\"\n              />\n              <p className=\"text-xs text-muted-foreground text-right\">\n                {formData.shortDescription.length}/150\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Full Description</Label>\n              <p className=\"text-sm text-muted-foreground mb-3\">\n                Add detailed information about your project with rich formatting support\n              </p>\n              <ProjectEditor\n                value={formData.description}\n                onChange={(html) => setFormData({ ...formData, description: html })}\n                placeholder=\"Describe your project with details, features, and technologies...\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Project Image</Label>\n              <div className=\"flex items-center gap-4\">\n                {formData.image ? (\n                  <div className=\"relative w-32 h-20 rounded-lg overflow-hidden bg-muted\">\n                    <img src={formData.image} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n                    <Button\n                      size=\"icon\"\n                      variant=\"destructive\"\n                      className=\"absolute top-1 right-1 h-6 w-6\"\n                      onClick={() => setFormData({ ...formData, image: \"\" })}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"w-32 h-20 rounded-lg bg-muted flex items-center justify-center\">\n                    <ImageIcon className=\"w-8 h-8 text-muted-foreground\" />\n                  </div>\n                )}\n                <div className=\"flex-1\">\n                  <Input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleImageUpload}\n                    disabled={uploadingImage}\n                    data-testid=\"input-image\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Max 5MB. Recommended: 1200x630px</p>\n                </div>\n                {uploadingImage && <Loader2 className=\"w-5 h-5 animate-spin\" />}\n              </div>\n              <div className=\"flex items-center gap-2 mt-2\">\n                <span className=\"text-sm text-muted-foreground\">Or enter URL:</span>\n                <Input\n                  placeholder=\"https://example.com/image.jpg\"\n                  value={formData.image}\n                  onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                  className=\"flex-1\"\n                  data-testid=\"input-image-url\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Technologies</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  value={techInput}\n                  onChange={(e) => setTechInput(e.target.value)}\n                  placeholder=\"Add technology (e.g., React)\"\n                  onKeyPress={(e) => e.key === \"Enter\" && (e.preventDefault(), addTech())}\n                  data-testid=\"input-tech\"\n                />\n                <Button type=\"button\" onClick={addTech} variant=\"outline\">\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.tech.map((tech) => (\n                  <Badge key={tech} variant=\"secondary\" className=\"gap-1\">\n                    {tech}\n                    <button onClick={() => removeTech(tech)} className=\"ml-1 hover:text-destructive\">\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"link\">Live URL</Label>\n                <Input\n                  id=\"link\"\n                  value={formData.link}\n                  onChange={(e) => setFormData({ ...formData, link: e.target.value })}\n                  placeholder=\"https://example.com\"\n                  data-testid=\"input-link\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"github\">GitHub URL</Label>\n                <Input\n                  id=\"github\"\n                  value={formData.github}\n                  onChange={(e) => setFormData({ ...formData, github: e.target.value })}\n                  placeholder=\"https://github.com/...\"\n                  data-testid=\"input-github\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Switch\n                id=\"featured\"\n                checked={formData.featured}\n                onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n                data-testid=\"switch-featured-form\"\n              />\n              <Label htmlFor=\"featured\">Featured on homepage</Label>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-submit\">\n              {isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              {editingProject ? \"Update Project\" : \"Create Project\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":24572,"size_tokens":null},"client/src/pages/admin/pages/Pages.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useState, useEffect } from \"react\";\nimport { \n  Plus, \n  Search, \n  Edit,\n  Trash,\n  FileText,\n  Eye,\n  Loader2,\n  BookOpen,\n  Layers,\n  Home,\n  User,\n  Briefcase,\n  MessageSquare,\n  Star,\n  Mail,\n  Save,\n  Settings,\n  GripVertical,\n  Image as ImageIcon\n} from \"lucide-react\";\nimport { type Page, type HomepageSection } from \"@shared/schema\";\nimport { PageEditor } from \"@/components/admin/page-editor\";\n\ninterface SiteSettings {\n  siteTitle?: string;\n  tagline?: string;\n  contactEmail?: string;\n  heroTitle?: string;\n  heroSubtitle?: string;\n  heroDescription?: string;\n  heroStatus?: string;\n  heroCTA?: string;\n  aboutTitle?: string;\n  aboutSubtitle?: string;\n  aboutDescription?: string;\n  aboutDescription2?: string;\n  aboutName?: string;\n  aboutEmail?: string;\n  aboutLocation?: string;\n  aboutFreelance?: string;\n  aboutImage?: string;\n  cvFileUrl?: string;\n  contactTitle?: string;\n  contactSubtitle?: string;\n  contactPhone?: string;\n  contactAddress?: string;\n  socialFacebook?: string;\n  socialTwitter?: string;\n  socialInstagram?: string;\n  socialLinkedin?: string;\n  socialGithub?: string;\n  socialYoutube?: string;\n  footerText?: string;\n  footerCopyright?: string;\n  [key: string]: any;\n}\n\nconst sectionConfig = [\n  { \n    name: \"hero\", \n    icon: Home, \n    label: \"Hero Section\",\n    description: \"Main banner with title, subtitle and call-to-action\",\n    fields: [\"heroTitle\", \"heroSubtitle\", \"heroDescription\", \"heroStatus\", \"heroCTA\"]\n  },\n  { \n    name: \"about\", \n    icon: User, \n    label: \"About Section\",\n    description: \"Personal information and bio\",\n    fields: [\"aboutTitle\", \"aboutSubtitle\", \"aboutDescription\", \"aboutDescription2\", \"aboutName\", \"aboutLocation\", \"aboutFreelance\", \"aboutImage\", \"cvFileUrl\"]\n  },\n  { \n    name: \"skills\", \n    icon: Settings, \n    label: \"Skills Section\",\n    description: \"Technical skills and proficiencies\",\n    fields: []\n  },\n  { \n    name: \"services\", \n    icon: Briefcase, \n    label: \"Services Section\",\n    description: \"Services offered to clients\",\n    fields: []\n  },\n  { \n    name: \"projects\", \n    icon: Layers, \n    label: \"Projects Section\",\n    description: \"Portfolio of completed projects\",\n    fields: []\n  },\n  { \n    name: \"testimonials\", \n    icon: Star, \n    label: \"Testimonials Section\",\n    description: \"Client reviews and feedback\",\n    fields: []\n  },\n  { \n    name: \"blog\", \n    icon: BookOpen, \n    label: \"Blog Section\",\n    description: \"Latest blog posts\",\n    fields: []\n  },\n  { \n    name: \"contact\", \n    icon: Mail, \n    label: \"Contact Section\",\n    description: \"Contact form and information\",\n    fields: [\"contactTitle\", \"contactSubtitle\", \"contactPhone\", \"contactAddress\"]\n  },\n];\n\nconst fieldLabels: Record<string, string> = {\n  heroTitle: \"Hero Title\",\n  heroSubtitle: \"Hero Subtitle\", \n  heroDescription: \"Hero Description\",\n  heroStatus: \"Status Text\",\n  heroCTA: \"Call-to-Action Button\",\n  aboutTitle: \"About Title\",\n  aboutSubtitle: \"About Subtitle\",\n  aboutDescription: \"About Description\",\n  aboutDescription2: \"Additional Description\",\n  aboutName: \"Your Name\",\n  aboutLocation: \"Location\",\n  aboutFreelance: \"Availability Status\",\n  aboutImage: \"Profile Image URL\",\n  cvFileUrl: \"CV/Resume URL\",\n  contactTitle: \"Contact Title\",\n  contactSubtitle: \"Contact Subtitle\",\n  contactPhone: \"Phone Number\",\n  contactAddress: \"Address\",\n};\n\nexport default function AdminPages() {\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState(\"homepage\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [editorOpen, setEditorOpen] = useState(false);\n  const [selectedPage, setSelectedPage] = useState<Page | undefined>();\n  const [editingSection, setEditingSection] = useState<string | null>(null);\n  const [localSettings, setLocalSettings] = useState<SiteSettings>({});\n\n  const { data: pages = [], isLoading: pagesLoading, refetch: refetchPages } = useQuery<Page[]>({\n    queryKey: [\"/api/pages\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/pages\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch pages\");\n      return res.json();\n    },\n  });\n\n  const { data: posts = [], isLoading: postsLoading } = useQuery({\n    queryKey: [\"/api/posts\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/posts\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch posts\");\n      return res.json();\n    },\n  });\n\n  const { data: projects = [], isLoading: projectsLoading } = useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/projects\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch projects\");\n      return res.json();\n    },\n  });\n\n  const { data: sections = [], isLoading: sectionsLoading, refetch: refetchSections } = useQuery<HomepageSection[]>({\n    queryKey: [\"/api/homepage/sections\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/homepage/sections\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch sections\");\n      return res.json();\n    },\n  });\n\n  const { data: settings, isLoading: settingsLoading, refetch: refetchSettings } = useQuery<SiteSettings>({\n    queryKey: [\"/api/settings\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/settings\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch settings\");\n      return res.json();\n    },\n  });\n\n  useEffect(() => {\n    if (settings) {\n      setLocalSettings(settings);\n    }\n  }, [settings]);\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await fetch(`/api/pages/${id}`, {\n        method: \"DELETE\",\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Failed to delete page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchPages();\n      toast({ title: \"Success\", description: \"Page deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: number; status: string }) => {\n      const res = await fetch(`/api/pages/${id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ status }),\n      });\n      if (!res.ok) throw new Error(\"Failed to update page\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchPages();\n      toast({ title: \"Success\", description: \"Page status updated\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleSectionMutation = useMutation({\n    mutationFn: async ({ name, visible }: { name: string; visible: boolean }) => {\n      const res = await fetch(`/api/homepage/sections/${name}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ visible }),\n      });\n      if (!res.ok) throw new Error(\"Failed to update section visibility\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchSections();\n      queryClient.invalidateQueries({ queryKey: [\"/api/homepage/sections\"] });\n      toast({ title: \"Success\", description: \"Section visibility updated\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (updates: Record<string, any>) => {\n      const res = await fetch(\"/api/settings\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(updates),\n      });\n      if (!res.ok) throw new Error(\"Failed to update settings\");\n      return res.json();\n    },\n    onSuccess: () => {\n      refetchSettings();\n      queryClient.invalidateQueries({ queryKey: [\"/api/settings\"] });\n      toast({ title: \"Success\", description: \"Content updated successfully\" });\n      setEditingSection(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleDelete = (id: number, title: string) => {\n    if (confirm(`Are you sure you want to delete \"${title}\"?`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const toggleStatus = (id: number, currentStatus: string) => {\n    const newStatus = currentStatus === \"Published\" ? \"Draft\" : \"Published\";\n    updateStatusMutation.mutate({ id, status: newStatus });\n  };\n\n  const startEdit = (id: number) => {\n    const page = pages.find(p => p.id === id);\n    if (page) {\n      setSelectedPage(page);\n      setEditorOpen(true);\n    }\n  };\n\n  const handleCreatePage = () => {\n    setSelectedPage(undefined);\n    setEditorOpen(true);\n  };\n\n  const handleSaveSection = (sectionName: string) => {\n    const section = sectionConfig.find(s => s.name === sectionName);\n    if (!section) return;\n\n    const updates: Record<string, string> = {};\n    section.fields.forEach(field => {\n      const value = localSettings[field];\n      if (value !== undefined && value !== null) {\n        const trimmedValue = typeof value === 'string' ? value.trim() : value;\n        if (trimmedValue !== '') {\n          updates[field] = trimmedValue;\n        }\n      }\n    });\n\n    if (Object.keys(updates).length === 0) {\n      toast({ title: \"No changes\", description: \"Please fill in at least one field\", variant: \"default\" });\n      return;\n    }\n\n    updateSettingsMutation.mutate(updates);\n  };\n\n  const updateLocalSetting = (key: string, value: string) => {\n    setLocalSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const filteredPages = pages.filter(page =>\n    page.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    page.slug.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const filteredPosts = posts.filter((post: any) =>\n    post.title.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const filteredProjects = projects.filter((project: any) =>\n    project.title.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const getSectionVisibility = (sectionName: string) => {\n    const section = sections.find(s => s.name === sectionName);\n    return section?.visible ?? true;\n  };\n\n  const isLoading = pagesLoading || postsLoading || projectsLoading || sectionsLoading || settingsLoading;\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <PageEditor \n        page={selectedPage}\n        open={editorOpen}\n        onOpenChange={setEditorOpen}\n      />\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Content Management</h1>\n            <p className=\"text-muted-foreground\">Manage homepage sections, pages, and content</p>\n          </div>\n          {activeTab === \"pages\" && (\n            <Button \n              className=\"bg-primary\" \n              data-testid=\"button-create-page\"\n              onClick={handleCreatePage}\n            >\n              <Plus className=\"w-4 h-4 mr-2\" /> New Page\n            </Button>\n          )}\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"homepage\" data-testid=\"tab-homepage\">\n              <Home className=\"w-4 h-4 mr-2\" />\n              Homepage\n            </TabsTrigger>\n            <TabsTrigger value=\"pages\" data-testid=\"tab-pages\">\n              <FileText className=\"w-4 h-4 mr-2\" />\n              Pages\n            </TabsTrigger>\n            <TabsTrigger value=\"blog\" data-testid=\"tab-blog\">\n              <BookOpen className=\"w-4 h-4 mr-2\" />\n              Blog Posts\n            </TabsTrigger>\n            <TabsTrigger value=\"projects\" data-testid=\"tab-projects\">\n              <Layers className=\"w-4 h-4 mr-2\" />\n              Projects\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Homepage Content Management Tab */}\n          <TabsContent value=\"homepage\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Home className=\"w-5 h-5\" />\n                  Homepage Sections\n                </CardTitle>\n                <CardDescription>\n                  Manage visibility and content of each section on your homepage\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Accordion type=\"single\" collapsible className=\"w-full\">\n                  {sectionConfig.map((section) => {\n                    const Icon = section.icon;\n                    const isVisible = getSectionVisibility(section.name);\n                    const hasContent = section.fields.length > 0;\n                    \n                    return (\n                      <AccordionItem key={section.name} value={section.name}>\n                        <AccordionTrigger className=\"hover:no-underline\">\n                          <div className=\"flex items-center justify-between w-full pr-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className={`p-2 rounded-lg ${isVisible ? 'bg-primary/10 text-primary' : 'bg-muted text-muted-foreground'}`}>\n                                <Icon className=\"w-4 h-4\" />\n                              </div>\n                              <div className=\"text-left\">\n                                <p className=\"font-medium\">{section.label}</p>\n                                <p className=\"text-xs text-muted-foreground\">{section.description}</p>\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-3\" onClick={(e) => e.stopPropagation()}>\n                              <Badge variant={isVisible ? \"default\" : \"secondary\"} className=\"text-xs\">\n                                {isVisible ? \"Visible\" : \"Hidden\"}\n                              </Badge>\n                              <Switch\n                                checked={isVisible}\n                                onCheckedChange={(checked) => \n                                  toggleSectionMutation.mutate({ \n                                    name: section.name, \n                                    visible: checked \n                                  })\n                                }\n                                disabled={toggleSectionMutation.isPending}\n                                data-testid={`switch-section-${section.name}`}\n                              />\n                            </div>\n                          </div>\n                        </AccordionTrigger>\n                        <AccordionContent>\n                          <div className=\"pt-4 space-y-4\">\n                            {hasContent ? (\n                              <>\n                                <div className=\"grid gap-4\">\n                                  {section.fields.map(field => (\n                                    <div key={field} className=\"space-y-2\">\n                                      <Label htmlFor={field}>{fieldLabels[field] || field}</Label>\n                                      {field.includes(\"Description\") ? (\n                                        <Textarea\n                                          id={field}\n                                          value={localSettings[field] || \"\"}\n                                          onChange={(e) => updateLocalSetting(field, e.target.value)}\n                                          rows={3}\n                                          data-testid={`input-${field}`}\n                                        />\n                                      ) : (\n                                        <Input\n                                          id={field}\n                                          value={localSettings[field] || \"\"}\n                                          onChange={(e) => updateLocalSetting(field, e.target.value)}\n                                          data-testid={`input-${field}`}\n                                        />\n                                      )}\n                                    </div>\n                                  ))}\n                                </div>\n                                <div className=\"flex justify-end pt-4\">\n                                  <Button \n                                    onClick={() => handleSaveSection(section.name)}\n                                    disabled={updateSettingsMutation.isPending}\n                                    data-testid={`button-save-${section.name}`}\n                                  >\n                                    {updateSettingsMutation.isPending ? (\n                                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    ) : (\n                                      <Save className=\"w-4 h-4 mr-2\" />\n                                    )}\n                                    Save Changes\n                                  </Button>\n                                </div>\n                              </>\n                            ) : (\n                              <div className=\"text-center py-6 text-muted-foreground\">\n                                <p className=\"text-sm mb-2\">Content for this section is managed separately.</p>\n                                <Button variant=\"outline\" size=\"sm\" asChild>\n                                  <a href={`/admin/${section.name}`}>\n                                    <Settings className=\"w-4 h-4 mr-2\" />\n                                    Manage {section.label.replace(\" Section\", \"\")}\n                                  </a>\n                                </Button>\n                              </div>\n                            )}\n                          </div>\n                        </AccordionContent>\n                      </AccordionItem>\n                    );\n                  })}\n                </Accordion>\n              </CardContent>\n            </Card>\n\n            {/* Quick Stats */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-primary/10 rounded-lg\">\n                      <Eye className=\"w-4 h-4 text-primary\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{sections.filter(s => s.visible).length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Visible Sections</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-blue-500/10 rounded-lg\">\n                      <Layers className=\"w-4 h-4 text-blue-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{projects.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Total Projects</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-green-500/10 rounded-lg\">\n                      <BookOpen className=\"w-4 h-4 text-green-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{posts.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Blog Posts</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-purple-500/10 rounded-lg\">\n                      <FileText className=\"w-4 h-4 text-purple-500\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">{pages.length}</p>\n                      <p className=\"text-xs text-muted-foreground\">Static Pages</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Pages Tab */}\n          <TabsContent value=\"pages\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search pages...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-pages\"\n                />\n              </div>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredPages.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <FileText className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No pages found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Slug</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Updated</TableHead>\n                      <TableHead className=\"text-right\">Actions</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredPages.map((page) => (\n                      <TableRow key={page.id}>\n                        <TableCell>\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-8 h-8 bg-primary/10 rounded flex items-center justify-center text-primary\">\n                              <FileText size={16} />\n                            </div>\n                            <span className=\"font-medium\">{page.title}</span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <code className=\"text-sm bg-muted px-2 py-1 rounded\">/{page.slug}</code>\n                        </TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={page.status === \"Published\" ? \"default\" : \"secondary\"}\n                            className=\"cursor-pointer\"\n                            onClick={() => toggleStatus(page.id, page.status)}\n                            data-testid={`badge-status-${page.id}`}\n                          >\n                            {page.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {page.views}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {page.updatedAt ? new Date(page.updatedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <div className=\"flex justify-end gap-2\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              data-testid={`button-edit-page-${page.id}`}\n                              onClick={() => startEdit(page.id)}\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"text-destructive\"\n                              onClick={() => handleDelete(page.id, page.title)}\n                              disabled={deleteMutation.isPending}\n                              data-testid={`button-delete-page-${page.id}`}\n                            >\n                              {deleteMutation.isPending ? (\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                              ) : (\n                                <Trash className=\"w-4 h-4\" />\n                              )}\n                            </Button>\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n\n          {/* Blog Posts Tab */}\n          <TabsContent value=\"blog\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search blog posts...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-posts\"\n                />\n              </div>\n              <Button asChild>\n                <a href=\"/admin/posts\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Manage Posts\n                </a>\n              </Button>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredPosts.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <BookOpen className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No blog posts found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Category</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Published</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredPosts.map((post: any) => (\n                      <TableRow key={post.id}>\n                        <TableCell>\n                          <span className=\"font-medium\">{post.title}</span>\n                        </TableCell>\n                        <TableCell>{post.category}</TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={post.status === \"Published\" ? \"default\" : \"secondary\"}\n                            data-testid={`badge-post-status-${post.id}`}\n                          >\n                            {post.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {post.views || 0}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {post.publishedAt ? new Date(post.publishedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n\n          {/* Projects Tab */}\n          <TabsContent value=\"projects\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 bg-card p-4 rounded-lg border border-border\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search projects...\"\n                  className=\"pl-9\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  data-testid=\"input-search-projects\"\n                />\n              </div>\n              <Button asChild>\n                <a href=\"/admin/projects\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Manage Projects\n                </a>\n              </Button>\n            </div>\n\n            <div className=\"bg-card rounded-lg border border-border overflow-hidden\">\n              {filteredProjects.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <Layers className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n                  <p>No projects found.</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Title</TableHead>\n                      <TableHead>Category</TableHead>\n                      <TableHead>Status</TableHead>\n                      <TableHead>Views</TableHead>\n                      <TableHead>Updated</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {filteredProjects.map((project: any) => (\n                      <TableRow key={project.id}>\n                        <TableCell>\n                          <span className=\"font-medium\">{project.title}</span>\n                        </TableCell>\n                        <TableCell>{project.category}</TableCell>\n                        <TableCell>\n                          <Badge\n                            variant={project.status === \"Published\" ? \"default\" : \"secondary\"}\n                            data-testid={`badge-project-status-${project.id}`}\n                          >\n                            {project.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4 text-muted-foreground\" />\n                            {project.views || 0}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {project.updatedAt ? new Date(project.updatedAt).toLocaleDateString() : \"N/A\"}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":33114,"size_tokens":null},"client/src/pages/admin/content/posts/Posts.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Pagination } from \"@/components/admin/pagination\";\nimport { useState, useRef } from \"react\";\nimport { Plus, Eye, Edit, Trash, Calendar, Save, X, Loader2 } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport type { Post, InsertPost } from \"@shared/schema\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\ninterface PostFormData {\n  title: string;\n  slug: string;\n  content: string;\n  excerpt: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  tags: string[];\n  featuredImage: string | null;\n  publishedAt: Date | null;\n}\n\nconst getDefaultFormData = (): PostFormData => ({\n  title: \"\",\n  slug: \"\",\n  content: \"\",\n  excerpt: \"\",\n  category: \"\",\n  author: \"Loi Developer\",\n  status: \"Draft\",\n  tags: [],\n  featuredImage: null,\n  publishedAt: null,\n});\n\nfunction generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/(^-|-$)/g, \"\");\n}\n\nexport default function AdminPostsEnhanced() {\n  const queryClient = useQueryClient();\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const [uploading, setUploading] = useState(false);\n\n  const handleImageUpload = async (file: File, setFeaturedImage: (url: string) => void) => {\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await fetch(\"/api/upload/file\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n      if (!res.ok) throw new Error(\"Upload failed\");\n      const data = await res.json();\n      setFeaturedImage(data.url);\n    } catch (error: any) {\n      console.error(\"Upload failed:\", error);\n    } finally {\n      setUploading(false);\n    }\n  };\n  const { data: posts = [], isLoading } = useQuery({\n    queryKey: [\"admin-posts\"],\n    queryFn: () => api.getPosts(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=post\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: InsertPost) => api.createPost(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<Post> }) => \n      api.updatePost(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deletePost(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n    },\n  });\n\n  const addPost = async (data: InsertPost) => {\n    await createMutation.mutateAsync(data);\n  };\n\n  const updatePost = async (id: number, data: Partial<Post>) => {\n    await updateMutation.mutateAsync({ id, data });\n  };\n\n  const deletePost = async (id: number) => {\n    await deleteMutation.mutateAsync(id);\n  };\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"published\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [editingPost, setEditingPost] = useState<number | null>(null);\n  const [postToDelete, setPostToDelete] = useState<number | null>(null);\n  const [formData, setFormData] = useState<PostFormData>(getDefaultFormData());\n  const [tagsInput, setTagsInput] = useState(\"\");\n\n  const postsPerPage = 5;\n\n  const filteredPosts = posts.filter((p) => {\n    if (activeTab === \"published\") return p.status === \"Published\";\n    if (activeTab === \"draft\") return p.status === \"Draft\";\n    if (activeTab === \"archived\") return p.status === \"Archived\";\n    return true;\n  });\n\n  const totalPages = Math.ceil(filteredPosts.length / postsPerPage);\n  const paginatedPosts = filteredPosts.slice(\n    (currentPage - 1) * postsPerPage,\n    currentPage * postsPerPage\n  );\n\n  const handleOpenDialog = (postId?: number) => {\n    if (postId) {\n      const post = posts.find((p) => p.id === postId);\n      if (post) {\n        setEditingPost(postId);\n        let parsedPublishedAt: Date | null = null;\n        if (post.publishedAt) {\n          const date = new Date(post.publishedAt);\n          if (!isNaN(date.getTime())) {\n            parsedPublishedAt = date;\n          }\n        }\n        setFormData({\n          title: post.title,\n          slug: post.slug,\n          content: post.content || \"\",\n          excerpt: post.excerpt || \"\",\n          category: post.category,\n          author: post.author,\n          status: post.status,\n          tags: post.tags || [],\n          featuredImage: post.featuredImage,\n          publishedAt: parsedPublishedAt,\n        });\n        setTagsInput(post.tags?.join(\", \") || \"\");\n      }\n    } else {\n      setEditingPost(null);\n      setFormData(getDefaultFormData());\n      setTagsInput(\"\");\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPost(null);\n    setFormData(getDefaultFormData());\n    setTagsInput(\"\");\n  };\n\n  const handleTitleChange = (title: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      title,\n      slug: editingPost ? prev.slug : generateSlug(title),\n    }));\n  };\n\n  const validateForm = (): string | null => {\n    if (!formData.title.trim()) return \"Title is required\";\n    if (!formData.content.trim()) return \"Content is required\";\n    if (!formData.category.trim()) return \"Category is required\";\n    if (!formData.author.trim()) return \"Author is required\";\n    return null;\n  };\n\n  const [formError, setFormError] = useState<string | null>(null);\n\n  const isSaving = createMutation.isPending || updateMutation.isPending;\n\n  const getPublishedAtForSubmit = (): string | null => {\n    if (formData.status !== \"Published\") {\n      return null;\n    }\n\n    if (formData.publishedAt instanceof Date && !isNaN(formData.publishedAt.getTime())) {\n      return formData.publishedAt.toISOString();\n    }\n\n    if (formData.publishedAt && typeof formData.publishedAt === 'string') {\n      const date = new Date(formData.publishedAt);\n      if (!isNaN(date.getTime())) {\n        return date.toISOString();\n      }\n    }\n\n    return new Date().toISOString();\n  };\n\n  const handleSubmit = async () => {\n    const error = validateForm();\n    if (error) {\n      setFormError(error);\n      return;\n    }\n    setFormError(null);\n\n    try {\n      const tags = tagsInput\n        .split(\",\")\n        .map((t) => t.trim())\n        .filter(Boolean);\n\n      const publishedAt = getPublishedAtForSubmit();\n\n      const postData = {\n        title: formData.title.trim(),\n        slug: formData.slug.trim() || generateSlug(formData.title),\n        content: formData.content.trim(),\n        excerpt: formData.excerpt.trim() || null,\n        category: formData.category,\n        author: formData.author.trim(),\n        status: formData.status,\n        tags,\n        featuredImage: formData.featuredImage,\n        publishedAt,\n      };\n\n      if (editingPost) {\n        await updatePost(editingPost, postData as any);\n      } else {\n        await addPost(postData as any);\n      }\n      handleCloseDialog();\n    } catch (error: any) {\n      console.error(\"Error saving post:\", error);\n      setFormError(error.message || \"Failed to save post\");\n    }\n  };\n\n  const handleDeleteClick = (id: number) => {\n    setPostToDelete(id);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const handleConfirmDelete = async () => {\n    if (postToDelete) {\n      await deletePost(postToDelete);\n      setPostToDelete(null);\n    }\n    setIsDeleteDialogOpen(false);\n  };\n\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const bgImages = ['/images/blog/bg-1.png', '/images/blog/bg-2.png', '/images/blog/bg-3.png'];\n\n  const renderPostCard = (post: any) => {\n    const imageUrl = post.featuredImage || bgImages[post.id % bgImages.length];\n    return (\n    <Card key={post.id} data-testid={`card-post-${post.id}`} className=\"overflow-hidden\">\n      <div \n        className=\"h-32 bg-cover bg-center bg-no-repeat\"\n        style={{ backgroundImage: `url('${imageUrl}')` }}\n      >\n        <div className=\"w-full h-full bg-black/40\" />\n      </div>\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <h3 className=\"font-bold\" data-testid={`text-post-title-${post.id}`}>{post.title}</h3>\n              <Badge variant=\"secondary\">{post.category}</Badge>\n              <Badge\n                variant={post.status === \"Published\" ? \"default\" : \"outline\"}\n                className={post.status === \"Published\" ? \"bg-green-500\" : \"\"}\n              >\n                {post.status}\n              </Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground mb-2 line-clamp-2\">\n              {post.excerpt || post.content?.substring(0, 100) || \"No excerpt available\"}\n            </p>\n            <div className=\"flex gap-4 text-xs text-muted-foreground flex-wrap\">\n              <span className=\"flex items-center gap-1\">\n                <Calendar className=\"w-3 h-3\" /> {formatDate(post.publishedAt || post.createdAt)}\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <Eye className=\"w-3 h-3\" /> {post.views || 0} views\n              </span>\n              {post.tags && post.tags.length > 0 && (\n                <span className=\"text-primary\">\n                  {post.tags.slice(0, 3).join(\", \")}\n                  {post.tags.length > 3 && \"...\"}\n                </span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleOpenDialog(post.id)}\n              data-testid={`button-edit-post-${post.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-destructive hover:text-destructive\"\n              onClick={() => handleDeleteClick(post.id)}\n              data-testid={`button-delete-post-${post.id}`}\n            >\n              <Trash className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n    );\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Blog Posts</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your blog content ({posts.length} posts)\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-new-post\"\n          >\n            <Plus className=\"w-4 h-4\" /> New Post\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={(v) => { setActiveTab(v); setCurrentPage(1); }}>\n          <TabsList>\n            <TabsTrigger value=\"published\" data-testid=\"tab-published\">\n              Published ({posts.filter((p) => p.status === \"Published\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"draft\" data-testid=\"tab-draft\">\n              Drafts ({posts.filter((p) => p.status === \"Draft\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"archived\" data-testid=\"tab-archived\">\n              Archived ({posts.filter((p) => p.status === \"Archived\").length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value={activeTab} className=\"space-y-4 mt-4\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  Loading posts...\n                </CardContent>\n              </Card>\n            ) : paginatedPosts.length === 0 ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  No posts found. Click \"New Post\" to create one.\n                </CardContent>\n              </Card>\n            ) : (\n              <>\n                {paginatedPosts.map(renderPostCard)}\n                {totalPages > 1 && (\n                  <Pagination\n                    currentPage={currentPage}\n                    totalPages={totalPages}\n                    onPageChange={setCurrentPage}\n                  />\n                )}\n              </>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingPost ? \"Edit Post\" : \"Create New Post\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingPost\n                ? \"Update the post details below.\"\n                : \"Fill in the details to create a new blog post.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                placeholder=\"Enter post title\"\n                value={formData.title}\n                onChange={(e) => handleTitleChange(e.target.value)}\n                data-testid=\"input-post-title\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"slug\">Slug</Label>\n              <Input\n                id=\"slug\"\n                placeholder=\"post-url-slug\"\n                value={formData.slug}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, slug: e.target.value }))\n                }\n                data-testid=\"input-post-slug\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(v) =>\n                    setFormData((prev) => ({ ...prev, category: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-category\">\n                    <SelectValue placeholder=\"Select category\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(v: \"Published\" | \"Draft\" | \"Archived\") =>\n                    setFormData((prev) => ({ ...prev, status: v }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-post-status\">\n                    <SelectValue placeholder=\"Select status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                    <SelectItem value=\"Archived\">Archived</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"content\">Content *</Label>\n              <RichTextEditor\n                value={formData.content}\n                onChange={(content) =>\n                  setFormData((prev) => ({ ...prev, content }))\n                }\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"excerpt\">Excerpt</Label>\n              <Textarea\n                id=\"excerpt\"\n                placeholder=\"Brief summary of the post\"\n                value={formData.excerpt}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, excerpt: e.target.value }))\n                }\n                rows={2}\n                data-testid=\"input-post-excerpt\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"image\">Featured Image</Label>\n              <div className=\"space-y-2\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    id=\"image\"\n                    placeholder=\"Image URL (e.g., /uploads/images/... or https://...)\"\n                    value={formData.featuredImage || ''}\n                    onChange={(e) =>\n                      setFormData((prev) => ({ ...prev, featuredImage: e.target.value || null }))\n                    }\n                    data-testid=\"input-post-image\"\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => imageInputRef.current?.click()}\n                    disabled={uploading}\n                    data-testid=\"button-upload-image\"\n                  >\n                    {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => setFormData((prev) => ({ ...prev, featuredImage: null }))}\n                    data-testid=\"button-clear-image\"\n                  >\n                    Clear\n                  </Button>\n                </div>\n                <input\n                  ref={imageInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  className=\"hidden\"\n                  onChange={(e) => {\n                    const file = e.target.files?.[0];\n                    if (file) {\n                      handleImageUpload(file, (url) => setFormData((prev) => ({ ...prev, featuredImage: url })));\n                    }\n                  }}\n                  data-testid=\"input-file-upload\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Táº£i áº£nh tá»« thiáº¿t bá»‹ (JPG, PNG, GIF, WebP) - Ä‘Æ°á»£c lÆ°u vÃ o /uploads/images/\n                </p>\n              </div>\n              {formData.featuredImage && (\n                <div className=\"mt-2 border border-border rounded-md overflow-hidden\">\n                  <img\n                    src={formData.featuredImage}\n                    alt=\"Featured preview\"\n                    className=\"w-full h-40 object-cover\"\n                    onError={(e) => {\n                      // Fallback if image fails to load\n                      (e.target as HTMLImageElement).src = '/images/blog/bg-1.png';\n                    }}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">\n                Há»— trá»£: Táº£i tá»« thiáº¿t bá»‹ hoáº·c dÃ¡n link áº£nh. áº¢nh máº·c Ä‘á»‹nh: /images/blog/bg-1.png, bg-2.png, bg-3.png\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\n              <Input\n                id=\"tags\"\n                placeholder=\"react, javascript, web development\"\n                value={tagsInput}\n                onChange={(e) => setTagsInput(e.target.value)}\n                data-testid=\"input-post-tags\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"author\">Author</Label>\n              <Input\n                id=\"author\"\n                placeholder=\"Author name\"\n                value={formData.author}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, author: e.target.value }))\n                }\n                data-testid=\"input-post-author\"\n              />\n            </div>\n          </div>\n\n          <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n            {formError && (\n              <p className=\"text-destructive text-sm w-full sm:w-auto sm:flex-1\" data-testid=\"text-form-error\">\n                {formError}\n              </p>\n            )}\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={handleCloseDialog}>\n                <X className=\"w-4 h-4 mr-2\" /> Cancel\n              </Button>\n              <Button\n                onClick={handleSubmit}\n                disabled={isSaving}\n                data-testid=\"button-save-post\"\n              >\n                <Save className=\"w-4 h-4 mr-2\" />\n                {isSaving ? \"Saving...\" : editingPost ? \"Update Post\" : \"Create Post\"}\n              </Button>\n            </div>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Are you sure?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. This will permanently delete the\n              post from the database.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":23859,"size_tokens":null},"client/src/pages/admin/content/projects/ProjectCategories.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Loader2 } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description: string | null;\n  createdAt: string;\n}\n\nconst getEmptyCategory = () => ({\n  name: \"\",\n  slug: \"\",\n  type: \"project\",\n  description: \"\",\n});\n\nexport default function AdminProjectCategories() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\n  const [formData, setFormData] = useState(getEmptyCategory());\n\n  const { data: categories = [], isLoading } = useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to fetch categories\");\n        return res.json();\n      }),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(\"/api/categories\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to create category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category created\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to create category\", variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: typeof formData) =>\n      fetch(`/api/categories/${editingCategory?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(data),\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to update category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Category updated\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to update category\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) =>\n      fetch(`/api/categories/${id}`, { \n        method: \"DELETE\",\n        credentials: \"include\"\n      }).then(res => {\n        if (!res.ok) throw new Error(\"Failed to delete category\");\n        return res.json();\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\", \"project\"] });\n      setDeleteId(null);\n      toast({ title: \"Success\", description: \"Category deleted\" });\n    },\n    onError: () => {\n      toast({ title: \"Error\", description: \"Failed to delete category\", variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(getEmptyCategory());\n    setEditingCategory(null);\n  };\n\n  const handleOpenDialog = (category?: Category) => {\n    if (category) {\n      setEditingCategory(category);\n      setFormData({\n        name: category.name,\n        slug: category.slug,\n        type: category.type,\n        description: category.description || \"\",\n      });\n    } else {\n      resetForm();\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.name.trim() || !formData.slug.trim()) {\n      toast({ title: \"Error\", description: \"Name and slug are required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingCategory) {\n      updateMutation.mutate(formData);\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const generateSlug = (name: string) => {\n    const slug = name\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n    return slug;\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"p-6 space-y-6 max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Project Categories</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage your project categories</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-new-category\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            New Category\n          </Button>\n        </div>\n\n        {/* Categories List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Categories ({categories.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"flex justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin\" />\n              </div>\n            ) : categories.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No categories yet. Create your first one!\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {categories.map((category: Category) => (\n                  <div\n                    key={category.id}\n                    className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\n                    data-testid={`category-item-${category.id}`}\n                  >\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-foreground\">{category.name}</h3>\n                      <p className=\"text-sm text-muted-foreground\">/{category.slug}</p>\n                      {category.description && (\n                        <p className=\"text-sm text-muted-foreground mt-1\">{category.description}</p>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2 ml-4\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleOpenDialog(category)}\n                        data-testid={`button-edit-category-${category.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setDeleteId(category.id)}\n                        data-testid={`button-delete-category-${category.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4 text-red-500\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{editingCategory ? \"Edit Category\" : \"New Category\"}</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"name\">Category Name *</Label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => {\n                  const newName = e.target.value;\n                  const newSlug = generateSlug(newName);\n                  setFormData({ ...formData, name: newName, slug: newSlug });\n                }}\n                placeholder=\"e.g., Full-stack\"\n                data-testid=\"input-category-name\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"slug\">Slug *</Label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n                placeholder=\"e.g., full-stack\"\n                data-testid=\"input-category-slug\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"description\">Description</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description}\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                placeholder=\"Category description (optional)\"\n                data-testid=\"textarea-category-description\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-save-category\"\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                \"Save Category\"\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation */}\n      <AlertDialog open={deleteId !== null} onOpenChange={(open) => !open && setDeleteId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Category</AlertDialogTitle>\n            <AlertDialogDescription>\n              This action cannot be undone. Are you sure you want to delete this category?\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deleteId && deleteMutation.mutate(deleteId)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":11229,"size_tokens":null},"client/src/pages/admin/communications/Inbox.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  Search, \n  Star, \n  Archive, \n  Trash2, \n  Reply, \n  Paperclip,\n  Mail,\n  Loader2,\n  Eye,\n  RefreshCw,\n  AlertCircle,\n  CheckCircle2,\n  Send\n} from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface Message {\n  id: number;\n  sender: string;\n  email: string;\n  subject: string;\n  message: string;\n  read: boolean;\n  starred: boolean;\n  tag: string;\n  createdAt: string | null;\n  archived: boolean;\n}\n\ninterface SmtpStatus {\n  configured: boolean;\n  active?: boolean;\n  message: string;\n}\n\nexport default function AdminInbox() {\n  const { toast } = useToast();\n  const [selectedMessageId, setSelectedMessageId] = useState<number | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [replyContent, setReplyContent] = useState(\"\");\n\n  const { data: messages = [], isLoading, refetch } = useQuery<Message[]>({\n    queryKey: ['/api/messages'],\n  });\n\n  const { data: smtpStatus } = useQuery<SmtpStatus>({\n    queryKey: ['/api/messages/smtp/status'],\n  });\n\n  useEffect(() => {\n    setReplyContent(\"\");\n  }, [selectedMessageId]);\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/messages/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/messages/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      toast({ title: \"Message deleted\" });\n      if (selectedMessageId === deleteMutation.variables) {\n        const remainingMessages = messages.filter(m => m.id !== deleteMutation.variables);\n        if (remainingMessages.length > 0) {\n          setSelectedMessageId(remainingMessages[0].id);\n        } else {\n          setSelectedMessageId(null);\n        }\n      }\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to delete message\", variant: \"destructive\" });\n    },\n  });\n\n  const archiveMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/messages/${id}/archive`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      toast({ title: \"Message archived\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to archive message\", variant: \"destructive\" });\n    },\n  });\n\n  const replyMutation = useMutation({\n    mutationFn: async ({ id, replyContent }: { id: number; replyContent: string }) => {\n      return apiRequest(\"POST\", `/api/messages/${id}/reply`, { replyContent });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      toast({ title: \"Reply sent\", description: \"Your reply has been sent successfully\" });\n      setReplyContent(\"\");\n    },\n    onError: (error: any) => {\n      toast({ title: \"Failed to send reply\", description: error.message || \"Failed to send reply\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSendReply = () => {\n    if (!selectedMessage || !replyContent.trim()) {\n      toast({ title: \"Error\", description: \"Please write a reply first\", variant: \"destructive\" });\n      return;\n    }\n    replyMutation.mutate({ id: selectedMessage.id, replyContent: replyContent.trim() });\n  };\n\n  const filteredMessages = messages.filter(m => \n    !m.archived && (\n      m.sender.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      m.subject.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      m.message.toLowerCase().includes(searchQuery.toLowerCase())\n    )\n  );\n\n  const effectiveSelectedId = selectedMessageId ?? filteredMessages[0]?.id ?? null;\n  const selectedMessage = filteredMessages.find(m => m.id === effectiveSelectedId) || filteredMessages[0];\n\n  const handleSelectMessage = (id: number) => {\n    setSelectedMessageId(id);\n    const msg = messages.find(m => m.id === id);\n    if (msg && !msg.read) {\n      markAsReadMutation.mutate(id);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this message permanently?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const handleArchive = (id: number) => {\n    archiveMutation.mutate(id);\n  };\n\n  const unreadCount = messages.filter(m => !m.read && !m.archived).length;\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-[calc(100vh-8rem)]\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"mb-4 flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-heading font-bold flex items-center gap-2\">\n            <Mail className=\"w-6 h-6\" />\n            Inbox\n            {unreadCount > 0 && (\n              <Badge variant=\"destructive\" className=\"ml-2\">{unreadCount} unread</Badge>\n            )}\n          </h1>\n          <p className=\"text-sm text-muted-foreground\">{filteredMessages.length} messages</p>\n        </div>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          onClick={() => refetch()}\n          data-testid=\"button-refresh-inbox\"\n        >\n          <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh\n        </Button>\n      </div>\n\n      <div className=\"h-[calc(100vh-12rem)] flex flex-col md:flex-row bg-card border border-border rounded-lg overflow-hidden\">\n        <div className=\"w-full md:w-80 border-r border-border flex flex-col\">\n          <div className=\"p-4 border-b border-border\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input \n                placeholder=\"Search messages...\" \n                className=\"pl-9\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                data-testid=\"input-search-messages\"\n              />\n            </div>\n          </div>\n          <ScrollArea className=\"flex-1\">\n            <div className=\"flex flex-col\">\n              {filteredMessages.length === 0 ? (\n                <div className=\"p-8 text-center text-muted-foreground\">\n                  <Mail className=\"w-12 h-12 mx-auto mb-4 opacity-20\" />\n                  <p className=\"font-medium\">No messages</p>\n                  <p className=\"text-sm\">Your inbox is empty</p>\n                </div>\n              ) : (\n                filteredMessages.map((msg) => (\n                  <button\n                    key={msg.id}\n                    onClick={() => handleSelectMessage(msg.id)}\n                    className={`flex flex-col gap-2 p-4 text-left border-b border-border hover:bg-muted/50 transition-colors ${\n                      !msg.read ? \"bg-primary/5\" : \"\"\n                    } ${effectiveSelectedId === msg.id ? \"bg-muted\" : \"\"}`}\n                    data-testid={`button-message-${msg.id}`}\n                  >\n                    <div className=\"flex justify-between items-start w-full gap-2\">\n                      <span className={`font-medium truncate ${!msg.read ? \"text-foreground\" : \"text-muted-foreground\"}`}>\n                        {msg.sender}\n                      </span>\n                      <span className=\"text-xs text-muted-foreground whitespace-nowrap\">\n                        {msg.createdAt ? formatDistanceToNow(new Date(msg.createdAt), { addSuffix: true }) : ''}\n                      </span>\n                    </div>\n                    <span className=\"text-sm font-medium truncate w-full\">\n                      {msg.subject}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground truncate w-full\">\n                      {msg.message}\n                    </span>\n                    <div className=\"flex gap-2 mt-1 flex-wrap\">\n                      {!msg.read && (\n                        <Badge variant=\"default\" className=\"text-[10px] h-5\">New</Badge>\n                      )}\n                      <Badge variant=\"secondary\" className=\"text-[10px] h-5\">\n                        {msg.tag || \"General\"}\n                      </Badge>\n                    </div>\n                  </button>\n                ))\n              )}\n            </div>\n          </ScrollArea>\n        </div>\n\n        <div className=\"flex-1 flex flex-col min-w-0\">\n          {selectedMessage ? (\n            <>\n              <div className=\"h-16 border-b border-border flex items-center justify-between px-6 gap-2\">\n                <div className=\"flex items-center gap-2\">\n                  <Button \n                    variant=\"ghost\" \n                    size=\"icon\"\n                    onClick={() => handleArchive(selectedMessage.id)}\n                    disabled={archiveMutation.isPending}\n                    title=\"Archive\"\n                    data-testid=\"button-archive-message\"\n                  >\n                    <Archive size={18} />\n                  </Button>\n                  <Button \n                    variant=\"ghost\" \n                    size=\"icon\" \n                    onClick={() => handleDelete(selectedMessage.id)}\n                    disabled={deleteMutation.isPending}\n                    title=\"Delete\"\n                    data-testid=\"button-delete-message\"\n                  >\n                    <Trash2 size={18} />\n                  </Button>\n                  <Separator orientation=\"vertical\" className=\"h-6 mx-2\" />\n                  {!selectedMessage.read && (\n                    <Button \n                      variant=\"ghost\" \n                      size=\"icon\"\n                      onClick={() => markAsReadMutation.mutate(selectedMessage.id)}\n                      disabled={markAsReadMutation.isPending}\n                      title=\"Mark as read\"\n                      data-testid=\"button-mark-read\"\n                    >\n                      <Eye size={18} />\n                    </Button>\n                  )}\n                  <Button variant=\"ghost\" size=\"icon\" title=\"Star\">\n                    <Star size={18} />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex-1 p-6 overflow-y-auto\">\n                <div className=\"mb-6\">\n                  <div className=\"flex justify-between items-start mb-4 gap-4 flex-wrap\">\n                    <h2 className=\"text-2xl font-bold\">{selectedMessage.subject}</h2>\n                    <div className=\"flex gap-2 flex-shrink-0\">\n                      <Badge variant=\"outline\">{selectedMessage.tag || \"General\"}</Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between mb-6 gap-4 flex-wrap\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center text-primary font-bold\">\n                        {selectedMessage.sender.charAt(0).toUpperCase()}\n                      </div>\n                      <div>\n                        <div className=\"font-medium\">{selectedMessage.sender}</div>\n                        <div className=\"text-sm text-muted-foreground\">{selectedMessage.email}</div>\n                      </div>\n                    </div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {selectedMessage.createdAt ? new Date(selectedMessage.createdAt).toLocaleString() : ''}\n                    </div>\n                  </div>\n                  <Separator className=\"mb-6\" />\n                  <div className=\"prose dark:prose-invert max-w-none\">\n                    <p className=\"whitespace-pre-wrap\">{selectedMessage.message}</p>\n                  </div>\n                </div>\n                \n                <div className=\"mt-8 border border-border rounded-lg p-4 bg-card\">\n                  <div className=\"flex items-center justify-between mb-3 gap-2\">\n                    <div className=\"text-sm text-muted-foreground\">Reply to {selectedMessage.sender}</div>\n                    {smtpStatus && (\n                      <div className=\"flex items-center gap-1.5 text-xs\">\n                        {smtpStatus.configured && smtpStatus.active ? (\n                          <>\n                            <CheckCircle2 className=\"w-3.5 h-3.5 text-green-500\" />\n                            <span className=\"text-green-600 dark:text-green-400\">Email ready</span>\n                          </>\n                        ) : (\n                          <>\n                            <AlertCircle className=\"w-3.5 h-3.5 text-amber-500\" />\n                            <span className=\"text-amber-600 dark:text-amber-400\">\n                              {smtpStatus.configured ? \"SMTP inactive\" : \"SMTP not configured\"}\n                            </span>\n                          </>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                  <Textarea \n                    className=\"w-full bg-transparent resize-none min-h-[100px] text-sm border-muted\" \n                    placeholder=\"Write your reply...\"\n                    value={replyContent}\n                    onChange={(e) => setReplyContent(e.target.value)}\n                    data-testid=\"textarea-reply\"\n                    disabled={replyMutation.isPending}\n                  />\n                  <div className=\"flex justify-between items-center mt-4 gap-2 flex-wrap\">\n                    <div className=\"text-xs text-muted-foreground\">\n                      {replyContent.length > 0 && `${replyContent.length} characters`}\n                    </div>\n                    <Button \n                      size=\"sm\" \n                      onClick={handleSendReply}\n                      disabled={!replyContent.trim() || replyMutation.isPending || !smtpStatus?.configured}\n                      data-testid=\"button-send-reply\"\n                    >\n                      {replyMutation.isPending ? (\n                        <>\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Sending...\n                        </>\n                      ) : (\n                        <>\n                          <Send className=\"w-4 h-4 mr-2\" /> Send Reply\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex-1 flex flex-col items-center justify-center text-muted-foreground\">\n              <Mail className=\"w-16 h-16 mb-4 opacity-20\" />\n              <p className=\"font-medium\">No message selected</p>\n              <p className=\"text-sm\">Select a message from the list to view</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":15592,"size_tokens":null},"client/src/pages/admin/tools/FileManager.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { \n  Upload, \n  Search, \n  FolderPlus,\n  File,\n  Folder,\n  Image as ImageIcon,\n  FileText,\n  Download,\n  Trash2,\n  Grid3x3,\n  List,\n  ArrowLeft,\n  Loader2,\n  Copy,\n  Eye,\n  X\n} from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface MediaItem {\n  id: number;\n  filename: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n  alt: string | null;\n  createdAt: Date | null;\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 B';\n  const k = 1024;\n  const sizes = ['B', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n}\n\nexport default function FileManager() {\n  const { toast } = useToast();\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<MediaItem | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const { data: mediaItems = [], isLoading } = useQuery<MediaItem[]>({\n    queryKey: ['/api/media'],\n  });\n\n  const createMediaMutation = useMutation({\n    mutationFn: api.createMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File uploaded successfully\" });\n      setUploadDialogOpen(false);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMediaMutation = useMutation({\n    mutationFn: api.deleteMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setUploading(true);\n\n    for (const file of Array.from(files)) {\n      try {\n        const reader = new FileReader();\n        reader.onload = async () => {\n          const base64 = reader.result as string;\n          const timestamp = Date.now();\n          const filename = `${timestamp}-${file.name.replace(/[^a-zA-Z0-9.-]/g, '_')}`;\n          \n          await createMediaMutation.mutateAsync({\n            filename,\n            originalName: file.name,\n            mimeType: file.type,\n            size: file.size,\n            url: base64,\n            alt: file.name,\n          });\n        };\n        reader.readAsDataURL(file);\n      } catch (error) {\n        console.error('Upload error:', error);\n      }\n    }\n\n    setUploading(false);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete \"${name}\"? This action cannot be undone.`)) {\n      deleteMediaMutation.mutate(id);\n    }\n  };\n\n  const copyToClipboard = (url: string) => {\n    navigator.clipboard.writeText(url);\n    toast({ title: \"Copied\", description: \"URL copied to clipboard\" });\n  };\n\n  const filteredMedia = mediaItems.filter(item => {\n    return searchQuery === \"\" || \n      item.originalName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.filename.toLowerCase().includes(searchQuery.toLowerCase());\n  });\n\n  const images = mediaItems.filter(m => m.mimeType.startsWith(\"image/\"));\n  const documents = mediaItems.filter(m => !m.mimeType.startsWith(\"image/\"));\n  const totalSize = mediaItems.reduce((sum, m) => sum + m.size, 0);\n  const maxStorage = 500 * 1024 * 1024;\n  const storagePercent = Math.round((totalSize / maxStorage) * 100);\n\n  const folders = [\n    { name: \"Images\", count: images.length, size: formatFileSize(images.reduce((s, m) => s + m.size, 0)), type: \"images\" },\n    { name: \"Documents\", count: documents.length, size: formatFileSize(documents.reduce((s, m) => s + m.size, 0)), type: \"docs\" },\n  ];\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">File Manager</h1>\n            <p className=\"text-muted-foreground\">\n              Browse and manage your files ({mediaItems.length} files)\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button onClick={() => setUploadDialogOpen(true)} data-testid=\"button-upload\">\n              <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-center justify-between\">\n              <div className=\"flex gap-2 w-full sm:w-auto\">\n                <div className=\"relative flex-1 sm:w-64\">\n                  <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"Search files...\" \n                    className=\"pl-9\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    data-testid=\"input-search-files\"\n                  />\n                </div>\n                <div className=\"flex gap-1 border rounded-md p-1\">\n                  <Button \n                    variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"grid\")}\n                    data-testid=\"button-view-grid\"\n                  >\n                    <Grid3x3 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button \n                    variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"list\")}\n                    data-testid=\"button-view-list\"\n                  >\n                    <List className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium\">Storage Used</span>\n              <span className=\"text-sm text-muted-foreground\">\n                {formatFileSize(totalSize)} / 500 MB\n              </span>\n            </div>\n            <div className=\"w-full bg-muted rounded-full h-2 overflow-hidden\">\n              <div \n                className=\"bg-primary h-full rounded-full transition-all\" \n                style={{ width: `${Math.min(storagePercent, 100)}%` }} \n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        <div>\n          <h3 className=\"text-lg font-bold mb-4\">Categories</h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            {folders.map((folder) => (\n              <Card key={folder.name} className=\"cursor-pointer hover:border-primary transition-colors group\">\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <div className=\"p-3 bg-primary/10 rounded-lg\">\n                      <Folder className=\"w-6 h-6 text-primary\" />\n                    </div>\n                  </div>\n                  <h4 className=\"font-bold mb-1\">{folder.name}</h4>\n                  <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                    <span>{folder.count} files</span>\n                    <span>-</span>\n                    <span>{folder.size}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n\n        <div>\n          <h3 className=\"text-lg font-bold mb-4\">\n            {searchQuery ? `Search Results (${filteredMedia.length})` : `All Files (${mediaItems.length})`}\n          </h3>\n          \n          {filteredMedia.length === 0 ? (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <File className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">No files found</h3>\n                <p className=\"text-muted-foreground text-sm mb-4\">\n                  {searchQuery ? \"Try adjusting your search\" : \"Upload your first file to get started\"}\n                </p>\n                <Button onClick={() => setUploadDialogOpen(true)}>\n                  <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n                </Button>\n              </CardContent>\n            </Card>\n          ) : viewMode === \"grid\" ? (\n            <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4\">\n              {filteredMedia.map((file) => (\n                <Card key={file.id} className=\"group hover:border-primary transition-colors cursor-pointer\" data-testid={`file-card-${file.id}`}>\n                  <div className=\"aspect-square bg-muted flex items-center justify-center relative overflow-hidden\">\n                    {file.mimeType.startsWith(\"image/\") ? (\n                      <img \n                        src={file.url} \n                        alt={file.alt || file.originalName}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    ) : (\n                      <FileText className=\"w-12 h-12 text-muted-foreground\" />\n                    )}\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        onClick={() => setPreviewItem(file)}\n                        title=\"Preview\"\n                      >\n                        <Eye className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        onClick={() => copyToClipboard(file.url)}\n                        title=\"Copy URL\"\n                      >\n                        <Copy className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        size=\"icon\" \n                        variant=\"secondary\"\n                        className=\"text-destructive\"\n                        onClick={() => handleDelete(file.id, file.originalName)}\n                        title=\"Delete\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <CardContent className=\"p-3\">\n                    <p className=\"font-medium text-sm truncate\" title={file.originalName}>\n                      {file.originalName}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground\">{formatFileSize(file.size)}</p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"p-0\">\n                <div className=\"divide-y\">\n                  {filteredMedia.map((file) => (\n                    <div \n                      key={file.id} \n                      className=\"flex items-center justify-between p-4 hover:bg-muted/50 cursor-pointer group\"\n                      data-testid={`file-row-${file.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        {file.mimeType.startsWith(\"image/\") ? (\n                          <ImageIcon className=\"w-5 h-5 text-muted-foreground\" />\n                        ) : (\n                          <FileText className=\"w-5 h-5 text-muted-foreground\" />\n                        )}\n                        <div>\n                          <p className=\"font-medium text-sm\">{file.originalName}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {file.createdAt && formatDistanceToNow(new Date(file.createdAt), { addSuffix: true })}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-4\">\n                        <span className=\"text-sm text-muted-foreground\">{formatFileSize(file.size)}</span>\n                        <div className=\"flex gap-1 invisible group-hover:visible transition-all\">\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\"\n                            onClick={() => setPreviewItem(file)}\n                          >\n                            <Eye className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\"\n                            onClick={() => copyToClipboard(file.url)}\n                          >\n                            <Copy className=\"w-4 h-4\" />\n                          </Button>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => handleDelete(file.id, file.originalName)}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>Upload Files</DialogTitle>\n              <DialogDescription>\n                Select files to upload to your file manager\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              <div \n                className=\"border-2 border-dashed border-muted-foreground/30 rounded-lg p-8 text-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                <Upload className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-sm font-medium mb-2\">Click to select files</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  Supports images, PDFs, and documents\n                </p>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  className=\"hidden\"\n                  multiple\n                  accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt\"\n                  onChange={handleFileSelect}\n                  data-testid=\"input-file\"\n                />\n              </div>\n\n              {uploading && (\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Uploading...</span>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setUploadDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={!!previewItem} onOpenChange={() => setPreviewItem(null)}>\n          <DialogContent className=\"sm:max-w-[700px]\">\n            <DialogHeader>\n              <DialogTitle>{previewItem?.originalName}</DialogTitle>\n              <DialogDescription>\n                {previewItem?.mimeType} - {previewItem && formatFileSize(previewItem.size)}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"py-4\">\n              {previewItem?.mimeType.startsWith(\"image/\") ? (\n                <img \n                  src={previewItem.url} \n                  alt={previewItem.alt || previewItem.originalName}\n                  className=\"max-w-full max-h-[400px] mx-auto rounded-lg\"\n                />\n              ) : (\n                <div className=\"flex flex-col items-center justify-center py-12\">\n                  <FileText className=\"w-16 h-16 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">Preview not available for this file type</p>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                onClick={() => previewItem && copyToClipboard(previewItem.url)}\n              >\n                <Copy className=\"w-4 h-4 mr-2\" /> Copy URL\n              </Button>\n              <Button variant=\"outline\" onClick={() => setPreviewItem(null)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":18492,"size_tokens":null},"client/src/pages/admin/settings/ThemeComparison.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useState } from \"react\";\n\ninterface ThemeComparisonProps {\n  currentTheme?: {\n    primaryColor: string;\n    secondaryColor: string;\n    accentColor: string;\n    headingFont: string;\n    borderRadius: string;\n  };\n}\n\nexport function ThemeComparison({ currentTheme }: ThemeComparisonProps) {\n  const [sliderPosition, setSliderPosition] = useState(50);\n\n  const defaultTheme = {\n    primaryColor: \"#7c3aed\",\n    secondaryColor: \"#ec4899\",\n    accentColor: \"#f59e0b\",\n    headingFont: \"Inter\",\n    borderRadius: \"8\",\n  };\n\n  const theme = currentTheme || defaultTheme;\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Before/After Comparison</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"relative w-full h-96 bg-muted rounded-lg overflow-hidden\">\n          {/* Before - Default Theme */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-900 dark:to-slate-800\">\n            <div className=\"h-full flex flex-col items-center justify-center space-y-4\">\n              <p className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">Before</p>\n              <div className=\"space-y-2\">\n                <div className=\"w-40 h-10 bg-slate-300 dark:bg-slate-600 rounded\" />\n                <div className=\"w-40 h-10 bg-slate-300 dark:bg-slate-600 rounded\" />\n              </div>\n              <button className=\"px-4 py-2 mt-4 text-white rounded\" style={{ backgroundColor: defaultTheme.primaryColor }}>\n                Learn More\n              </button>\n            </div>\n          </div>\n\n          {/* After - Current Theme */}\n          <div\n            className=\"absolute inset-0 bg-gradient-to-br overflow-hidden\"\n            style={{ \n              width: `${sliderPosition}%`,\n              backgroundImage: `linear-gradient(to bottom right, ${theme.primaryColor}10, ${theme.secondaryColor}10)`\n            }}\n          >\n            <div className=\"h-full flex flex-col items-center justify-center space-y-4\">\n              <p className=\"text-sm font-medium\" style={{ color: theme.primaryColor }}>\n                After\n              </p>\n              <div className=\"space-y-2\">\n                <div \n                  className=\"w-40 h-10 rounded\" \n                  style={{ backgroundColor: `${theme.primaryColor}30` }} \n                />\n                <div \n                  className=\"w-40 h-10 rounded\" \n                  style={{ backgroundColor: `${theme.secondaryColor}30` }} \n                />\n              </div>\n              <button \n                className=\"px-4 py-2 mt-4 text-white rounded\"\n                style={{ backgroundColor: theme.primaryColor }}\n              >\n                Learn More\n              </button>\n            </div>\n          </div>\n\n          {/* Slider Handle */}\n          <div\n            className=\"absolute top-0 bottom-0 w-1 bg-white cursor-col-resize shadow-lg\"\n            style={{ left: `${sliderPosition}%` }}\n            onMouseDown={(e) => {\n              const rect = e.currentTarget.parentElement?.getBoundingClientRect();\n              if (!rect) return;\n\n              const handleMouseMove = (moveEvent: MouseEvent) => {\n                const newPosition = ((moveEvent.clientX - rect.left) / rect.width) * 100;\n                setSliderPosition(Math.max(0, Math.min(100, newPosition)));\n              };\n\n              const handleMouseUp = () => {\n                document.removeEventListener(\"mousemove\", handleMouseMove);\n                document.removeEventListener(\"mouseup\", handleMouseUp);\n              };\n\n              document.addEventListener(\"mousemove\", handleMouseMove);\n              document.addEventListener(\"mouseup\", handleMouseUp);\n            }}\n          >\n            <div className=\"absolute -left-4 top-1/2 -translate-y-1/2 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center\">\n              <div className=\"text-xs font-bold text-slate-600\">âŸ¨âŸ©</div>\n            </div>\n          </div>\n        </div>\n        <p className=\"text-xs text-muted-foreground mt-3 text-center\">Drag the slider to compare theme changes</p>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":4270,"size_tokens":null},"client/src/pages/home/Pages.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { Calendar, Eye, Loader2, FileText } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useState } from \"react\";\n\nexport default function Pages() {\n  const { data: pages = [], isLoading } = useQuery({\n    queryKey: [\"/api/pages\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/pages?published=true\");\n      if (!response.ok) throw new Error(\"Failed to fetch pages\");\n      return response.json();\n    },\n  });\n\n  const publishedPages = pages.filter((page: any) => page.status === \"Published\");\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Pages & <span className=\"text-primary\">Resources</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Explore our custom pages and resources\n              </p>\n            </div>\n          </motion.div>\n\n          {publishedPages.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <FileText className=\"w-16 h-16 mx-auto mb-4 text-muted-foreground opacity-50\" />\n              <p className=\"text-muted-foreground text-lg\">No published pages available</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {publishedPages.map((page: any, index: number) => (\n                <motion.div\n                  key={page.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: index * 0.1 }}\n                >\n                  <Card className=\"h-full hover:shadow-lg transition-shadow overflow-hidden\">\n                    {page.featuredImage && (\n                      <div className=\"h-48 overflow-hidden\">\n                        <img\n                          src={page.featuredImage}\n                          alt={page.title}\n                          className=\"w-full h-full object-cover hover:scale-105 transition-transform duration-300\"\n                        />\n                      </div>\n                    )}\n                    <CardHeader className=\"pb-3\">\n                      <Link href={`/page/${page.slug}`}>\n                        <div className=\"cursor-pointer group\">\n                          <h3 className=\"text-xl font-bold group-hover:text-primary transition-colors line-clamp-2\">\n                            {page.title}\n                          </h3>\n                        </div>\n                      </Link>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      {page.excerpt && (\n                        <p className=\"text-muted-foreground line-clamp-3\">\n                          {page.excerpt}\n                        </p>\n                      )}\n\n                      <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                        <div className=\"flex items-center gap-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <Calendar className=\"w-4 h-4\" />\n                            {new Date(page.updatedAt).toLocaleDateString()}\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4\" />\n                            {page.views}\n                          </div>\n                        </div>\n                      </div>\n\n                      <Link href={`/page/${page.slug}`}>\n                        <button className=\"w-full px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium mt-4\">\n                          Read More\n                        </button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":4913,"size_tokens":null},"server/api/projects.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertProjectSchema } from \"@shared/schema\";\n\nconst router = Router();\n\n// Get all projects\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const projects = req.query.published === \"true\" \n      ? await storage.getPublishedProjects()\n      : await storage.getAllProjects();\n    res.json(projects);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Get project by ID\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const project = await storage.getProject(parseInt(req.params.id));\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json(project);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Create project\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertProjectSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const project = await storage.createProject(parsed.data);\n    res.status(201).json(project);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Update project\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const project = await storage.updateProject(parseInt(req.params.id), req.body);\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json(project);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Delete project\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteProject(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json({ message: \"Project deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Increment project views\nrouter.post(\"/:id/view\", async (req, res) => {\n  try {\n    await storage.incrementProjectViews(parseInt(req.params.id));\n    res.json({ message: \"View counted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2373,"size_tokens":null},"server/api/media.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { upload, uploadsDir, generateCleanFilename } from \"../utils/upload\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst router = Router();\n\nrouter.post(\"/upload/file\", requireAuth, upload.single('file'), async (req, res) => {\n  try {\n    if (!req.file) {\n      return res.status(400).json({ message: \"No file uploaded\" });\n    }\n\n    const file = req.file;\n    let subDir = \"media\";\n    if (file.mimetype.startsWith(\"image/\")) {\n      subDir = \"images\";\n    } else if (\n      file.mimetype === \"application/pdf\" ||\n      file.mimetype === \"application/msword\" ||\n      file.mimetype === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" ||\n      file.mimetype === \"application/vnd.ms-excel\" ||\n      file.mimetype === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" ||\n      file.mimetype === \"application/vnd.ms-powerpoint\" ||\n      file.mimetype === \"application/vnd.openxmlformats-officedocument.presentationml.presentation\" ||\n      file.mimetype === \"text/plain\"\n    ) {\n      subDir = \"documents\";\n    }\n\n    const fileUrl = `/uploads/${subDir}/${file.filename}`;\n\n    const mediaItem = await storage.createMedia({\n      filename: file.filename,\n      originalName: file.originalname,\n      mimeType: file.mimetype,\n      size: file.size,\n      url: fileUrl,\n      alt: req.body.alt || null,\n    });\n\n    res.status(201).json(mediaItem);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/upload/files\", requireAuth, upload.array('files', 20), async (req, res) => {\n  try {\n    const files = req.files as Express.Multer.File[];\n    if (!files || files.length === 0) {\n      return res.status(400).json({ message: \"No files uploaded\" });\n    }\n\n    const mediaItems = [];\n\n    for (const file of files) {\n      let subDir = \"media\";\n      if (file.mimetype.startsWith(\"image/\")) {\n        subDir = \"images\";\n      } else if (\n        file.mimetype === \"application/pdf\" ||\n        file.mimetype === \"application/msword\" ||\n        file.mimetype === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" ||\n        file.mimetype === \"application/vnd.ms-excel\" ||\n        file.mimetype === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" ||\n        file.mimetype === \"application/vnd.ms-powerpoint\" ||\n        file.mimetype === \"application/vnd.openxmlformats-officedocument.presentationml.presentation\" ||\n        file.mimetype === \"text/plain\"\n      ) {\n        subDir = \"documents\";\n      }\n\n      const fileUrl = `/uploads/${subDir}/${file.filename}`;\n\n      const mediaItem = await storage.createMedia({\n        filename: file.filename,\n        originalName: file.originalname,\n        mimeType: file.mimetype,\n        size: file.size,\n        url: fileUrl,\n        alt: null,\n      });\n\n      mediaItems.push(mediaItem);\n    }\n\n    res.status(201).json(mediaItems);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/upload/image\", requireAuth, async (req, res) => {\n  try {\n    const { image, filename } = req.body;\n    if (!image) {\n      return res.status(400).json({ message: \"No image data provided\" });\n    }\n\n    const imagesDir = path.join(process.cwd(), \"uploads\", \"images\");\n    if (!fs.existsSync(imagesDir)) {\n      fs.mkdirSync(imagesDir, { recursive: true });\n    }\n\n    if (image.startsWith(\"data:\")) {\n      const matches = image.match(/^data:([^;]+);base64,(.+)$/);\n      if (!matches) {\n        return res.status(400).json({ message: \"Invalid base64 image format\" });\n      }\n\n      const mimeType = matches[1];\n      const base64Data = matches[2];\n      const buffer = Buffer.from(base64Data, \"base64\");\n\n      let ext = \".png\";\n      if (mimeType === \"image/jpeg\" || mimeType === \"image/jpg\") ext = \".jpg\";\n      else if (mimeType === \"image/gif\") ext = \".gif\";\n      else if (mimeType === \"image/webp\") ext = \".webp\";\n      else if (mimeType === \"image/svg+xml\") ext = \".svg\";\n\n      const originalName = filename || `image${ext}`;\n      const finalFilename = generateCleanFilename(originalName, \"images\");\n      const filePath = path.join(imagesDir, finalFilename);\n\n      const resolvedPath = path.resolve(filePath);\n      const resolvedUploadsDir = path.resolve(imagesDir);\n      if (!resolvedPath.startsWith(resolvedUploadsDir)) {\n        return res.status(400).json({ message: \"Invalid file path\" });\n      }\n\n      fs.writeFileSync(filePath, buffer);\n\n      const savedUrl = `/uploads/images/${finalFilename}`;\n\n      try {\n        await storage.createMedia({\n          filename: finalFilename,\n          originalName: originalName,\n          mimeType: mimeType,\n          size: buffer.length,\n          url: savedUrl,\n          alt: null,\n        });\n      } catch (dbError) {\n        console.error(\"Failed to save media to database:\", dbError);\n      }\n\n      res.json({ url: savedUrl, path: savedUrl });\n    } else if (image.startsWith(\"http://\") || image.startsWith(\"https://\")) {\n      res.json({ url: image, path: image });\n    } else {\n      return res.status(400).json({ message: \"Invalid image format. Must be base64 data URL or HTTP URL\" });\n    }\n  } catch (error: any) {\n    console.error(\"Upload image error:\", error);\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/media\", requireAuth, async (req, res) => {\n  try {\n    const media = await storage.getAllMedia();\n    res.json(media);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/media\", requireAuth, async (req, res) => {\n  try {\n    const { filename, originalName, mimeType, size, url, alt } = req.body;\n    if (!filename || !originalName || !mimeType || !url) {\n      return res.status(400).json({ message: \"Missing required fields\" });\n    }\n\n    const safeFilename = path.basename(filename).replace(/[^a-zA-Z0-9._-]/g, '_');\n    if (!safeFilename || safeFilename.startsWith('.')) {\n      return res.status(400).json({ message: \"Invalid filename\" });\n    }\n\n    let savedUrl = url;\n\n    if (url.startsWith(\"data:\")) {\n      if (!fs.existsSync(uploadsDir)) {\n        fs.mkdirSync(uploadsDir, { recursive: true });\n      }\n\n      let subDir = \"media\";\n      if (mimeType.startsWith(\"image/\")) {\n        subDir = \"images\";\n      } else if (\n        mimeType === \"application/pdf\" ||\n        mimeType === \"application/msword\" ||\n        mimeType === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" ||\n        mimeType === \"application/vnd.ms-excel\" ||\n        mimeType === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" ||\n        mimeType === \"application/vnd.ms-powerpoint\" ||\n        mimeType === \"application/vnd.openxmlformats-officedocument.presentationml.presentation\" ||\n        mimeType === \"text/plain\"\n      ) {\n        subDir = \"documents\";\n      }\n\n      const targetDir = path.join(uploadsDir, subDir);\n      if (!fs.existsSync(targetDir)) {\n        fs.mkdirSync(targetDir, { recursive: true });\n      }\n\n      const base64Data = url.split(\",\")[1];\n      if (!base64Data) {\n        return res.status(400).json({ message: \"Invalid base64 data\" });\n      }\n\n      const buffer = Buffer.from(base64Data, \"base64\");\n      const filePath = path.join(targetDir, safeFilename);\n\n      const resolvedPath = path.resolve(filePath);\n      const resolvedTargetDir = path.resolve(targetDir);\n      if (!resolvedPath.startsWith(resolvedTargetDir)) {\n        return res.status(400).json({ message: \"Invalid file path\" });\n      }\n\n      fs.writeFileSync(filePath, buffer);\n      savedUrl = `/uploads/${subDir}/${safeFilename}`;\n    }\n\n    const mediaItem = await storage.createMedia({\n      filename: safeFilename,\n      originalName,\n      mimeType,\n      size: size || 0,\n      url: savedUrl,\n      alt: alt || null,\n    });\n    res.status(201).json(mediaItem);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/media/:id\", requireAuth, async (req, res) => {\n  try {\n    const mediaItem = await storage.getMedia(parseInt(req.params.id));\n    if (!mediaItem) {\n      return res.status(404).json({ message: \"Media not found\" });\n    }\n    res.json(mediaItem);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/media/:id\", requireAuth, async (req, res) => {\n  try {\n    const { alt } = req.body;\n    const mediaItem = await storage.updateMedia(parseInt(req.params.id), { alt });\n    if (!mediaItem) {\n      return res.status(404).json({ message: \"Media not found\" });\n    }\n    res.json(mediaItem);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/media/:id\", requireAuth, async (req, res) => {\n  try {\n    const mediaItem = await storage.getMedia(parseInt(req.params.id));\n    if (!mediaItem) {\n      return res.status(404).json({ message: \"Media not found\" });\n    }\n\n    if (mediaItem.url.startsWith(\"/uploads/\")) {\n      const relativePath = mediaItem.url.replace(/^\\//, \"\");\n      const filePath = path.join(process.cwd(), relativePath);\n      if (fs.existsSync(filePath)) {\n        fs.unlinkSync(filePath);\n      }\n    }\n\n    const success = await storage.deleteMedia(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Failed to delete media record\" });\n    }\n    res.json({ message: \"Media deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/media/sync\", requireAuth, async (req, res) => {\n  try {\n    const folders = [\"images\", \"documents\", \"media\"];\n    const syncedFiles: any[] = [];\n    const skippedFiles: string[] = [];\n\n    const existingMedia = await storage.getAllMedia();\n    const existingUrls = new Set(existingMedia.map(m => m.url));\n\n    for (const folder of folders) {\n      const folderPath = path.join(uploadsDir, folder);\n      if (!fs.existsSync(folderPath)) continue;\n\n      const files = fs.readdirSync(folderPath);\n      for (const filename of files) {\n        const filePath = path.join(folderPath, filename);\n        const stat = fs.statSync(filePath);\n\n        if (!stat.isFile()) continue;\n\n        const url = `/uploads/${folder}/${filename}`;\n\n        if (existingUrls.has(url)) {\n          skippedFiles.push(filename);\n          continue;\n        }\n\n        const ext = path.extname(filename).toLowerCase();\n        let mimeType = \"application/octet-stream\";\n        const mimeTypes: Record<string, string> = {\n          \".jpg\": \"image/jpeg\", \".jpeg\": \"image/jpeg\", \".png\": \"image/png\",\n          \".gif\": \"image/gif\", \".webp\": \"image/webp\", \".svg\": \"image/svg+xml\",\n          \".pdf\": \"application/pdf\", \".doc\": \"application/msword\",\n          \".docx\": \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n          \".xls\": \"application/vnd.ms-excel\",\n          \".xlsx\": \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n          \".txt\": \"text/plain\", \".mp4\": \"video/mp4\", \".mp3\": \"audio/mpeg\"\n        };\n        if (mimeTypes[ext]) mimeType = mimeTypes[ext];\n\n        const mediaItem = await storage.createMedia({\n          filename,\n          originalName: filename,\n          mimeType,\n          size: stat.size,\n          url,\n          alt: null\n        });\n        syncedFiles.push(mediaItem);\n      }\n    }\n\n    res.json({\n      message: `Synced ${syncedFiles.length} files, skipped ${skippedFiles.length} existing files`,\n      synced: syncedFiles,\n      skipped: skippedFiles\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":11803,"size_tokens":null},"client/src/pages/admin/communications/Newsletter.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport { useState, useEffect } from \"react\";\nimport {\n  Mail,\n  Save,\n  Loader2\n} from \"lucide-react\";\n\ninterface NewsletterSettings {\n  enabled: boolean;\n  title: string;\n  subtitle: string;\n  description: string;\n  placeholder: string;\n  buttonText: string;\n  successMessage: string;\n  backgroundImage?: string;\n}\n\nexport default function AdminNewsletter() {\n  const { toast } = useToast();\n  const [localSettings, setLocalSettings] = useState<NewsletterSettings>({\n    enabled: false,\n    title: \"Subscribe to Our Newsletter\",\n    subtitle: \"Get the latest updates\",\n    description: \"Stay informed with our weekly newsletter\",\n    placeholder: \"Enter your email\",\n    buttonText: \"Subscribe\",\n    successMessage: \"Thanks for subscribing!\",\n  });\n\n  const { data: settings, isLoading } = useQuery<NewsletterSettings>({\n    queryKey: ['/api/newsletter/settings'],\n  });\n\n  useEffect(() => {\n    if (settings && Object.keys(settings).length > 0) {\n      setLocalSettings(settings as NewsletterSettings);\n    }\n  }, [settings]);\n\n  const updateSettingsMutation = useMutation({\n    mutationFn: async (newSettings: NewsletterSettings) => {\n      const response = await apiRequest('POST', '/api/newsletter/settings', newSettings);\n      return response as unknown as NewsletterSettings;\n    },\n    onSuccess: (data: NewsletterSettings) => {\n      setLocalSettings(data);\n      toast({ title: \"Newsletter settings saved successfully\" });\n      queryClient.invalidateQueries({ queryKey: ['/api/newsletter/settings'] });\n      queryClient.setQueryData(['/api/newsletter/settings'], data);\n    },\n    onError: () => {\n      toast({ title: \"Failed to save settings\", variant: \"destructive\" });\n    }\n  });\n\n  const handleSave = () => {\n    updateSettingsMutation.mutate(localSettings);\n  };\n\n  const handleInputChange = (field: keyof NewsletterSettings, value: any) => {\n    setLocalSettings(prev => ({ ...prev, [field]: value }));\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Newsletter Management</h1>\n            <p className=\"text-muted-foreground\">Configure and manage newsletter popup on homepage</p>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Settings Form */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> Subscribers\n                </CardTitle>\n                <CardDescription>Recent newsletter subscribers</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    Subscriber list functionality will be available in the next update.\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Subscriptions are currently logged in Activity Log.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> Newsletter Popup Settings\n                </CardTitle>\n                <CardDescription>Configure the popup that appears on the homepage</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Activation Toggle */}\n                <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable Newsletter Popup</p>\n                    <p className=\"text-xs text-muted-foreground\">Show newsletter popup when users visit homepage</p>\n                  </div>\n                  <Switch\n                    checked={localSettings.enabled}\n                    onCheckedChange={(v) => handleInputChange('enabled', v)}\n                    data-testid=\"switch-newsletter-enabled\"\n                  />\n                </div>\n\n                {localSettings.enabled && (\n                  <>\n                    {/* Title */}\n                    <div>\n                      <Label htmlFor=\"title\">Popup Title</Label>\n                      <Input\n                        id=\"title\"\n                        value={localSettings.title}\n                        onChange={(e) => handleInputChange('title', e.target.value)}\n                        placeholder=\"Subscribe to Our Newsletter\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-title\"\n                      />\n                    </div>\n\n                    {/* Subtitle */}\n                    <div>\n                      <Label htmlFor=\"subtitle\">Subtitle</Label>\n                      <Input\n                        id=\"subtitle\"\n                        value={localSettings.subtitle}\n                        onChange={(e) => handleInputChange('subtitle', e.target.value)}\n                        placeholder=\"Get the latest updates\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-subtitle\"\n                      />\n                    </div>\n\n                    {/* Description */}\n                    <div>\n                      <Label htmlFor=\"description\">Description</Label>\n                      <div className=\"mt-2\" data-testid=\"editor-newsletter-description\">\n                        <RichTextEditor\n                          value={localSettings.description}\n                          onChange={(value) => handleInputChange('description', value)}\n                          placeholder=\"Stay informed with our weekly newsletter\"\n                        />\n                      </div>\n                    </div>\n\n                    {/* Email Placeholder */}\n                    <div>\n                      <Label htmlFor=\"placeholder\">Email Input Placeholder</Label>\n                      <Input\n                        id=\"placeholder\"\n                        value={localSettings.placeholder}\n                        onChange={(e) => handleInputChange('placeholder', e.target.value)}\n                        placeholder=\"Enter your email\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-placeholder\"\n                      />\n                    </div>\n\n                    {/* Button Text */}\n                    <div>\n                      <Label htmlFor=\"buttonText\">Subscribe Button Text</Label>\n                      <Input\n                        id=\"buttonText\"\n                        value={localSettings.buttonText}\n                        onChange={(e) => handleInputChange('buttonText', e.target.value)}\n                        placeholder=\"Subscribe\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-button\"\n                      />\n                    </div>\n\n                    {/* Success Message */}\n                    <div>\n                      <Label htmlFor=\"successMessage\">Success Message</Label>\n                      <Input\n                        id=\"successMessage\"\n                        value={localSettings.successMessage}\n                        onChange={(e) => handleInputChange('successMessage', e.target.value)}\n                        placeholder=\"Thanks for subscribing!\"\n                        className=\"mt-2\"\n                        data-testid=\"input-newsletter-success\"\n                      />\n                    </div>\n\n                    {/* Save Button */}\n                    <Button \n                      onClick={handleSave} \n                      disabled={updateSettingsMutation.isPending}\n                      className=\"w-full\"\n                      data-testid=\"button-save-newsletter\"\n                    >\n                      {updateSettingsMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                      <Save className=\"w-4 h-4 mr-2\" /> Save Newsletter Settings\n                    </Button>\n                  </>\n                )}\n\n                {!localSettings.enabled && (\n                  <div className=\"p-4 bg-muted rounded-lg text-center text-sm text-muted-foreground\">\n                    Enable the toggle above to configure newsletter popup settings\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9543,"size_tokens":null},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\n\ndeclare module \"express-session\" {\n  interface SessionData {\n    userId: number;\n    username: string;\n    role: string;\n    pending2FA?: boolean;\n    pendingUserId?: number;\n    temp2FASecret?: string;\n    currentChallenge?: string;\n    tempUserId?: number;\n  }\n}\n\nexport function requireAuth(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.userId) {\n    return res.status(401).json({ error: \"Authentication required\" });\n  }\n  next();\n}\n\nexport function requireAdmin(req: Request, res: Response, next: NextFunction) {\n  if (!req.session.userId) {\n    return res.status(401).json({ error: \"Authentication required\" });\n  }\n  const adminRoles = ['Super Admin', 'Admin', 'Editor', 'Moderator'];\n  if (!adminRoles.includes(req.session.role || '')) {\n    return res.status(403).json({ error: \"Admin access required\" });\n  }\n  next();\n}\n","path":null,"size_bytes":915,"size_tokens":null},"client/src/pages/home/BlogPost.tsx":{"content":"import { useRoute, Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion } from \"framer-motion\";\nimport { ArrowLeft, Calendar, User, Tag, Eye, Clock } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { CommentSection } from \"@/components/sections/CommentSection\";\nimport { SocialShare } from \"@/components/common/SocialShare\";\nimport { SEOHead } from \"@/components/common/SEOHead\";\n\nexport default function BlogPost() {\n  const [match, params] = useRoute(\"/blog/:slug\");\n  const slug = params?.slug;\n\n  const { data: post, isLoading, error } = useQuery({\n    queryKey: [\"post\", slug],\n    queryFn: async () => {\n      const postData = await api.getPost(slug!);\n      // Increment view count\n      if (postData?.id) {\n        try {\n          await fetch(`/api/posts/${postData.id}/view`, { method: 'POST' });\n        } catch (e) {\n          console.error('Failed to increment view count');\n        }\n      }\n      return postData;\n    },\n    enabled: !!slug,\n  });\n\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const estimateReadTime = (content: string | null) => {\n    if (!content) return \"1 min read\";\n    const words = content.split(/\\s+/).length;\n    const minutes = Math.ceil(words / 200);\n    return `${minutes} min read`;\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-24\">\n          <div className=\"max-w-3xl mx-auto\">\n            <div className=\"animate-pulse space-y-6\">\n              <div className=\"h-8 bg-muted rounded w-3/4\"></div>\n              <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n              <div className=\"space-y-3 mt-8\">\n                <div className=\"h-4 bg-muted rounded\"></div>\n                <div className=\"h-4 bg-muted rounded\"></div>\n                <div className=\"h-4 bg-muted rounded w-5/6\"></div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  if (error || !post) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-24\">\n          <div className=\"max-w-3xl mx-auto text-center\">\n            <h1 className=\"text-4xl font-bold mb-4\">Post Not Found</h1>\n            <p className=\"text-muted-foreground mb-8\">\n              The article you're looking for doesn't exist or has been removed.\n            </p>\n            <Link href=\"/#blog\">\n              <Button>\n                <ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to Blog\n              </Button>\n            </Link>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <SEOHead\n        title={`${post.title} | Blog`}\n        description={post.excerpt || undefined}\n        image={post.featuredImage || undefined}\n        url={`/blog/${post.slug}`}\n        type=\"article\"\n        author={post.author}\n        publishedTime={post.publishedAt?.toString() || post.createdAt?.toString()}\n        modifiedTime={post.updatedAt?.toString()}\n        tags={post.tags || undefined}\n      />\n      <Navbar />\n      \n      <article className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"max-w-3xl mx-auto\"\n          >\n            <Link href=\"/#blog\">\n              <Button variant=\"ghost\" className=\"mb-8 group\" data-testid=\"button-back-blog\">\n                <ArrowLeft className=\"w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform\" />\n                Back to Blog\n              </Button>\n            </Link>\n\n            <header className=\"mb-8\">\n              <div className=\"flex flex-wrap gap-2 mb-4\">\n                <Badge variant=\"secondary\" className=\"text-sm\" data-testid=\"badge-category\">\n                  {post.category}\n                </Badge>\n                {post.status === \"Draft\" && (\n                  <Badge variant=\"outline\" className=\"text-yellow-500 border-yellow-500\">\n                    Draft\n                  </Badge>\n                )}\n              </div>\n\n              <h1 \n                className=\"text-4xl md:text-5xl font-heading font-bold mb-6 leading-tight\"\n                data-testid=\"text-post-title\"\n              >\n                {post.title}\n              </h1>\n\n              {post.excerpt && (\n                <p className=\"text-xl text-muted-foreground mb-6\" data-testid=\"text-post-excerpt\">\n                  {post.excerpt}\n                </p>\n              )}\n\n              <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground\">\n                <div className=\"flex items-center gap-2\">\n                  <User className=\"w-4 h-4\" />\n                  <span data-testid=\"text-post-author\">{post.author}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span data-testid=\"text-post-date\">\n                    {formatDate(post.publishedAt || post.createdAt)}\n                  </span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"w-4 h-4\" />\n                  <span>{estimateReadTime(post.content)}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Eye className=\"w-4 h-4\" />\n                  <span>{post.views || 0} views</span>\n                </div>\n              </div>\n            </header>\n\n            <Separator className=\"my-8\" />\n\n            {post.featuredImage && (\n              <div className=\"mb-8 rounded-xl overflow-hidden\">\n                <img\n                  src={post.featuredImage}\n                  alt={post.title}\n                  className=\"w-full h-auto object-cover\"\n                />\n              </div>\n            )}\n\n            <div \n              className=\"prose prose-lg prose-invert max-w-none\n                [&_h1]:text-3xl [&_h1]:font-bold [&_h1]:mt-8 [&_h1]:mb-4\n                [&_h2]:text-2xl [&_h2]:font-bold [&_h2]:mt-6 [&_h2]:mb-3\n                [&_h3]:text-xl [&_h3]:font-bold [&_h3]:mt-4 [&_h3]:mb-2\n                [&_ul]:list-disc [&_ul]:ml-6\n                [&_ol]:list-decimal [&_ol]:ml-6\n                [&_li]:mb-2 [&_li]:text-foreground/90\n                [&_blockquote]:border-l-4 [&_blockquote]:border-primary [&_blockquote]:pl-4 [&_blockquote]:italic [&_blockquote]:my-4\n                [&_p]:mb-4 [&_p]:text-foreground/90 [&_p]:leading-relaxed\n                [&_strong]:font-bold\n                [&_em]:italic\n                [&_a]:text-primary [&_a]:underline [&_a]:hover:text-primary/80\n                [&_code]:bg-muted [&_code]:px-2 [&_code]:py-1 [&_code]:rounded\n                [&_pre]:bg-muted [&_pre]:p-4 [&_pre]:rounded [&_pre]:overflow-x-auto [&_pre]:my-4\"\n              data-testid=\"content-post-body\"\n              dangerouslySetInnerHTML={{ __html: post.content || \"\" }}\n            />\n\n            {post.tags && post.tags.length > 0 && (\n              <>\n                <Separator className=\"my-8\" />\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <Tag className=\"w-4 h-4 text-muted-foreground\" />\n                  {post.tags.map((tag: string) => (\n                    <Badge key={tag} variant=\"outline\" className=\"text-sm\">\n                      {tag}\n                    </Badge>\n                  ))}\n                </div>\n              </>\n            )}\n\n            <Separator className=\"my-8\" />\n\n            <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\n              <Link href=\"/#blog\">\n                <Button variant=\"outline\">\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" /> More Articles\n                </Button>\n              </Link>\n              <SocialShare\n                url={`/blog/${post.slug}`}\n                title={post.title}\n                description={post.excerpt || undefined}\n                image={post.featuredImage || undefined}\n              />\n            </div>\n\n            <CommentSection postId={post.id} title=\"Comments\" />\n          </motion.div>\n        </div>\n      </article>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":8888,"size_tokens":null},"client/src/pages/admin/system/Logs.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Download, RefreshCw, Trash2, Filter } from \"lucide-react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\nimport { formatDistanceToNow } from \"date-fns\";\n\nexport default function AdminLogs() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [logLevel, setLogLevel] = useState<string>(\"all\");\n\n  const { data: logs = [], isLoading, refetch } = useQuery({\n    queryKey: [\"/api/logs\", logLevel],\n    queryFn: () => api.getLogs(logLevel),\n  });\n\n  const clearLogsMutation = useMutation({\n    mutationFn: () => api.clearActivityLogs(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/logs\"] });\n      toast({ title: \"Success\", description: \"Logs cleared\" });\n    },\n  });\n\n  const exportLogs = async () => {\n    try {\n      await api.exportLogs();\n      toast({ title: \"Success\", description: \"Logs exported\" });\n    } catch (error: any) {\n      toast({ \n        title: \"Error\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">System Logs</h1>\n            <p className=\"text-muted-foreground\">Advanced log management and analysis</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={() => refetch()}>\n              <RefreshCw className=\"w-4 h-4 mr-2\" /> Refresh\n            </Button>\n            <Button variant=\"outline\" onClick={exportLogs}>\n              <Download className=\"w-4 h-4 mr-2\" /> Export\n            </Button>\n            <Button \n              variant=\"destructive\" \n              onClick={() => clearLogsMutation.mutate()}\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" /> Clear All\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Activity Logs</CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"w-4 h-4 text-muted-foreground\" />\n                <Select value={logLevel} onValueChange={setLogLevel}>\n                  <SelectTrigger className=\"w-[180px]\">\n                    <SelectValue placeholder=\"Filter by level\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Levels</SelectItem>\n                    <SelectItem value=\"info\">Info</SelectItem>\n                    <SelectItem value=\"warning\">Warning</SelectItem>\n                    <SelectItem value=\"error\">Error</SelectItem>\n                    <SelectItem value=\"success\">Success</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <CardDescription>\n              View and filter system activity logs ({logs.length} entries)\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">Loading logs...</div>\n            ) : logs.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                No logs found\n              </div>\n            ) : (\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Timestamp</TableHead>\n                    <TableHead>User</TableHead>\n                    <TableHead>Action</TableHead>\n                    <TableHead>Type</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {logs.map((log: any) => (\n                    <TableRow key={log.id}>\n                      <TableCell className=\"text-sm\">\n                        {formatDistanceToNow(new Date(log.createdAt), { \n                          addSuffix: true \n                        })}\n                      </TableCell>\n                      <TableCell>{log.userName || \"System\"}</TableCell>\n                      <TableCell>{log.action}</TableCell>\n                      <TableCell>\n                        <Badge \n                          variant={\n                            log.type === \"success\" ? \"default\" :\n                            log.type === \"error\" ? \"destructive\" :\n                            log.type === \"warning\" ? \"secondary\" : \"outline\"\n                          }\n                        >\n                          {log.type}\n                        </Badge>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5486,"size_tokens":null},"client/src/pages/home/Home.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { Hero } from \"@/components/sections/Hero\";\nimport { About } from \"@/components/sections/About\";\nimport { Skills } from \"@/components/sections/Skills\";\nimport { Services } from \"@/components/sections/Services\";\nimport { Projects } from \"@/components/sections/Projects\";\nimport { Testimonials } from \"@/components/sections/Testimonials\";\nimport { Blog } from \"@/components/sections/Blog\";\nimport { Contact } from \"@/components/sections/Contact\";\nimport { NewsletterSection } from \"@/components/sections/NewsletterSection\";\nimport { Preloader } from \"@/components/ui/Preloader\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { X, Mail } from \"lucide-react\";\nimport type { HomepageSection } from \"@shared/schema\";\n\ninterface NewsletterSettings {\n  enabled: boolean;\n  title: string;\n  subtitle: string;\n  description: string;\n  placeholder: string;\n  buttonText: string;\n  successMessage: string;\n}\n\nexport default function Home() {\n  const [loading, setLoading] = useState(true);\n  const [showNewsletter, setShowNewsletter] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [submitted, setSubmitted] = useState(false);\n\n  const { data: newsletterSettings } = useQuery<NewsletterSettings>({\n    queryKey: ['/api/newsletter/settings'],\n    enabled: !loading,\n  });\n\n  const { data: sections = [] } = useQuery<HomepageSection[]>({\n    queryKey: ['/api/homepage/sections'],\n    enabled: !loading,\n  });\n\n  const isSectionVisible = (sectionName: string): boolean => {\n    const section = sections.find((s) => s.name === sectionName);\n    return section ? section.visible : true;\n  };\n\n  // Lock scroll during loading\n  useEffect(() => {\n    if (loading) {\n      document.body.style.overflow = \"hidden\";\n    } else {\n      document.body.style.overflow = \"auto\";\n    }\n  }, [loading]);\n\n  // Show newsletter popup on page load if enabled\n  useEffect(() => {\n    if (!loading && newsletterSettings?.enabled) {\n      const dismissed = localStorage.getItem('newsletter-dismissed');\n      if (!dismissed) {\n        setShowNewsletter(true);\n      }\n    }\n  }, [loading, newsletterSettings?.enabled]);\n\n  const handleCloseNewsletter = () => {\n    setShowNewsletter(false);\n    localStorage.setItem('newsletter-dismissed', 'true');\n  };\n\n  const handleNewsletterSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email) return;\n    \n    try {\n      await fetch('/api/newsletter/subscribe', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ email }),\n      });\n      setSubmitted(true);\n      setTimeout(() => {\n        handleCloseNewsletter();\n        setEmail(\"\");\n        setSubmitted(false);\n      }, 2000);\n    } catch (error) {\n      console.error('Newsletter subscription error:', error);\n    }\n  };\n\n  return (\n    <>\n      {loading && <Preloader onComplete={() => setLoading(false)} />}\n      \n      <div className={loading ? \"opacity-0\" : \"opacity-100 transition-opacity duration-1000\"}>\n        <Navbar />\n        <main>\n          <Hero />\n          <About />\n          <Skills />\n          <Services />\n          {isSectionVisible('projects') && <Projects />}\n          {isSectionVisible('testimonials') && <Testimonials />}\n          {isSectionVisible('blog') && <Blog />}\n          {isSectionVisible('newsletter') && <NewsletterSection />}\n          <Contact />\n        </main>\n        <Footer />\n\n        {/* Newsletter Popup */}\n        {showNewsletter && newsletterSettings?.enabled && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" data-testid=\"newsletter-popup-overlay\">\n            <div className=\"bg-background rounded-lg shadow-lg max-w-md w-full p-8 relative animate-in fade-in zoom-in-95 duration-300\" data-testid=\"newsletter-popup\">\n              {/* Close Button */}\n              <button\n                onClick={handleCloseNewsletter}\n                className=\"absolute top-4 right-4 p-1 hover:bg-muted rounded-md transition-colors\"\n                data-testid=\"button-close-newsletter\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n\n              {!submitted ? (\n                <>\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <div className=\"p-2 bg-primary/10 rounded-lg\">\n                      <Mail className=\"w-5 h-5 text-primary\" />\n                    </div>\n                    <div>\n                      <h2 className=\"font-bold text-lg\" data-testid=\"newsletter-title\">{newsletterSettings.title}</h2>\n                      <p className=\"text-sm text-muted-foreground\" data-testid=\"newsletter-subtitle\">{newsletterSettings.subtitle}</p>\n                    </div>\n                  </div>\n\n                  <p className=\"text-sm text-muted-foreground mb-6\" data-testid=\"newsletter-description\">\n                    {newsletterSettings.description}\n                  </p>\n\n                  <form onSubmit={handleNewsletterSubmit} className=\"space-y-3\">\n                    <input\n                      type=\"email\"\n                      placeholder={newsletterSettings.placeholder}\n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      className=\"w-full px-4 py-2 rounded-lg border border-input bg-background text-sm focus:outline-none focus:ring-2 focus:ring-primary\"\n                      required\n                      data-testid=\"input-newsletter-email\"\n                    />\n                    <Button\n                      type=\"submit\"\n                      className=\"w-full\"\n                      data-testid=\"button-newsletter-subscribe\"\n                    >\n                      {newsletterSettings.buttonText}\n                    </Button>\n                  </form>\n\n                  <p className=\"text-xs text-center text-muted-foreground mt-4\">\n                    We respect your privacy. Unsubscribe at any time.\n                  </p>\n                </>\n              ) : (\n                <div className=\"text-center py-8\">\n                  <div className=\"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                    <Mail className=\"w-6 h-6 text-green-500\" />\n                  </div>\n                  <p className=\"font-medium\" data-testid=\"newsletter-success-message\">{newsletterSettings.successMessage}</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n","path":null,"size_bytes":6773,"size_tokens":null},"client/src/pages/admin/system/System.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  RotateCcw, \n  Clock, \n  ShieldCheck,\n  AlertTriangle,\n  HardDrive,\n  RefreshCw,\n  Users,\n  FileText,\n  Briefcase,\n  MessageSquare,\n  Loader2,\n  CheckCircle,\n  XCircle,\n  Database,\n  Server,\n  Cpu,\n  MemoryStick,\n  Zap,\n  Globe,\n  Activity,\n  TrendingUp,\n  HardDriveDownload,\n  Layers\n} from \"lucide-react\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow, format } from \"date-fns\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\nfunction formatUptime(seconds: number): string {\n  const days = Math.floor(seconds / 86400);\n  const hours = Math.floor((seconds % 86400) / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  const secs = Math.floor(seconds % 60);\n\n  if (days > 0) {\n    return `${days}d ${hours}h ${minutes}m`;\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m ${secs}s`;\n  } else if (minutes > 0) {\n    return `${minutes}m ${secs}s`;\n  } else {\n    return `${secs}s`;\n  }\n}\n\nfunction formatBytes(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nconst tableIcons: Record<string, any> = {\n  \"Users\": Users,\n  \"Projects\": Briefcase,\n  \"Posts\": FileText,\n  \"Messages\": MessageSquare,\n};\n\nexport default function AdminSystem() {\n  const { toast } = useToast();\n\n  const { data: systemStats, isLoading: statsLoading, refetch: refetchStats } = useQuery({\n    queryKey: [\"/api/system/stats\"],\n    queryFn: () => api.getSystemStats(),\n    refetchInterval: 30000,\n  });\n\n  const resetMutation = useMutation({\n    mutationFn: () => api.resetSystem(),\n    onSuccess: (data) => {\n      refetchStats();\n      toast({ title: \"Info\", description: data.message });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message || \"Failed to reset system\", variant: \"destructive\" });\n    },\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case \"Healthy\": return \"text-green-500\";\n      case \"Warning\": return \"text-yellow-500\";\n      case \"Error\": return \"text-red-500\";\n      default: return \"text-muted-foreground\";\n    }\n  };\n\n  const getStatusBgColor = (status: string) => {\n    switch (status) {\n      case \"Healthy\": return \"bg-green-500/5 border-green-500/20\";\n      case \"Warning\": return \"bg-yellow-500/5 border-yellow-500/20\";\n      case \"Error\": return \"bg-red-500/5 border-red-500/20\";\n      default: return \"\";\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"Healthy\": return <CheckCircle className=\"w-5 h-5 text-green-500\" />;\n      case \"Warning\": return <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />;\n      case \"Error\": return <XCircle className=\"w-5 h-5 text-red-500\" />;\n      default: return <Activity className=\"w-5 h-5 text-muted-foreground\" />;\n    }\n  };\n\n  const totalRecords = systemStats?.tableStats?.reduce((sum, t) => sum + t.count, 0) || 0;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">System & Monitoring</h1>\n            <p className=\"text-muted-foreground\">Monitor system health, performance metrics and database status</p>\n          </div>\n          <div className=\"flex gap-2 flex-wrap\">\n            <Button \n              variant=\"outline\" \n              onClick={() => refetchStats()}\n              disabled={statsLoading}\n              data-testid=\"button-refresh-stats\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${statsLoading ? 'animate-spin' : ''}`} />\n              Refresh\n            </Button>\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button \n                  variant=\"outline\" \n                  className=\"text-destructive border-destructive/50\"\n                  data-testid=\"button-reset-system\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset System\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Reset System</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    This action will attempt to reset the system. This operation is restricted in this environment.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction \n                    onClick={() => resetMutation.mutate()}\n                    className=\"bg-destructive text-destructive-foreground\"\n                  >\n                    {resetMutation.isPending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Reset\"}\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        </div>\n\n        {statsLoading ? (\n          <div className=\"flex items-center justify-center py-20\">\n            <div className=\"text-center\">\n              <Loader2 className=\"w-10 h-10 animate-spin text-primary mx-auto mb-4\" />\n              <p className=\"text-muted-foreground\">Loading system information...</p>\n            </div>\n          </div>\n        ) : (\n          <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full max-w-md grid-cols-3\">\n              <TabsTrigger value=\"overview\" className=\"gap-2\" data-testid=\"tab-overview\">\n                <Activity className=\"w-4 h-4\" /> Overview\n              </TabsTrigger>\n              <TabsTrigger value=\"database\" className=\"gap-2\" data-testid=\"tab-database\">\n                <Database className=\"w-4 h-4\" /> Database\n              </TabsTrigger>\n              <TabsTrigger value=\"server\" className=\"gap-2\" data-testid=\"tab-server\">\n                <Server className=\"w-4 h-4\" /> Server\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"overview\" className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                <Card className={`${getStatusBgColor(systemStats?.status || \"Healthy\")} transition-all`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"space-y-2\">\n                        <p className=\"text-sm font-medium text-muted-foreground\">System Status</p>\n                        <div className={`text-2xl font-bold ${getStatusColor(systemStats?.status || \"Healthy\")}`}>\n                          {systemStats?.status || \"Checking...\"}\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Last check: {systemStats?.lastCheck ? formatDistanceToNow(new Date(systemStats.lastCheck), { addSuffix: true }) : \"Unknown\"}\n                        </p>\n                      </div>\n                      <div className={`p-3 rounded-xl ${\n                        systemStats?.status === \"Healthy\" ? \"bg-green-500/10\" :\n                        systemStats?.status === \"Warning\" ? \"bg-yellow-500/10\" :\n                        systemStats?.status === \"Error\" ? \"bg-red-500/10\" : \"bg-muted\"\n                      }`}>\n                        {getStatusIcon(systemStats?.status || \"Unknown\")}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"space-y-2\">\n                        <p className=\"text-sm font-medium text-muted-foreground\">Server Uptime</p>\n                        <div className=\"text-2xl font-bold\">\n                          {systemStats?.serverUptime ? formatUptime(systemStats.serverUptime) : \"Unknown\"}\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">Since last restart</p>\n                      </div>\n                      <div className=\"p-3 rounded-xl bg-blue-500/10\">\n                        <Clock className=\"w-5 h-5 text-blue-500\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"space-y-2\">\n                        <p className=\"text-sm font-medium text-muted-foreground\">Database Size</p>\n                        <div className=\"text-2xl font-bold\">{systemStats?.databaseSize || \"Unknown\"}</div>\n                        <p className=\"text-xs text-muted-foreground\">{totalRecords.toLocaleString()} total records</p>\n                      </div>\n                      <div className=\"p-3 rounded-xl bg-purple-500/10\">\n                        <HardDrive className=\"w-5 h-5 text-purple-500\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"space-y-2\">\n                        <p className=\"text-sm font-medium text-muted-foreground\">Total Tables</p>\n                        <div className=\"text-2xl font-bold\">{systemStats?.tableStats?.length || 0}</div>\n                        <p className=\"text-xs text-muted-foreground\">Active database tables</p>\n                      </div>\n                      <div className=\"p-3 rounded-xl bg-orange-500/10\">\n                        <Layers className=\"w-5 h-5 text-orange-500\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <ShieldCheck className=\"w-5 h-5 text-green-500\" />\n                      System Health\n                    </CardTitle>\n                    <CardDescription>Current system health indicators</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n                          <span className=\"text-sm\">Database Connection</span>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">Connected</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n                          <span className=\"text-sm\">API Server</span>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">Running</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n                          <span className=\"text-sm\">WebSocket</span>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">Active</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n                          <span className=\"text-sm\">Cron Jobs</span>\n                        </div>\n                        <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">Running</Badge>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <TrendingUp className=\"w-5 h-5 text-primary\" />\n                      Quick Stats\n                    </CardTitle>\n                    <CardDescription>Key performance indicators</CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"p-4 rounded-lg bg-muted/50\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground text-sm mb-1\">\n                          <Globe className=\"w-4 h-4\" />\n                          Environment\n                        </div>\n                        <p className=\"font-semibold\">Production</p>\n                      </div>\n                      <div className=\"p-4 rounded-lg bg-muted/50\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground text-sm mb-1\">\n                          <Zap className=\"w-4 h-4\" />\n                          Node.js\n                        </div>\n                        <p className=\"font-semibold\">v20.x</p>\n                      </div>\n                      <div className=\"p-4 rounded-lg bg-muted/50\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground text-sm mb-1\">\n                          <Database className=\"w-4 h-4\" />\n                          PostgreSQL\n                        </div>\n                        <p className=\"font-semibold\">v16.x</p>\n                      </div>\n                      <div className=\"p-4 rounded-lg bg-muted/50\">\n                        <div className=\"flex items-center gap-2 text-muted-foreground text-sm mb-1\">\n                          <Clock className=\"w-4 h-4\" />\n                          Timezone\n                        </div>\n                        <p className=\"font-semibold\">UTC</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"database\" className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Database className=\"w-5 h-5\" />\n                    Database Tables\n                  </CardTitle>\n                  <CardDescription>Record counts and storage information per table</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {systemStats?.tableStats && systemStats.tableStats.length > 0 ? (\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n                      {systemStats.tableStats.map((table) => {\n                        const IconComponent = tableIcons[table.name] || Database;\n                        const maxCount = Math.max(...(systemStats.tableStats?.map(t => t.count) || [1]));\n                        const percentage = maxCount > 0 ? (table.count / maxCount) * 100 : 0;\n                        \n                        return (\n                          <div \n                            key={table.name} \n                            className=\"p-4 rounded-xl border bg-card transition-all hover:shadow-md hover:border-primary/30\"\n                            data-testid={`table-stat-${table.name.toLowerCase()}`}\n                          >\n                            <div className=\"flex items-start justify-between mb-3\">\n                              <div className=\"p-2 rounded-lg bg-primary/10\">\n                                <IconComponent className=\"w-4 h-4 text-primary\" />\n                              </div>\n                              <Badge variant=\"secondary\" className=\"text-xs\">\n                                {table.count.toLocaleString()}\n                              </Badge>\n                            </div>\n                            <h4 className=\"font-semibold text-sm mb-1\">{table.name}</h4>\n                            <div className=\"space-y-2\">\n                              <Progress value={percentage} className=\"h-1.5\" />\n                              <p className=\"text-xs text-muted-foreground\">\n                                {((table.count / totalRecords) * 100).toFixed(1)}% of total\n                              </p>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-8 text-muted-foreground\">\n                      <Database className=\"w-12 h-12 mx-auto mb-4 opacity-20\" />\n                      <p>No table statistics available</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"p-3 rounded-xl bg-blue-500/10\">\n                        <HardDriveDownload className=\"w-6 h-6 text-blue-500\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground\">Database Size</p>\n                        <p className=\"text-2xl font-bold\">{systemStats?.databaseSize || \"Unknown\"}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"p-3 rounded-xl bg-green-500/10\">\n                        <Layers className=\"w-6 h-6 text-green-500\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground\">Total Tables</p>\n                        <p className=\"text-2xl font-bold\">{systemStats?.tableStats?.length || 0}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"p-3 rounded-xl bg-purple-500/10\">\n                        <FileText className=\"w-6 h-6 text-purple-500\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground\">Total Records</p>\n                        <p className=\"text-2xl font-bold\">{totalRecords.toLocaleString()}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"server\" className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <Server className=\"w-5 h-5\" />\n                      Server Information\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-3\">\n                      <div className=\"flex items-center justify-between py-2 border-b\">\n                        <span className=\"text-muted-foreground\">Platform</span>\n                        <span className=\"font-medium\">Linux (NixOS)</span>\n                      </div>\n                      <div className=\"flex items-center justify-between py-2 border-b\">\n                        <span className=\"text-muted-foreground\">Node.js Version</span>\n                        <span className=\"font-medium\">v20.19.x</span>\n                      </div>\n                      <div className=\"flex items-center justify-between py-2 border-b\">\n                        <span className=\"text-muted-foreground\">Uptime</span>\n                        <span className=\"font-medium\">{systemStats?.serverUptime ? formatUptime(systemStats.serverUptime) : \"Unknown\"}</span>\n                      </div>\n                      <div className=\"flex items-center justify-between py-2 border-b\">\n                        <span className=\"text-muted-foreground\">Environment</span>\n                        <Badge variant=\"outline\">Development</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between py-2\">\n                        <span className=\"text-muted-foreground\">Last Check</span>\n                        <span className=\"font-medium text-sm\">\n                          {systemStats?.lastCheck ? format(new Date(systemStats.lastCheck), 'MMM d, yyyy HH:mm:ss') : \"Unknown\"}\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-lg\">\n                      <Cpu className=\"w-5 h-5\" />\n                      Resources\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <span className=\"flex items-center gap-2\">\n                          <Cpu className=\"w-4 h-4 text-blue-500\" />\n                          CPU Usage\n                        </span>\n                        <span className=\"font-medium\">~5%</span>\n                      </div>\n                      <Progress value={5} className=\"h-2\" />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <span className=\"flex items-center gap-2\">\n                          <MemoryStick className=\"w-4 h-4 text-green-500\" />\n                          Memory Usage\n                        </span>\n                        <span className=\"font-medium\">~128 MB</span>\n                      </div>\n                      <Progress value={15} className=\"h-2\" />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <span className=\"flex items-center gap-2\">\n                          <HardDrive className=\"w-4 h-4 text-purple-500\" />\n                          Disk Usage\n                        </span>\n                        <span className=\"font-medium\">~{systemStats?.databaseSize || \"N/A\"}</span>\n                      </div>\n                      <Progress value={10} className=\"h-2\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <Activity className=\"w-5 h-5\" />\n                    Active Services\n                  </CardTitle>\n                  <CardDescription>Currently running background services</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                    <div className=\"flex items-center gap-3 p-4 rounded-lg border\">\n                      <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></div>\n                      <div>\n                        <p className=\"font-medium text-sm\">Express Server</p>\n                        <p className=\"text-xs text-muted-foreground\">Port 5000</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3 p-4 rounded-lg border\">\n                      <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></div>\n                      <div>\n                        <p className=\"font-medium text-sm\">WebSocket</p>\n                        <p className=\"text-xs text-muted-foreground\">Real-time events</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3 p-4 rounded-lg border\">\n                      <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></div>\n                      <div>\n                        <p className=\"font-medium text-sm\">Cron Scheduler</p>\n                        <p className=\"text-xs text-muted-foreground\">Background tasks</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3 p-4 rounded-lg border\">\n                      <div className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></div>\n                      <div>\n                        <p className=\"font-medium text-sm\">PostgreSQL</p>\n                        <p className=\"text-xs text-muted-foreground\">Database</p>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        )}\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":27017,"size_tokens":null},"client/src/pages/admin/communications/Comments.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Search, \n  Trash, \n  GripVertical,\n  Edit,\n  Plus,\n  Star,\n  MessageSquare,\n  Loader2,\n  Eye,\n  HelpCircle,\n  Save,\n  X,\n  Check\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport type { Comment, Review, FAQ } from \"@shared/schema\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\n\nexport default function AdminComments() {\n  const [activeTab, setActiveTab] = useState(\"comments\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [faqDialogOpen, setFaqDialogOpen] = useState(false);\n  const [editingFaq, setEditingFaq] = useState<FAQ | null>(null);\n  const [faqForm, setFaqForm] = useState({ question: \"\", answer: \"\", visible: true, order: 0 });\n  const { toast } = useToast();\n\n  const { data: comments = [], isLoading: commentsLoading } = useQuery<Comment[]>({\n    queryKey: ['/api/comments']\n  });\n\n  const { data: reviews = [], isLoading: reviewsLoading } = useQuery<Review[]>({\n    queryKey: ['/api/reviews']\n  });\n\n  const { data: faqs = [], isLoading: faqsLoading } = useQuery<FAQ[]>({\n    queryKey: ['/api/faqs']\n  });\n\n  const { data: posts = [] } = useQuery<any[]>({\n    queryKey: ['/api/posts']\n  });\n\n  const { data: projects = [] } = useQuery<any[]>({\n    queryKey: ['/api/projects']\n  });\n\n  const deleteCommentMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/comments/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment deleted\" });\n    }\n  });\n\n  const markCommentAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/comments/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment marked as read\" });\n    }\n  });\n\n  const approveCommentMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/comments/${id}/approve`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment approved\" });\n    }\n  });\n\n  const rejectCommentMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/comments/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      toast({ title: \"Comment rejected\" });\n    }\n  });\n\n  const deleteReviewMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/reviews/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      toast({ title: \"Review deleted\" });\n    }\n  });\n\n  const markReviewAsReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/reviews/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      toast({ title: \"Review marked as read\" });\n    }\n  });\n\n  const createFaqMutation = useMutation({\n    mutationFn: async (data: { question: string; answer: string; visible: boolean; order: number }) => {\n      return apiRequest(\"POST\", \"/api/faqs\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ created successfully\" });\n      setFaqDialogOpen(false);\n      resetFaqForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error creating FAQ\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const updateFaqMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: Partial<FAQ> }) => {\n      return apiRequest(\"PUT\", `/api/faqs/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ updated successfully\" });\n      setFaqDialogOpen(false);\n      setEditingFaq(null);\n      resetFaqForm();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error updating FAQ\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const deleteFaqMutation = useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/faqs/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/faqs'] });\n      toast({ title: \"FAQ deleted\" });\n    }\n  });\n\n  const resetFaqForm = () => {\n    setFaqForm({ question: \"\", answer: \"\", visible: true, order: faqs.length });\n    setEditingFaq(null);\n  };\n\n  const openFaqDialog = (faq?: FAQ) => {\n    if (faq) {\n      setEditingFaq(faq);\n      setFaqForm({\n        question: faq.question,\n        answer: faq.answer,\n        visible: faq.visible,\n        order: faq.order\n      });\n    } else {\n      resetFaqForm();\n      setFaqForm(prev => ({ ...prev, order: faqs.length }));\n    }\n    setFaqDialogOpen(true);\n  };\n\n  const handleFaqSubmit = () => {\n    if (!faqForm.question.trim() || !faqForm.answer.trim()) {\n      toast({ title: \"Please fill in all fields\", variant: \"destructive\" });\n      return;\n    }\n    \n    if (editingFaq) {\n      updateFaqMutation.mutate({ id: editingFaq.id, data: faqForm });\n    } else {\n      createFaqMutation.mutate(faqForm);\n    }\n  };\n\n  const getPostTitle = (postId: number | null) => {\n    if (!postId) return null;\n    const post = posts.find((p: any) => p.id === postId);\n    return post?.title || \"Unknown Post\";\n  };\n\n  const getProjectTitle = (projectId: number | null) => {\n    if (!projectId) return null;\n    const project = projects.find((p: any) => p.id === projectId);\n    return project?.title || \"Unknown Project\";\n  };\n\n  const filteredComments = comments.filter(comment => \n    comment.authorName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    comment.content.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const filteredReviews = reviews.filter(review =>\n    review.authorName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    review.content.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const filteredFaqs = faqs.filter(faq =>\n    faq.question.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    faq.answer.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'Approved': return 'border-l-green-500';\n      case 'Pending': return 'border-l-yellow-500';\n      case 'Spam': return 'border-l-red-500';\n      default: return 'border-l-gray-500';\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Interactions</h1>\n            <p className=\"text-muted-foreground\">Manage user comments, reviews, and FAQs</p>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"comments\" value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full max-w-md grid-cols-3\">\n            <TabsTrigger value=\"comments\" data-testid=\"tab-comments\">\n              Comments\n              {comments.filter(c => c.status === 'Pending').length > 0 && (\n                <Badge variant=\"destructive\" className=\"ml-2 h-5 w-5 p-0 flex items-center justify-center text-xs\">\n                  {comments.filter(c => c.status === 'Pending').length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"reviews\" data-testid=\"tab-reviews\">\n              Reviews\n              {reviews.filter(r => r.status === 'Pending').length > 0 && (\n                <Badge variant=\"destructive\" className=\"ml-2 h-5 w-5 p-0 flex items-center justify-center text-xs\">\n                  {reviews.filter(r => r.status === 'Pending').length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"faqs\" data-testid=\"tab-faqs\">\n              FAQs\n              <Badge variant=\"secondary\" className=\"ml-2\">{faqs.length}</Badge>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"comments\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search comments...\" \n                  className=\"pl-9\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-comments\"\n                />\n              </div>\n            </div>\n\n            {commentsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredComments.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <MessageSquare className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No comments yet</h3>\n                <p className=\"text-muted-foreground\">Comments will appear here when users leave them on your content.</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {filteredComments.map((comment) => (\n                  <Card key={comment.id} className={`border-l-4 ${getStatusColor(comment.status)}`} data-testid={`card-comment-${comment.id}`}>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start justify-between gap-4\">\n                        <div className=\"flex gap-4\">\n                          <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center font-bold text-primary\">\n                            {comment.authorName.charAt(0).toUpperCase()}\n                          </div>\n                          <div>\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <span className=\"font-semibold\">{comment.authorName}</span>\n                              <span className=\"text-xs text-muted-foreground\">\n                                {comment.createdAt && formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}\n                              </span>\n                              <Badge variant={comment.status === 'Approved' ? 'default' : comment.status === 'Pending' ? 'secondary' : 'destructive'} className=\"text-xs\">\n                                {comment.status}\n                              </Badge>\n                              {!comment.read && (\n                                <Badge variant=\"outline\" className=\"text-xs bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400\">New</Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm mt-1 text-foreground/90\">{comment.content}</p>\n                            <p className=\"text-xs text-primary mt-2\">\n                              On: {comment.postId ? getPostTitle(comment.postId) : getProjectTitle(comment.projectId)}\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-1\">\n                          {!comment.read && (\n                            <Button \n                              variant=\"ghost\" \n                              size=\"icon\" \n                              className=\"text-primary\"\n                              onClick={() => markCommentAsReadMutation.mutate(comment.id)}\n                              disabled={markCommentAsReadMutation.isPending}\n                              title=\"Mark as read\"\n                              data-testid={`button-read-comment-${comment.id}`}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          {comment.status === 'Pending' && (\n                            <>\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"text-green-500\"\n                                onClick={() => approveCommentMutation.mutate(comment.id)}\n                                disabled={approveCommentMutation.isPending}\n                                title=\"Approve\"\n                                data-testid={`button-approve-comment-${comment.id}`}\n                              >\n                                <Check className=\"w-4 h-4\" />\n                              </Button>\n                              <Button \n                                variant=\"ghost\" \n                                size=\"icon\" \n                                className=\"text-red-500\"\n                                onClick={() => rejectCommentMutation.mutate(comment.id)}\n                                disabled={rejectCommentMutation.isPending}\n                                title=\"Reject\"\n                                data-testid={`button-reject-comment-${comment.id}`}\n                              >\n                                <X className=\"w-4 h-4\" />\n                              </Button>\n                            </>\n                          )}\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteCommentMutation.mutate(comment.id)}\n                            disabled={deleteCommentMutation.isPending}\n                            data-testid={`button-delete-comment-${comment.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"reviews\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search reviews...\" \n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-reviews\"\n                />\n              </div>\n            </div>\n\n            {reviewsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredReviews.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Star className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No reviews yet</h3>\n                <p className=\"text-muted-foreground\">Reviews will appear here when users rate your projects.</p>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredReviews.map((review) => (\n                  <Card key={review.id} className={`border-l-4 ${getStatusColor(review.status)}`} data-testid={`card-review-${review.id}`}>\n                    <CardHeader className=\"flex flex-row items-start justify-between gap-4 pb-2\">\n                      <div>\n                        <CardTitle className=\"text-lg flex items-center gap-2\">\n                          {review.authorName}\n                          {!review.read && (\n                            <Badge variant=\"outline\" className=\"text-xs bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400\">New</Badge>\n                          )}\n                        </CardTitle>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Project: {getProjectTitle(review.projectId)}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {review.createdAt && formatDistanceToNow(new Date(review.createdAt), { addSuffix: true })}\n                        </p>\n                      </div>\n                      <div className=\"flex\">\n                        {[1, 2, 3, 4, 5].map(s => (\n                          <Star \n                            key={s} \n                            className={`w-4 h-4 ${s <= review.rating ? 'text-yellow-500 fill-yellow-500' : 'text-gray-300'}`} \n                          />\n                        ))}\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm italic\">\"{review.content}\"</p>\n                      <div className=\"flex justify-between items-center gap-2 mt-4\">\n                        <Badge variant=\"default\">\n                          {review.status}\n                        </Badge>\n                        <div className=\"flex gap-1\">\n                          {!review.read && (\n                            <Button \n                              variant=\"ghost\" \n                              size=\"icon\" \n                              className=\"text-primary\"\n                              onClick={() => markReviewAsReadMutation.mutate(review.id)}\n                              disabled={markReviewAsReadMutation.isPending}\n                              title=\"Mark as read\"\n                              data-testid={`button-read-review-${review.id}`}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                          )}\n                          <Button \n                            variant=\"ghost\" \n                            size=\"icon\" \n                            className=\"text-destructive\"\n                            onClick={() => deleteReviewMutation.mutate(review.id)}\n                            disabled={deleteReviewMutation.isPending}\n                            data-testid={`button-delete-review-${review.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"faqs\" className=\"space-y-6 mt-6\">\n            <div className=\"flex justify-between gap-4 flex-wrap\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search FAQs...\" \n                  className=\"pl-9\" \n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-faqs\" \n                />\n              </div>\n              <Button onClick={() => openFaqDialog()} data-testid=\"button-add-faq\">\n                <Plus className=\"w-4 h-4 mr-2\" /> Add Question\n              </Button>\n            </div>\n            \n            {faqsLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredFaqs.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <HelpCircle className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold\">No FAQs yet</h3>\n                <p className=\"text-muted-foreground\">Add frequently asked questions to help your visitors.</p>\n                <Button onClick={() => openFaqDialog()} className=\"mt-4\">\n                  <Plus className=\"w-4 h-4 mr-2\" /> Add Your First FAQ\n                </Button>\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {filteredFaqs.map((faq) => (\n                  <div \n                    key={faq.id} \n                    className={`flex items-center gap-4 p-4 bg-card border border-border rounded-lg group ${!faq.visible ? 'opacity-60' : ''}`} \n                    data-testid={`card-faq-${faq.id}`}\n                  >\n                    <div className=\"cursor-grab text-muted-foreground hover:text-foreground\">\n                      <GripVertical className=\"w-5 h-5\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2\">\n                        <h4 className=\"font-semibold\">{faq.question}</h4>\n                        {!faq.visible && (\n                          <Badge variant=\"outline\" className=\"text-xs\">Hidden</Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground line-clamp-2\">{faq.answer}</p>\n                    </div>\n                    <div className=\"invisible group-hover:visible flex gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        onClick={() => openFaqDialog(faq)}\n                        data-testid={`button-edit-faq-${faq.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"text-destructive\"\n                        onClick={() => deleteFaqMutation.mutate(faq.id)}\n                        disabled={deleteFaqMutation.isPending}\n                        data-testid={`button-delete-faq-${faq.id}`}\n                      >\n                        <Trash className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={faqDialogOpen} onOpenChange={setFaqDialogOpen}>\n        <DialogContent className=\"sm:max-w-[500px]\">\n          <DialogHeader>\n            <DialogTitle>{editingFaq ? \"Edit FAQ\" : \"Add New FAQ\"}</DialogTitle>\n            <DialogDescription>\n              {editingFaq ? \"Update this frequently asked question.\" : \"Add a new frequently asked question to help your visitors.\"}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"question\">Question</Label>\n              <Input\n                id=\"question\"\n                placeholder=\"e.g., What technologies do you specialize in?\"\n                value={faqForm.question}\n                onChange={(e) => setFaqForm({ ...faqForm, question: e.target.value })}\n                data-testid=\"input-faq-question\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"answer\">Answer</Label>\n              <Textarea\n                id=\"answer\"\n                placeholder=\"Provide a helpful answer...\"\n                rows={4}\n                value={faqForm.answer}\n                onChange={(e) => setFaqForm({ ...faqForm, answer: e.target.value })}\n                data-testid=\"input-faq-answer\"\n              />\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"visible\"\n                  checked={faqForm.visible}\n                  onCheckedChange={(checked) => setFaqForm({ ...faqForm, visible: checked })}\n                  data-testid=\"switch-faq-visible\"\n                />\n                <Label htmlFor=\"visible\">Visible on website</Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Label htmlFor=\"order\" className=\"text-sm\">Order:</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  className=\"w-20\"\n                  min=\"0\"\n                  value={faqForm.order}\n                  onChange={(e) => setFaqForm({ ...faqForm, order: parseInt(e.target.value) || 0 })}\n                  data-testid=\"input-faq-order\"\n                />\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setFaqDialogOpen(false)}>\n              <X className=\"w-4 h-4 mr-2\" /> Cancel\n            </Button>\n            <Button \n              onClick={handleFaqSubmit}\n              disabled={createFaqMutation.isPending || updateFaqMutation.isPending}\n              data-testid=\"button-save-faq\"\n            >\n              {(createFaqMutation.isPending || updateFaqMutation.isPending) ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4 mr-2\" />\n              )}\n              {editingFaq ? \"Update\" : \"Save\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":26585,"size_tokens":null},"client/src/pages/admin/dashboard/Analytics.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  BarChart, \n  Bar, \n  LineChart, \n  Line, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer, \n  PieChart, \n  Pie, \n  Cell \n} from \"recharts\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Download, RefreshCw, Loader2, Eye, FileText, Briefcase, MessageSquare, Star } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useState } from \"react\";\n\ninterface DashboardStats {\n  totalProjects: number;\n  publishedProjects: number;\n  totalPosts: number;\n  publishedPosts: number;\n  totalMessages: number;\n  unreadMessages: number;\n  totalUsers: number;\n  totalComments: number;\n  totalReviews: number;\n  pendingReviews: number;\n  totalViews: number;\n}\n\nexport default function AdminAnalytics() {\n  const { toast } = useToast();\n  const [dateRange, setDateRange] = useState(\"7days\");\n\n  const { data: stats, isLoading, refetch } = useQuery<DashboardStats>({\n    queryKey: [\"/api/dashboard/stats\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/dashboard/stats\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch stats\");\n      return res.json();\n    },\n  });\n\n  const { data: posts = [] } = useQuery<any[]>({\n    queryKey: [\"/api/posts\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/posts\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch posts\");\n      return res.json();\n    },\n  });\n\n  const { data: projects = [] } = useQuery<any[]>({\n    queryKey: [\"/api/projects\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/projects\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch projects\");\n      return res.json();\n    },\n  });\n\n  // Fetch real analytics data\n  const { data: analyticsData } = useQuery({\n    queryKey: ['/api/analytics/daily', { days: 7 }],\n    queryFn: async () => {\n      const res = await fetch('/api/analytics/daily?days=7', { credentials: 'include' });\n      if (!res.ok) throw new Error('Failed to fetch analytics');\n      return res.json();\n    },\n  });\n\n  const trafficData = analyticsData?.map((day: any) => ({\n    date: new Date(day.date).toLocaleDateString('en-US', { weekday: 'short' }),\n    posts: day.postViews || 0,\n    projects: day.projectViews || 0,\n    views: day.totalViews || 0,\n  })) || [];\n\n  // Top content by views\n  const topContent = [\n    ...posts.filter(p => p.status === \"Published\").map(p => ({\n      title: p.title,\n      path: `/blog/${p.slug}`,\n      views: p.views || 0,\n      type: \"post\"\n    })),\n    ...projects.filter(p => p.status === \"Published\").map(p => ({\n      title: p.title,\n      path: `/projects/${p.id}`,\n      views: p.views || 0,\n      type: \"project\"\n    }))\n  ].sort((a, b) => b.views - a.views).slice(0, 5);\n\n  // Content status data\n  const contentStatusData = [\n    { name: \"Published Posts\", value: stats?.publishedPosts || 0, color: \"#7c3aed\" },\n    { name: \"Draft Posts\", value: (stats?.totalPosts || 0) - (stats?.publishedPosts || 0), color: \"#8b5cf6\" },\n    { name: \"Published Projects\", value: stats?.publishedProjects || 0, color: \"#3b82f6\" },\n    { name: \"Draft Projects\", value: (stats?.totalProjects || 0) - (stats?.publishedProjects || 0), color: \"#60a5fa\" },\n  ];\n\n  const handleExport = () => {\n    const csvContent = [\n      [\"Analytics Report\", new Date().toLocaleDateString()],\n      [],\n      [\"Metric\", \"Value\"],\n      [\"Total Views\", stats?.totalViews || 0],\n      [\"Total Posts\", stats?.totalPosts || 0],\n      [\"Published Posts\", stats?.publishedPosts || 0],\n      [\"Total Projects\", stats?.totalProjects || 0],\n      [\"Published Projects\", stats?.publishedProjects || 0],\n      [\"Total Messages\", stats?.totalMessages || 0],\n      [\"Unread Messages\", stats?.unreadMessages || 0],\n      [\"Total Comments\", stats?.totalComments || 0],\n      [\"Total Reviews\", stats?.totalReviews || 0],\n      [\"Pending Reviews\", stats?.pendingReviews || 0],\n      [\"Total Users\", stats?.totalUsers || 0],\n    ].map(row => row.join(\",\")).join(\"\\n\");\n\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `analytics_${new Date().toISOString().split(\"T\")[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    toast({ title: \"Success\", description: \"Analytics exported successfully\" });\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Analytics</h1>\n            <p className=\"text-muted-foreground\">Detailed insights into your website performance</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => refetch()}\n              data-testid=\"button-refresh-analytics\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleExport}\n              data-testid=\"button-export-analytics\"\n            >\n              <Download className=\"w-4 h-4 mr-1\" /> Export\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n            <TabsTrigger value=\"content\">Content</TabsTrigger>\n            <TabsTrigger value=\"engagement\">Engagement</TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <Eye className=\"w-4 h-4 text-primary\" /> Total Views\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalViews || 0}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Posts + Projects</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <FileText className=\"w-4 h-4 text-blue-500\" /> Posts\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.publishedPosts}/{stats?.totalPosts}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Published / Total</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <Briefcase className=\"w-4 h-4 text-purple-500\" /> Projects\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.publishedProjects}/{stats?.totalProjects}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Published / Total</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <MessageSquare className=\"w-4 h-4 text-green-500\" /> Messages\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalMessages}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {stats?.unreadMessages} unread\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Traffic Trend</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[300px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <LineChart data={trafficData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.1)\" />\n                      <XAxis dataKey=\"date\" stroke=\"rgba(255,255,255,0.5)\" />\n                      <YAxis stroke=\"rgba(255,255,255,0.5)\" />\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                      <Line type=\"monotone\" dataKey=\"posts\" stroke=\"#7c3aed\" strokeWidth={2} name=\"Posts\" />\n                      <Line type=\"monotone\" dataKey=\"projects\" stroke=\"#3b82f6\" strokeWidth={2} name=\"Projects\" />\n                    </LineChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Top Content</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {topContent.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No content yet</p>\n                    ) : (\n                      topContent.map((item, i) => (\n                        <div key={i} className=\"flex items-center justify-between border-b border-border pb-2 last:border-0\">\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"text-sm font-medium truncate\">{item.title}</p>\n                            <p className=\"text-xs text-muted-foreground\">{item.type}</p>\n                          </div>\n                          <Badge variant=\"outline\">{item.views} views</Badge>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Engagement Metrics</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Comments</span>\n                    <span className=\"font-bold\">{stats?.totalComments}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Reviews</span>\n                    <span className=\"font-bold\">{stats?.totalReviews}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-yellow-500/5 rounded-lg\">\n                    <span className=\"text-sm\">Pending Reviews</span>\n                    <span className=\"font-bold text-yellow-500\">{stats?.pendingReviews}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-primary/5 rounded-lg\">\n                    <span className=\"text-sm\">Total Users</span>\n                    <span className=\"font-bold\">{stats?.totalUsers}</span>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Content Tab */}\n          <TabsContent value=\"content\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Posts Overview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Posts</span>\n                      <Badge variant=\"default\">{stats?.totalPosts}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Published</span>\n                      <Badge variant=\"outline\" className=\"bg-green-500/10\">{stats?.publishedPosts}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Draft</span>\n                      <Badge variant=\"secondary\">{(stats?.totalPosts || 0) - (stats?.publishedPosts || 0)}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Post Views</span>\n                      <Badge variant=\"outline\">{posts.reduce((sum, p) => sum + (p.views || 0), 0)}</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Projects Overview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Projects</span>\n                      <Badge variant=\"default\">{stats?.totalProjects}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Published</span>\n                      <Badge variant=\"outline\" className=\"bg-blue-500/10\">{stats?.publishedProjects}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Draft</span>\n                      <Badge variant=\"secondary\">{(stats?.totalProjects || 0) - (stats?.publishedProjects || 0)}</Badge>\n                    </div>\n                    <div className=\"flex justify-between items-center p-3 border rounded-lg\">\n                      <span>Total Project Views</span>\n                      <Badge variant=\"outline\">{projects.reduce((sum, p) => sum + (p.views || 0), 0)}</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Content Distribution</CardTitle>\n              </CardHeader>\n              <CardContent className=\"flex justify-center\">\n                <div className=\"h-[300px] w-full max-w-sm\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <PieChart>\n                      <Pie\n                        data={contentStatusData.filter(d => d.value > 0)}\n                        innerRadius={60}\n                        outerRadius={100}\n                        paddingAngle={5}\n                        dataKey=\"value\"\n                      >\n                        {contentStatusData.map((entry, index) => (\n                          <Cell key={`cell-${index}`} fill={entry.color} />\n                        ))}\n                      </Pie>\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                    </PieChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Engagement Tab */}\n          <TabsContent value=\"engagement\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Total Comments</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold\">{stats?.totalComments}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">User interactions</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Total Reviews</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold\">{stats?.totalReviews}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Project ratings</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm\">Pending Reviews</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-yellow-500\">{stats?.pendingReviews}</div>\n                  <p className=\"text-xs text-muted-foreground mt-1\">Awaiting approval</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Message Activity</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-4 bg-primary/5 rounded-lg\">\n                    <div>\n                      <p className=\"font-semibold\">Total Messages</p>\n                      <p className=\"text-xs text-muted-foreground\">All incoming messages</p>\n                    </div>\n                    <div className=\"text-2xl font-bold\">{stats?.totalMessages}</div>\n                  </div>\n                  <div className=\"flex justify-between items-center p-4 bg-red-500/5 rounded-lg\">\n                    <div>\n                      <p className=\"font-semibold\">Unread Messages</p>\n                      <p className=\"text-xs text-muted-foreground\">Require attention</p>\n                    </div>\n                    <div className=\"text-2xl font-bold text-red-500\">{stats?.unreadMessages}</div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Engagement Bar Chart</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-[300px]\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <BarChart data={[\n                      { name: \"Comments\", value: stats?.totalComments || 0 },\n                      { name: \"Reviews\", value: stats?.totalReviews || 0 },\n                      { name: \"Messages\", value: stats?.totalMessages || 0 },\n                    ]}>\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.1)\" />\n                      <XAxis dataKey=\"name\" stroke=\"rgba(255,255,255,0.5)\" />\n                      <YAxis stroke=\"rgba(255,255,255,0.5)\" />\n                      <Tooltip contentStyle={{ backgroundColor: \"#1e293b\", border: \"none\", borderRadius: \"8px\" }} />\n                      <Bar dataKey=\"value\" fill=\"#7c3aed\" />\n                    </BarChart>\n                  </ResponsiveContainer>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":20063,"size_tokens":null},"client/src/pages/admin/settings/Social.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  Facebook, \n  Twitter, \n  Linkedin, \n  Instagram, \n  Github, \n  Youtube,\n  Share2,\n  BarChart2,\n  Calendar,\n  Image as ImageIcon,\n  Link as LinkIcon\n} from \"lucide-react\";\n\nexport default function AdminSocial() {\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Social Media</h1>\n            <p className=\"text-muted-foreground\">Manage integrations and auto-posting</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n             <Share2 className=\"w-4 h-4\" /> Create New Post\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n           {/* Connected Accounts */}\n           <div className=\"lg:col-span-1 space-y-6\">\n              <h2 className=\"text-xl font-bold\">Connected Accounts</h2>\n              <div className=\"space-y-4\">\n                 {[\n                    { name: \"Facebook\", icon: Facebook, connected: true, handle: \"@loideveloper\" },\n                    { name: \"Twitter / X\", icon: Twitter, connected: true, handle: \"@loicode\" },\n                    { name: \"LinkedIn\", icon: Linkedin, connected: false, handle: \"\" },\n                    { name: \"Instagram\", icon: Instagram, connected: true, handle: \"@loi.dev\" },\n                    { name: \"GitHub\", icon: Github, connected: true, handle: \"@loigit\" },\n                 ].map((platform, i) => (\n                    <Card key={i} className=\"overflow-hidden\">\n                       <CardContent className=\"p-4 flex items-center justify-between\">\n                          <div className=\"flex items-center gap-3\">\n                             <div className=\"p-2 bg-muted rounded-full\">\n                                <platform.icon className=\"w-5 h-5\" />\n                             </div>\n                             <div>\n                                <h4 className=\"font-medium\">{platform.name}</h4>\n                                {platform.connected ? (\n                                   <span className=\"text-xs text-green-500 flex items-center gap-1\">\n                                      â— Connected as {platform.handle}\n                                   </span>\n                                ) : (\n                                   <span className=\"text-xs text-muted-foreground\">Not connected</span>\n                                )}\n                             </div>\n                          </div>\n                          <Switch checked={platform.connected} />\n                       </CardContent>\n                    </Card>\n                 ))}\n              </div>\n           </div>\n\n           {/* Post Scheduler & Analytics */}\n           <div className=\"lg:col-span-2 space-y-6\">\n              <Card>\n                 <CardHeader>\n                    <CardTitle>Auto-Post Settings</CardTitle>\n                    <CardDescription>Configure automatic sharing when new content is published</CardDescription>\n                 </CardHeader>\n                 <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                       <div className=\"space-y-0.5\">\n                          <h4 className=\"font-medium\">Share New Blog Posts</h4>\n                          <p className=\"text-sm text-muted-foreground\">Automatically tweet and post to LinkedIn when a new blog is published</p>\n                       </div>\n                       <Switch defaultChecked />\n                    </div>\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                       <div className=\"space-y-0.5\">\n                          <h4 className=\"font-medium\">Share New Projects</h4>\n                          <p className=\"text-sm text-muted-foreground\">Post to Instagram and Facebook when a portfolio item is added</p>\n                       </div>\n                       <Switch defaultChecked />\n                    </div>\n                 </CardContent>\n              </Card>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                 <Card>\n                    <CardHeader>\n                       <CardTitle className=\"flex items-center gap-2\">\n                          <BarChart2 className=\"w-5 h-5\" /> Engagement\n                       </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                       <div className=\"text-3xl font-bold mb-2\">12.5K</div>\n                       <p className=\"text-sm text-muted-foreground\">Total interactions this month</p>\n                       <div className=\"mt-4 h-24 flex items-end gap-1\">\n                          {[40, 65, 45, 80, 55, 90, 70].map((h, i) => (\n                             <div key={i} className=\"flex-1 bg-primary/20 rounded-t hover:bg-primary/50 transition-colors\" style={{ height: `${h}%` }} />\n                          ))}\n                       </div>\n                    </CardContent>\n                 </Card>\n\n                 <Card>\n                    <CardHeader>\n                       <CardTitle className=\"flex items-center gap-2\">\n                          <Calendar className=\"w-5 h-5\" /> Scheduled Posts\n                       </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                       <div className=\"space-y-4\">\n                          {[\n                             { title: \"React 19 Feature Breakdown\", time: \"Tomorrow, 10:00 AM\", platforms: [Twitter, Linkedin] },\n                             { title: \"Project Showcase: E-commerce\", time: \"Fri, 2:00 PM\", platforms: [Instagram, Facebook] },\n                          ].map((post, i) => (\n                             <div key={i} className=\"flex items-center justify-between border-b last:border-0 pb-2 last:pb-0\">\n                                <div>\n                                   <p className=\"font-medium text-sm truncate max-w-[150px]\">{post.title}</p>\n                                   <p className=\"text-xs text-muted-foreground\">{post.time}</p>\n                                </div>\n                                <div className=\"flex gap-1\">\n                                   {post.platforms.map((Icon, idx) => (\n                                      <Icon key={idx} className=\"w-3 h-3 text-muted-foreground\" />\n                                   ))}\n                                </div>\n                             </div>\n                          ))}\n                       </div>\n                       <Button variant=\"outline\" size=\"sm\" className=\"w-full mt-4\">View Calendar</Button>\n                    </CardContent>\n                 </Card>\n              </div>\n           </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":7292,"size_tokens":null},"server/api/auth.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth, requireAdmin } from \"../middleware/auth\";\nimport { hashPassword, verifyPassword } from \"../utils/password\";\nimport { verifyCaptcha } from \"../utils/captcha\";\nimport { insertUserSchema } from \"@shared/schema\";\nimport { loginRateLimitMiddleware, recordFailedLogin, clearLoginAttempts } from \"../middleware/security\";\n// @ts-ignore - speakeasy doesn't have type definitions\nimport speakeasy from \"speakeasy\";\n// @ts-ignore - qrcode types may be incomplete  \nimport QRCode from \"qrcode\";\nimport { \n  generateRegistrationOptions, \n  verifyRegistrationResponse,\n  generateAuthenticationOptions,\n  verifyAuthenticationResponse \n} from \"@simplewebauthn/server\";\n\nconst router = Router();\n\n// WebAuthn configuration\nconst rpName = \"Loi Developer Portfolio\";\nconst rpID = process.env.RP_ID || \"localhost\";\nconst origin = process.env.ORIGIN || `http://localhost:5000`;\n\n// 2FA: Generate secret and QR code\nrouter.post('/2fa/generate', requireAuth, async (req, res) => {\n  try {\n    const user = await storage.getUser(req.session.userId!);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    const secret = speakeasy.generateSecret({\n      name: `Loi Developer (${user.email})`,\n      issuer: \"Loi Developer Portfolio\"\n    });\n\n    req.session.temp2FASecret = secret.base32;\n\n    const qrCodeUrl = await QRCode.toDataURL(secret.otpauth_url!);\n\n    res.json({\n      secret: secret.base32,\n      qrCode: qrCodeUrl\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// 2FA: Verify and enable\nrouter.post('/2fa/verify', requireAuth, async (req, res) => {\n  try {\n    const { token } = req.body;\n    const secret = req.session.temp2FASecret;\n\n    if (!secret) {\n      return res.status(400).json({ message: \"No 2FA setup in progress\" });\n    }\n\n    const verified = speakeasy.totp.verify({\n      secret,\n      encoding: 'base32',\n      token,\n      window: 2\n    });\n\n    if (!verified) {\n      return res.status(400).json({ message: \"Invalid verification code\" });\n    }\n\n    await storage.updateUser(req.session.userId!, {\n      twoFactorSecret: secret,\n      twoFactorEnabled: true\n    });\n\n    delete req.session.temp2FASecret;\n\n    await storage.createActivityLog({\n      action: \"2FA enabled\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"success\"\n    });\n\n    res.json({ message: \"2FA enabled successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// 2FA: Disable\nrouter.post('/2fa/disable', requireAuth, async (req, res) => {\n  try {\n    const { token } = req.body;\n    const user = await storage.getUser(req.session.userId!);\n\n    if (!user?.twoFactorSecret) {\n      return res.status(400).json({ message: \"2FA not enabled\" });\n    }\n\n    const verified = speakeasy.totp.verify({\n      secret: user.twoFactorSecret,\n      encoding: 'base32',\n      token,\n      window: 2\n    });\n\n    if (!verified) {\n      return res.status(400).json({ message: \"Invalid verification code\" });\n    }\n\n    await storage.updateUser(req.session.userId!, {\n      twoFactorSecret: null,\n      twoFactorEnabled: false\n    });\n\n    await storage.createActivityLog({\n      action: \"2FA disabled\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n\n    res.json({ message: \"2FA disabled successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// 2FA: Verify token during login (legacy)\nrouter.post(\"/2fa/login\", async (req, res) => {\n  try {\n    const { userId, token } = req.body;\n    const user = await storage.getUser(userId);\n\n    if (!user?.twoFactorSecret) {\n      return res.status(400).json({ message: \"2FA not enabled for this user\" });\n    }\n\n    const verified = speakeasy.totp.verify({\n      secret: user.twoFactorSecret,\n      encoding: 'base32',\n      token,\n      window: 2\n    });\n\n    if (!verified) {\n      return res.status(400).json({ message: \"Invalid verification code\" });\n    }\n\n    req.session.userId = user.id;\n    req.session.username = user.username;\n    req.session.role = user.role;\n\n    const { password: _, twoFactorSecret: __, ...userWithoutSensitive } = user;\n    res.json({ user: userWithoutSensitive });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// 2FA: Verify during login flow (session-based)\nrouter.post(\"/2fa/verify-login\", async (req, res) => {\n  try {\n    const { code } = req.body;\n    const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n    const userAgent = req.get('User-Agent') || 'unknown';\n\n    if (!req.session.pending2FA || !req.session.pendingUserId) {\n      return res.status(400).json({ message: \"No pending 2FA verification\" });\n    }\n\n    const user = await storage.getUser(req.session.pendingUserId);\n    if (!user || !user.twoFactorSecret) {\n      return res.status(400).json({ message: \"User not found or 2FA not enabled\" });\n    }\n\n    const verified = speakeasy.totp.verify({\n      secret: user.twoFactorSecret,\n      encoding: 'base32',\n      token: code,\n      window: 2\n    });\n\n    if (!verified) {\n      await storage.createSecurityLog({\n        action: \"Failed 2FA verification\",\n        userId: user.id,\n        userName: user.username,\n        ipAddress: clientIp,\n        userAgent: userAgent,\n        eventType: \"two_factor_failed\",\n        blocked: false\n      });\n      return res.status(400).json({ message: \"Invalid verification code\" });\n    }\n\n    req.session.regenerate(async (err) => {\n      if (err) {\n        console.error('Session regeneration failed:', err);\n        return res.status(500).json({ message: \"Session error, please try again\" });\n      }\n\n      req.session.userId = user.id;\n      req.session.username = user.username;\n      req.session.role = user.role;\n\n      await storage.createSecurityLog({\n        action: \"Successful 2FA login\",\n        userId: user.id,\n        userName: user.username,\n        ipAddress: clientIp,\n        userAgent: userAgent,\n        eventType: \"login\",\n        blocked: false\n      });\n\n      const { password: _, twoFactorSecret: __, ...userWithoutSensitive } = user;\n      res.json({ user: userWithoutSensitive, message: \"Login successful\" });\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Login\nrouter.post(\"/login\", loginRateLimitMiddleware, async (req, res) => {\n  try {\n    const { username, password, captchaToken, captchaType } = req.body;\n    const clientIp = req.ip || req.socket.remoteAddress || 'unknown';\n    const userAgent = req.get('User-Agent') || 'unknown';\n\n    if (!username || !password) {\n      return res.status(400).json({ message: \"Username and password required\" });\n    }\n\n    const captchaResult = await verifyCaptcha(captchaToken, captchaType);\n    if (!captchaResult.success) {\n      recordFailedLogin(clientIp);\n      await storage.createSecurityLog({\n        action: `Failed login attempt - captcha failed`,\n        userId: null,\n        userName: username,\n        ipAddress: clientIp,\n        userAgent: userAgent,\n        eventType: \"login_failed\",\n        blocked: true\n      });\n      return res.status(400).json({ message: captchaResult.error || \"Captcha verification failed\" });\n    }\n\n    const user = await storage.getUserByUsernameOrEmail(username);\n    if (!user) {\n      recordFailedLogin(clientIp);\n      await storage.createSecurityLog({\n        action: `Failed login attempt - user not found`,\n        userId: null,\n        userName: username,\n        ipAddress: clientIp,\n        userAgent: userAgent,\n        eventType: \"login_failed\",\n        blocked: true\n      });\n      return res.status(401).json({ message: \"Invalid credentials\" });\n    }\n\n    const isValid = await verifyPassword(password, user.password);\n    if (!isValid) {\n      recordFailedLogin(clientIp);\n      await storage.createSecurityLog({\n        action: `Failed login attempt - invalid password`,\n        userId: user.id,\n        userName: user.username,\n        ipAddress: clientIp,\n        userAgent: userAgent,\n        eventType: \"login_failed\",\n        blocked: true\n      });\n      return res.status(401).json({ message: \"Invalid credentials\" });\n    }\n\n    clearLoginAttempts(clientIp);\n\n    if (user.twoFactorEnabled) {\n      const webAuthnCredentials = await storage.getWebAuthnCredentialsByUser(user.id);\n      const hasBiometric = webAuthnCredentials.length > 0;\n\n      req.session.pending2FA = true;\n      req.session.pendingUserId = user.id;\n      return res.json({ \n        requires2FA: true,\n        hasBiometric,\n        message: \"Please enter your 2FA code\"\n      });\n    }\n\n    const passwordExpirationSetting = await storage.getSecuritySetting('passwordExpiration');\n    if (passwordExpirationSetting?.value === 'true' || passwordExpirationSetting?.value === true) {\n      if (user.passwordUpdatedAt) {\n        const passwordAge = Date.now() - new Date(user.passwordUpdatedAt).getTime();\n        const maxAge = 90 * 24 * 60 * 60 * 1000;\n        if (passwordAge > maxAge) {\n          await storage.createSecurityLog({\n            action: `Login blocked - password expired`,\n            userId: user.id,\n            userName: user.username,\n            ipAddress: clientIp,\n            userAgent: userAgent,\n            eventType: \"password_expired\",\n            blocked: true\n          });\n          return res.status(403).json({ \n            passwordExpired: true,\n            userId: user.id,\n            message: \"Your password has expired. Please reset it to continue.\"\n          });\n        }\n      } else {\n        const now = new Date();\n        const expiresAt = new Date(now.getTime() + 90 * 24 * 60 * 60 * 1000);\n        await storage.updateUser(user.id, {\n          passwordUpdatedAt: now,\n          passwordExpiresAt: expiresAt\n        });\n      }\n    }\n\n    req.session.userId = user.id;\n    req.session.username = user.username;\n    req.session.role = user.role;\n\n    const sessionExpiry = new Date();\n    sessionExpiry.setHours(sessionExpiry.getHours() + 24);\n\n    try {\n      await storage.terminateSessionBySessionId(req.sessionID);\n    } catch (e) {\n    }\n\n    await storage.createUserSession({\n      sessionId: req.sessionID,\n      userId: user.id,\n      ipAddress: clientIp,\n      userAgent: userAgent,\n      deviceInfo: userAgent,\n      location: 'Unknown',\n      expiresAt: sessionExpiry\n    });\n\n    await storage.createActivityLog({\n      action: `User ${user.name} logged in`,\n      userId: user.id,\n      userName: user.name,\n      type: \"success\"\n    });\n\n    await storage.createSecurityLog({\n      action: `Successful login`,\n      userId: user.id,\n      userName: user.username,\n      ipAddress: clientIp,\n      userAgent: userAgent,\n      eventType: \"login_success\",\n      blocked: false\n    });\n\n    const { password: _, ...userWithoutPassword } = user;\n    res.json({ user: userWithoutPassword });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Logout\nrouter.post(\"/logout\", (req, res) => {\n  req.session.destroy((err) => {\n    if (err) {\n      return res.status(500).json({ message: \"Could not log out\" });\n    }\n    res.json({ message: \"Logged out successfully\" });\n  });\n});\n\n// Get current user\nrouter.get(\"/me\", requireAuth, async (req, res) => {\n  try {\n    const user = await storage.getUser(req.session.userId!);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    const { password, ...userWithoutPassword } = user;\n    res.json(userWithoutPassword);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Profile update\nrouter.put(\"/profile\", requireAuth, async (req, res) => {\n  try {\n    const userId = req.session.userId!;\n    const { name, email, username, avatar } = req.body;\n\n    const updateData: any = {};\n    if (name !== undefined) updateData.name = name;\n    if (email !== undefined) updateData.email = email;\n    if (username !== undefined) updateData.username = username;\n    if (avatar !== undefined) updateData.avatar = avatar;\n\n    if (username) {\n      const existingUser = await storage.getUserByUsername(username);\n      if (existingUser && existingUser.id !== userId) {\n        return res.status(400).json({ message: \"Username already taken\" });\n      }\n    }\n\n    if (email) {\n      const existingEmail = await storage.getUserByEmail(email);\n      if (existingEmail && existingEmail.id !== userId) {\n        return res.status(400).json({ message: \"Email already taken\" });\n      }\n    }\n\n    const user = await storage.updateUser(userId, updateData);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    if (username) {\n      req.session.username = username;\n    }\n\n    const { password, ...userWithoutPassword } = user;\n    res.json(userWithoutPassword);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Force password reset for expired passwords\nrouter.post(\"/force-password-reset\", async (req, res) => {\n  try {\n    const { userId, currentPassword, newPassword } = req.body;\n\n    if (!userId || !currentPassword || !newPassword) {\n      return res.status(400).json({ message: \"All fields are required\" });\n    }\n\n    const user = await storage.getUser(userId);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    const isValid = await verifyPassword(currentPassword, user.password);\n    if (!isValid) {\n      return res.status(401).json({ message: \"Current password is incorrect\" });\n    }\n\n    const hashedPassword = await hashPassword(newPassword);\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + 90 * 24 * 60 * 60 * 1000);\n\n    await storage.updateUser(userId, { \n      password: hashedPassword,\n      passwordUpdatedAt: now,\n      passwordExpiresAt: expiresAt\n    });\n\n    await storage.createActivityLog({\n      action: 'Forced password reset due to expiration',\n      userId: user.id,\n      userName: user.username,\n      type: 'warning'\n    });\n\n    res.json({ message: \"Password reset successfully. You can now login.\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Password change\nrouter.put(\"/password\", requireAuth, async (req, res) => {\n  try {\n    const userId = req.session.userId!;\n    const { currentPassword, newPassword } = req.body;\n\n    if (!currentPassword || !newPassword) {\n      return res.status(400).json({ message: \"Current password and new password are required\" });\n    }\n\n    const user = await storage.getUser(userId);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    const isValid = await verifyPassword(currentPassword, user.password);\n    if (!isValid) {\n      return res.status(401).json({ message: \"Current password is incorrect\" });\n    }\n\n    const hashedPassword = await hashPassword(newPassword);\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + 90 * 24 * 60 * 60 * 1000);\n\n    await storage.updateUser(userId, { \n      password: hashedPassword,\n      passwordUpdatedAt: now,\n      passwordExpiresAt: expiresAt\n    });\n\n    await storage.createActivityLog({\n      action: 'Password changed successfully',\n      userId: userId,\n      userName: req.session.username || 'Unknown',\n      type: 'success'\n    });\n\n    res.json({ message: \"Password updated successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Register new user (admin only)\nrouter.post(\"/register\", requireAdmin, async (req, res) => {\n  try {\n    const parsed = insertUserSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const existing = await storage.getUserByUsername(parsed.data.username);\n    if (existing) {\n      return res.status(400).json({ message: \"Username already exists\" });\n    }\n    const hashedPassword = await hashPassword(parsed.data.password);\n    const user = await storage.createUser({\n      ...parsed.data,\n      password: hashedPassword\n    });\n    const { password: _, ...userWithoutPassword } = user;\n    res.status(201).json({ user: userWithoutPassword });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// WebAuthn: Generate registration options\nrouter.get(\"/webauthn/register/options\", requireAuth, async (req, res) => {\n  try {\n    const user = await storage.getUser(req.session.userId!);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    const options = await generateRegistrationOptions({\n      rpName,\n      rpID,\n      userID: new TextEncoder().encode(user.id.toString()),\n      userName: user.email,\n      attestationType: 'none',\n      authenticatorSelection: {\n        residentKey: 'preferred',\n        userVerification: 'preferred',\n      },\n    });\n\n    req.session.currentChallenge = options.challenge;\n\n    res.json(options);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// WebAuthn: Verify registration\nrouter.post(\"/webauthn/register/verify\", requireAuth, async (req, res) => {\n  try {\n    const { credential, deviceName } = req.body;\n    const expectedChallenge = req.session.currentChallenge;\n\n    if (!expectedChallenge) {\n      return res.status(400).json({ message: \"No challenge in session\" });\n    }\n\n    const verification = await verifyRegistrationResponse({\n      response: credential,\n      expectedChallenge,\n      expectedOrigin: origin,\n      expectedRPID: rpID,\n    });\n\n    if (!verification.verified || !verification.registrationInfo) {\n      return res.status(400).json({ message: \"Verification failed\" });\n    }\n\n    const { credential: webauthnCredential } = verification.registrationInfo;\n    const credentialId = Buffer.from(webauthnCredential.id).toString('base64');\n    const publicKey = Buffer.from(webauthnCredential.publicKey).toString('base64');\n    const counter = webauthnCredential.counter;\n\n    await storage.createWebAuthnCredential({\n      userId: req.session.userId!,\n      credentialId,\n      publicKey,\n      counter,\n      deviceName: deviceName || 'Biometric Device'\n    });\n\n    delete req.session.currentChallenge;\n\n    await storage.createActivityLog({\n      action: `Biometric login registered: ${deviceName || 'Biometric Device'}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"success\"\n    });\n\n    res.json({ verified: true });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// WebAuthn: Generate authentication options\nrouter.post(\"/webauthn/login/options\", async (req, res) => {\n  try {\n    const { email } = req.body;\n\n    if (!req.session.pending2FA || !req.session.pendingUserId) {\n      return res.status(400).json({ message: \"Please login with password first\" });\n    }\n\n    const user = await storage.getUserByEmail(email);\n\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    if (req.session.pendingUserId && req.session.pendingUserId !== user.id) {\n      return res.status(400).json({ message: \"Invalid session state\" });\n    }\n\n    const credentials = await storage.getWebAuthnCredentialsByUser(user.id);\n\n    if (credentials.length === 0) {\n      return res.status(400).json({ message: \"No biometric credentials registered\" });\n    }\n\n    const options = await generateAuthenticationOptions({\n      rpID,\n      allowCredentials: credentials.map(cred => ({\n        id: cred.credentialId,\n      })),\n      userVerification: 'preferred',\n    });\n\n    req.session.currentChallenge = options.challenge;\n    req.session.tempUserId = user.id;\n\n    res.json(options);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// WebAuthn: Verify authentication\nrouter.post(\"/webauthn/login/verify\", async (req, res) => {\n  try {\n    const { credential } = req.body;\n    const expectedChallenge = req.session.currentChallenge;\n    const userId = req.session.tempUserId;\n\n    if (!req.session.pending2FA || !req.session.pendingUserId) {\n      return res.status(400).json({ message: \"No pending 2FA verification\" });\n    }\n\n    if (!expectedChallenge || !userId) {\n      return res.status(400).json({ message: \"Invalid session\" });\n    }\n\n    if (userId !== req.session.pendingUserId) {\n      return res.status(400).json({ message: \"Invalid session state\" });\n    }\n\n    const credentialId = Buffer.from(credential.id, 'base64url').toString('base64');\n    const dbCredential = await storage.getWebAuthnCredentialById(credentialId);\n\n    if (!dbCredential || dbCredential.userId !== userId) {\n      return res.status(400).json({ message: \"Credential not found\" });\n    }\n\n    const verification = await verifyAuthenticationResponse({\n      response: credential,\n      expectedChallenge,\n      expectedOrigin: origin,\n      expectedRPID: rpID,\n      credential: {\n        id: dbCredential.credentialId,\n        publicKey: new Uint8Array(Buffer.from(dbCredential.publicKey, 'base64')),\n        counter: dbCredential.counter,\n      },\n    });\n\n    if (!verification.verified) {\n      return res.status(400).json({ message: \"Authentication failed\" });\n    }\n\n    await storage.updateWebAuthnCredentialCounter(\n      dbCredential.id,\n      verification.authenticationInfo.newCounter\n    );\n\n    const user = await storage.getUser(userId);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    req.session.regenerate(async (err) => {\n      if (err) {\n        console.error('Session regeneration failed:', err);\n        return res.status(500).json({ message: \"Session error, please try again\" });\n      }\n\n      req.session.userId = user.id;\n      req.session.username = user.username;\n      req.session.role = user.role;\n\n      const { password: _, twoFactorSecret: __, ...userWithoutSensitive } = user;\n      res.json({ user: userWithoutSensitive });\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":22332,"size_tokens":null},"client/src/pages/home/Projects.tsx":{"content":"import { useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ExternalLink, Github, Plus, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { ReviewSection } from \"@/components/sections/ReviewSection\";\nimport { useState, useMemo } from \"react\";\n\nexport default function Projects() {\n  const [selectedProject, setSelectedProject] = useState<any | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterCategory, setFilterCategory] = useState(\"all\");\n  const [, setLocation] = useLocation();\n\n  const { data: projects = [], isLoading } = useQuery({\n    queryKey: ['/api/projects'],\n    queryFn: async () => {\n      const response = await fetch('/api/projects');\n      if (!response.ok) throw new Error('Failed to fetch projects');\n      return response.json();\n    }\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: ['/api/categories', 'project'],\n    queryFn: async () => {\n      const response = await fetch('/api/categories?type=project');\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    }\n  });\n\n  const filteredProjects = useMemo(() => {\n    return projects.filter((project: any) => {\n      const matchesSearch = project.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        project.description.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesCategory = filterCategory === 'all' || \n        project.category.toLowerCase() === filterCategory.toLowerCase();\n      return matchesSearch && matchesCategory && project.status === 'Published';\n    });\n  }, [projects, searchQuery, filterCategory]);\n\n  const categoryOptions = [\n    { id: 'all', name: 'All Projects' },\n    ...categories.map((cat: any) => ({ id: cat.slug, name: cat.name }))\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n      \n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          {/* Header */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Featured <span className=\"text-primary\">Projects</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Explore my portfolio of web applications, designs, and creative solutions.\n              </p>\n            </div>\n          </motion.div>\n\n          {/* Search and Filters */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-12 space-y-6\"\n          >\n            {/* Search */}\n            <Input\n              placeholder=\"Search projects...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"max-w-md\"\n              data-testid=\"input-search-projects\"\n            />\n\n            {/* Categories */}\n            <div className=\"flex flex-wrap gap-2\">\n              {categoryOptions.map((cat) => (\n                <Button\n                  key={cat.id}\n                  variant={filterCategory === cat.id ? \"default\" : \"outline\"}\n                  onClick={() => setFilterCategory(cat.id)}\n                  data-testid={`button-filter-${cat.id}`}\n                >\n                  {cat.name}\n                </Button>\n              ))}\n            </div>\n          </motion.div>\n\n          {/* Projects Grid */}\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-16\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n          ) : filteredProjects.length === 0 ? (\n            <div className=\"text-center py-16\">\n              <p className=\"text-lg text-muted-foreground mb-4\">No projects found</p>\n              <Button variant=\"outline\" onClick={() => {\n                setSearchQuery(\"\");\n                setFilterCategory(\"all\");\n              }} data-testid=\"button-clear-filters\">\n                Clear filters\n              </Button>\n            </div>\n          ) : (\n            <motion.div\n              layout\n              className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\"\n            >\n              <AnimatePresence>\n                {filteredProjects.map((project: any) => (\n                  <motion.div\n                    layout\n                    key={project.id}\n                    initial={{ opacity: 0, scale: 0.9 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.9 }}\n                    transition={{ duration: 0.3 }}\n                    className=\"group relative rounded-xl overflow-hidden bg-card border border-border shadow-md hover:shadow-xl transition-all duration-300\"\n                    data-testid={`card-project-${project.id}`}\n                  >\n                    {/* Image */}\n                    <div className=\"aspect-video overflow-hidden bg-muted\">\n                      <img\n                        src={project.image || '/placeholder.jpg'}\n                        alt={project.title}\n                        className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\"\n                      />\n                    </div>\n\n                    {/* Content */}\n                    <div className=\"p-6\">\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <h3 className=\"text-lg font-bold line-clamp-2\">{project.title}</h3>\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n                        {project.description}\n                      </p>\n\n                      {/* Tech Tags */}\n                      <div className=\"flex flex-wrap gap-2 mb-4\">\n                        {(project.tech || []).slice(0, 3).map((t: string) => (\n                          <Badge key={t} variant=\"secondary\" className=\"text-xs\">\n                            {t}\n                          </Badge>\n                        ))}\n                        {(project.tech || []).length > 3 && (\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            +{(project.tech || []).length - 3}\n                          </Badge>\n                        )}\n                      </div>\n\n                      {/* Actions */}\n                      <div className=\"flex gap-2 pt-4 border-t\">\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"flex-1\"\n                          onClick={() => setSelectedProject(project)}\n                          data-testid={`button-view-details-${project.id}`}\n                        >\n                          <Plus className=\"w-4 h-4 mr-1\" />\n                          Details\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          data-testid={`button-external-link-${project.id}`}\n                        >\n                          <ExternalLink className=\"w-4 h-4\" />\n                        </Button>\n                        <Button\n                          size=\"icon\"\n                          variant=\"ghost\"\n                          data-testid={`button-github-${project.id}`}\n                        >\n                          <Github className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            </motion.div>\n          )}\n        </div>\n      </div>\n\n      {/* Project Detail Modal */}\n      <Dialog open={!!selectedProject} onOpenChange={() => setSelectedProject(null)}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] p-0\">\n          <ScrollArea className=\"max-h-[85vh]\">\n            <div className=\"p-6\">\n              <DialogHeader>\n                <DialogTitle>{selectedProject?.title}</DialogTitle>\n                <DialogDescription>{selectedProject?.description}</DialogDescription>\n              </DialogHeader>\n              {selectedProject && (\n                <div className=\"space-y-6 mt-4\">\n                  <div className=\"aspect-video rounded-lg overflow-hidden bg-muted\">\n                    <img\n                      src={selectedProject.image}\n                      alt={selectedProject.title}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  </div>\n\n                  <div className=\"grid md:grid-cols-2 gap-6\">\n                    <div>\n                      <h4 className=\"font-bold mb-2\">Challenge & Solution</h4>\n                      <p className=\"text-muted-foreground text-sm\">\n                        {selectedProject.description || \"Comprehensive project solution with modern technologies and best practices.\"}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"font-bold mb-2\">Technologies</h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {selectedProject.tech.map((t: string) => (\n                          <Badge key={t} variant=\"secondary\">\n                            {t}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n\n                  <ReviewSection projectId={selectedProject.id} title=\"Project Reviews\" />\n\n                  <div className=\"flex justify-end gap-4 pt-4 border-t\">\n                    <Button variant=\"outline\" onClick={() => setSelectedProject(null)} data-testid=\"button-close-modal\">\n                      Close\n                    </Button>\n                    <Button data-testid=\"button-view-live\">View Live Project</Button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":10899,"size_tokens":null},"server/api/newsletter.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/settings\", async (req: Request, res: Response) => {\n  try {\n    const settings = await storage.getSetting(\"newsletter-settings\");\n    if (settings) {\n      const value = typeof settings.value === 'string' ? JSON.parse(settings.value) : settings.value;\n      res.json(value);\n    } else {\n      res.json({\n        enabled: false,\n        title: \"Subscribe to Our Newsletter\",\n        subtitle: \"Get the latest updates\",\n        description: \"Stay informed with our weekly newsletter\",\n        placeholder: \"Enter your email\",\n        buttonText: \"Subscribe\",\n        successMessage: \"Thanks for subscribing!\",\n      });\n    }\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/settings\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const settings = await storage.upsertSetting(\"newsletter-settings\", req.body);\n    const value = typeof settings.value === 'string' ? JSON.parse(settings.value) : settings.value;\n    res.json(value);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/subscribe\", async (req: Request, res: Response) => {\n  try {\n    const { email } = req.body;\n    if (!email) {\n      return res.status(400).json({ message: \"Email is required\" });\n    }\n\n    await storage.createActivityLog({\n      action: `User subscribed to newsletter: ${email}`,\n      userId: req.session.userId,\n      userName: req.session.username || \"Guest\",\n      type: \"info\"\n    });\n\n    res.json({ message: \"Successfully subscribed to newsletter\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1861,"size_tokens":null},"server/api/logs.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst router = Router();\n\nconst logsDir = path.join(process.cwd(), \"logs\");\nif (!fs.existsSync(logsDir)) {\n  fs.mkdirSync(logsDir, { recursive: true });\n}\n\nconst writeLogToFile = (level: string, message: string, details?: any) => {\n  const timestamp = new Date().toISOString();\n  const logEntry = {\n    timestamp,\n    level,\n    message,\n    details: details || null\n  };\n\n  const today = new Date().toISOString().split('T')[0];\n  const logFile = path.join(logsDir, `app-${today}.log`);\n\n  fs.appendFileSync(logFile, JSON.stringify(logEntry) + '\\n');\n};\n\nrouter.get(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const { level, limit = 100, source = \"all\" } = req.query;\n    const logs: any[] = [];\n\n    if (source === \"all\" || source === \"database\") {\n      const dbLogs = await storage.getAllActivityLogs(Number(limit));\n      logs.push(...dbLogs.map(log => ({\n        ...log,\n        source: \"database\",\n        timestamp: log.createdAt\n      })));\n    }\n\n    if (source === \"all\" || source === \"file\") {\n      const logFiles = fs.existsSync(logsDir) ? fs.readdirSync(logsDir).filter(f => f.endsWith('.log')) : [];\n\n      for (const logFile of logFiles.slice(-7)) {\n        const filePath = path.join(logsDir, logFile);\n        const content = fs.readFileSync(filePath, 'utf-8');\n        const lines = content.split('\\n').filter(line => line.trim());\n\n        for (const line of lines) {\n          try {\n            const logEntry = JSON.parse(line);\n            logs.push({\n              ...logEntry,\n              source: \"file\",\n              type: logEntry.level\n            });\n          } catch (e) {\n          }\n        }\n      }\n    }\n\n    let filteredLogs = logs;\n    if (level && level !== 'all') {\n      filteredLogs = logs.filter(log => log.type === level || log.level === level);\n    }\n\n    filteredLogs.sort((a, b) => {\n      const timeA = new Date(a.timestamp || a.createdAt).getTime();\n      const timeB = new Date(b.timestamp || b.createdAt).getTime();\n      return timeB - timeA;\n    });\n\n    res.json(filteredLogs.slice(0, Number(limit)));\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/files\", requireAdmin, async (req, res) => {\n  try {\n    if (!fs.existsSync(logsDir)) {\n      return res.json([]);\n    }\n\n    const logFiles = fs.readdirSync(logsDir)\n      .filter(f => f.endsWith('.log'))\n      .map(filename => {\n        const filePath = path.join(logsDir, filename);\n        const stats = fs.statSync(filePath);\n        return {\n          filename,\n          size: stats.size,\n          sizeFormatted: stats.size < 1024 ? `${stats.size} B` : \n                        stats.size < 1024*1024 ? `${(stats.size/1024).toFixed(1)} KB` :\n                        `${(stats.size/1024/1024).toFixed(2)} MB`,\n          modified: stats.mtime,\n          date: filename.replace('app-', '').replace('.log', '')\n        };\n      })\n      .sort((a, b) => new Date(b.modified).getTime() - new Date(a.modified).getTime());\n\n    res.json(logFiles);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const { level, message, details } = req.body;\n\n    writeLogToFile(level || 'info', message, details);\n\n    res.json({ success: true, message: \"Log entry created\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/files/:filename\", requireAdmin, async (req, res) => {\n  try {\n    const { filename } = req.params;\n    const filePath = path.join(logsDir, filename);\n\n    if (!fs.existsSync(filePath)) {\n      return res.status(404).json({ message: \"Log file not found\" });\n    }\n\n    fs.unlinkSync(filePath);\n\n    await storage.createActivityLog({\n      action: `Deleted log file: ${filename}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n\n    res.json({ message: \"Log file deleted successfully\", success: true });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":4287,"size_tokens":null},"client/src/pages/home/Maintenance.tsx":{"content":"import { useSiteSettings } from \"@/context/SiteContext\";\nimport { AlertTriangle, Cpu, Terminal, Shield } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\n\nexport default function Maintenance() {\n  const { settings } = useSiteSettings();\n  const [progress, setProgress] = useState(0);\n  const [glitchText, setGlitchText] = useState(\"\");\n\n  const maintenanceTitle =\n    settings.maintenanceTitle || \"SYSTEM_UPGRADE_IN_PROGRESS\";\n  const maintenanceMessage =\n    settings.maintenanceMessage ||\n    \"// Critical infrastructure maintenance underway\";\n  const maintenanceEstimate = settings.maintenanceEstimate || \"ETA: 00:23:17\";\n\n  // Glitch effect for title\n  useEffect(() => {\n    const chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$#@!%^&*\";\n    let interval: NodeJS.Timeout;\n\n    if (Math.random() > 0.7) {\n      interval = setInterval(() => {\n        const length = maintenanceTitle.length;\n        const positions = Array.from({ length: 2 }, () =>\n          Math.floor(Math.random() * length),\n        );\n\n        let newText = maintenanceTitle;\n        positions.forEach((pos) => {\n          newText =\n            newText.substring(0, pos) +\n            chars[Math.floor(Math.random() * chars.length)] +\n            newText.substring(pos + 1);\n        });\n\n        setGlitchText(newText);\n\n        setTimeout(() => setGlitchText(\"\"), 100);\n      }, 3000);\n    }\n\n    return () => clearInterval(interval);\n  }, [maintenanceTitle]);\n\n  // Progress simulation\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setProgress((prev) => (prev >= 87 ? 87 : prev + Math.random() * 3));\n    }, 800);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // SVG background as constant\n  const gridSvg = `url(\"data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h60v60H0z' fill='none'/%3E%3Cpath d='M30 2l4 8 9 1-6 6 1 9-8-4-8 4 1-9-6-6 9-1z' fill='%2300ff0020' fill-rule='evenodd'/%3E%3C/svg%3E\")`;\n\n  return (\n    <div className=\"min-h-screen bg-black text-green-400 font-mono overflow-hidden relative\">\n      {/* Animated background elements */}\n      <div\n        className=\"absolute inset-0 opacity-20\"\n        style={{ backgroundImage: gridSvg }}\n      ></div>\n\n      {/* Scanline effect */}\n      <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-green-500/5 to-transparent animate-scan pointer-events-none\"></div>\n\n      {/* Grid overlay */}\n      <div className=\"absolute inset-0 bg-grid-green-900/[0.02] bg-[size:20px_20px]\"></div>\n\n      <div className=\"container mx-auto px-4 py-12 relative z-10\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* Header with status bars */}\n          <div className=\"flex items-center justify-between mb-8 p-4 border border-green-500/30 bg-black/50 backdrop-blur-sm\">\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"p-2 bg-green-900/30 border border-green-500/50\">\n                <Cpu className=\"w-6 h-6 text-green-400\" />\n              </div>\n              <div>\n                <div className=\"text-xs text-green-300 uppercase tracking-wider\">\n                  System Status\n                </div>\n                <div className=\"text-green-400 font-bold\">MAINTENANCE_MODE</div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-6\">\n              <div className=\"text-right\">\n                <div className=\"text-xs text-green-300\">Uptime</div>\n                <div className=\"text-green-400 font-bold\">99.87%</div>\n              </div>\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n            </div>\n          </div>\n\n          {/* Main content */}\n          <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\n            {/* Left panel - System info */}\n            <div className=\"md:col-span-2 border border-green-500/30 bg-black/70 p-6\">\n              <div className=\"flex items-center space-x-3 mb-6\">\n                <AlertTriangle className=\"w-8 h-8 text-yellow-500 animate-pulse\" />\n                <h1 className=\"text-2xl font-bold text-green-300 tracking-wider\">\n                  {glitchText || maintenanceTitle}\n                </h1>\n              </div>\n\n              <div className=\"space-y-4 mb-8\">\n                <div className=\"flex items-start space-x-3\">\n                  <Terminal className=\"w-5 h-5 text-green-500 mt-1 flex-shrink-0\" />\n                  <p className=\"text-green-400 font-medium\">\n                    {maintenanceMessage}\n                  </p>\n                </div>\n\n                <div className=\"flex items-start space-x-3\">\n                  <Shield className=\"w-5 h-5 text-blue-400 mt-1 flex-shrink-0\" />\n                  <p className=\"text-blue-300 text-sm\">{maintenanceEstimate}</p>\n                </div>\n              </div>\n\n              {/* Progress bar */}\n              <div className=\"mb-6\">\n                <div className=\"flex justify-between text-xs text-green-300 mb-2\">\n                  <span>System Rebuild Progress</span>\n                  <span>{progress.toFixed(1)}%</span>\n                </div>\n                <div className=\"h-2 bg-green-900/30 overflow-hidden\">\n                  <div\n                    className=\"h-full bg-gradient-to-r from-green-500 to-emerald-400 transition-all duration-500 relative\"\n                    style={{ width: `${progress}%` }}\n                  >\n                    <div className=\"absolute inset-y-0 left-0 w-4 bg-white/30 animate-shimmer\"></div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Status indicators */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                {[\n                  { label: \"Database\", status: \"Upgrading\", color: \"yellow\" },\n                  { label: \"API Layer\", status: \"Rebuilding\", color: \"blue\" },\n                  { label: \"Security\", status: \"Active\", color: \"green\" },\n                  { label: \"Cache\", status: \"Clearing\", color: \"purple\" },\n                ].map((item, index) => (\n                  <div\n                    key={index}\n                    className=\"p-3 border border-green-500/20 bg-black/50\"\n                  >\n                    <div className=\"text-xs text-green-300 mb-1\">\n                      {item.label}\n                    </div>\n                    <div className=\"flex items-center\">\n                      <div\n                        className={`w-2 h-2 rounded-full mr-2 ${\n                          item.color === \"yellow\"\n                            ? \"bg-yellow-500\"\n                            : item.color === \"blue\"\n                              ? \"bg-blue-500\"\n                              : item.color === \"green\"\n                                ? \"bg-green-500\"\n                                : \"bg-purple-500\"\n                        } animate-pulse`}\n                      ></div>\n                      <div\n                        className={`text-sm font-bold ${\n                          item.color === \"yellow\"\n                            ? \"text-yellow-400\"\n                            : item.color === \"blue\"\n                              ? \"text-blue-400\"\n                              : item.color === \"green\"\n                                ? \"text-green-400\"\n                                : \"text-purple-400\"\n                        }`}\n                      >\n                        {item.status}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Right panel - Logs */}\n            <div className=\"border border-green-500/30 bg-black/70 p-6\">\n              <div className=\"text-green-300 font-bold mb-4 flex items-center\">\n                <Terminal className=\"w-5 h-5 mr-2\" />\n                SYSTEM LOGS\n              </div>\n              <div className=\"space-y-2 text-sm font-mono\">\n                {[\n                  \"> Initializing maintenance protocol...\",\n                  \"> Securing active connections... âœ“\",\n                  \"> Backing up database tables... âœ“\",\n                  \"> Deploying security patches...\",\n                  \"> Optimizing query performance...\",\n                  \"> Testing failover systems...\",\n                  \"> Cleaning temporary files...\",\n                  \"> Preparing restart sequence...\",\n                ].map((log, index) => (\n                  <div\n                    key={index}\n                    className=\"text-green-400/80 animate-pulse\"\n                    style={{ animationDelay: `${index * 0.2}s` }}\n                  >\n                    {log}\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* Footer */}\n          <div className=\"border-t border-green-500/30 pt-6\">\n            <div className=\"flex flex-col md:flex-row justify-between items-center text-sm\">\n              <div className=\"text-green-500/60 mb-4 md:mb-0\">\n                <div className=\"flex items-center space-x-4\">\n                  <span>Contact:</span>\n                  <a\n                    href={`mailto:${settings.contactEmail || \"sysadmin@domain.com\"}`}\n                    className=\"text-green-400 hover:text-green-300 transition-colors underline\"\n                  >\n                    {settings.contactEmail || \"sysadmin@domain.com\"}\n                  </a>\n                </div>\n              </div>\n\n              <div className=\"text-green-500/40 text-xs tracking-wider\">\n                {settings.footerCopyright ||\n                  `[${new Date().getFullYear()}] All systems reserved.`}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Glitch overlay effect */}\n      <div className=\"absolute inset-0 pointer-events-none opacity-[0.02]\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-green-500 to-transparent animate-pulse\"></div>\n      </div>\n\n      <style>{`\n        @keyframes scan {\n          0% {\n            transform: translateY(-100%);\n          }\n          100% {\n            transform: translateY(100vh);\n          }\n        }\n\n        @keyframes shimmer {\n          0% {\n            transform: translateX(-100%);\n          }\n          100% {\n            transform: translateX(100%);\n          }\n        }\n\n        .animate-scan {\n          animation: scan 3s linear infinite;\n        }\n\n        .animate-shimmer {\n          animation: shimmer 2s infinite;\n        }\n\n        .bg-grid-green-900 {\n          background-image:\n            linear-gradient(to right, currentColor 1px, transparent 1px),\n            linear-gradient(to bottom, currentColor 1px, transparent 1px);\n        }\n      `}</style>\n    </div>\n  );\n}\n","path":null,"size_bytes":10803,"size_tokens":null},"client/src/pages/admin/settings/LanguageManager.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Languages, Plus, Download, Upload, Trash2, Edit2, Check, X, Globe, Search\n} from \"lucide-react\";\nimport { useState, useRef } from \"react\";\nimport { useLanguage, LanguageData, TranslationData } from \"@/context/LanguageContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\n\nexport default function LanguageManager() {\n  const { \n    languages, \n    currentLanguage, \n    setCurrentLanguage, \n    addLanguage, \n    removeLanguage, \n    updateTranslations,\n    exportLanguage,\n    importLanguage \n  } = useLanguage();\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  const [newLangCode, setNewLangCode] = useState(\"\");\n  const [newLangName, setNewLangName] = useState(\"\");\n  const [newLangNative, setNewLangNative] = useState(\"\");\n  const [editingKey, setEditingKey] = useState<string | null>(null);\n  const [editingValue, setEditingValue] = useState(\"\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedLang, setSelectedLang] = useState<string>(languages[0]?.code || \"en\");\n  const [newKeyDialog, setNewKeyDialog] = useState(false);\n  const [newKey, setNewKey] = useState(\"\");\n  const [newTranslations, setNewTranslations] = useState<Record<string, string>>({});\n\n  const handleAddLanguage = () => {\n    if (!newLangCode || !newLangName) {\n      toast({ title: \"Error\", description: \"Please fill in all required fields\", variant: \"destructive\" });\n      return;\n    }\n\n    const baseTranslations = languages.find(l => l.code === \"en\")?.translations || {};\n    \n    addLanguage({\n      code: newLangCode.toLowerCase(),\n      name: newLangName,\n      nativeName: newLangNative || newLangName,\n      translations: { ...baseTranslations },\n    });\n\n    toast({ title: \"Success\", description: `Language \"${newLangName}\" added successfully` });\n    setNewLangCode(\"\");\n    setNewLangName(\"\");\n    setNewLangNative(\"\");\n  };\n\n  const handleExport = (code: string) => {\n    const data = exportLanguage(code);\n    const blob = new Blob([data], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `language_${code}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n    toast({ title: \"Exported\", description: `Language file exported successfully` });\n  };\n\n  const handleImport = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const content = event.target?.result as string;\n      if (importLanguage(content)) {\n        toast({ title: \"Imported\", description: \"Language imported successfully\" });\n      } else {\n        toast({ title: \"Error\", description: \"Invalid language file format\", variant: \"destructive\" });\n      }\n    };\n    reader.readAsText(file);\n    e.target.value = \"\";\n  };\n\n  const handleSaveTranslation = (langCode: string, key: string, value: string) => {\n    updateTranslations(langCode, { [key]: value });\n    setEditingKey(null);\n    setEditingValue(\"\");\n    toast({ title: \"Saved\", description: \"Translation updated\" });\n  };\n\n  const handleAddKey = () => {\n    if (!newKey) return;\n    \n    languages.forEach(lang => {\n      updateTranslations(lang.code, { [newKey]: newTranslations[lang.code] || newKey });\n    });\n    \n    setNewKeyDialog(false);\n    setNewKey(\"\");\n    setNewTranslations({});\n    toast({ title: \"Added\", description: \"New translation key added\" });\n  };\n\n  const filteredKeys = Object.keys(languages.find(l => l.code === selectedLang)?.translations || {})\n    .filter(key => \n      key.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (languages.find(l => l.code === selectedLang)?.translations[key] || \"\")\n        .toLowerCase().includes(searchQuery.toLowerCase())\n    );\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold flex items-center gap-2\">\n              <Languages className=\"w-8 h-8\" /> Language Manager\n            </h1>\n            <p className=\"text-muted-foreground\">Manage translations and language settings</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <input \n              type=\"file\" \n              ref={fileInputRef} \n              className=\"hidden\" \n              accept=\".json\"\n              onChange={handleImport}\n            />\n            <Button variant=\"outline\" onClick={() => fileInputRef.current?.click()}>\n              <Upload className=\"w-4 h-4 mr-2\" /> Import\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <Card className=\"lg:col-span-1\">\n            <CardHeader>\n              <CardTitle>Languages</CardTitle>\n              <CardDescription>Available languages in your site</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                {languages.map((lang) => (\n                  <div \n                    key={lang.code}\n                    className={`flex items-center justify-between p-3 border rounded-lg cursor-pointer transition-colors ${\n                      selectedLang === lang.code ? \"border-primary bg-primary/5\" : \"hover:border-primary/50\"\n                    }`}\n                    onClick={() => setSelectedLang(lang.code)}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Globe className=\"w-5 h-5 text-muted-foreground\" />\n                      <div>\n                        <p className=\"font-medium\">{lang.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{lang.nativeName} ({lang.code})</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {currentLanguage === lang.code && (\n                        <Badge variant=\"secondary\">Active</Badge>\n                      )}\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handleExport(lang.code);\n                        }}\n                      >\n                        <Download className=\"w-4 h-4\" />\n                      </Button>\n                      {lang.code !== \"en\" && (\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          className=\"text-destructive\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            removeLanguage(lang.code);\n                            toast({ title: \"Removed\", description: `Language \"${lang.name}\" removed` });\n                          }}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"pt-4 border-t space-y-3\">\n                <h4 className=\"font-medium text-sm\">Add New Language</h4>\n                <div className=\"space-y-2\">\n                  <Input \n                    placeholder=\"Language code (e.g. fr, de, ja)\" \n                    value={newLangCode}\n                    onChange={(e) => setNewLangCode(e.target.value)}\n                  />\n                  <Input \n                    placeholder=\"Language name (e.g. French)\" \n                    value={newLangName}\n                    onChange={(e) => setNewLangName(e.target.value)}\n                  />\n                  <Input \n                    placeholder=\"Native name (e.g. FranÃ§ais)\" \n                    value={newLangNative}\n                    onChange={(e) => setNewLangNative(e.target.value)}\n                  />\n                  <Button className=\"w-full\" onClick={handleAddLanguage}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Language\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"lg:col-span-2\">\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>Translations</CardTitle>\n                  <CardDescription>\n                    Edit translations for {languages.find(l => l.code === selectedLang)?.name}\n                  </CardDescription>\n                </div>\n                <Dialog open={newKeyDialog} onOpenChange={setNewKeyDialog}>\n                  <DialogTrigger asChild>\n                    <Button size=\"sm\">\n                      <Plus className=\"w-4 h-4 mr-2\" /> Add Key\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Add Translation Key</DialogTitle>\n                      <DialogDescription>\n                        Add a new translation key and its values for all languages\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-4 py-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Translation Key</Label>\n                        <Input \n                          placeholder=\"e.g. nav.newPage\"\n                          value={newKey}\n                          onChange={(e) => setNewKey(e.target.value)}\n                        />\n                      </div>\n                      {languages.map(lang => (\n                        <div key={lang.code} className=\"space-y-2\">\n                          <Label>{lang.name} ({lang.code})</Label>\n                          <Input \n                            placeholder={`Translation in ${lang.name}`}\n                            value={newTranslations[lang.code] || \"\"}\n                            onChange={(e) => setNewTranslations(prev => ({\n                              ...prev,\n                              [lang.code]: e.target.value\n                            }))}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                    <DialogFooter>\n                      <Button variant=\"outline\" onClick={() => setNewKeyDialog(false)}>\n                        Cancel\n                      </Button>\n                      <Button onClick={handleAddKey}>Add Key</Button>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"mb-4\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                  <Input \n                    placeholder=\"Search translations...\"\n                    className=\"pl-9\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2 max-h-[500px] overflow-y-auto pr-2\">\n                {filteredKeys.map((key) => {\n                  const lang = languages.find(l => l.code === selectedLang);\n                  const value = lang?.translations[key] || \"\";\n                  const isEditing = editingKey === key;\n\n                  return (\n                    <div key={key} className=\"p-3 border rounded-lg\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <code className=\"text-xs bg-muted px-2 py-1 rounded font-mono\">{key}</code>\n                        {!isEditing && (\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\"\n                            onClick={() => {\n                              setEditingKey(key);\n                              setEditingValue(value);\n                            }}\n                          >\n                            <Edit2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                      {isEditing ? (\n                        <div className=\"flex gap-2\">\n                          <Input \n                            value={editingValue}\n                            onChange={(e) => setEditingValue(e.target.value)}\n                            className=\"flex-1\"\n                          />\n                          <Button \n                            size=\"icon\" \n                            variant=\"ghost\"\n                            onClick={() => handleSaveTranslation(selectedLang, key, editingValue)}\n                          >\n                            <Check className=\"w-4 h-4 text-green-500\" />\n                          </Button>\n                          <Button \n                            size=\"icon\" \n                            variant=\"ghost\"\n                            onClick={() => {\n                              setEditingKey(null);\n                              setEditingValue(\"\");\n                            }}\n                          >\n                            <X className=\"w-4 h-4 text-red-500\" />\n                          </Button>\n                        </div>\n                      ) : (\n                        <p className=\"text-sm\">{value}</p>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Default Language</CardTitle>\n            <CardDescription>Set the default language for your site</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {languages.map((lang) => (\n                <Button\n                  key={lang.code}\n                  variant={currentLanguage === lang.code ? \"default\" : \"outline\"}\n                  onClick={() => {\n                    setCurrentLanguage(lang.code);\n                    toast({ title: \"Default Changed\", description: `Default language set to ${lang.name}` });\n                  }}\n                >\n                  <Globe className=\"w-4 h-4 mr-2\" />\n                  {lang.name}\n                </Button>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":15424,"size_tokens":null},"client/src/pages/admin/system/Cache.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Zap, Trash2, RefreshCw, Database, Image, FileText } from \"lucide-react\";\n\nexport default function AdminCache() {\n  const cacheItems = [\n    { name: \"Application Cache\", size: \"24.5 MB\", items: 1247, icon: Zap, color: \"text-purple-500\" },\n    { name: \"Database Queries\", size: \"12.8 MB\", items: 856, icon: Database, color: \"text-blue-500\" },\n    { name: \"Image Cache\", size: \"156 MB\", items: 342, icon: Image, color: \"text-green-500\" },\n    { name: \"Page Cache\", size: \"8.2 MB\", items: 124, icon: FileText, color: \"text-yellow-500\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Cache Manager</h1>\n            <p className=\"text-muted-foreground\">Manage and clear application cache</p>\n          </div>\n          <Button variant=\"destructive\" className=\"gap-2\">\n            <Trash2 className=\"w-4 h-4\" /> Clear All Cache\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {cacheItems.map((item, i) => (\n            <Card key={i}>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className={`p-3 rounded-lg bg-muted ${item.color}`}>\n                      <item.icon className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                      <CardTitle className=\"text-lg\">{item.name}</CardTitle>\n                      <CardDescription>{item.items} items</CardDescription>\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-2xl font-bold\">{item.size}</p>\n                    <p className=\"text-xs text-muted-foreground\">Total size</p>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\">\n                      <RefreshCw className=\"w-4 h-4 mr-1\" /> Refresh\n                    </Button>\n                    <Button variant=\"destructive\" size=\"sm\">\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Cache Statistics</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-primary\">94%</p>\n                <p className=\"text-xs text-muted-foreground\">Hit Rate</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-green-500\">201 MB</p>\n                <p className=\"text-xs text-muted-foreground\">Total Cache</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-yellow-500\">2,569</p>\n                <p className=\"text-xs text-muted-foreground\">Cached Items</p>\n              </div>\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\n                <p className=\"text-2xl font-bold text-blue-500\">2h ago</p>\n                <p className=\"text-xs text-muted-foreground\">Last Cleared</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4039,"size_tokens":null},"client/src/pages/admin/auth/Login.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Eye, EyeOff, Lock, User, Shield, ArrowRight, ShieldCheck, Fingerprint, KeyRound } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"@/components/ui/dialog\";\nimport { InputOTP, InputOTPGroup, InputOTPSlot } from \"@/components/ui/input-otp\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useRecaptcha } from \"@/hooks/use-recaptcha\";\nimport { startAuthentication } from \"@simplewebauthn/browser\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function AdminLogin() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [honeypot, setHoneypot] = useState(\"\");\n  const [show2FADialog, setShow2FADialog] = useState(false);\n  const [twoFactorCode, setTwoFactorCode] = useState(\"\");\n  const [tempSessionToken, setTempSessionToken] = useState(\"\");\n  const [hasBiometric, setHasBiometric] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const turnstileRef = useRef<HTMLDivElement>(null);\n\n  const {\n    isEnabled: captchaEnabled,\n    isLoaded: captchaLoaded,\n    captchaType,\n    executeRecaptcha,\n    renderTurnstile,\n    honeypotFieldName,\n    error: captchaError\n  } = useRecaptcha({ formType: 'login', action: 'login' });\n\n  useEffect(() => {\n    fetch(\"/api/auth/me\", {\n      credentials: \"include\"\n    })\n    .then(res => {\n      if (res.ok) {\n        setLocation(\"/admin\");\n      }\n    })\n    .catch(() => {});\n  }, [setLocation]);\n\n  useEffect(() => {\n    if (captchaType === 'cloudflare' && captchaLoaded && turnstileRef.current) {\n      renderTurnstile('login-turnstile-container');\n    }\n  }, [captchaType, captchaLoaded, renderTurnstile]);\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (honeypot) {\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      let captchaToken: string | null = null;\n      \n      if (captchaEnabled) {\n        captchaToken = await executeRecaptcha();\n        if (captchaError) {\n          toast({\n            title: \"Verification Failed\",\n            description: captchaError,\n            variant: \"destructive\",\n          });\n          setIsLoading(false);\n          return;\n        }\n      }\n\n      const response = await fetch(\"/api/auth/login\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify({ \n          username, \n          password,\n          captchaToken,\n          captchaType\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        if (data.requires2FA) {\n          setTempSessionToken(data.tempToken || \"\");\n          setHasBiometric(data.hasBiometric || false);\n          setShow2FADialog(true);\n        } else {\n          setTimeout(() => {\n            window.location.href = \"/admin\";\n          }, 100);\n        }\n      } else {\n        if (data.passwordExpired && data.userId) {\n          toast({\n            title: \"Password Expired\",\n            description: \"Your password has expired. Redirecting to reset...\",\n            variant: \"destructive\",\n          });\n          setTimeout(() => {\n            window.location.href = `/admin/force-password-reset?userId=${data.userId}`;\n          }, 1500);\n        } else {\n          toast({\n            title: \"Login Failed\",\n            description: data.message || \"Invalid credentials\",\n            variant: \"destructive\",\n          });\n        }\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to connect to server\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handle2FAVerify = async () => {\n    if (twoFactorCode.length !== 6) {\n      toast({\n        title: \"Invalid Code\",\n        description: \"Please enter a 6-digit code\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/auth/2fa/verify-login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ code: twoFactorCode }),\n      });\n\n      const data = await response.json();\n      \n      if (response.ok) {\n        setShow2FADialog(false);\n        setTimeout(() => {\n          window.location.href = \"/admin\";\n        }, 100);\n      } else {\n        toast({\n          title: \"Verification Failed\",\n          description: data.message || \"Invalid code\",\n          variant: \"destructive\",\n        });\n        setTwoFactorCode(\"\");\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to verify code\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleBiometricLogin = async () => {\n    setIsLoading(true);\n    try {\n      const optionsRes = await fetch(\"/api/auth/webauthn/login/options\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ email: username }),\n      });\n\n      if (!optionsRes.ok) {\n        throw new Error(\"Failed to get authentication options\");\n      }\n\n      const options = await optionsRes.json();\n      const credential = await startAuthentication({ optionsJSON: options });\n\n      const verifyRes = await fetch(\"/api/auth/webauthn/login/verify\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify({ credential }),\n      });\n\n      if (verifyRes.ok) {\n        setShow2FADialog(false);\n        setTimeout(() => {\n          window.location.href = \"/admin\";\n        }, 100);\n      } else {\n        const data = await verifyRes.json();\n        toast({\n          title: \"Biometric Login Failed\",\n          description: data.message || \"Authentication failed\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Biometric Error\",\n        description: error.message || \"Failed to authenticate\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center relative overflow-hidden bg-black\">\n      <div className=\"absolute inset-0 z-0\">\n        <img \n          src={loginBg} \n          alt=\"Background\" \n          className=\"w-full h-full object-cover opacity-50\"\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent\" />\n      </div>\n\n      <div className=\"absolute inset-0 z-0 opacity-20 bg-[linear-gradient(rgba(255,255,255,0.05)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.05)_1px,transparent_1px)] bg-[size:50px_50px]\" />\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"relative z-10 w-full max-w-md px-4\"\n      >\n        <Card className=\"border-white/10 bg-black/40 backdrop-blur-xl shadow-2xl\">\n          <CardHeader className=\"text-center space-y-2 pb-6 border-b border-white/5\">\n            <div className=\"mx-auto w-12 h-12 bg-primary/20 rounded-xl flex items-center justify-center mb-2 ring-1 ring-primary/50\">\n              <Shield className=\"w-6 h-6 text-primary\" />\n            </div>\n            <CardTitle className=\"text-2xl font-bold tracking-tight text-white\">Admin Access</CardTitle>\n            <CardDescription className=\"text-white/50\">\n              Enter your credentials to access the dashboard\n            </CardDescription>\n          </CardHeader>\n          \n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleLogin} className=\"space-y-4\">\n              <input\n                type=\"text\"\n                name={honeypotFieldName}\n                value={honeypot}\n                onChange={(e) => setHoneypot(e.target.value)}\n                autoComplete=\"off\"\n                tabIndex={-1}\n                style={{ position: 'absolute', left: '-9999px', opacity: 0, height: 0, width: 0 }}\n                aria-hidden=\"true\"\n              />\n\n              <div className=\"space-y-2\">\n                <Label className=\"text-white/80\">Username</Label>\n                <div className=\"relative\">\n                  <User className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type=\"text\" \n                    placeholder=\"admin\" \n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    className=\"pl-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                    tabIndex={1}\n                    required \n                    data-testid=\"input-username\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n                  <Label className=\"text-white/80\">Password</Label>\n                  <a href=\"/admin/forgot-password\" className=\"text-xs text-primary hover:text-primary/80\" tabIndex={3} data-testid=\"link-forgot-password\">Forgot password?</a>\n                </div>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                  <Input \n                    type={showPassword ? \"text\" : \"password\"} \n                    placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    className=\"pl-9 pr-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                    tabIndex={2}\n                    required \n                    data-testid=\"input-password\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute right-3 top-3 text-white/40 hover:text-white transition-colors\"\n                    tabIndex={4}\n                    data-testid=\"button-toggle-password\"\n                  >\n                    {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </button>\n                </div>\n              </div>\n\n              {captchaType === 'cloudflare' && (\n                <div \n                  id=\"login-turnstile-container\" \n                  ref={turnstileRef}\n                  className=\"flex justify-center\"\n                  data-testid=\"login-turnstile-container\"\n                />\n              )}\n\n              <Button \n                type=\"submit\" \n                className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2 group relative overflow-hidden\"\n                disabled={isLoading}\n                data-testid=\"button-login\"\n              >\n                <span className=\"relative z-10 flex items-center justify-center gap-2\">\n                  {isLoading ? \"Authenticating...\" : \"Sign In\"}\n                  {!isLoading && <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />}\n                </span>\n                <div className=\"absolute inset-0 bg-gradient-to-r from-primary via-purple-600 to-primary opacity-0 group-hover:opacity-100 transition-opacity duration-500\" />\n              </Button>\n            </form>\n          </CardContent>\n          \n          <CardFooter className=\"flex flex-col items-center gap-2 justify-center pt-6 border-t border-white/5\">\n            {captchaEnabled && captchaType !== 'disabled' && (\n              <div className=\"flex items-center gap-2 text-white/40\">\n                <ShieldCheck className=\"w-4 h-4\" />\n                <span className=\"text-xs\">\n                  {captchaType === 'google' && 'Protected by reCAPTCHA'}\n                  {captchaType === 'cloudflare' && 'Protected by Cloudflare'}\n                  {captchaType === 'local' && 'Spam protection enabled'}\n                </span>\n              </div>\n            )}\n            <p className=\"text-xs text-white/30 text-center\">\n              Subject to Privacy Policy and Terms of Service.\n            </p>\n          </CardFooter>\n        </Card>\n      </motion.div>\n\n      <Dialog open={show2FADialog} onOpenChange={setShow2FADialog}>\n        <DialogContent className=\"sm:max-w-md bg-black/90 border-white/10 text-white\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <KeyRound className=\"w-5 h-5 text-primary\" />\n              Two-Factor Authentication\n            </DialogTitle>\n            <DialogDescription className=\"text-white/60\">\n              Enter the 6-digit code from your authenticator app\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-6 py-4\">\n            <div className=\"flex justify-center\">\n              <InputOTP\n                maxLength={6}\n                value={twoFactorCode}\n                onChange={setTwoFactorCode}\n                data-testid=\"input-2fa-code\"\n              >\n                <InputOTPGroup>\n                  <InputOTPSlot index={0} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={1} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={2} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={3} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={4} className=\"bg-white/5 border-white/20 text-white\" />\n                  <InputOTPSlot index={5} className=\"bg-white/5 border-white/20 text-white\" />\n                </InputOTPGroup>\n              </InputOTP>\n            </div>\n\n            {hasBiometric && (\n              <div className=\"text-center\">\n                <p className=\"text-sm text-white/40 mb-3\">Or use your registered biometric</p>\n                <Button\n                  variant=\"outline\"\n                  onClick={handleBiometricLogin}\n                  disabled={isLoading}\n                  className=\"border-white/20 text-white/80\"\n                  data-testid=\"button-biometric-login\"\n                >\n                  <Fingerprint className=\"w-4 h-4 mr-2\" />\n                  Use Biometric\n                </Button>\n              </div>\n            )}\n          </div>\n\n          <DialogFooter className=\"flex gap-2\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => {\n                setShow2FADialog(false);\n                setTwoFactorCode(\"\");\n              }}\n              className=\"text-white/60\"\n              data-testid=\"button-cancel-2fa\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handle2FAVerify}\n              disabled={isLoading || twoFactorCode.length !== 6}\n              className=\"bg-primary text-white\"\n              data-testid=\"button-verify-2fa\"\n            >\n              {isLoading ? \"Verifying...\" : \"Verify\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":16059,"size_tokens":null},"server/api/database.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { upload } from \"../utils/upload\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst router = Router();\n\nconst backupsDir = path.join(process.cwd(), \"backups\");\nif (!fs.existsSync(backupsDir)) {\n  fs.mkdirSync(backupsDir, { recursive: true });\n}\n\nrouter.get(\"/status\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const stats = await storage.getSystemStats();\n\n    const users = await storage.getAllUsers();\n    const projects = await storage.getAllProjects();\n    const posts = await storage.getAllPosts();\n    const skills = await storage.getAllSkills();\n    const services = await storage.getAllServices();\n    const testimonials = await storage.getAllTestimonials();\n    const messages = await storage.getAllMessages();\n    const comments = await storage.getAllComments();\n    const reviews = await storage.getAllReviews();\n    const media = await storage.getAllMedia();\n\n    res.json({\n      status: \"Connected\",\n      uptime: \"99.9%\",\n      tables: {\n        users: users.length,\n        projects: projects.length,\n        posts: posts.length,\n        skills: skills.length,\n        services: services.length,\n        testimonials: testimonials.length,\n        messages: messages.length,\n        comments: comments.length,\n        reviews: reviews.length,\n        media: media.length\n      },\n      totalRecords: users.length + projects.length + posts.length + skills.length + \n                    services.length + testimonials.length + messages.length + \n                    comments.length + reviews.length + media.length,\n      databaseSize: stats.databaseSize || \"N/A\"\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message, status: \"Error\" });\n  }\n});\n\nrouter.post(\"/backup\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const backup = {\n      version: \"1.0\",\n      timestamp: new Date().toISOString(),\n      data: {\n        users: await storage.getAllUsers(),\n        projects: await storage.getAllProjects(),\n        posts: await storage.getAllPosts(),\n        pages: await storage.getAllPages(),\n        skills: await storage.getAllSkills(),\n        services: await storage.getAllServices(),\n        testimonials: await storage.getAllTestimonials(),\n        messages: await storage.getAllMessages(),\n        comments: await storage.getAllComments(),\n        reviews: await storage.getAllReviews(),\n        media: await storage.getAllMedia(),\n        categories: await storage.getAllCategories(),\n        settings: await storage.getAllSettings(),\n        activityLogs: await storage.getAllActivityLogs(500),\n        notifications: await storage.getAllNotifications()\n      }\n    };\n\n    const filename = `backup-${new Date().toISOString().replace(/[:.]/g, '-')}.json`;\n    const filePath = path.join(backupsDir, filename);\n    fs.writeFileSync(filePath, JSON.stringify(backup, null, 2));\n\n    const stats = fs.statSync(filePath);\n\n    await storage.createActivityLog({\n      action: `Database backup created: ${filename}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n\n    res.json({\n      success: true,\n      message: \"Backup created successfully\",\n      filename,\n      size: stats.size,\n      sizeFormatted: stats.size < 1024*1024 ? `${(stats.size/1024).toFixed(1)} KB` : `${(stats.size/1024/1024).toFixed(2)} MB`,\n      timestamp: backup.timestamp,\n      recordCount: Object.values(backup.data).reduce((sum: number, arr: any[]) => sum + arr.length, 0)\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/backup/:filename\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { filename } = req.params;\n    const filePath = path.join(backupsDir, filename);\n\n    if (!fs.existsSync(filePath)) {\n      return res.status(404).json({ message: \"Backup file not found\" });\n    }\n\n    res.download(filePath, filename);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/backups\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    if (!fs.existsSync(backupsDir)) {\n      return res.json([]);\n    }\n\n    const backupFiles = fs.readdirSync(backupsDir)\n      .filter(f => f.endsWith('.json'))\n      .map(filename => {\n        const filePath = path.join(backupsDir, filename);\n        const stats = fs.statSync(filePath);\n        return {\n          filename,\n          size: stats.size,\n          sizeFormatted: stats.size < 1024*1024 ? `${(stats.size/1024).toFixed(1)} KB` : `${(stats.size/1024/1024).toFixed(2)} MB`,\n          created: stats.birthtime,\n          modified: stats.mtime\n        };\n      })\n      .sort((a, b) => new Date(b.created).getTime() - new Date(a.created).getTime());\n\n    res.json(backupFiles);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/backup/:filename\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { filename } = req.params;\n    const filePath = path.join(backupsDir, filename);\n\n    if (!fs.existsSync(filePath)) {\n      return res.status(404).json({ message: \"Backup file not found\" });\n    }\n\n    fs.unlinkSync(filePath);\n\n    await storage.createActivityLog({\n      action: `Deleted backup file: ${filename}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n\n    res.json({ message: \"Backup file deleted successfully\", success: true });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/restore\", requireAdmin, upload.single('backup'), async (req: Request, res: Response) => {\n  try {\n    if (!req.file) {\n      return res.status(400).json({ message: \"No backup file uploaded\" });\n    }\n\n    const backupContent = fs.readFileSync(req.file.path, 'utf-8');\n    const backup = JSON.parse(backupContent);\n\n    if (!backup.version || !backup.data) {\n      return res.status(400).json({ message: \"Invalid backup file format\" });\n    }\n\n    const summary = {\n      version: backup.version,\n      timestamp: backup.timestamp,\n      tables: Object.entries(backup.data).map(([table, data]: [string, any]) => ({\n        table,\n        records: Array.isArray(data) ? data.length : 0\n      }))\n    };\n\n    await storage.createActivityLog({\n      action: `Database restore validated from backup (${backup.timestamp})`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n\n    fs.unlinkSync(req.file.path);\n\n    res.json({\n      success: true,\n      message: \"Backup file validated successfully. Full restore requires confirmation.\",\n      summary\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":6970,"size_tokens":null},"client/src/pages/admin/content/testimonials/Testimonials.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Star, Plus, Edit, Trash, Search, AlertCircle, Loader2, Upload, X } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { insertTestimonialSchema, type Testimonial } from \"@shared/schema\";\nimport type { z } from \"zod\";\n\ntype TestimonialFormData = z.infer<typeof insertTestimonialSchema>;\n\nexport default function AdminTestimonials() {\n  const { toast } = useToast();\n  const [isOpen, setIsOpen] = useState(false);\n  const [editingId, setEditingId] = useState<number | null>(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n\n  const { data: testimonials = [], isLoading } = useQuery({\n    queryKey: [\"/api/testimonials\"],\n    queryFn: () => api.getTestimonials(),\n  });\n\n  const form = useForm<TestimonialFormData>({\n    resolver: zodResolver(insertTestimonialSchema),\n    defaultValues: {\n      name: \"\",\n      role: \"\",\n      company: \"\",\n      content: \"\",\n      rating: 5,\n      avatar: \"\",\n      active: true,\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: TestimonialFormData) => api.createTestimonial(data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial added successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      form.reset();\n      setIsOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to add testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: { id: number; data: Partial<TestimonialFormData> }) =>\n      api.updateTestimonial(data.id, data.data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial updated successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      form.reset();\n      setEditingId(null);\n      setIsOpen(false);\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to update testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteTestimonial(id),\n    onSuccess: () => {\n      toast({ description: \"Testimonial deleted successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to delete testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAvatarUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"image/\")) {\n      toast({ description: \"Please select an image file\", variant: \"destructive\" });\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const base64 = event.target?.result as string;\n      form.setValue(\"avatar\", base64);\n      setAvatarPreview(base64);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleOpenDialog = (testimonial?: Testimonial) => {\n    if (testimonial) {\n      setEditingId(testimonial.id);\n      form.reset({\n        name: testimonial.name,\n        role: testimonial.role || \"\",\n        company: testimonial.company || \"\",\n        content: testimonial.content,\n        rating: testimonial.rating || 5,\n        avatar: testimonial.avatar || \"\",\n        active: testimonial.active !== false,\n      });\n      setAvatarPreview(testimonial.avatar || null);\n    } else {\n      setEditingId(null);\n      form.reset();\n      setAvatarPreview(null);\n    }\n    setIsOpen(true);\n  };\n\n  const handleClearAvatar = () => {\n    form.setValue(\"avatar\", \"\");\n    setAvatarPreview(null);\n  };\n\n  const onSubmit = (data: TestimonialFormData) => {\n    if (editingId) {\n      updateMutation.mutate({ id: editingId, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this testimonial?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredTestimonials = testimonials.filter(\n    (t) =>\n      t.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      t.company?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Testimonials</h1>\n            <p className=\"text-muted-foreground\">Manage customer reviews and feedback</p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-add-testimonial-admin\"\n          >\n            <Plus className=\"w-4 h-4\" /> Add Testimonial\n          </Button>\n        </div>\n\n        {/* Search & Filter */}\n        <div className=\"flex gap-4 bg-card p-4 rounded-lg border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search testimonials...\"\n              className=\"pl-9\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              data-testid=\"input-search-testimonials\"\n            />\n          </div>\n        </div>\n\n        {/* Loading State */}\n        {isLoading && (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        )}\n\n        {/* Testimonials Grid */}\n        {!isLoading && (\n          <>\n            {filteredTestimonials.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <AlertCircle className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                  <p className=\"text-muted-foreground\">\n                    {searchTerm ? \"No testimonials found matching your search\" : \"No testimonials yet. Add one to get started!\"}\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredTestimonials.map((testimonial) => (\n                  <Card key={testimonial.id} className=\"relative\">\n                    <CardHeader>\n                      <div className=\"flex items-start gap-4\">\n                        <Avatar className=\"w-12 h-12\">\n                          <AvatarImage src={testimonial.avatar} />\n                          <AvatarFallback>{testimonial.name.charAt(0)}</AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-semibold\">{testimonial.name}</h3>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {testimonial.role} {testimonial.company && `at ${testimonial.company}`}\n                          </p>\n                          <div className=\"flex gap-1 mt-2\">\n                            {[...Array(testimonial.rating || 5)].map((_, i) => (\n                              <Star\n                                key={i}\n                                className=\"w-4 h-4 fill-yellow-500 text-yellow-500\"\n                                data-testid={`star-${i}`}\n                              />\n                            ))}\n                          </div>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <p className=\"text-sm text-muted-foreground italic\">\"{testimonial.content}\"</p>\n                      <div className=\"flex items-center justify-between mt-4 gap-2\">\n                        <Badge variant={testimonial.active ? \"default\" : \"secondary\"}>\n                          {testimonial.active ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => handleOpenDialog(testimonial)}\n                            data-testid={`button-edit-testimonial-${testimonial.id}`}\n                          >\n                            <Edit className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"text-destructive\"\n                            onClick={() => handleDelete(testimonial.id)}\n                            disabled={deleteMutation.isPending}\n                            data-testid={`button-delete-testimonial-${testimonial.id}`}\n                          >\n                            <Trash className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      {/* Add/Edit Dialog */}\n      <Dialog open={isOpen} onOpenChange={(open) => {\n        setIsOpen(open);\n        if (!open) setAvatarPreview(null);\n      }}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] flex flex-col\">\n          <DialogHeader>\n            <DialogTitle>{editingId ? \"Edit Testimonial\" : \"Add New Testimonial\"}</DialogTitle>\n          </DialogHeader>\n\n          <div className=\"flex-1 overflow-y-auto pr-4\">\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Client Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"John Smith\" {...field} data-testid=\"input-testimonial-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"role\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Job Title / Role</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"CEO\" {...field} value={field.value ?? \"\"} data-testid=\"input-testimonial-role\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"company\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Company Name</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"TechCorp Inc\" {...field} value={field.value ?? \"\"} data-testid=\"input-testimonial-company\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Testimonial Text</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"What did the client say about your work?\"\n                        className=\"resize-none\"\n                        rows={4}\n                        {...field}\n                        data-testid=\"input-testimonial-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"rating\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Rating (Stars)</FormLabel>\n                      <Select value={(field.value ?? 5).toString()} onValueChange={(v) => field.onChange(parseInt(v))}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-testimonial-rating\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {[5, 4, 3, 2, 1].map((star) => (\n                            <SelectItem key={star} value={star.toString()}>\n                              {star} stars\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"active\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select value={field.value ? \"active\" : \"inactive\"} onValueChange={(v) => field.onChange(v === \"active\")}>\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"avatar\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Avatar Image (Optional)</FormLabel>\n                    \n                    {/* Avatar Preview */}\n                    {avatarPreview && (\n                      <div className=\"relative w-24 h-24 rounded-lg overflow-hidden border border-border\">\n                        <img src={avatarPreview} alt=\"Avatar preview\" className=\"w-full h-full object-cover\" />\n                        <button\n                          type=\"button\"\n                          onClick={handleClearAvatar}\n                          className=\"absolute top-1 right-1 bg-destructive/90 text-white p-1 rounded hover:bg-destructive\"\n                          data-testid=\"button-clear-avatar\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    )}\n\n                    <div className=\"space-y-3\">\n                      {/* File Upload */}\n                      <div>\n                        <label className=\"flex items-center justify-center gap-2 p-4 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors\">\n                          <Upload className=\"w-4 h-4 text-muted-foreground\" />\n                          <span className=\"text-sm text-muted-foreground\">Click to upload image</span>\n                          <input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            onChange={handleAvatarUpload}\n                            className=\"hidden\"\n                            data-testid=\"input-upload-avatar\"\n                          />\n                        </label>\n                        <p className=\"text-xs text-muted-foreground mt-1\">PNG, JPG, GIF, WebP (Max 5MB)</p>\n                      </div>\n\n                      {/* URL Input */}\n                      <div>\n                        <label className=\"text-sm text-muted-foreground mb-2 block\">Or paste image URL</label>\n                        <Input\n                          placeholder=\"https://example.com/avatar.jpg\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          onChange={(e) => {\n                            field.onChange(e);\n                            if (e.target.value && !e.target.value.includes(\"data:\")) {\n                              setAvatarPreview(e.target.value);\n                            }\n                          }}\n                          data-testid=\"input-testimonial-avatar-url\"\n                        />\n                      </div>\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              </form>\n            </Form>\n          </div>\n\n          <div className=\"flex gap-2 justify-end pt-4 border-t border-border mt-6\">\n            <Button variant=\"outline\" onClick={() => setIsOpen(false)} type=\"button\">\n              Cancel\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n              data-testid=\"button-submit-testimonial\"\n              onClick={() => form.handleSubmit(onSubmit)()}\n            >\n              {createMutation.isPending || updateMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Saving...\n                </>\n              ) : (\n                <>{editingId ? \"Update\" : \"Add\"} Testimonial</>\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":19222,"size_tokens":null},"server/api/services.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertServiceSchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const services = req.query.active === \"true\"\n      ? await storage.getActiveServices()\n      : await storage.getAllServices();\n    res.json(services);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const service = await storage.getService(parseInt(req.params.id));\n    if (!service) {\n      return res.status(404).json({ message: \"Service not found\" });\n    }\n    res.json(service);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertServiceSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const service = await storage.createService(parsed.data);\n    res.status(201).json(service);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const service = await storage.updateService(parseInt(req.params.id), req.body);\n    if (!service) {\n      return res.status(404).json({ message: \"Service not found\" });\n    }\n    res.json(service);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteService(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Service not found\" });\n    }\n    res.json({ message: \"Service deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1992,"size_tokens":null},"client/src/pages/admin/pages/FAQs.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Plus, \n  Search, \n  GripVertical,\n  Edit,\n  Trash,\n  Eye,\n  EyeOff,\n  MoveUp,\n  MoveDown\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminFAQs() {\n  const [faqs, setFaqs] = useState([\n    { id: 1, question: \"What technologies do you specialize in?\", answer: \"I specialize in the React ecosystem, Node.js, and cloud architecture.\", visible: true, order: 1 },\n    { id: 2, question: \"Do you offer maintenance packages?\", answer: \"Yes, I offer monthly maintenance packages to keep your site secure and updated.\", visible: true, order: 2 },\n    { id: 3, question: \"What is your typical turnaround time?\", answer: \"It depends on the project scope, but typically 2-4 weeks for a standard website.\", visible: true, order: 3 },\n    { id: 4, question: \"Do you work with international clients?\", answer: \"Absolutely! I have experience working with clients across different time zones.\", visible: false, order: 4 },\n  ]);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">FAQs Management</h1>\n            <p className=\"text-muted-foreground\">Manage frequently asked questions for your visitors</p>\n          </div>\n          <Button className=\"bg-primary gap-2\">\n            <Plus className=\"w-4 h-4\" /> Add New FAQ\n          </Button>\n        </div>\n\n        <div className=\"flex gap-4 bg-card p-4 rounded-lg border border-border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input placeholder=\"Search FAQs...\" className=\"pl-9\" />\n          </div>\n        </div>\n\n        <div className=\"space-y-3\">\n          {faqs.map((faq, index) => (\n            <Card key={faq.id} className=\"group hover:border-primary/50 transition-colors\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"cursor-grab text-muted-foreground hover:text-foreground transition-colors\">\n                    <GripVertical className=\"w-5 h-5\" />\n                  </div>\n                  \n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <h4 className=\"font-semibold text-lg\">{faq.question}</h4>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant={faq.visible ? \"default\" : \"secondary\"}>\n                          {faq.visible ? \"Visible\" : \"Hidden\"}\n                        </Badge>\n                        <span className=\"text-xs text-muted-foreground\">Order: {faq.order}</span>\n                      </div>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">{faq.answer}</p>\n                  </div>\n\n                  <div className=\"opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1\">\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Move Up\">\n                      <MoveUp className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Move Down\">\n                      <MoveDown className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title={faq.visible ? \"Hide\" : \"Show\"}>\n                      {faq.visible ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" title=\"Edit\">\n                      <Edit className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" className=\"text-destructive\" title=\"Delete\">\n                      <Trash className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Add/Edit Form */}\n        <Card className=\"border-primary/20 bg-primary/5\">\n          <CardHeader>\n            <CardTitle>Add New FAQ</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Question</label>\n              <Input placeholder=\"Enter your question here...\" />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Answer</label>\n              <Textarea \n                placeholder=\"Provide a detailed answer...\" \n                className=\"min-h-[120px]\"\n              />\n            </div>\n            <div className=\"flex gap-2 justify-end\">\n              <Button variant=\"outline\">Cancel</Button>\n              <Button>Save FAQ</Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5339,"size_tokens":null},"server/api/faqs.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req: Request, res: Response) => {\n  try {\n    const faqs = req.query.visible === \"true\"\n      ? await storage.getVisibleFAQs()\n      : await storage.getAllFAQs();\n    res.json(faqs);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req: Request, res: Response) => {\n  try {\n    const faq = await storage.getFAQ(parseInt(req.params.id));\n    if (!faq) {\n      return res.status(404).json({ message: \"FAQ not found\" });\n    }\n    res.json(faq);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAuth, async (req: Request, res: Response) => {\n  try {\n    const faq = await storage.createFAQ(req.body);\n    res.status(201).json(faq);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req: Request, res: Response) => {\n  try {\n    const faq = await storage.updateFAQ(parseInt(req.params.id), req.body);\n    if (!faq) {\n      return res.status(404).json({ message: \"FAQ not found\" });\n    }\n    res.json(faq);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req: Request, res: Response) => {\n  try {\n    const success = await storage.deleteFAQ(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"FAQ not found\" });\n    }\n    res.json({ message: \"FAQ deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1785,"size_tokens":null},"client/src/pages/admin/tools/Media.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { \n  Upload, \n  Search, \n  Image as ImageIcon, \n  File, \n  Trash2,\n  Eye,\n  Loader2,\n  X,\n  Copy,\n  Grid3x3,\n  List,\n  FileText,\n  Folder,\n  RefreshCw\n} from \"lucide-react\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\n\ninterface MediaItem {\n  id: number;\n  filename: string;\n  originalName: string;\n  mimeType: string;\n  size: number;\n  url: string;\n  alt: string | null;\n  createdAt: Date | null;\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 B';\n  const k = 1024;\n  const sizes = ['B', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n}\n\nfunction getFileIcon(mimeType: string) {\n  if (mimeType.startsWith('image/')) {\n    return <ImageIcon className=\"w-12 h-12 text-blue-500\" />;\n  }\n  return <FileText className=\"w-12 h-12 text-muted-foreground\" />;\n}\n\nexport default function AdminMedia() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState(\"all\");\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<MediaItem | null>(null);\n  const [editingAlt, setEditingAlt] = useState<MediaItem | null>(null);\n  const [altText, setAltText] = useState(\"\");\n  const [uploading, setUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const { data: mediaItems = [], isLoading, error } = useQuery<MediaItem[]>({\n    queryKey: ['/api/media'],\n    retry: 3,\n  });\n\n  const createMediaMutation = useMutation({\n    mutationFn: api.createMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File uploaded successfully\" });\n      setUploadDialogOpen(false);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMediaMutation = useMutation({\n    mutationFn: api.deleteMedia,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"File deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMediaMutation = useMutation({\n    mutationFn: async ({ id, alt }: { id: number; alt: string }) => {\n      const res = await fetch(`/api/media/${id}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ alt }),\n      });\n      if (!res.ok) throw new Error('Failed to update media');\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ title: \"Success\", description: \"Alt text updated\" });\n      setEditingAlt(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const syncMediaMutation = useMutation({\n    mutationFn: api.syncMedia,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      toast({ \n        title: \"Sync Complete\", \n        description: `${data.synced.length} new files synced, ${data.skipped.length} already existed` \n      });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setUploading(true);\n\n    try {\n      if (files.length === 1) {\n        // Single file upload\n        const formData = new FormData();\n        formData.append('file', files[0]);\n        \n        const response = await fetch('/api/upload/file', {\n          method: 'POST',\n          body: formData,\n          credentials: 'include',\n        });\n        \n        if (!response.ok) {\n          const error = await response.json();\n          throw new Error(error.message || 'Upload failed');\n        }\n        \n        toast({ title: \"Success\", description: \"File uploaded successfully\" });\n        queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      } else {\n        // Multiple files upload\n        const formData = new FormData();\n        Array.from(files).forEach(file => {\n          formData.append('files', file);\n        });\n        \n        const response = await fetch('/api/upload/files', {\n          method: 'POST',\n          body: formData,\n          credentials: 'include',\n        });\n        \n        if (!response.ok) {\n          const error = await response.json();\n          throw new Error(error.message || 'Upload failed');\n        }\n        \n        toast({ title: \"Success\", description: `${files.length} files uploaded successfully` });\n        queryClient.invalidateQueries({ queryKey: ['/api/media'] });\n      }\n    } catch (error: any) {\n      console.error('Upload error:', error);\n      toast({ title: \"Error\", description: error.message || 'Upload failed', variant: \"destructive\" });\n    }\n\n    setUploading(false);\n    setUploadDialogOpen(false);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete \"${name}\"? This action cannot be undone.`)) {\n      deleteMediaMutation.mutate(id);\n    }\n  };\n\n  const copyToClipboard = (url: string) => {\n    navigator.clipboard.writeText(url);\n    toast({ title: \"Copied\", description: \"URL copied to clipboard\" });\n  };\n\n  const openEditAlt = (item: MediaItem) => {\n    setEditingAlt(item);\n    setAltText(item.alt || \"\");\n  };\n\n  const saveAltText = () => {\n    if (editingAlt) {\n      updateMediaMutation.mutate({ id: editingAlt.id, alt: altText });\n    }\n  };\n\n  const filteredMedia = mediaItems.filter(item => {\n    const matchesSearch = searchQuery === \"\" || \n      item.originalName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      item.filename.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesType = filterType === \"all\" ||\n      (filterType === \"images\" && item.mimeType.startsWith(\"image/\")) ||\n      (filterType === \"docs\" && !item.mimeType.startsWith(\"image/\"));\n    \n    return matchesSearch && matchesType;\n  });\n\n  const imageCount = mediaItems.filter(m => m.mimeType.startsWith(\"image/\")).length;\n  const docCount = mediaItems.filter(m => !m.mimeType.startsWith(\"image/\")).length;\n  const totalSize = mediaItems.reduce((sum, m) => sum + m.size, 0);\n  const maxStorage = 500 * 1024 * 1024;\n  const storagePercent = Math.round((totalSize / maxStorage) * 100);\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          <p className=\"ml-2 text-muted-foreground\">Loading media...</p>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  if (error) {\n    console.error('Media error:', error);\n    return (\n      <AdminLayout>\n        <div className=\"flex flex-col items-center justify-center h-64\">\n          <p className=\"text-destructive mb-4\">Error loading media: {error instanceof Error ? error.message : 'Unknown error'}</p>\n          <Button onClick={() => window.location.reload()}>Reload Page</Button>\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-media-title\">Media Library</h1>\n            <p className=\"text-muted-foreground\">\n              {mediaItems.length} files ({formatFileSize(totalSize)} total)\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\"\n              onClick={() => syncMediaMutation.mutate()}\n              disabled={syncMediaMutation.isPending}\n              data-testid=\"button-sync-files\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${syncMediaMutation.isPending ? 'animate-spin' : ''}`} /> \n              {syncMediaMutation.isPending ? 'Syncing...' : 'Sync Folder'}\n            </Button>\n            <Button \n              onClick={() => setUploadDialogOpen(true)}\n              data-testid=\"button-upload-files\"\n            >\n              <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n            </Button>\n          </div>\n        </div>\n\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium\">Storage Used</span>\n              <span className=\"text-sm text-muted-foreground\">\n                {formatFileSize(totalSize)} / 500 MB\n              </span>\n            </div>\n            <div className=\"w-full bg-muted rounded-full h-2 overflow-hidden\">\n              <div \n                className=\"bg-primary h-full rounded-full transition-all\" \n                style={{ width: `${Math.min(storagePercent, 100)}%` }} \n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <Card className=\"cursor-pointer hover:border-primary transition-colors\" onClick={() => setFilterType(\"images\")}>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-3\">\n                <div className=\"p-3 bg-blue-500/10 rounded-lg\">\n                  <ImageIcon className=\"w-6 h-6 text-blue-500\" />\n                </div>\n              </div>\n              <h4 className=\"font-bold mb-1\">Images</h4>\n              <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                <span>{imageCount} files</span>\n                <span>-</span>\n                <span>{formatFileSize(mediaItems.filter(m => m.mimeType.startsWith(\"image/\")).reduce((s, m) => s + m.size, 0))}</span>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"cursor-pointer hover:border-primary transition-colors\" onClick={() => setFilterType(\"docs\")}>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-3\">\n                <div className=\"p-3 bg-orange-500/10 rounded-lg\">\n                  <FileText className=\"w-6 h-6 text-orange-500\" />\n                </div>\n              </div>\n              <h4 className=\"font-bold mb-1\">Documents</h4>\n              <div className=\"flex gap-2 text-xs text-muted-foreground\">\n                <span>{docCount} files</span>\n                <span>-</span>\n                <span>{formatFileSize(mediaItems.filter(m => !m.mimeType.startsWith(\"image/\")).reduce((s, m) => s + m.size, 0))}</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-center justify-between\">\n              <div className=\"relative flex-1 w-full\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input \n                  placeholder=\"Search files...\" \n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  data-testid=\"input-search-media\"\n                />\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Tabs value={filterType} onValueChange={setFilterType} className=\"w-auto\">\n                  <TabsList>\n                    <TabsTrigger value=\"all\" data-testid=\"tab-all\">All ({mediaItems.length})</TabsTrigger>\n                    <TabsTrigger value=\"images\" data-testid=\"tab-images\">Images ({imageCount})</TabsTrigger>\n                    <TabsTrigger value=\"docs\" data-testid=\"tab-docs\">Docs ({docCount})</TabsTrigger>\n                  </TabsList>\n                </Tabs>\n                <div className=\"flex gap-1 border rounded-md p-1\">\n                  <Button \n                    variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"grid\")}\n                    data-testid=\"button-view-grid\"\n                  >\n                    <Grid3x3 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button \n                    variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"} \n                    size=\"icon\"\n                    onClick={() => setViewMode(\"list\")}\n                    data-testid=\"button-view-list\"\n                  >\n                    <List className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {filteredMedia.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <ImageIcon className=\"w-12 h-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No files found</h3>\n              <p className=\"text-muted-foreground text-sm mb-4\">\n                {searchQuery ? \"Try adjusting your search\" : \"Upload your first file\"}\n              </p>\n              <Button onClick={() => setUploadDialogOpen(true)}>\n                <Upload className=\"w-4 h-4 mr-2\" /> Upload Files\n              </Button>\n            </CardContent>\n          </Card>\n        ) : viewMode === \"grid\" ? (\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4\">\n            {filteredMedia.map((item) => (\n              <div \n                key={item.id} \n                className=\"group relative bg-card border border-border rounded-lg overflow-hidden hover:shadow-md transition-all\"\n                data-testid={`media-item-${item.id}`}\n              >\n                <div className=\"aspect-square bg-muted flex items-center justify-center relative overflow-hidden\">\n                  {item.mimeType.startsWith(\"image/\") ? (\n                    <img \n                      src={item.url} \n                      alt={item.alt || item.originalName} \n                      className=\"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110\" \n                    />\n                  ) : (\n                    getFileIcon(item.mimeType)\n                  )}\n                  \n                  <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full\"\n                      onClick={() => setPreviewItem(item)}\n                      title=\"Preview\"\n                    >\n                      <Eye size={14} />\n                    </Button>\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full\"\n                      onClick={() => openEditAlt(item)}\n                      title=\"Edit Alt Text\"\n                    >\n                      <FileText size={14} />\n                    </Button>\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full\"\n                      onClick={() => copyToClipboard(item.url)}\n                      title=\"Copy URL\"\n                    >\n                      <Copy size={14} />\n                    </Button>\n                    <Button \n                      size=\"icon\" \n                      variant=\"secondary\" \n                      className=\"h-8 w-8 rounded-full text-destructive\"\n                      onClick={() => handleDelete(item.id, item.originalName)}\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={14} />\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"p-3\">\n                  <div className=\"font-medium text-sm truncate\" title={item.originalName}>\n                    {item.originalName}\n                  </div>\n                  <div className=\"text-xs text-muted-foreground flex justify-between mt-1\">\n                    <span>{item.mimeType.split('/')[1]?.toUpperCase() || 'FILE'}</span>\n                    <span>{formatFileSize(item.size)}</span>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"p-0\">\n              <div className=\"divide-y\">\n                {filteredMedia.map((file) => (\n                  <div \n                    key={file.id} \n                    className=\"flex items-center justify-between p-4 hover:bg-muted/50 cursor-pointer group\"\n                    data-testid={`media-row-${file.id}`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {file.mimeType.startsWith(\"image/\") ? (\n                        <div className=\"w-10 h-10 rounded overflow-hidden bg-muted flex items-center justify-center\">\n                          <img \n                            src={file.url} \n                            alt={file.alt || file.originalName}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n                      ) : (\n                        <div className=\"w-10 h-10 rounded bg-muted flex items-center justify-center\">\n                          <FileText className=\"w-5 h-5 text-muted-foreground\" />\n                        </div>\n                      )}\n                      <div>\n                        <p className=\"font-medium text-sm\">{file.originalName}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {file.createdAt && formatDistanceToNow(new Date(file.createdAt), { addSuffix: true })}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-4\">\n                      <span className=\"text-sm text-muted-foreground\">{formatFileSize(file.size)}</span>\n                      <div className=\"flex gap-1 invisible group-hover:visible transition-all\">\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          onClick={() => setPreviewItem(file)}\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\"\n                          onClick={() => copyToClipboard(file.url)}\n                        >\n                          <Copy className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"ghost\" \n                          size=\"icon\" \n                          className=\"text-destructive\"\n                          onClick={() => handleDelete(file.id, file.originalName)}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>\n          <DialogContent className=\"sm:max-w-[500px]\">\n            <DialogHeader>\n              <DialogTitle>Upload Files</DialogTitle>\n              <DialogDescription>\n                Select files to upload to your media library\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              <div \n                className=\"border-2 border-dashed border-muted-foreground/30 rounded-lg p-8 text-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\"\n                onClick={() => fileInputRef.current?.click()}\n              >\n                <Upload className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-sm font-medium mb-2\">Click to select files</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  Supports images, PDFs, and documents\n                </p>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  className=\"hidden\"\n                  multiple\n                  accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt\"\n                  onChange={handleFileSelect}\n                  data-testid=\"input-file-upload\"\n                />\n              </div>\n\n              {uploading && (\n                <div className=\"flex items-center justify-center gap-2 text-sm text-muted-foreground\">\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  <span>Uploading...</span>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setUploadDialogOpen(false)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={!!editingAlt} onOpenChange={() => setEditingAlt(null)}>\n          <DialogContent className=\"sm:max-w-[400px]\">\n            <DialogHeader>\n              <DialogTitle>Edit Alt Text</DialogTitle>\n              <DialogDescription>\n                Update the alternative text for this image\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"alt-text\">Alt Text</Label>\n                <Input\n                  id=\"alt-text\"\n                  value={altText}\n                  onChange={(e) => setAltText(e.target.value)}\n                  placeholder=\"Describe this image...\"\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setEditingAlt(null)}>\n                Cancel\n              </Button>\n              <Button onClick={saveAltText} disabled={updateMediaMutation.isPending}>\n                {updateMediaMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                Save\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog open={!!previewItem} onOpenChange={() => setPreviewItem(null)}>\n          <DialogContent className=\"sm:max-w-[700px]\">\n            <DialogHeader>\n              <DialogTitle>{previewItem?.originalName}</DialogTitle>\n              <DialogDescription>\n                {previewItem?.mimeType} - {previewItem && formatFileSize(previewItem.size)}\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"py-4\">\n              {previewItem?.mimeType.startsWith(\"image/\") ? (\n                <img \n                  src={previewItem.url} \n                  alt={previewItem.alt || previewItem.originalName}\n                  className=\"max-w-full max-h-[400px] mx-auto rounded-lg\"\n                />\n              ) : previewItem?.mimeType === \"application/pdf\" ? (\n                <iframe \n                  src={previewItem.url}\n                  className=\"w-full h-[500px] rounded-lg border\"\n                />\n              ) : previewItem?.mimeType === \"text/plain\" || previewItem?.mimeType?.includes(\"text/\") ? (\n                <div className=\"bg-muted p-4 rounded-lg max-h-[500px] overflow-auto\">\n                  <pre className=\"text-sm font-mono whitespace-pre-wrap break-words\">\n                    <a href={previewItem.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n                      Open {previewItem.originalName} â†’\n                    </a>\n                  </pre>\n                </div>\n              ) : previewItem ? (\n                <div className=\"flex flex-col items-center justify-center py-12\">\n                  {getFileIcon(previewItem?.mimeType || '')}\n                  <p className=\"text-muted-foreground mt-4\">\n                    <a href={previewItem.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n                      Download {previewItem.originalName}\n                    </a>\n                  </p>\n                </div>\n              ) : null}\n            </div>\n\n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                onClick={() => previewItem && copyToClipboard(previewItem.url)}\n              >\n                <Copy className=\"w-4 h-4 mr-2\" /> Copy URL\n              </Button>\n              <Button variant=\"outline\" onClick={() => setPreviewItem(null)}>\n                <X className=\"w-4 h-4 mr-2\" /> Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":26456,"size_tokens":null},"client/src/pages/admin/communications/Notifications.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Bell, Mail, MessageSquare, CheckCircle, Trash2, AlertCircle, Search, Filter, Check, Star } from \"lucide-react\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ntype NotificationItem = {\n  id: string;\n  type: 'message' | 'comment' | 'review';\n  sender: string;\n  content: string;\n  subject?: string;\n  read: boolean;\n  createdAt: Date | null;\n  originalId: number;\n  rating?: number;\n};\n\nexport default function AdminNotifications() {\n  const { toast } = useToast();\n  const [emailNotif, setEmailNotif] = useState(true);\n  const [commentAlerts, setCommentAlerts] = useState(true);\n  const [systemUpdates, setSystemUpdates] = useState(true);\n  const [newsletterStats, setNewsletterStats] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [filterRead, setFilterRead] = useState<string>(\"all\");\n\n  const { data: messages = [], refetch: refetchMessages } = useQuery<any[]>({\n    queryKey: ['/api/messages'],\n    retry: false,\n  });\n\n  const { data: comments = [], refetch: refetchComments } = useQuery<any[]>({\n    queryKey: ['/api/comments'],\n  });\n\n  const { data: reviews = [], refetch: refetchReviews } = useQuery<any[]>({\n    queryKey: ['/api/reviews'],\n  });\n\n  const markMessageReadMutation = useMutation({\n    mutationFn: (id: number) => api.markMessageAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      await refetchMessages();\n    },\n  });\n\n  const markCommentReadMutation = useMutation({\n    mutationFn: (id: number) => api.markCommentAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      await refetchComments();\n    },\n  });\n\n  const markReviewReadMutation = useMutation({\n    mutationFn: (id: number) => api.markReviewAsRead(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      await refetchReviews();\n    },\n  });\n\n  const archiveMessageMutation = useMutation({\n    mutationFn: (id: number) => api.archiveMessage(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/messages'] });\n      await refetchMessages();\n    },\n  });\n\n  const archiveCommentMutation = useMutation({\n    mutationFn: (id: number) => api.archiveComment(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n      await refetchComments();\n    },\n  });\n\n  const archiveReviewMutation = useMutation({\n    mutationFn: (id: number) => api.archiveReview(id),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n      await refetchReviews();\n    },\n  });\n\n  const allNotifications: NotificationItem[] = [\n    ...messages.filter(m => !m.archived).map(m => ({\n      id: `msg-${m.id}`,\n      type: 'message' as const,\n      sender: m.sender || 'Unknown',\n      content: m.message || '',\n      subject: m.subject || undefined,\n      read: m.read,\n      createdAt: m.createdAt ? new Date(m.createdAt) : null,\n      originalId: m.id,\n    })),\n    ...comments.filter((c: any) => !c.archived).map((c: any) => ({\n      id: `comment-${c.id}`,\n      type: 'comment' as const,\n      sender: c.authorName || 'Unknown',\n      content: c.content || '',\n      subject: 'New comment',\n      read: c.read || false,\n      createdAt: c.createdAt ? new Date(c.createdAt) : null,\n      originalId: c.id,\n    })),\n    ...reviews.filter((r: any) => !r.archived).map((r: any) => ({\n      id: `review-${r.id}`,\n      type: 'review' as const,\n      sender: r.authorName || 'Unknown',\n      content: r.content || '',\n      subject: `${r.rating || 5}-star review`,\n      read: r.read || false,\n      createdAt: r.createdAt ? new Date(r.createdAt) : null,\n      originalId: r.id,\n      rating: r.rating,\n    })),\n  ].sort((a, b) => {\n    const dateA = a.createdAt ? a.createdAt.getTime() : 0;\n    const dateB = b.createdAt ? b.createdAt.getTime() : 0;\n    return dateB - dateA;\n  });\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case \"comment\":\n        return <MessageSquare className=\"w-4 h-4\" />;\n      case \"message\":\n        return <Mail className=\"w-4 h-4\" />;\n      case \"review\":\n        return <Star className=\"w-4 h-4\" />;\n      default:\n        return <Bell className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case \"comment\":\n        return \"bg-blue-500/10 text-blue-500 border-blue-500/20\";\n      case \"message\":\n        return \"bg-green-500/10 text-green-500 border-green-500/20\";\n      case \"review\":\n        return \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\";\n      default:\n        return \"bg-muted text-muted-foreground border-border\";\n    }\n  };\n\n  const unreadCount = allNotifications.filter(n => !n.read).length;\n\n  const filteredNotifications = allNotifications.filter(notif => {\n    const matchesSearch = searchQuery === \"\" || \n      notif.sender?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      notif.subject?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      notif.content?.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesType = filterType === \"all\" || notif.type === filterType;\n    const matchesRead = filterRead === \"all\" || \n      (filterRead === \"unread\" && !notif.read) ||\n      (filterRead === \"read\" && notif.read);\n\n    return matchesSearch && matchesType && matchesRead;\n  });\n\n  const handleMarkAllAsRead = async () => {\n    const unreadMessages = messages.filter(m => !m.read);\n    const unreadComments = comments.filter((c: any) => !c.read);\n    const unreadReviews = reviews.filter((r: any) => !r.read);\n    const totalUnread = unreadMessages.length + unreadComments.length + unreadReviews.length;\n    \n    if (totalUnread === 0) {\n      toast({ title: \"Info\", description: \"All notifications are already read\" });\n      return;\n    }\n    \n    try {\n      for (const msg of unreadMessages) {\n        await markMessageReadMutation.mutateAsync(msg.id);\n      }\n      for (const comment of unreadComments) {\n        await markCommentReadMutation.mutateAsync(comment.id);\n      }\n      for (const review of unreadReviews) {\n        await markReviewReadMutation.mutateAsync(review.id);\n      }\n      \n      // Refetch all data to update UI\n      await Promise.all([\n        refetchMessages(),\n        refetchComments(),\n        refetchReviews()\n      ]);\n      \n      toast({ title: \"Success\", description: `Marked all ${totalUnread} notifications as read` });\n    } catch (error) {\n      toast({ title: \"Error\", description: \"Failed to mark notifications as read\", variant: \"destructive\" });\n    }\n  };\n\n  const handleClearAll = async () => {\n    const total = allNotifications.length;\n    if (total === 0) {\n      toast({ title: \"Info\", description: \"No notifications to clear\" });\n      return;\n    }\n    \n    if (confirm(`Clear all ${total} notifications?\\n\\nThis will hide all notifications from this list. The original data will be preserved.`)) {\n      try {\n        // Archive messages that are not archived\n        const messagesToArchive = messages.filter(m => !m.archived);\n        for (const msg of messagesToArchive) {\n          await archiveMessageMutation.mutateAsync(msg.id);\n        }\n        \n        // Archive all unarchived comments\n        const commentsToArchive = comments.filter((c: any) => !c.archived);\n        for (const comment of commentsToArchive) {\n          await archiveCommentMutation.mutateAsync(comment.id);\n        }\n        \n        // Archive all unarchived reviews\n        const reviewsToArchive = reviews.filter((r: any) => !r.archived);\n        for (const review of reviewsToArchive) {\n          await archiveReviewMutation.mutateAsync(review.id);\n        }\n        \n        toast({ title: \"Success\", description: `Cleared all ${total} notifications` });\n      } catch (error) {\n        toast({ title: \"Error\", description: \"Failed to clear notifications\", variant: \"destructive\" });\n      }\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Notifications</h1>\n            <p className=\"text-muted-foreground\">\n              Manage system and contact form notifications\n              {unreadCount > 0 && (\n                <span className=\"ml-2 text-primary font-medium\">\n                  ({unreadCount} unread)\n                </span>\n              )}\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={handleMarkAllAsRead}\n              disabled={unreadCount === 0}\n              title=\"Mark all notifications as read\"\n              data-testid=\"button-mark-all-read\"\n            >\n              <Check className=\"w-4 h-4 mr-2\" />\n              Mark All Read\n            </Button>\n            <Button \n              variant=\"outline\" \n              onClick={handleClearAll}\n              disabled={allNotifications.length === 0}\n              title=\"Mark all notifications as read\"\n              data-testid=\"button-clear-all\"\n            >\n              <Trash2 className=\"w-4 h-4 mr-2\" />\n              Clear All\n            </Button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex flex-col sm:flex-row gap-4\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  type=\"search\"\n                  placeholder=\"Search notifications...\"\n                  className=\"pl-9\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                />\n              </div>\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" className=\"gap-2\">\n                    <Filter className=\"w-4 h-4\" />\n                    Type: {filterType === \"all\" ? \"All\" : filterType}\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuItem onClick={() => setFilterType(\"all\")}>\n                    All Types\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"message\")}>\n                    Messages\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"comment\")}>\n                    Comments\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterType(\"review\")}>\n                    Reviews\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" className=\"gap-2\">\n                    <Filter className=\"w-4 h-4\" />\n                    Status: {filterRead === \"all\" ? \"All\" : filterRead === \"unread\" ? \"Unread\" : \"Read\"}\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuItem onClick={() => setFilterRead(\"all\")}>\n                    All\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterRead(\"unread\")}>\n                    Unread Only\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => setFilterRead(\"read\")}>\n                    Read Only\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Notifications List */}\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center justify-between\">\n                  <span>All Notifications ({filteredNotifications.length})</span>\n                  {filteredNotifications.length > 0 && (\n                    <Badge variant=\"secondary\">\n                      {filteredNotifications.filter(n => !n.read).length} unread\n                    </Badge>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n                {filteredNotifications.length === 0 ? (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Bell className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p className=\"text-lg font-medium\">No notifications found</p>\n                    <p className=\"text-sm mt-1\">\n                      {searchQuery || filterType !== \"all\" || filterRead !== \"all\"\n                        ? \"Try adjusting your filters\"\n                        : \"You're all caught up!\"}\n                    </p>\n                  </div>\n                ) : (\n                  filteredNotifications.map((notif) => (\n                    <div\n                      key={notif.id}\n                      className={`flex items-start gap-4 p-4 rounded-lg border transition-all ${\n                        !notif.read\n                          ? \"bg-primary/5 border-primary/20 shadow-sm\"\n                          : \"border-border hover:bg-muted/50\"\n                      }`}\n                    >\n                      <div className={`p-2.5 rounded-full border ${getTypeColor(notif.type)}`}>\n                        {getTypeIcon(notif.type)}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2 justify-between mb-1\">\n                          <div className=\"flex items-center gap-2\">\n                            <p className=\"font-medium text-sm truncate\">\n                              {notif.sender}\n                            </p>\n                            {!notif.read && (\n                              <Badge variant=\"default\" className=\"h-5 px-1.5 text-xs\">\n                                New\n                              </Badge>\n                            )}\n                          </div>\n                          {notif.createdAt && (\n                            <span className=\"text-xs text-muted-foreground flex-shrink-0\">\n                              {formatDistanceToNow(notif.createdAt, {\n                                addSuffix: true,\n                              })}\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm font-medium truncate mb-1\">\n                          {notif.subject || \"No subject\"}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                          {notif.content || \"No content\"}\n                        </p>\n                      </div>\n                      <div className=\"flex gap-1 flex-shrink-0\">\n                        {notif.type === 'message' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markMessageReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'comment' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markCommentReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'review' && !notif.read && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-primary hover:text-primary hover:bg-primary/10\"\n                            title=\"Mark as read\"\n                            onClick={() => markReviewReadMutation.mutate(notif.originalId)}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'message' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveMessageMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'comment' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveCommentMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                        {notif.type === 'review' && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-muted-foreground hover:text-foreground hover:bg-muted\"\n                            title=\"Remove from notifications\"\n                            onClick={async () => {\n                              try {\n                                await archiveReviewMutation.mutateAsync(notif.originalId);\n                                toast({ description: \"Notification removed\" });\n                              } catch (error) {\n                                toast({ description: \"Failed to remove notification\", variant: \"destructive\" });\n                              }\n                            }}\n                            data-testid={`button-dismiss-notification-${notif.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"space-y-4\">\n            {/* Quick Stats */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertCircle className=\"w-4 h-4\" />\n                  Quick Stats\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-primary/5 border border-primary/10\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Unread Total</p>\n                    <p className=\"text-2xl font-bold text-primary\">{unreadCount}</p>\n                  </div>\n                  <Bell className=\"w-8 h-8 text-primary/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Messages</p>\n                    <p className=\"text-2xl font-bold\">\n                      {messages.filter(m => !m.archived && !m.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {messages.filter(m => !m.archived).length}</span>\n                    </p>\n                  </div>\n                  <Mail className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Comments</p>\n                    <p className=\"text-2xl font-bold\">\n                      {comments.filter((c: any) => !c.archived && !c.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {comments.filter((c: any) => !c.archived).length}</span>\n                    </p>\n                  </div>\n                  <MessageSquare className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n                <div className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50 border\">\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">Reviews</p>\n                    <p className=\"text-2xl font-bold\">\n                      {reviews.filter((r: any) => !r.archived && !r.read).length}\n                      <span className=\"text-sm font-normal text-muted-foreground ml-1\">/ {reviews.filter((r: any) => !r.archived).length}</span>\n                    </p>\n                  </div>\n                  <Star className=\"w-8 h-8 text-muted-foreground/50\" />\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Notification Settings */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification Settings</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Email Notifications</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Receive notifications via email\n                    </p>\n                  </div>\n                  <Switch checked={emailNotif} onCheckedChange={setEmailNotif} />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Comment Alerts</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      New comments on posts\n                    </p>\n                  </div>\n                  <Switch\n                    checked={commentAlerts}\n                    onCheckedChange={setCommentAlerts}\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">System Updates</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Important system events\n                    </p>\n                  </div>\n                  <Switch\n                    checked={systemUpdates}\n                    onCheckedChange={setSystemUpdates}\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Newsletter Stats</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Weekly subscriber updates\n                    </p>\n                  </div>\n                  <Switch\n                    checked={newsletterStats}\n                    onCheckedChange={setNewsletterStats}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":26264,"size_tokens":null},"server/api/categories.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertCategorySchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const type = req.query.type as string;\n    const categories = type \n      ? await storage.getCategoriesByType(type)\n      : await storage.getCategoriesByType(\"all\");\n    res.json(categories);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const category = await storage.getCategory(parseInt(req.params.id));\n    if (!category) {\n      return res.status(404).json({ message: \"Category not found\" });\n    }\n    res.json(category);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertCategorySchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const category = await storage.createCategory(parsed.data);\n    res.status(201).json(category);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const category = await storage.updateCategory(parseInt(req.params.id), req.body);\n    if (!category) {\n      return res.status(404).json({ message: \"Category not found\" });\n    }\n    res.json(category);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteCategory(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Category not found\" });\n    }\n    res.json({ message: \"Category deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2051,"size_tokens":null},"client/src/pages/admin/settings/Settings.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Save,\n  Upload,\n  Mail,\n  Database,\n  Zap,\n  Key,\n  Plug,\n  Bell,\n  Code2,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  Globe,\n  DollarSign,\n  Hash,\n  Languages,\n  HardDrive,\n  RefreshCw,\n  Download,\n  Trash2,\n  Terminal,\n  Bug,\n  Gauge,\n  Server,\n  X,\n  ImageIcon,\n  Eye,\n  EyeOff,\n  Loader2,\n} from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { SettingsPerformance } from \"./SettingsPerformance\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { StorageTab } from \"@/components/admin/StorageTab\";\nimport { DatabaseTab } from \"@/components/admin/DatabaseTab\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\ninterface EmailTemplate {\n  subject: string;\n  body: string;\n}\n\nexport default function AdminSettingsEnhanced() {\n  const [logoFile, setLogoFile] = useState<string | null>(null);\n  const [profileImageUploading, setProfileImageUploading] = useState(false);\n  const [cvFileUploading, setCVFileUploading] = useState(false);\n  const [brandingUploading, setBrandingUploading] = useState(false);\n  const [showSmtpPassword, setShowSmtpPassword] = useState(false);\n  const [editingTemplate, setEditingTemplate] = useState<string | null>(null);\n  const [templateSubject, setTemplateSubject] = useState(\"\");\n  const [templateBody, setTemplateBody] = useState(\"\");\n  const profileImageInputRef = useRef<HTMLInputElement>(null);\n  const cvFileInputRef = useRef<HTMLInputElement>(null);\n  const { settings, updateSettings, saveSettings, isSaving } =\n    useSiteSettings();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch email templates with TanStack Query\n  const { data: emailTemplates = {}, isLoading: templatesLoading } = useQuery({\n    queryKey: ['/api/email/templates'],\n    queryFn: () => api.getEmailTemplates()\n  });\n\n  // Mutation for updating email templates\n  const updateTemplateMutation = useMutation({\n    mutationFn: ({ name, data }: { name: string; data: { subject: string; body: string } }) =>\n      api.updateEmailTemplate(name, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/email/templates'] });\n      toast({ title: \"Success\", description: \"Email template saved successfully\" });\n      setEditingTemplate(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const openTemplateEditor = (templateName: string) => {\n    const template = emailTemplates[templateName];\n    if (template) {\n      setTemplateSubject(template.subject);\n      setTemplateBody(template.body);\n    } else {\n      setTemplateSubject(\"\");\n      setTemplateBody(\"\");\n    }\n    setEditingTemplate(templateName);\n  };\n\n  const saveTemplate = () => {\n    if (!editingTemplate) return;\n    updateTemplateMutation.mutate({\n      name: editingTemplate,\n      data: { subject: templateSubject, body: templateBody }\n    });\n  };\n\n  const templateLabels: Record<string, string> = {\n    welcome: \"Welcome Email\",\n    notification: \"Notification Email\",\n    newsletter: \"Newsletter Template\",\n    contact: \"Contact Form Email\",\n    comment: \"Comment Notification\"\n  };\n\n  const handleBrandingUpload = async (\n    file: File,\n    settingKey: \"logoUrl\" | \"faviconUrl\"\n  ) => {\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setBrandingUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n\n      const response = await fetch(\"/api/storage/upload\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(errorText || \"Upload failed\");\n      }\n\n      const data = await response.json();\n      updateSettings({ [settingKey]: data.url });\n      toast({\n        title: \"Success\",\n        description: \"Image uploaded successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setBrandingUploading(false);\n    }\n  };\n\n  const handleProfileImageUpload = async (\n    e: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_IMAGE_SIZE = 5 * 1024 * 1024; // 5MB\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_IMAGE_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 5MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setProfileImageUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ aboutImage: base64 });\n        toast({ title: \"Success\", description: `Image uploaded successfully (${(file.size / 1024).toFixed(2)}KB)` });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setProfileImageUploading(false);\n    }\n  };\n\n  const handleCVFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_PDF_SIZE = 10 * 1024 * 1024; // 10MB\n    if (file.type !== \"application/pdf\") {\n      toast({\n        title: \"Error\",\n        description: \"Please select a PDF file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_PDF_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 10MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setCVFileUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ cvFileUrl: base64 });\n        toast({\n          title: \"Success\",\n          description: `CV file uploaded successfully (${(file.size / 1024).toFixed(2)}KB)`,\n        });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload CV file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setCVFileUploading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    const result = await saveSettings();\n    if (result?.success) {\n      toast({ \n        title: \"ThÃ nh cÃ´ng âœ“\", \n        description: \"CÃ i Ä‘áº·t Ä‘Æ°á»£c lÆ°u thÃ nh cÃ´ng\" \n      });\n    } else {\n      toast({\n        title: \"Lá»—i\",\n        description: result?.error || \"KhÃ´ng thá»ƒ lÆ°u cÃ i Ä‘áº·t\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Settings</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your website configuration\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary hover:bg-primary/90\"\n            onClick={handleSave}\n            disabled={isSaving}\n          >\n            {isSaving ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              <>\n                <Save className=\"w-4 h-4 mr-2\" />\n                Save Changes\n              </>\n            )}\n          </Button>\n        </div>\n\n        <Tabs defaultValue=\"general\" className=\"space-y-6\">\n          <div className=\"w-full overflow-x-auto\">\n            <TabsList className=\"inline-flex gap-1 h-auto p-1 min-w-full\">\n              <TabsTrigger value=\"general\">General</TabsTrigger>\n              <TabsTrigger value=\"branding\">Branding</TabsTrigger>\n              <TabsTrigger value=\"seo\">SEO</TabsTrigger>\n              <TabsTrigger value=\"email\">Email</TabsTrigger>\n              <TabsTrigger value=\"storage\">Storage</TabsTrigger>\n              <TabsTrigger value=\"performance\">Performance</TabsTrigger>\n              <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\n              <TabsTrigger value=\"developer\">Developer</TabsTrigger>\n              <TabsTrigger value=\"localization\">Localization</TabsTrigger>\n              <TabsTrigger value=\"database\">Database</TabsTrigger>\n            </TabsList>\n          </div>\n\n          {/* GENERAL TAB */}\n          <TabsContent value=\"general\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Site Information</CardTitle>\n                <CardDescription>\n                  Basic information about your portfolio website.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Site Title (Homepage & Admin)</Label>\n                  <Input\n                    value={settings.siteTitle}\n                    onChange={(e) =>\n                      updateSettings({ siteTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Loi Developer - Full-stack Creative\"\n                    data-testid=\"input-site-title\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Appears in browser tab and header\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Tagline</Label>\n                  <Input\n                    value={settings.tagline}\n                    onChange={(e) =>\n                      updateSettings({ tagline: e.target.value })\n                    }\n                    placeholder=\"e.g., Building digital experiences with code.\"\n                    data-testid=\"input-tagline\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle>Hero Section</CardTitle>\n                <CardDescription>\n                  Main heading and call-to-action on homepage.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Hero Title</Label>\n                  <Input\n                    value={settings.heroTitle}\n                    onChange={(e) =>\n                      updateSettings({ heroTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Hello, I'm Loi Developer\"\n                    data-testid=\"input-hero-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Hero Subtitle</Label>\n                  <Textarea\n                    value={settings.heroSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ heroSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer | UI/UX Enthusiast\"\n                    rows={2}\n                    data-testid=\"input-hero-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>View Projects CTA Button Text</Label>\n                  <Input\n                    value={settings.heroCTA}\n                    onChange={(e) =>\n                      updateSettings({ heroCTA: e.target.value })\n                    }\n                    placeholder=\"e.g., View My Work\"\n                    data-testid=\"input-hero-cta\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label className=\"text-base font-semibold\">\n                    CV File Management\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Upload a PDF or paste a link for your CV Download button\n                  </p>\n                  {settings.cvFileUrl && (\n                    <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-muted/50\">\n                      <div className=\"flex items-center gap-2 min-w-0\">\n                        <FileText className=\"w-4 h-4 flex-shrink-0 text-primary\" />\n                        <span\n                          className=\"text-sm font-medium truncate\"\n                          data-testid=\"text-cv-file-name\"\n                        >\n                          {settings.cvFileUrl.startsWith(\"data:\")\n                            ? \"CV.pdf\"\n                            : settings.cvFileUrl.split(\"/\").pop() || \"CV file\"}\n                        </span>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => updateSettings({ cvFileUrl: \"\" })}\n                        data-testid=\"button-remove-cv\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  )}\n                  {!settings.cvFileUrl && (\n                    <div className=\"border-2 border-dashed rounded-lg p-4 text-center hover:bg-muted/50 transition-colors\">\n                      <FileText className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                      <p className=\"text-sm text-muted-foreground mb-3\">\n                        No CV uploaded\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mb-2\">\n                        Upload from device or paste a PDF link\n                      </p>\n                    </div>\n                  )}\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => cvFileInputRef.current?.click()}\n                      disabled={cvFileUploading}\n                      data-testid=\"button-upload-cv\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />{\" \"}\n                      {cvFileUploading ? \"Uploading...\" : \"Upload PDF\"}\n                    </Button>\n                    <input\n                      ref={cvFileInputRef}\n                      type=\"file\"\n                      accept=\".pdf,application/pdf\"\n                      onChange={handleCVFileUpload}\n                      className=\"hidden\"\n                      data-testid=\"input-cv-file-upload\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or Paste PDF URL</Label>\n                    <Input\n                      value={settings.cvFileUrl}\n                      onChange={(e) =>\n                        updateSettings({ cvFileUrl: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/CV.pdf or /uploads/CV.pdf\"\n                      data-testid=\"input-cv-file-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Paste a direct link to your CV PDF file\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>About Me Section</CardTitle>\n                <CardDescription>\n                  Complete information about yourself with professional\n                  formatting.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.aboutTitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., About Me\"\n                    data-testid=\"input-about-title\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Profile Image</Label>\n                  <div className=\"flex flex-col gap-3\">\n                    {settings.aboutImage && (\n                      <div className=\"relative w-full max-w-xs\">\n                        <img\n                          src={settings.aboutImage}\n                          alt=\"Profile preview\"\n                          className=\"w-full h-64 object-cover rounded-lg border border-border\"\n                        />\n                        <Button\n                          size=\"icon\"\n                          variant=\"destructive\"\n                          className=\"absolute top-2 right-2\"\n                          onClick={() => updateSettings({ aboutImage: \"\" })}\n                          data-testid=\"button-remove-profile-image\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    )}\n                    {!settings.aboutImage && (\n                      <div className=\"border-2 border-dashed rounded-lg p-8 text-center hover:bg-muted/50 transition-colors\">\n                        <ImageIcon className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                        <p className=\"text-sm text-muted-foreground mb-3\">\n                          No image selected\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => profileImageInputRef.current?.click()}\n                      disabled={profileImageUploading}\n                      data-testid=\"button-upload-profile-image\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />\n                      Upload Image\n                    </Button>\n                    <input\n                      ref={profileImageInputRef}\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      onChange={handleProfileImageUpload}\n                      data-testid=\"input-profile-image-file\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or paste image URL</Label>\n                    <Input\n                      value={settings.aboutImage}\n                      onChange={(e) =>\n                        updateSettings({ aboutImage: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/image.jpg or /uploads/profile.jpg\"\n                      data-testid=\"input-about-image-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Supports any image format (JPG, PNG, GIF, WebP, etc.)\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Your Name</Label>\n                  <Input\n                    value={settings.aboutName}\n                    onChange={(e) =>\n                      updateSettings({ aboutName: e.target.value })\n                    }\n                    placeholder=\"e.g., Nguyen Thanh Loi\"\n                    data-testid=\"input-about-name\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From (Location)</Label>\n                    <Input\n                      value={settings.aboutLocation}\n                      onChange={(e) =>\n                        updateSettings({ aboutLocation: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City\"\n                      data-testid=\"input-about-location\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Freelance Status</Label>\n                    <Input\n                      value={settings.aboutFreelance}\n                      onChange={(e) =>\n                        updateSettings({ aboutFreelance: e.target.value })\n                      }\n                      placeholder=\"e.g., Available\"\n                      data-testid=\"input-about-freelance\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Subtitle</Label>\n                  <Input\n                    value={settings.aboutSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer based in Vietnam\"\n                    data-testid=\"input-about-subtitle\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>First Paragraph (Description)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use the rich text editor to format your content with\n                    headings, lists, links, and more.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription: value })\n                    }\n                    placeholder=\"Write your first paragraph about yourself...\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Second Paragraph (Philosophy/Additional Info)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Add your philosophy or additional information in the second\n                    paragraph.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription2}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription2: value })\n                    }\n                    placeholder=\"Write your philosophy or additional information...\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Contact Section</CardTitle>\n                <CardDescription>\n                  Contact form and information display.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.contactTitle}\n                    onChange={(e) =>\n                      updateSettings({ contactTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Let's Talk\"\n                    data-testid=\"input-contact-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Section Subtitle</Label>\n                  <Textarea\n                    value={settings.contactSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ contactSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Have a project in mind?\"\n                    rows={2}\n                    data-testid=\"input-contact-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Contact Email</Label>\n                  <Input\n                    type=\"email\"\n                    value={settings.contactEmail}\n                    onChange={(e) =>\n                      updateSettings({ contactEmail: e.target.value })\n                    }\n                    placeholder=\"e.g., hello@example.com\"\n                    data-testid=\"input-contact-email\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    This email is used in both About and Contact sections\n                  </p>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Phone Number</Label>\n                    <Input\n                      value={settings.contactPhone}\n                      onChange={(e) =>\n                        updateSettings({ contactPhone: e.target.value })\n                      }\n                      placeholder=\"e.g., +84 123 456 789\"\n                      data-testid=\"input-contact-phone\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Address</Label>\n                    <Input\n                      value={settings.contactAddress}\n                      onChange={(e) =>\n                        updateSettings({ contactAddress: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City, Vietnam\"\n                      data-testid=\"input-contact-address\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Social Media Links (Follow Me)</CardTitle>\n                <CardDescription>\n                  Add your social media profiles.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"space-y-2\">\n                  <Label>Facebook URL</Label>\n                  <Input\n                    value={settings.socialFacebook}\n                    onChange={(e) =>\n                      updateSettings({ socialFacebook: e.target.value })\n                    }\n                    placeholder=\"https://facebook.com/username\"\n                    data-testid=\"input-social-facebook\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter/X URL</Label>\n                  <Input\n                    value={settings.socialTwitter}\n                    onChange={(e) =>\n                      updateSettings({ socialTwitter: e.target.value })\n                    }\n                    placeholder=\"https://twitter.com/username\"\n                    data-testid=\"input-social-twitter\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Instagram URL</Label>\n                  <Input\n                    value={settings.socialInstagram}\n                    onChange={(e) =>\n                      updateSettings({ socialInstagram: e.target.value })\n                    }\n                    placeholder=\"https://instagram.com/username\"\n                    data-testid=\"input-social-instagram\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>LinkedIn URL</Label>\n                  <Input\n                    value={settings.socialLinkedin}\n                    onChange={(e) =>\n                      updateSettings({ socialLinkedin: e.target.value })\n                    }\n                    placeholder=\"https://linkedin.com/in/username\"\n                    data-testid=\"input-social-linkedin\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>GitHub URL</Label>\n                  <Input\n                    value={settings.socialGithub}\n                    onChange={(e) =>\n                      updateSettings({ socialGithub: e.target.value })\n                    }\n                    placeholder=\"https://github.com/username\"\n                    data-testid=\"input-social-github\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>YouTube URL</Label>\n                  <Input\n                    value={settings.socialYoutube}\n                    onChange={(e) =>\n                      updateSettings({ socialYoutube: e.target.value })\n                    }\n                    placeholder=\"https://youtube.com/@username\"\n                    data-testid=\"input-social-youtube\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Footer</CardTitle>\n                <CardDescription>\n                  Footer content and copyright information.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Footer Text</Label>\n                  <Input\n                    value={settings.footerText}\n                    onChange={(e) =>\n                      updateSettings({ footerText: e.target.value })\n                    }\n                    placeholder=\"e.g., Crafted with love & countless cups of coffee\"\n                    data-testid=\"input-footer-text\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Copyright Notice</Label>\n                  <Input\n                    value={settings.footerCopyright}\n                    onChange={(e) =>\n                      updateSettings({ footerCopyright: e.target.value })\n                    }\n                    placeholder=\"e.g., 2024 Loi Developer. All rights reserved.\"\n                    data-testid=\"input-footer-copyright\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Maintenance Mode</CardTitle>\n                <CardDescription>\n                  Temporarily disable access to the public site.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex items-center justify-between\">\n                <div className=\"space-y-0.5\">\n                  <Label>Enable Maintenance Mode</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Visitors will see a \"Coming Soon\" page.\n                  </p>\n                </div>\n                <Switch\n                  checked={settings.maintenanceMode}\n                  onCheckedChange={(checked) =>\n                    updateSettings({ maintenanceMode: checked })\n                  }\n                  data-testid=\"toggle-maintenance-mode\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* BRANDING TAB */}\n          <TabsContent value=\"branding\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Logo & Favicon</CardTitle>\n                <CardDescription>\n                  Upload your site logo and favicon from the uploads folder.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"logo-upload\">Site Logo</Label>\n                  <div\n                    className=\"border-2 border-dashed rounded-lg p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-accent/50 transition\"\n                    onClick={() => {\n                      const input = document.getElementById(\"logo-upload\") as HTMLInputElement;\n                      input?.click();\n                    }}\n                  >\n                    <input\n                      id=\"logo-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"logoUrl\");\n                        }\n                      }}\n                      data-testid=\"input-logo-upload\"\n                    />\n                    {settings.logoUrl ? (\n                      <div className=\"flex flex-col items-center gap-2\">\n                        <img\n                          src={settings.logoUrl}\n                          alt=\"Logo\"\n                          className=\"h-12 w-auto\"\n                        />\n                        <p className=\"text-xs text-muted-foreground\">\n                          {brandingUploading ? \"Uploading...\" : \"Click to replace\"}\n                        </p>\n                      </div>\n                    ) : (\n                      <>\n                        <Upload className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                        <p className=\"text-sm font-medium\">\n                          Drop image or click to upload\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          PNG, SVG, JPG (Max 2MB)\n                        </p>\n                      </>\n                    )}\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"favicon-upload\">Favicon</Label>\n                  <div className=\"flex gap-2\">\n                    <div className=\"w-16 h-16 rounded-lg border border-border flex items-center justify-center bg-muted overflow-hidden\">\n                      {settings.faviconUrl ? (\n                        <img\n                          src={settings.faviconUrl}\n                          alt=\"Favicon\"\n                          className=\"w-full h-full object-cover\"\n                        />\n                      ) : (\n                        <span className=\"text-2xl\">âœ¨</span>\n                      )}\n                    </div>\n                    <input\n                      id=\"favicon-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"faviconUrl\");\n                        }\n                      }}\n                      data-testid=\"input-favicon-upload\"\n                    />\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      disabled={brandingUploading}\n                      onClick={() => {\n                        const input = document.getElementById(\"favicon-upload\") as HTMLInputElement;\n                        input?.click();\n                      }}\n                    >\n                      {brandingUploading\n                        ? \"Uploading...\"\n                        : settings.faviconUrl\n                          ? \"Change Favicon\"\n                          : \"Upload Favicon\"}\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SEO TAB */}\n          <TabsContent value=\"seo\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>SEO Configuration</CardTitle>\n                <CardDescription>\n                  Optimize your site for search engines.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Meta Description (Default)</Label>\n                  <Input\n                    placeholder=\"Describe your website...\"\n                    value={settings.metaDescription || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaDescription: e.target.value })\n                    }\n                    data-testid=\"input-meta-description\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Keywords</Label>\n                  <Input\n                    placeholder=\"web development, full-stack, react, node.js\"\n                    value={settings.metaKeywords || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaKeywords: e.target.value })\n                    }\n                    data-testid=\"input-meta-keywords\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Google Analytics ID</Label>\n                  <Input\n                    placeholder=\"G-XXXXXXXXXX or UA-XXXXXXXXX-X\"\n                    value={settings.googleAnalyticsId || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ googleAnalyticsId: e.target.value })\n                    }\n                    data-testid=\"input-google-analytics\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Open Graph & Twitter Cards</CardTitle>\n                <CardDescription>\n                  Control how your site appears on social media.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Open Graph Image URL</Label>\n                  <Input\n                    placeholder=\"https://example.com/og-image.png\"\n                    value={settings.ogImageUrl || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ ogImageUrl: e.target.value })\n                    }\n                    data-testid=\"input-og-image\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter Card Type</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.twitterCardType || \"summary_large_image\"}\n                    onChange={(e) =>\n                      updateSettings({ twitterCardType: e.target.value })\n                    }\n                    data-testid=\"select-twitter-card\"\n                  >\n                    <option value=\"summary_large_image\">\n                      summary_large_image\n                    </option>\n                    <option value=\"summary\">summary</option>\n                    <option value=\"app\">app</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Robots.txt & Sitemap</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-edit-robots\"\n                >\n                  Edit robots.txt\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-regenerate-sitemap\"\n                >\n                  Regenerate Sitemap\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* EMAIL TAB */}\n          <TabsContent value=\"email\" className=\"space-y-4\">\n            <Card className=\"border-amber-500/20 bg-amber-500/5\">\n              <CardContent className=\"flex items-center gap-3 py-3\">\n                <AlertCircle className=\"w-5 h-5 text-amber-500\" />\n                <div>\n                  <p className=\"text-sm font-medium\">Configuration Required</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    SMTP settings are saved but email sending requires a mail\n                    server integration.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> SMTP Configuration\n                </CardTitle>\n                <CardDescription>\n                  Configure email settings for notifications and newsletters.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From Name</Label>\n                    <Input\n                      placeholder=\"Loi Developer\"\n                      value={settings.emailFromName || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromName: e.target.value })\n                      }\n                      data-testid=\"input-email-from-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>From Email Address</Label>\n                    <Input\n                      placeholder=\"noreply@example.com\"\n                      value={settings.emailFromAddress || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromAddress: e.target.value })\n                      }\n                      data-testid=\"input-email-from-address\"\n                    />\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-2\">\n                  <Label>SMTP Host</Label>\n                  <Input\n                    placeholder=\"smtp.gmail.com\"\n                    value={settings.smtpHost || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ smtpHost: e.target.value })\n                    }\n                    data-testid=\"input-smtp-host\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>SMTP Port</Label>\n                    <Input\n                      placeholder=\"587\"\n                      value={settings.smtpPort || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPort: e.target.value })\n                      }\n                      data-testid=\"input-smtp-port\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>SMTP User</Label>\n                    <Input\n                      placeholder=\"your-email@gmail.com\"\n                      value={settings.smtpUser || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpUser: e.target.value })\n                      }\n                      data-testid=\"input-smtp-user\"\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>SMTP Password</Label>\n                  <div className=\"flex gap-2\">\n                    <Input\n                      type={showSmtpPassword ? \"text\" : \"password\"}\n                      placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                      value={settings.smtpPassword || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPassword: e.target.value })\n                      }\n                      data-testid=\"input-smtp-password\"\n                    />\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      onClick={() => setShowSmtpPassword(!showSmtpPassword)}\n                      data-testid=\"button-toggle-smtp-password\"\n                    >\n                      {showSmtpPassword ? (\n                        <EyeOff className=\"w-4 h-4\" />\n                      ) : (\n                        <Eye className=\"w-4 h-4\" />\n                      )}\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Use TLS/SSL</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Encrypt email transmission\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.smtpSecure ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ smtpSecure: checked })\n                    }\n                    data-testid=\"switch-smtp-secure\"\n                  />\n                </div>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  data-testid=\"button-test-email\"\n                  onClick={async () => {\n                    try {\n                      const testEmail = prompt(\"Enter email address to send test email to:\");\n                      if (!testEmail) return;\n                      \n                      await api.sendTestEmail({\n                        to: testEmail,\n                        subject: \"Test Email from Portfolio\",\n                        body: \"<h1>Test Email</h1><p>This is a test email from your portfolio admin panel.</p>\"\n                      });\n                      \n                      toast({\n                        title: \"Success\",\n                        description: \"Test email sent successfully\"\n                      });\n                    } catch (error: any) {\n                      toast({\n                        title: \"Error\",\n                        description: error.message || \"Failed to send test email\",\n                        variant: \"destructive\"\n                      });\n                    }\n                  }}\n                >\n                  <Mail className=\"w-4 h-4 mr-2\" /> Send Test Email\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Email Templates</CardTitle>\n                <CardDescription>\n                  Customize email templates for different notifications. Use placeholders like {\"{{siteName}}\"}, {\"{{userName}}\"}, {\"{{date}}\"} etc.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                {templatesLoading ? (\n                  <div className=\"text-center py-4 text-muted-foreground\">Loading templates...</div>\n                ) : (\n                  Object.entries(templateLabels).map(([key, label]) => (\n                    <Button\n                      key={key}\n                      variant=\"outline\"\n                      className=\"w-full justify-start\"\n                      onClick={() => openTemplateEditor(key)}\n                      data-testid={`button-edit-${key}-email`}\n                    >\n                      <FileText className=\"w-4 h-4 mr-2\" />\n                      {label}\n                      {emailTemplates[key] && (\n                        <Badge variant=\"secondary\" className=\"ml-auto\">Configured</Badge>\n                      )}\n                    </Button>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Email Template Editor Dialog */}\n            <Dialog open={!!editingTemplate} onOpenChange={(open) => !open && setEditingTemplate(null)}>\n              <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>Edit {editingTemplate && templateLabels[editingTemplate]}</DialogTitle>\n                  <DialogDescription>\n                    Customize the email template. Use placeholders that will be replaced with actual values.\n                  </DialogDescription>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Subject</Label>\n                    <Input\n                      value={templateSubject}\n                      onChange={(e) => setTemplateSubject(e.target.value)}\n                      placeholder=\"Email subject...\"\n                      data-testid=\"input-template-subject\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Body (HTML)</Label>\n                    <Textarea\n                      value={templateBody}\n                      onChange={(e) => setTemplateBody(e.target.value)}\n                      placeholder=\"<h1>Hello {{userName}}</h1>...\"\n                      className=\"min-h-[300px] font-mono text-sm\"\n                      data-testid=\"input-template-body\"\n                    />\n                  </div>\n                  <div className=\"bg-muted p-3 rounded-lg\">\n                    <p className=\"text-sm font-medium mb-2\">Available Placeholders:</p>\n                    <div className=\"flex flex-wrap gap-2 text-xs\">\n                      <Badge variant=\"outline\">{\"{{siteName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{userName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{date}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderEmail}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{messageContent}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{postTitle}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{commentContent}}\"}</Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2 justify-end\">\n                    <Button variant=\"outline\" onClick={() => setEditingTemplate(null)}>\n                      Cancel\n                    </Button>\n                    <Button onClick={saveTemplate} disabled={updateTemplateMutation.isPending}>\n                      {updateTemplateMutation.isPending ? \"Saving...\" : \"Save Template\"}\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          </TabsContent>\n\n          {/* STORAGE TAB */}\n          <TabsContent value=\"storage\" className=\"space-y-4\">\n            <StorageTab />\n          </TabsContent>\n\n          {/* PERFORMANCE TAB */}\n          <TabsContent value=\"performance\" className=\"space-y-4\">\n            <SettingsPerformance />\n          </TabsContent>\n\n          {/* NOTIFICATIONS & ALERTS TAB */}\n          <TabsContent value=\"notifications\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Notification preferences are saved. Email notifications require SMTP configuration in the Email tab.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bell className=\"w-5 h-5\" /> Notification Preferences\n                </CardTitle>\n                <CardDescription>\n                  Configure how and when you receive notifications\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Email Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          New contact form submissions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Receive email when someone contacts you\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewContact ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewContact: checked })\n                        }\n                        data-testid=\"switch-notify-contact\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">New comments</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Get notified when comments are posted\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewComment ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewComment: checked })\n                        }\n                        data-testid=\"switch-notify-comment\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Security alerts</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Important security-related notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifySecurityAlert ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifySecurityAlert: checked })\n                        }\n                        data-testid=\"switch-notify-security\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Newsletter subscriptions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          When new users subscribe\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewsletter ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewsletter: checked })\n                        }\n                        data-testid=\"switch-notify-newsletter\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Weekly analytics summary\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Weekly report of site performance\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyWeeklySummary ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyWeeklySummary: checked })\n                        }\n                        data-testid=\"switch-notify-weekly\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Push Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Browser notifications\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Show desktop notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyBrowser ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyBrowser: checked })\n                        }\n                        data-testid=\"switch-push-browser\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Mobile push</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Send to mobile devices\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyMobile ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyMobile: checked })\n                        }\n                        data-testid=\"switch-push-mobile\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Channel Priority & Routing</CardTitle>\n                <CardDescription>\n                  Configure notification delivery channels and priority\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  {[\n                    {\n                      channel: \"Email\",\n                      priority: 1,\n                      enabled: true,\n                      desc: \"Primary notification channel\",\n                    },\n                    {\n                      channel: \"Browser Push\",\n                      priority: 2,\n                      enabled: false,\n                      desc: \"Desktop notifications\",\n                    },\n                    {\n                      channel: \"SMS\",\n                      priority: 3,\n                      enabled: false,\n                      desc: \"Text messages for critical alerts\",\n                    },\n                    {\n                      channel: \"Slack\",\n                      priority: 4,\n                      enabled: true,\n                      desc: \"Team notifications\",\n                    },\n                    {\n                      channel: \"Discord\",\n                      priority: 5,\n                      enabled: true,\n                      desc: \"Community updates\",\n                    },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-xs font-bold\">\n                          {item.priority}\n                        </div>\n                        <div>\n                          <p className=\"font-medium text-sm\">{item.channel}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {item.desc}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†‘\n                        </Button>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†“\n                        </Button>\n                        <Switch defaultChecked={item.enabled} />\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-muted/50\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Fallback Routing</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Try next channel if delivery fails\n                    </p>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Alert Thresholds</CardTitle>\n                <CardDescription>\n                  Set triggers for automatic alerts\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Storage Usage Alert (%)</Label>\n                    <Input type=\"number\" defaultValue=\"80\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Failed Login Attempts</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Error Rate Threshold (%)</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Response Time (ms)</Label>\n                    <Input type=\"number\" defaultValue=\"3000\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification History</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {[\n                  {\n                    message: \"Storage usage reached 75%\",\n                    time: \"2 hours ago\",\n                    type: \"warning\",\n                  },\n                  {\n                    message: \"Weekly backup completed successfully\",\n                    time: \"Yesterday\",\n                    type: \"success\",\n                  },\n                  {\n                    message: \"3 failed login attempts detected\",\n                    time: \"2 days ago\",\n                    type: \"error\",\n                  },\n                ].map((notif, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center gap-3 p-3 border rounded-lg\"\n                  >\n                    {notif.type === \"warning\" && (\n                      <AlertCircle className=\"w-5 h-5 text-yellow-500\" />\n                    )}\n                    {notif.type === \"success\" && (\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                    )}\n                    {notif.type === \"error\" && (\n                      <AlertCircle className=\"w-5 h-5 text-red-500\" />\n                    )}\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm\">{notif.message}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {notif.time}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DEVELOPER SETTINGS TAB */}\n          <TabsContent value=\"developer\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Developer settings are saved to database. Actual logic application requires backend implementation.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bug className=\"w-5 h-5\" /> Debug Mode\n                </CardTitle>\n                <CardDescription>\n                  Enable debugging features for development\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-yellow-500/5 border-yellow-500/20\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable Debug Mode</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Shows detailed error messages and stack traces\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.debugMode ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ debugMode: checked })\n                    }\n                    data-testid=\"switch-debug-mode\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to Console</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Output logs to browser/server console\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToConsole ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToConsole: checked })\n                    }\n                    data-testid=\"switch-log-console\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to File</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Save logs to file system\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToFile ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToFile: checked })\n                    }\n                    data-testid=\"switch-log-file\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Gauge className=\"w-5 h-5\" /> API Rate Limits\n                </CardTitle>\n                <CardDescription>\n                  Configure rate limiting for API endpoints\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Requests per minute (global)</Label>\n                  <Input\n                    type=\"number\"\n                    value={settings.apiRateLimit ?? 100}\n                    onChange={(e) =>\n                      updateSettings({\n                        apiRateLimit: parseInt(e.target.value) || 100,\n                      })\n                    }\n                    data-testid=\"input-api-rate-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Maximum API requests per minute across all endpoints\n                  </p>\n                </div>\n                <div className=\"space-y-3\">\n                  <h4 className=\"font-medium text-sm\">\n                    Endpoint-specific limits (read-only)\n                  </h4>\n                  {[\n                    { endpoint: \"/api/contact\", limit: 5, window: \"1 hour\" },\n                    {\n                      endpoint: \"/api/auth/login\",\n                      limit: 10,\n                      window: \"15 mins\",\n                    },\n                    { endpoint: \"/api/upload\", limit: 20, window: \"1 hour\" },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-2 border rounded text-sm\"\n                    >\n                      <code className=\"text-xs bg-muted px-2 py-1 rounded\">\n                        {item.endpoint}\n                      </code>\n                      <span>\n                        {item.limit} requests / {item.window}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Terminal className=\"w-5 h-5\" /> Advanced Options\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable CORS</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Allow cross-origin requests\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.corsEnabled ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ corsEnabled: checked })\n                    }\n                    data-testid=\"switch-cors-enabled\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Allowed Origins (CORS)</Label>\n                  <Input\n                    placeholder=\"* (all origins) or https://example.com, https://app.example.com\"\n                    value={settings.corsOrigins || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ corsOrigins: e.target.value })\n                    }\n                    data-testid=\"input-cors-origins\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Use * to allow all origins, or specify comma-separated\n                    domains\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Custom Headers</Label>\n                  <Textarea\n                    placeholder=\"X-Custom-Header: value&#10;X-Another-Header: value\"\n                    className=\"font-mono text-sm\"\n                    rows={3}\n                    value={settings.customHeaders || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ customHeaders: e.target.value })\n                    }\n                    data-testid=\"input-custom-headers\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Add custom HTTP headers to all responses\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* LOCALIZATION TAB (Enhanced) */}\n          <TabsContent value=\"localization\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"w-5 h-5\" /> Regional Settings\n                </CardTitle>\n                <CardDescription>\n                  Configure timezone and language preferences\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Timezone</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timezone || \"Asia/Ho_Chi_Minh\"}\n                    onChange={(e) =>\n                      updateSettings({ timezone: e.target.value })\n                    }\n                    data-testid=\"select-timezone\"\n                  >\n                    <option value=\"Asia/Ho_Chi_Minh\">\n                      UTC+07:00 (Vietnam)\n                    </option>\n                    <option value=\"Asia/Shanghai\">UTC+08:00 (Shanghai)</option>\n                    <option value=\"Asia/Tokyo\">UTC+09:00 (Tokyo)</option>\n                    <option value=\"Europe/London\">UTC+00:00 (London)</option>\n                    <option value=\"America/New_York\">\n                      UTC-05:00 (New York)\n                    </option>\n                    <option value=\"America/Los_Angeles\">\n                      UTC-08:00 (Los Angeles)\n                    </option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Language</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.language || \"en\"}\n                    onChange={(e) =>\n                      updateSettings({ language: e.target.value })\n                    }\n                    data-testid=\"select-language\"\n                  >\n                    <option value=\"en\">English</option>\n                    <option value=\"vi\">Tiáº¿ng Viá»‡t</option>\n                    <option value=\"zh\">ä¸­æ–‡</option>\n                    <option value=\"ja\">æ—¥æœ¬èªž</option>\n                    <option value=\"ko\">í•œêµ­ì–´</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Date Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.dateFormat || \"MM/DD/YYYY\"}\n                    onChange={(e) =>\n                      updateSettings({ dateFormat: e.target.value })\n                    }\n                    data-testid=\"select-date-format\"\n                  >\n                    <option value=\"MM/DD/YYYY\">MM/DD/YYYY</option>\n                    <option value=\"DD/MM/YYYY\">DD/MM/YYYY</option>\n                    <option value=\"YYYY-MM-DD\">YYYY-MM-DD</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Time Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timeFormat || \"12h\"}\n                    onChange={(e) =>\n                      updateSettings({ timeFormat: e.target.value })\n                    }\n                    data-testid=\"select-time-format\"\n                  >\n                    <option value=\"12h\">12 Hour (AM/PM)</option>\n                    <option value=\"24h\">24 Hour</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Languages className=\"w-5 h-5\" /> Custom Translations\n                </CardTitle>\n                <CardDescription>\n                  Manage custom translation strings for multi-language support\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2 flex-wrap\">\n                  <Button variant=\"outline\" size=\"sm\">\n                    Import Translations\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\">\n                    Export Translations\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-3 gap-2 p-2 bg-muted rounded text-sm font-medium\">\n                    <span>Key</span>\n                    <span>English</span>\n                    <span>Vietnamese</span>\n                  </div>\n                  <div className=\"max-h-[400px] overflow-y-auto space-y-1\">\n                    {[\n                      { key: \"site.title\", en: \"Loi Developer\", vi: \"Loi Developer\" },\n                      { key: \"site.tagline\", en: \"Full-stack Developer\", vi: \"Láº­p trÃ¬nh viÃªn Full-stack\" },\n                      { key: \"nav.home\", en: \"Home\", vi: \"Trang chá»§\" },\n                      { key: \"nav.about\", en: \"About\", vi: \"Giá»›i thiá»‡u\" },\n                      { key: \"nav.projects\", en: \"Projects\", vi: \"Dá»± Ã¡n\" },\n                      { key: \"nav.blog\", en: \"Blog\", vi: \"BÃ i viáº¿t\" },\n                      { key: \"nav.services\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"nav.contact\", en: \"Contact\", vi: \"LiÃªn há»‡\" },\n                      { key: \"hero.greeting\", en: \"Hello, I'm\", vi: \"Xin chÃ o, tÃ´i lÃ \" },\n                      { key: \"hero.cta\", en: \"View My Work\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"hero.download_cv\", en: \"Download CV\", vi: \"Táº£i CV\" },\n                      { key: \"about.title\", en: \"About Me\", vi: \"Vá» tÃ´i\" },\n                      { key: \"about.experience\", en: \"Years of Experience\", vi: \"NÄƒm kinh nghiá»‡m\" },\n                      { key: \"about.projects\", en: \"Projects Completed\", vi: \"Dá»± Ã¡n hoÃ n thÃ nh\" },\n                      { key: \"projects.title\", en: \"My Projects\", vi: \"Dá»± Ã¡n cá»§a tÃ´i\" },\n                      { key: \"projects.view\", en: \"View Project\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"projects.all\", en: \"All Projects\", vi: \"Táº¥t cáº£\" },\n                      { key: \"blog.title\", en: \"Latest Posts\", vi: \"BÃ i viáº¿t má»›i\" },\n                      { key: \"blog.read_more\", en: \"Read More\", vi: \"Äá»c thÃªm\" },\n                      { key: \"services.title\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"services.learn_more\", en: \"Learn More\", vi: \"TÃ¬m hiá»ƒu thÃªm\" },\n                      { key: \"contact.title\", en: \"Get In Touch\", vi: \"LiÃªn há»‡\" },\n                      { key: \"contact.name\", en: \"Your Name\", vi: \"Há» tÃªn\" },\n                      { key: \"contact.email\", en: \"Your Email\", vi: \"Email\" },\n                      { key: \"contact.message\", en: \"Your Message\", vi: \"Ná»™i dung\" },\n                      { key: \"contact.send\", en: \"Send Message\", vi: \"Gá»­i tin nháº¯n\" },\n                      { key: \"contact.success\", en: \"Message sent successfully!\", vi: \"Gá»­i thÃ nh cÃ´ng!\" },\n                      { key: \"footer.copyright\", en: \"All rights reserved\", vi: \"Báº£n quyá»n thuá»™c vá»\" },\n                      { key: \"common.loading\", en: \"Loading...\", vi: \"Äang táº£i...\" },\n                      { key: \"common.error\", en: \"Something went wrong\", vi: \"ÄÃ£ xáº£y ra lá»—i\" },\n                      { key: \"common.save\", en: \"Save\", vi: \"LÆ°u\" },\n                      { key: \"common.cancel\", en: \"Cancel\", vi: \"Há»§y\" },\n                      { key: \"common.delete\", en: \"Delete\", vi: \"XÃ³a\" },\n                      { key: \"common.edit\", en: \"Edit\", vi: \"Sá»­a\" },\n                    ].map((item, i) => (\n                      <div\n                        key={i}\n                        className=\"grid grid-cols-3 gap-2 p-2 border rounded text-sm\"\n                      >\n                        <code className=\"text-xs bg-muted px-2 py-1 rounded truncate\">\n                          {item.key}\n                        </code>\n                        <Input defaultValue={item.en} className=\"h-8\" />\n                        <Input defaultValue={item.vi} className=\"h-8\" />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 justify-end\">\n                  <Button variant=\"outline\">\n                    + Add Translation Key\n                  </Button>\n                  <Button>\n                    Save Translations\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DATABASE MANAGEMENT TAB */}\n          <TabsContent value=\"database\" className=\"space-y-4\">\n            <DatabaseTab />\n          </TabsContent>\n\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":82676,"size_tokens":null},"server/api/testimonials.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertTestimonialSchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const testimonials = req.query.active === \"true\"\n      ? await storage.getActiveTestimonials()\n      : await storage.getAllTestimonials();\n    res.json(testimonials);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const testimonial = await storage.getTestimonial(parseInt(req.params.id));\n    if (!testimonial) {\n      return res.status(404).json({ message: \"Testimonial not found\" });\n    }\n    res.json(testimonial);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertTestimonialSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const testimonial = await storage.createTestimonial(parsed.data);\n    res.status(201).json(testimonial);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const testimonial = await storage.updateTestimonial(parseInt(req.params.id), req.body);\n    if (!testimonial) {\n      return res.status(404).json({ message: \"Testimonial not found\" });\n    }\n    res.json(testimonial);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteTestimonial(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Testimonial not found\" });\n    }\n    res.json({ message: \"Testimonial deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2080,"size_tokens":null},"client/src/pages/admin/settings/SEO.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Search, Globe, FileText, Image, CheckCircle, AlertCircle } from \"lucide-react\";\n\nexport default function AdminSEO() {\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">SEO Optimization</h1>\n            <p className=\"text-muted-foreground\">Improve search engine visibility</p>\n          </div>\n          <Button className=\"bg-primary\">Save SEO Settings</Button>\n        </div>\n\n        {/* SEO Score */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          {[\n            { label: \"SEO Score\", value: \"85/100\", status: \"good\", icon: CheckCircle },\n            { label: \"Meta Tags\", value: \"12/15\", status: \"warning\", icon: AlertCircle },\n            { label: \"Image Alt\", value: \"Complete\", status: \"good\", icon: Image },\n            { label: \"Sitemap\", value: \"Updated\", status: \"good\", icon: FileText },\n          ].map((metric, i) => (\n            <Card key={i}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3\">\n                  <metric.icon className={`w-5 h-5 ${metric.status === 'good' ? 'text-green-500' : 'text-yellow-500'}`} />\n                  <div>\n                    <p className=\"text-xs text-muted-foreground\">{metric.label}</p>\n                    <p className=\"font-bold\">{metric.value}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        <Tabs defaultValue=\"meta\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"meta\">Meta Tags</TabsTrigger>\n            <TabsTrigger value=\"schema\">Schema Markup</TabsTrigger>\n            <TabsTrigger value=\"sitemap\">Sitemap</TabsTrigger>\n            <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"meta\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Global Meta Tags</CardTitle>\n                <CardDescription>Default meta information for all pages</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Meta Title</label>\n                  <Input defaultValue=\"Loi Developer - Full-stack Developer Portfolio\" />\n                  <p className=\"text-xs text-muted-foreground mt-1\">60 characters recommended</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Meta Description</label>\n                  <Textarea \n                    defaultValue=\"Professional full-stack developer specializing in React, Node.js, and modern web technologies\"\n                    className=\"min-h-[80px]\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">160 characters recommended</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Keywords</label>\n                  <Input defaultValue=\"web developer, full-stack, react, node.js, portfolio\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Canonical URL</label>\n                  <Input defaultValue=\"https://loideveloper.com\" />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Open Graph / Social Media</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">OG Image</label>\n                  <Input defaultValue=\"https://loideveloper.com/og-image.jpg\" />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block\">Twitter Handle</label>\n                    <Input placeholder=\"@username\" />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block\">Card Type</label>\n                    <select className=\"w-full p-2 border rounded-md bg-background\">\n                      <option>summary_large_image</option>\n                      <option>summary</option>\n                    </select>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"schema\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Schema.org Structured Data</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <Textarea \n                  className=\"font-mono text-xs min-h-[300px]\"\n                  defaultValue={`{\n  \"@context\": \"https://schema.org\",\n  \"@type\": \"Person\",\n  \"name\": \"Loi Developer\",\n  \"jobTitle\": \"Full-stack Developer\",\n  \"url\": \"https://loideveloper.com\"\n}`}\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"sitemap\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>XML Sitemap</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input defaultValue=\"https://loideveloper.com/sitemap.xml\" readOnly className=\"bg-muted\" />\n                  <Button>Regenerate</Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <p className=\"text-sm font-medium\">Included URLs:</p>\n                  <div className=\"space-y-1 text-sm text-muted-foreground\">\n                    <div className=\"flex justify-between\">\n                      <span>Homepage</span>\n                      <Badge variant=\"secondary\">Priority: 1.0</Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Projects (15 pages)</span>\n                      <Badge variant=\"secondary\">Priority: 0.8</Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Blog Posts (28 pages)</span>\n                      <Badge variant=\"secondary\">Priority: 0.7</Badge>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"analytics\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Tracking & Analytics</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Google Analytics ID</label>\n                  <Input placeholder=\"G-XXXXXXXXXX\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Google Search Console</label>\n                  <Input placeholder=\"Verification code\" />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Facebook Pixel</label>\n                  <Input placeholder=\"Pixel ID\" />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":8061,"size_tokens":null},"server/api/users.ts":{"content":"import { Router } from \"express\";\n\nconst router = Router();\n\n// Users API has been removed\nexport default router;","path":null,"size_bytes":113,"size_tokens":null},"client/src/pages/admin/content/projects/Projects.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { Plus, Edit, Trash2, Eye, Star, ExternalLink, Github, Image as ImageIcon, X, Loader2 } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ProjectEditor } from \"@/components/admin/project-editor\";\n\ninterface Project {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  shortDescription: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: string;\n  views: number;\n  featured: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\nconst emptyProject = {\n  title: \"\",\n  category: \"full-stack\",\n  image: \"\",\n  shortDescription: \"\",\n  description: \"\",\n  tech: [] as string[],\n  link: \"\",\n  github: \"\",\n  status: \"Draft\",\n  featured: false,\n};\n\nconst defaultCategory = \"full-stack\";\n\nexport default function AdminProjectsEnhanced() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProject, setEditingProject] = useState<Project | null>(null);\n  const [formData, setFormData] = useState(emptyProject);\n  const [techInput, setTechInput] = useState(\"\");\n  const [filter, setFilter] = useState(\"all\");\n  const [uploadingImage, setUploadingImage] = useState(false);\n\n  const { data: projects = [], isLoading } = useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: () => api.getProjects(),\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => api.createProject(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<typeof formData> }) => \n      api.updateProject(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      setIsDialogOpen(false);\n      resetForm();\n      toast({ title: \"Success\", description: \"Project updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => api.deleteProject(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleFeaturedMutation = useMutation({\n    mutationFn: ({ id, featured }: { id: number; featured: boolean }) =>\n      api.updateProject(id, { featured }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: ({ id, status }: { id: number; status: string }) =>\n      api.updateProject(id, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const resetForm = () => {\n    setFormData(emptyProject);\n    setEditingProject(null);\n    setTechInput(\"\");\n  };\n\n  const openCreateDialog = () => {\n    resetForm();\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (project: Project) => {\n    setEditingProject(project);\n    setFormData({\n      title: project.title,\n      category: project.category,\n      image: project.image || \"\",\n      shortDescription: project.shortDescription || \"\",\n      description: project.description || \"\",\n      tech: project.tech || [],\n      link: project.link || \"\",\n      github: project.github || \"\",\n      status: project.status,\n      featured: project.featured,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Error\", description: \"Title is required\", variant: \"destructive\" });\n      return;\n    }\n\n    if (editingProject) {\n      updateMutation.mutate({ id: editingProject.id, data: formData });\n    } else {\n      createMutation.mutate(formData);\n    }\n  };\n\n  const addTech = () => {\n    if (techInput.trim() && !formData.tech.includes(techInput.trim())) {\n      setFormData({ ...formData, tech: [...formData.tech, techInput.trim()] });\n      setTechInput(\"\");\n    }\n  };\n\n  const removeTech = (tech: string) => {\n    setFormData({ ...formData, tech: formData.tech.filter(t => t !== tech) });\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({ title: \"Error\", description: \"Image size must be less than 5MB\", variant: \"destructive\" });\n      return;\n    }\n\n    setUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const base64 = reader.result as string;\n        try {\n          const result = await api.uploadImage(base64, file.name);\n          setFormData({ ...formData, image: result.url });\n          toast({ title: \"Success\", description: \"Image uploaded successfully\" });\n        } catch (error: any) {\n          toast({ title: \"Error\", description: error.message || \"Failed to upload image\", variant: \"destructive\" });\n        } finally {\n          setUploadingImage(false);\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      setUploadingImage(false);\n      toast({ title: \"Error\", description: \"Failed to read image file\", variant: \"destructive\" });\n    }\n  };\n\n  const filteredProjects = projects.filter((project: Project) => {\n    if (filter === \"all\") return true;\n    if (filter === \"featured\") return project.featured;\n    if (filter === \"published\") return project.status === \"Published\";\n    if (filter === \"draft\") return project.status === \"Draft\";\n    return project.category === filter;\n  });\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"page-title\">Projects</h1>\n            <p className=\"text-muted-foreground\">Manage your portfolio projects</p>\n          </div>\n          <Button onClick={openCreateDialog} data-testid=\"button-create-project\">\n            <Plus className=\"w-4 h-4 mr-2\" /> New Project\n          </Button>\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          {[\"all\", \"featured\", \"published\", \"draft\", ...categories.map(c => c.slug)].map((f) => (\n            <Button\n              key={f}\n              variant={filter === f ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setFilter(f)}\n              data-testid={`filter-${f}`}\n            >\n              {f === \"all\" ? \"All\" : \n               f === \"featured\" ? \"Featured\" :\n               f === \"published\" ? \"Published\" :\n               f === \"draft\" ? \"Draft\" :\n               categories.find(c => c.slug === f)?.name || f}\n            </Button>\n          ))}\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No projects found</p>\n              <Button onClick={openCreateDialog}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create your first project\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project: Project) => (\n              <Card key={project.id} className=\"overflow-hidden group\" data-testid={`card-project-${project.id}`}>\n                <div className=\"aspect-video relative bg-muted overflow-hidden\">\n                  {project.image ? (\n                    <img\n                      src={project.image}\n                      alt={project.title}\n                      className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <ImageIcon className=\"w-12 h-12 text-muted-foreground/50\" />\n                    </div>\n                  )}\n                  <div className=\"absolute top-2 left-2 flex gap-1\">\n                    <Badge variant={project.status === \"Published\" ? \"default\" : \"secondary\"}>\n                      {project.status}\n                    </Badge>\n                    {project.featured && (\n                      <Badge variant=\"default\" className=\"bg-yellow-500\">\n                        <Star className=\"w-3 h-3 mr-1\" /> Featured\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-lg line-clamp-1\">{project.title}</CardTitle>\n                  <CardDescription className=\"line-clamp-2\">\n                    {project.description || \"No description\"}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex flex-wrap gap-1\">\n                    {(project.tech || []).slice(0, 4).map((tech) => (\n                      <Badge key={tech} variant=\"outline\" className=\"text-xs\">\n                        {tech}\n                      </Badge>\n                    ))}\n                    {(project.tech || []).length > 4 && (\n                      <Badge variant=\"outline\" className=\"text-xs\">\n                        +{project.tech.length - 4}\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                    <span className=\"flex items-center gap-1\">\n                      <Eye className=\"w-4 h-4\" /> {project.views}\n                    </span>\n                    <span>{categories.find(c => c.slug === project.category)?.name || project.category}</span>\n                  </div>\n                  <div className=\"flex items-center justify-between pt-2 border-t\">\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={project.featured}\n                        onCheckedChange={(checked) => \n                          toggleFeaturedMutation.mutate({ id: project.id, featured: checked })\n                        }\n                        data-testid={`switch-featured-${project.id}`}\n                      />\n                      <span className=\"text-sm text-muted-foreground\">Featured</span>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      {project.link && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.link} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <ExternalLink className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      {project.github && (\n                        <Button size=\"icon\" variant=\"ghost\" asChild>\n                          <a href={project.github} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <Github className=\"w-4 h-4\" />\n                          </a>\n                        </Button>\n                      )}\n                      <Button \n                        size=\"icon\" \n                        variant=\"ghost\" \n                        onClick={() => openEditDialog(project)}\n                        data-testid={`button-edit-${project.id}`}\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <AlertDialog>\n                        <AlertDialogTrigger asChild>\n                          <Button size=\"icon\" variant=\"ghost\" data-testid={`button-delete-${project.id}`}>\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </AlertDialogTrigger>\n                        <AlertDialogContent>\n                          <AlertDialogHeader>\n                            <AlertDialogTitle>Delete Project</AlertDialogTitle>\n                            <AlertDialogDescription>\n                              Are you sure you want to delete \"{project.title}\"? This action cannot be undone.\n                            </AlertDialogDescription>\n                          </AlertDialogHeader>\n                          <AlertDialogFooter>\n                            <AlertDialogCancel>Cancel</AlertDialogCancel>\n                            <AlertDialogAction\n                              onClick={() => deleteMutation.mutate(project.id)}\n                              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                            >\n                              Delete\n                            </AlertDialogAction>\n                          </AlertDialogFooter>\n                        </AlertDialogContent>\n                      </AlertDialog>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>{editingProject ? \"Edit Project\" : \"Create New Project\"}</DialogTitle>\n            <DialogDescription>\n              {editingProject ? \"Update your project details\" : \"Add a new project to your portfolio\"}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-6 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                value={formData.title}\n                onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                placeholder=\"Project title\"\n                data-testid=\"input-title\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"category\">Category</Label>\n                <Select\n                  value={formData.category}\n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger data-testid=\"select-category\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {categories.length > 0 ? (\n                      categories.map((cat: Category) => (\n                        <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                          {cat.name}\n                        </SelectItem>\n                      ))\n                    ) : (\n                      <SelectItem value=\"default\" disabled>No categories available</SelectItem>\n                    )}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"status\">Status</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value) => setFormData({ ...formData, status: value })}\n                >\n                  <SelectTrigger data-testid=\"select-status\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Draft\">Draft</SelectItem>\n                    <SelectItem value=\"Published\">Published</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"shortDescription\">Short Description</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                A brief summary shown in featured project cards (max 150 characters)\n              </p>\n              <Input\n                id=\"shortDescription\"\n                value={formData.shortDescription}\n                onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}\n                placeholder=\"Brief project summary for featured display...\"\n                maxLength={150}\n                data-testid=\"input-short-description\"\n              />\n              <p className=\"text-xs text-muted-foreground text-right\">\n                {formData.shortDescription.length}/150\n              </p>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Full Description</Label>\n              <p className=\"text-sm text-muted-foreground mb-3\">\n                Add detailed information about your project with rich formatting support\n              </p>\n              <ProjectEditor\n                value={formData.description}\n                onChange={(html) => setFormData({ ...formData, description: html })}\n                placeholder=\"Describe your project with details, features, and technologies...\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Project Image</Label>\n              <div className=\"flex items-center gap-4\">\n                {formData.image ? (\n                  <div className=\"relative w-32 h-20 rounded-lg overflow-hidden bg-muted\">\n                    <img src={formData.image} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n                    <Button\n                      size=\"icon\"\n                      variant=\"destructive\"\n                      className=\"absolute top-1 right-1 h-6 w-6\"\n                      onClick={() => setFormData({ ...formData, image: \"\" })}\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                ) : (\n                  <div className=\"w-32 h-20 rounded-lg bg-muted flex items-center justify-center\">\n                    <ImageIcon className=\"w-8 h-8 text-muted-foreground\" />\n                  </div>\n                )}\n                <div className=\"flex-1\">\n                  <Input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleImageUpload}\n                    disabled={uploadingImage}\n                    data-testid=\"input-image\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Max 5MB. Recommended: 1200x630px</p>\n                </div>\n                {uploadingImage && <Loader2 className=\"w-5 h-5 animate-spin\" />}\n              </div>\n              <div className=\"flex items-center gap-2 mt-2\">\n                <span className=\"text-sm text-muted-foreground\">Or enter URL:</span>\n                <Input\n                  placeholder=\"https://example.com/image.jpg\"\n                  value={formData.image}\n                  onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                  className=\"flex-1\"\n                  data-testid=\"input-image-url\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>Technologies</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  value={techInput}\n                  onChange={(e) => setTechInput(e.target.value)}\n                  placeholder=\"Add technology (e.g., React)\"\n                  onKeyPress={(e) => e.key === \"Enter\" && (e.preventDefault(), addTech())}\n                  data-testid=\"input-tech\"\n                />\n                <Button type=\"button\" onClick={addTech} variant=\"outline\">\n                  Add\n                </Button>\n              </div>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {formData.tech.map((tech) => (\n                  <Badge key={tech} variant=\"secondary\" className=\"gap-1\">\n                    {tech}\n                    <button onClick={() => removeTech(tech)} className=\"ml-1 hover:text-destructive\">\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </Badge>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"link\">Live URL</Label>\n                <Input\n                  id=\"link\"\n                  value={formData.link}\n                  onChange={(e) => setFormData({ ...formData, link: e.target.value })}\n                  placeholder=\"https://example.com\"\n                  data-testid=\"input-link\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"github\">GitHub URL</Label>\n                <Input\n                  id=\"github\"\n                  value={formData.github}\n                  onChange={(e) => setFormData({ ...formData, github: e.target.value })}\n                  placeholder=\"https://github.com/...\"\n                  data-testid=\"input-github\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Switch\n                id=\"featured\"\n                checked={formData.featured}\n                onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n                data-testid=\"switch-featured-form\"\n              />\n              <Label htmlFor=\"featured\">Featured on homepage</Label>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-submit\">\n              {isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              {editingProject ? \"Update Project\" : \"Create Project\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":24572,"size_tokens":null},"server/api/security.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth, requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/settings\", requireAdmin, async (req, res) => {\n  try {\n    const settings = await storage.getAllSecuritySettings();\n    const settingsObject: Record<string, any> = {};\n\n    settings.forEach(s => {\n      const keys = s.key.split('.');\n      if (keys.length === 1) {\n        settingsObject[s.key] = s.value;\n      } else {\n        let current = settingsObject;\n        for (let i = 0; i < keys.length - 1; i++) {\n          if (!current[keys[i]]) {\n            current[keys[i]] = {};\n          }\n          current = current[keys[i]];\n        }\n        current[keys[keys.length - 1]] = s.value;\n      }\n    });\n\n    res.json(settingsObject);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/settings\", requireAdmin, async (req, res) => {\n  try {\n    const { key, value } = req.body;\n    const setting = await storage.upsertSecuritySetting(key, value);\n    await storage.createActivityLog({\n      action: `Security setting updated: ${key}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(setting);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/settings/bulk\", requireAdmin, async (req, res) => {\n  try {\n    const settings = req.body;\n    const updated: any[] = [];\n    for (const [key, value] of Object.entries(settings)) {\n      const setting = await storage.upsertSecuritySetting(key, value);\n      updated.push(setting);\n    }\n    await storage.createActivityLog({\n      action: `Bulk security settings updated`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json({ message: \"Settings updated\", count: updated.length });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/devices\", requireAuth, async (req, res) => {\n  try {\n    const devices = await storage.getTrustedDevicesByUser(req.session.userId!);\n    res.json(devices);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/devices\", requireAuth, async (req, res) => {\n  try {\n    const { deviceName, deviceFingerprint, ipAddress, userAgent, trusted } = req.body;\n    const device = await storage.createTrustedDevice({\n      userId: req.session.userId!,\n      deviceName,\n      deviceFingerprint,\n      ipAddress,\n      userAgent,\n      trusted: trusted ?? true\n    });\n    res.json(device);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/devices/:id\", requireAuth, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const device = await storage.updateTrustedDevice(id, req.body);\n    res.json(device);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/devices/:id\", requireAuth, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    await storage.deleteTrustedDevice(id);\n    res.json({ message: \"Device removed\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/sessions\", requireAuth, async (req, res) => {\n  try {\n    if (req.session.role === \"Super Admin\" || req.session.role === \"Admin\") {\n      const sessions = await storage.getAllActiveSessions();\n      res.json(sessions);\n    } else {\n      const sessions = await storage.getActiveSessionsByUser(req.session.userId!);\n      res.json(sessions);\n    }\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/sessions/user/:userId\", requireAuth, async (req, res) => {\n  try {\n    const userId = parseInt(req.params.userId);\n    if (req.session.userId !== userId && req.session.role !== \"Super Admin\" && req.session.role !== \"Admin\") {\n      return res.status(403).json({ message: \"Access denied\" });\n    }\n    const sessions = await storage.getActiveSessionsByUser(userId);\n    res.json(sessions);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/sessions/terminate/:id\", requireAuth, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    await storage.terminateSession(id);\n    await storage.createActivityLog({\n      action: \"Session terminated\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n    res.json({ message: \"Session terminated\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/sessions/terminate-all\", requireAdmin, async (req, res) => {\n  try {\n    await storage.terminateAllSessions();\n    await storage.createActivityLog({\n      action: \"All sessions terminated\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n    res.json({ message: \"All sessions terminated\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/sessions/logout-all-devices\", requireAuth, async (req, res) => {\n  try {\n    await storage.terminateAllUserSessions(req.session.userId!);\n    const devices = await storage.getTrustedDevicesByUser(req.session.userId!);\n    for (const device of devices) {\n      await storage.deleteTrustedDevice(device.id);\n    }\n    await storage.createActivityLog({\n      action: \"Logged out from all devices\",\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json({ message: \"Logged out from all devices\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/ip-rules\", requireAdmin, async (req, res) => {\n  try {\n    const rules = await storage.getAllIpRules();\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/ip-rules/:type\", requireAdmin, async (req, res) => {\n  try {\n    const type = req.params.type;\n    const rules = await storage.getIpRulesByType(type);\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/ip-rules\", requireAdmin, async (req, res) => {\n  try {\n    const { ipAddress, type, reason } = req.body;\n    const rule = await storage.createIpRule({\n      ipAddress,\n      type,\n      reason,\n      createdBy: req.session.userId\n    });\n    await storage.createActivityLog({\n      action: `IP ${type === 'whitelist' ? 'whitelisted' : 'blacklisted'}: ${ipAddress}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: type === 'blacklist' ? 'warning' : 'info'\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/ip-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    await storage.deleteIpRule(id);\n    await storage.createActivityLog({\n      action: `IP rule removed`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json({ message: \"IP rule removed\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/logs\", requireAdmin, async (req, res) => {\n  try {\n    const limit = parseInt(req.query.limit as string) || 100;\n    const logs = await storage.getRecentSecurityLogs(limit);\n    res.json(logs);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/logs/:type\", requireAdmin, async (req, res) => {\n  try {\n    const eventType = req.params.type;\n    const logs = await storage.getSecurityLogsByType(eventType);\n    res.json(logs);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/logs\", requireAdmin, async (req, res) => {\n  try {\n    const log = await storage.createSecurityLog(req.body);\n    res.json(log);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/login-history\", requireAuth, async (req, res) => {\n  try {\n    const limit = parseInt(req.query.limit as string) || 50;\n    const loginLogs = await storage.getLoginHistory(limit);\n    res.json(loginLogs);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/stats\", requireAdmin, async (req, res) => {\n  try {\n    const stats = await storage.getSecurityStats();\n    res.json(stats);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Firewall Rules CRUD\nrouter.get(\"/firewall-rules\", requireAdmin, async (req, res) => {\n  try {\n    const rules = await storage.getAllFirewallRules();\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/firewall-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.getFirewallRule(id);\n    if (!rule) {\n      return res.status(404).json({ message: \"Firewall rule not found\" });\n    }\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/firewall-rules\", requireAdmin, async (req, res) => {\n  try {\n    const { name, description, ruleType, condition, value, action, priority, enabled, expiresAt, metadata } = req.body;\n    const rule = await storage.createFirewallRule({\n      name,\n      description,\n      ruleType,\n      condition,\n      value,\n      action,\n      priority: priority || 100,\n      enabled: enabled !== false,\n      expiresAt: expiresAt ? new Date(expiresAt) : null,\n      metadata,\n      createdBy: req.session.userId\n    });\n    await storage.createActivityLog({\n      action: `Firewall rule created: ${name}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/firewall-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.updateFirewallRule(id, req.body);\n    if (!rule) {\n      return res.status(404).json({ message: \"Firewall rule not found\" });\n    }\n    await storage.createActivityLog({\n      action: `Firewall rule updated: ${rule.name}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/firewall-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.getFirewallRule(id);\n    await storage.deleteFirewallRule(id);\n    await storage.createActivityLog({\n      action: `Firewall rule deleted: ${rule?.name || id}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n    res.json({ message: \"Firewall rule deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Geo Blocking CRUD\nrouter.get(\"/geo-blocking\", requireAdmin, async (req, res) => {\n  try {\n    const rules = await storage.getAllGeoBlockingRules();\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/geo-blocking\", requireAdmin, async (req, res) => {\n  try {\n    const { countryCode, countryName, action, enabled } = req.body;\n    const rule = await storage.createGeoBlockingRule({\n      countryCode,\n      countryName,\n      action: action || 'block',\n      enabled: enabled !== false,\n      createdBy: req.session.userId\n    });\n    await storage.createActivityLog({\n      action: `Geo blocking rule created: ${countryName} (${countryCode})`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/geo-blocking/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.updateGeoBlockingRule(id, req.body);\n    if (!rule) {\n      return res.status(404).json({ message: \"Geo blocking rule not found\" });\n    }\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/geo-blocking/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.getGeoBlockingRule(id);\n    await storage.deleteGeoBlockingRule(id);\n    await storage.createActivityLog({\n      action: `Geo blocking rule removed: ${rule?.countryName || id}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json({ message: \"Geo blocking rule deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Rate Limit Rules CRUD\nrouter.get(\"/rate-limit-rules\", requireAdmin, async (req, res) => {\n  try {\n    const rules = await storage.getAllRateLimitRules();\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/rate-limit-rules\", requireAdmin, async (req, res) => {\n  try {\n    const { name, path, method, maxRequests, windowSeconds, blockDuration, enabled } = req.body;\n    const rule = await storage.createRateLimitRule({\n      name,\n      path,\n      method: method || '*',\n      maxRequests: maxRequests || 100,\n      windowSeconds: windowSeconds || 60,\n      blockDuration: blockDuration || 300,\n      enabled: enabled !== false,\n      createdBy: req.session.userId\n    });\n    await storage.createActivityLog({\n      action: `Rate limit rule created: ${name}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/rate-limit-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.updateRateLimitRule(id, req.body);\n    if (!rule) {\n      return res.status(404).json({ message: \"Rate limit rule not found\" });\n    }\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/rate-limit-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.getRateLimitRule(id);\n    await storage.deleteRateLimitRule(id);\n    await storage.createActivityLog({\n      action: `Rate limit rule deleted: ${rule?.name || id}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n    res.json({ message: \"Rate limit rule deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// User Agent Rules CRUD\nrouter.get(\"/user-agent-rules\", requireAdmin, async (req, res) => {\n  try {\n    const rules = await storage.getAllUserAgentRules();\n    res.json(rules);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/user-agent-rules\", requireAdmin, async (req, res) => {\n  try {\n    const { name, pattern, matchType, action, category, enabled } = req.body;\n    const rule = await storage.createUserAgentRule({\n      name,\n      pattern,\n      matchType: matchType || 'contains',\n      action: action || 'block',\n      category,\n      enabled: enabled !== false,\n      createdBy: req.session.userId\n    });\n    await storage.createActivityLog({\n      action: `User agent rule created: ${name}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"info\"\n    });\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.patch(\"/user-agent-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.updateUserAgentRule(id, req.body);\n    if (!rule) {\n      return res.status(404).json({ message: \"User agent rule not found\" });\n    }\n    res.json(rule);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/user-agent-rules/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const rule = await storage.getUserAgentRule(id);\n    await storage.deleteUserAgentRule(id);\n    await storage.createActivityLog({\n      action: `User agent rule deleted: ${rule?.name || id}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: \"warning\"\n    });\n    res.json({ message: \"User agent rule deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Blocked Requests\nrouter.get(\"/blocked-requests\", requireAdmin, async (req, res) => {\n  try {\n    const limit = parseInt(req.query.limit as string) || 100;\n    const requests = await storage.getRecentBlockedRequests(limit);\n    res.json(requests);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/blocked-requests/stats\", requireAdmin, async (req, res) => {\n  try {\n    const stats = await storage.getBlockedRequestStats();\n    res.json(stats);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":17773,"size_tokens":null},"client/src/pages/admin/settings/ThemeEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Palette, \n  Type, \n  Layout, \n  Monitor, \n  Smartphone, \n  Tablet,\n  Save, \n  RotateCcw, \n  Download, \n  Upload,\n  Check,\n  Loader2,\n  Sun,\n  Moon,\n  Eye\n} from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { ThemeComparison } from \"./ThemeComparison\";\n\nconst THEME_PRESETS = [\n  { \n    name: \"Modern\", \n    description: \"Clean and professional\",\n    colors: { primary: \"#7c3aed\", secondary: \"#ec4899\", accent: \"#f59e0b\" } \n  },\n  { \n    name: \"Classic\", \n    description: \"Timeless elegance\",\n    colors: { primary: \"#1f2937\", secondary: \"#374151\", accent: \"#6366f1\" } \n  },\n  { \n    name: \"Minimal\", \n    description: \"Simple and focused\",\n    colors: { primary: \"#000000\", secondary: \"#666666\", accent: \"#3b82f6\" } \n  },\n  { \n    name: \"Vibrant\", \n    description: \"Bold and energetic\",\n    colors: { primary: \"#ff6b6b\", secondary: \"#4ecdc4\", accent: \"#95e1d3\" } \n  },\n  { \n    name: \"Ocean\", \n    description: \"Calm and serene\",\n    colors: { primary: \"#0ea5e9\", secondary: \"#06b6d4\", accent: \"#22d3ee\" } \n  },\n  { \n    name: \"Forest\", \n    description: \"Natural and organic\",\n    colors: { primary: \"#059669\", secondary: \"#10b981\", accent: \"#34d399\" } \n  },\n];\n\nconst FONT_OPTIONS = {\n  heading: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Space Grotesk\", label: \"Space Grotesk\" },\n    { value: \"Outfit\", label: \"Outfit\" },\n    { value: \"Poppins\", label: \"Poppins\" },\n    { value: \"Plus Jakarta Sans\", label: \"Plus Jakarta Sans\" },\n    { value: \"Montserrat\", label: \"Montserrat\" },\n  ],\n  body: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Roboto\", label: \"Roboto\" },\n    { value: \"Open Sans\", label: \"Open Sans\" },\n    { value: \"Lato\", label: \"Lato\" },\n    { value: \"Source Sans Pro\", label: \"Source Sans Pro\" },\n  ]\n};\n\ntype ThemeSettings = {\n  primaryColor: string;\n  secondaryColor: string;\n  accentColor: string;\n  headingFont: string;\n  bodyFont: string;\n  fontScale: string;\n  lineHeight: string;\n  letterSpacing: string;\n  containerWidth: string;\n  borderRadius: string;\n  animationSpeed: string;\n  shadowPreset: string;\n  stickyHeader: boolean;\n  darkModeEnabled: boolean;\n  darkModeDefault: string;\n  selectedPreset: string;\n  customCSS: string;\n};\n\nconst defaultTheme: ThemeSettings = {\n  primaryColor: \"#7c3aed\",\n  secondaryColor: \"#ec4899\",\n  accentColor: \"#f59e0b\",\n  headingFont: \"Inter\",\n  bodyFont: \"Inter\",\n  fontScale: \"1\",\n  lineHeight: \"1.5\",\n  letterSpacing: \"0\",\n  containerWidth: \"1440\",\n  borderRadius: \"8\",\n  animationSpeed: \"300\",\n  shadowPreset: \"soft\",\n  stickyHeader: true,\n  darkModeEnabled: true,\n  darkModeDefault: \"system\",\n  selectedPreset: \"Modern\",\n  customCSS: \"\",\n};\n\nexport default function AdminThemeEnhanced() {\n  const { toast } = useToast();\n  const [theme, setTheme] = useState<ThemeSettings>(defaultTheme);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [previewMode, setPreviewMode] = useState<\"desktop\" | \"tablet\" | \"mobile\">(\"desktop\");\n\n  const { data: savedSettings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: ['/api/settings'],\n  });\n\n  useEffect(() => {\n    if (savedSettings) {\n      // If theme is stored as a string (JSON), parse it\n      if (typeof (savedSettings as any).theme === 'string') {\n        try {\n          const parsedTheme = JSON.parse((savedSettings as any).theme);\n          setTheme({ ...defaultTheme, ...parsedTheme });\n          setHasChanges(false);\n        } catch (e) {\n          console.error('Failed to parse theme:', e);\n        }\n      } else if ((savedSettings as any).theme && typeof (savedSettings as any).theme === 'object') {\n        // If it's already an object, use it directly\n        setTheme({ ...defaultTheme, ...(savedSettings as any).theme });\n        setHasChanges(false);\n      }\n    }\n  }, [savedSettings]);\n\n  const saveMutation = useMutation({\n    mutationFn: async (settings: ThemeSettings) => {\n      const res = await apiRequest('PUT', '/api/settings/theme', { value: JSON.stringify(settings) });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      setHasChanges(false);\n      toast({\n        title: \"Theme saved\",\n        description: \"Your theme settings have been saved successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error saving theme\",\n        description: error.message || \"Failed to save theme settings.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateTheme = (updates: Partial<ThemeSettings>) => {\n    setTheme(prev => ({ ...prev, ...updates }));\n    setHasChanges(true);\n  };\n\n  const applyPreset = (preset: typeof THEME_PRESETS[0]) => {\n    updateTheme({\n      primaryColor: preset.colors.primary,\n      secondaryColor: preset.colors.secondary,\n      accentColor: preset.colors.accent,\n      selectedPreset: preset.name,\n    });\n  };\n\n  const handleReset = () => {\n    if (hasChanges) {\n      if (!confirm(\"You have unsaved changes. Reset anyway?\")) {\n        return;\n      }\n    }\n    setTheme(defaultTheme);\n    setHasChanges(true);\n    toast({\n      title: \"Theme reset\",\n      description: \"Theme has been reset to default settings.\",\n    });\n  };\n\n  const handleExport = () => {\n    const blob = new Blob([JSON.stringify(theme, null, 2)], { type: 'application/json' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `theme-settings-${new Date().toISOString().slice(0, 10)}.json`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleImport = () => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          try {\n            const imported = JSON.parse(e.target?.result as string);\n            setTheme({ ...defaultTheme, ...imported });\n            setHasChanges(true);\n            toast({\n              title: \"Theme imported\",\n              description: \"Theme settings have been imported successfully.\",\n            });\n          } catch {\n            toast({\n              title: \"Import failed\",\n              description: \"Invalid theme file format.\",\n              variant: \"destructive\",\n            });\n          }\n        };\n        reader.readAsText(file);\n      }\n    };\n    input.click();\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Theme Customization</h1>\n            <p className=\"text-muted-foreground\">Customize the look and feel of your website</p>\n          </div>\n          <div className=\"flex gap-2 flex-wrap\">\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleExport}\n              data-testid=\"button-export\"\n            >\n              <Download className=\"w-4 h-4\" /> Export\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleImport}\n              data-testid=\"button-import\"\n            >\n              <Upload className=\"w-4 h-4\" /> Import\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleReset}\n              data-testid=\"button-reset\"\n            >\n              <RotateCcw className=\"w-4 h-4\" /> Reset\n            </Button>\n            <Button \n              className=\"gap-2\"\n              onClick={() => saveMutation.mutate(theme)}\n              disabled={saveMutation.isPending || !hasChanges}\n              data-testid=\"button-save\"\n            >\n              {saveMutation.isPending ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4\" />\n              )}\n              Save Changes\n              {hasChanges && <Badge variant=\"secondary\" className=\"ml-1\">Unsaved</Badge>}\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"colors\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-2xl grid-cols-5\">\n            <TabsTrigger value=\"colors\" data-testid=\"tab-colors\">Colors</TabsTrigger>\n            <TabsTrigger value=\"typography\" data-testid=\"tab-typography\">Typography</TabsTrigger>\n            <TabsTrigger value=\"layout\" data-testid=\"tab-layout\">Layout</TabsTrigger>\n            <TabsTrigger value=\"presets\" data-testid=\"tab-presets\">Presets</TabsTrigger>\n            <TabsTrigger value=\"preview\" data-testid=\"tab-preview\">Preview</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"colors\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Palette className=\"w-5 h-5\" /> Color Scheme\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Primary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.primaryColor}\n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-primary-color\"\n                      />\n                      <Input \n                        value={theme.primaryColor} \n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for buttons, links, and main highlights</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Secondary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.secondaryColor}\n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-secondary-color\"\n                      />\n                      <Input \n                        value={theme.secondaryColor} \n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for secondary actions and backgrounds</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Accent Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.accentColor}\n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-accent-color\"\n                      />\n                      <Input \n                        value={theme.accentColor} \n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for accents and notifications</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Quick Color Presets</label>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {[\"#7c3aed\", \"#3b82f6\", \"#10b981\", \"#f59e0b\", \"#ef4444\", \"#ec4899\", \"#8b5cf6\", \"#06b6d4\"].map((color) => (\n                        <button\n                          key={color}\n                          className={`w-8 h-8 rounded-full border-2 transition-all ${theme.primaryColor === color ? 'border-foreground scale-110' : 'border-transparent'}`}\n                          style={{ backgroundColor: color }}\n                          onClick={() => updateTheme({ primaryColor: color })}\n                          data-testid={`color-preset-${color}`}\n                        />\n                      ))}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sun className=\"w-5 h-5\" /> Dark Mode Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Enable Dark Mode</label>\n                      <p className=\"text-xs text-muted-foreground\">Allow users to switch to dark mode</p>\n                    </div>\n                    <Switch \n                      checked={theme.darkModeEnabled}\n                      onCheckedChange={(checked) => updateTheme({ darkModeEnabled: checked })}\n                      data-testid=\"switch-dark-mode\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Default Mode</label>\n                    <Select \n                      value={theme.darkModeDefault} \n                      onValueChange={(value) => updateTheme({ darkModeDefault: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-dark-mode-default\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"system\">System Preference</SelectItem>\n                        <SelectItem value=\"light\">Light Mode</SelectItem>\n                        <SelectItem value=\"dark\">Dark Mode</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"p-4 bg-muted rounded-lg\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <Check className=\"w-4 h-4 text-green-500\" />\n                      <p className=\"text-sm font-medium\">Contrast Check</p>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">WCAG AA compliant</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"typography\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Type className=\"w-5 h-5\" /> Font Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Heading Font</label>\n                    <Select \n                      value={theme.headingFont}\n                      onValueChange={(value) => updateTheme({ headingFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-heading-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.heading.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Body Font</label>\n                    <Select \n                      value={theme.bodyFont}\n                      onValueChange={(value) => updateTheme({ bodyFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-body-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.body.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Font Size Scale</label>\n                    <Select \n                      value={theme.fontScale}\n                      onValueChange={(value) => updateTheme({ fontScale: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-font-scale\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0.875\">Small (0.875x)</SelectItem>\n                        <SelectItem value=\"1\">Normal (1x)</SelectItem>\n                        <SelectItem value=\"1.125\">Large (1.125x)</SelectItem>\n                        <SelectItem value=\"1.25\">Extra Large (1.25x)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Spacing</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Line Height</label>\n                    <Input \n                      value={theme.lineHeight}\n                      onChange={(e) => updateTheme({ lineHeight: e.target.value })}\n                      data-testid=\"input-line-height\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Letter Spacing (px)</label>\n                    <Input \n                      value={theme.letterSpacing}\n                      onChange={(e) => updateTheme({ letterSpacing: e.target.value })}\n                      data-testid=\"input-letter-spacing\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"lg:col-span-2\">\n                <CardHeader>\n                  <CardTitle>Typography Preview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div \n                    className=\"p-6 bg-muted rounded-lg space-y-4\"\n                    style={{ fontFamily: theme.bodyFont, lineHeight: theme.lineHeight }}\n                  >\n                    <h1 \n                      className=\"text-4xl font-bold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      The Quick Brown Fox\n                    </h1>\n                    <h2 \n                      className=\"text-2xl font-semibold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      Jumps Over The Lazy Dog\n                    </h2>\n                    <p className=\"text-base\">\n                      Lorem ipsum dolor sit amet, consectetur adipiscing elit. \n                      Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n                    </p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      This is how your body text will appear with the selected typography settings.\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"layout\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Layout className=\"w-5 h-5\" /> Layout Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Container Width</label>\n                    <Select \n                      value={theme.containerWidth}\n                      onValueChange={(value) => updateTheme({ containerWidth: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-container-width\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"1200\">Boxed (1200px)</SelectItem>\n                        <SelectItem value=\"1440\">Wide (1440px)</SelectItem>\n                        <SelectItem value=\"100%\">Full Width</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Sticky Header</label>\n                      <p className=\"text-xs text-muted-foreground\">Keep header visible on scroll</p>\n                    </div>\n                    <Switch \n                      checked={theme.stickyHeader}\n                      onCheckedChange={(checked) => updateTheme({ stickyHeader: checked })}\n                      data-testid=\"switch-sticky-header\"\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Border Radius</label>\n                    <Select \n                      value={theme.borderRadius}\n                      onValueChange={(value) => updateTheme({ borderRadius: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-border-radius\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0\">Sharp (0px)</SelectItem>\n                        <SelectItem value=\"4\">Small (4px)</SelectItem>\n                        <SelectItem value=\"8\">Medium (8px)</SelectItem>\n                        <SelectItem value=\"12\">Large (12px)</SelectItem>\n                        <SelectItem value=\"16\">Extra Large (16px)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Animation & Effects</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Animation Speed</label>\n                    <Select \n                      value={theme.animationSpeed}\n                      onValueChange={(value) => updateTheme({ animationSpeed: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-animation-speed\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"400\">Slow (400ms)</SelectItem>\n                        <SelectItem value=\"300\">Normal (300ms)</SelectItem>\n                        <SelectItem value=\"200\">Fast (200ms)</SelectItem>\n                        <SelectItem value=\"0\">Instant (0ms)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Shadow Preset</label>\n                    <Select \n                      value={theme.shadowPreset}\n                      onValueChange={(value) => updateTheme({ shadowPreset: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-shadow-preset\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"none\">None</SelectItem>\n                        <SelectItem value=\"soft\">Soft</SelectItem>\n                        <SelectItem value=\"medium\">Medium</SelectItem>\n                        <SelectItem value=\"bold\">Bold</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"grid grid-cols-4 gap-2 pt-2\">\n                    {['none', 'soft', 'medium', 'bold'].map((shadow) => (\n                      <button\n                        key={shadow}\n                        onClick={() => updateTheme({ shadowPreset: shadow })}\n                        className={`p-4 bg-card rounded-lg border transition-all ${\n                          theme.shadowPreset === shadow ? 'border-primary ring-2 ring-primary/20' : 'border-border'\n                        }`}\n                        style={{\n                          boxShadow: shadow === 'none' ? 'none' :\n                            shadow === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                            shadow === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                            '0 10px 15px rgba(0,0,0,0.1)'\n                        }}\n                      >\n                        <span className=\"text-xs capitalize\">{shadow}</span>\n                      </button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"presets\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Theme Presets</CardTitle>\n                <CardDescription>Choose from pre-designed theme combinations</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {THEME_PRESETS.map((preset) => (\n                    <button\n                      key={preset.name}\n                      onClick={() => applyPreset(preset)}\n                      className={`p-4 rounded-lg border-2 transition text-left ${\n                        theme.selectedPreset === preset.name\n                          ? \"border-primary bg-primary/5\"\n                          : \"border-border hover:border-primary/50\"\n                      }`}\n                      data-testid={`preset-${preset.name.toLowerCase()}`}\n                    >\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className=\"flex gap-1\">\n                          {Object.values(preset.colors).map((color, i) => (\n                            <div\n                              key={i}\n                              className=\"w-6 h-6 rounded-full border border-border\"\n                              style={{ backgroundColor: color }}\n                            />\n                          ))}\n                        </div>\n                        {theme.selectedPreset === preset.name && (\n                          <Badge className=\"ml-auto\">Active</Badge>\n                        )}\n                      </div>\n                      <h4 className=\"font-medium\">{preset.name}</h4>\n                      <p className=\"text-xs text-muted-foreground\">{preset.description}</p>\n                    </button>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Custom CSS</CardTitle>\n                <CardDescription>Add custom CSS to override theme styles</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <textarea\n                  className=\"w-full p-3 border rounded-md font-mono text-sm bg-muted/50 min-h-[200px] focus:outline-none focus:ring-2 focus:ring-primary\"\n                  placeholder={`:root {\n  --primary: ${theme.primaryColor};\n  --secondary: ${theme.secondaryColor};\n}`}\n                  value={theme.customCSS}\n                  onChange={(e) => updateTheme({ customCSS: e.target.value })}\n                  data-testid=\"textarea-custom-css\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"preview\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4\">\n              <div>\n                <h3 className=\"font-medium\">Live Preview</h3>\n                <p className=\"text-sm text-muted-foreground\">Changes are applied in real-time</p>\n              </div>\n              <div className=\"flex gap-2 flex-wrap\">\n                <Button\n                  variant={previewMode === \"desktop\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"desktop\")}\n                  data-testid=\"button-preview-desktop\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Monitor className=\"w-4 h-4\" />\n                  <span>Desktop</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"tablet\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"tablet\")}\n                  data-testid=\"button-preview-tablet\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Tablet className=\"w-4 h-4\" />\n                  <span>Tablet</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"mobile\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"mobile\")}\n                  data-testid=\"button-preview-mobile\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Smartphone className=\"w-4 h-4\" />\n                  <span>Mobile</span>\n                </Button>\n              </div>\n            </div>\n\n            <Card className=\"overflow-hidden\">\n              <CardContent className=\"p-6 bg-muted/30\">\n                <div \n                  className={`mx-auto transition-all duration-300 overflow-y-auto max-h-[600px] ${\n                    previewMode === 'desktop' ? 'max-w-full' :\n                    previewMode === 'tablet' ? 'max-w-[768px]' :\n                    'max-w-[375px]'\n                  }`}\n                  style={{\n                    fontFamily: theme.bodyFont,\n                    fontSize: `${parseFloat(theme.fontScale) * 16}px`,\n                    lineHeight: theme.lineHeight,\n                    letterSpacing: `${theme.letterSpacing}px`,\n                  }}\n                >\n                  <div \n                    className=\"border overflow-hidden shadow-lg bg-background\"\n                    style={{ \n                      borderRadius: `${theme.borderRadius}px`,\n                      transition: `all ${theme.animationSpeed}ms ease`,\n                      boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                        theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                        theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                        '0 10px 15px rgba(0,0,0,0.1)'\n                    }}\n                  >\n                    {/* Navbar */}\n                    <div \n                      className=\"h-14 border-b flex items-center justify-between px-4 sticky top-0 z-10\"\n                      style={{ \n                        backgroundColor: `${theme.primaryColor}10`,\n                        borderColor: `${theme.primaryColor}20`\n                      }}\n                    >\n                      <div className=\"font-bold text-lg\" style={{ color: theme.primaryColor, fontFamily: theme.headingFont }}>\n                        Loi Developer\n                      </div>\n                      <div className=\"flex gap-4 text-xs\">\n                        <span>Portfolio</span>\n                        <span>Blog</span>\n                        <span>Contact</span>\n                      </div>\n                    </div>\n\n                    {/* Hero Section */}\n                    <div className=\"p-8 text-center space-y-3 bg-gradient-to-b from-background to-muted/20\">\n                      <h1 \n                        className=\"text-3xl font-bold\" \n                        style={{ fontFamily: theme.headingFont, color: theme.primaryColor }}\n                      >\n                        Hello, I'm Loi Developer\n                      </h1>\n                      <p className=\"text-sm text-muted-foreground max-w-md mx-auto\">\n                        Full-stack Developer | UI/UX Enthusiast | Creative Thinker\n                      </p>\n                      <Button \n                        size=\"sm\" \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        View My Work\n                      </Button>\n                    </div>\n\n                    {/* Services Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Featured Services</h2>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {[\n                          'Web Development',\n                          'UI/UX Design',\n                          'Backend APIs',\n                          'DevOps'\n                        ].map(service => (\n                          <div \n                            key={service}\n                            className=\"p-3 border bg-card\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}30`,\n                              boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                                theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                                theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                                '0 10px 15px rgba(0,0,0,0.1)'\n                            }}\n                          >\n                            <div className=\"text-xs text-center font-medium\" style={{ color: theme.primaryColor }}>\n                              {service}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Projects Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Latest Projects</h2>\n                      <div className=\"space-y-2\">\n                        {[1, 2, 3].map(i => (\n                          <div \n                            key={i}\n                            className=\"p-3 border bg-card flex items-start gap-2\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}20`\n                            }}\n                          >\n                            <div \n                              className=\"w-12 h-12 rounded flex-shrink-0\" \n                              style={{ \n                                backgroundColor: `${theme.primaryColor}20`,\n                                borderRadius: `${theme.borderRadius}px`\n                              }} \n                            />\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"h-2 w-24 bg-muted rounded mb-1\" />\n                              <div className=\"h-2 w-32 bg-muted/60 rounded\" />\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Footer */}\n                    <div \n                      className=\"p-4 text-center text-xs border-t\"\n                      style={{ borderColor: `${theme.primaryColor}20` }}\n                    >\n                      <p className=\"text-muted-foreground\">\n                        2024 Loi Developer. All rights reserved.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <ThemeComparison currentTheme={theme} />\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Component Preview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Buttons</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Button \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Button>\n                      <Button \n                        style={{ \n                          backgroundColor: theme.secondaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Secondary\n                      </Button>\n                      <Button \n                        variant=\"outline\"\n                        style={{ \n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                      >\n                        Outline\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Badges</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Badge>\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.accentColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Accent\n                      </Badge>\n                      <Badge \n                        variant=\"outline\"\n                        style={{ borderRadius: `${theme.borderRadius}px` }}\n                      >\n                        Outline\n                      </Badge>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Cards</h4>\n                    <Card \n                      style={{ \n                        borderRadius: `${theme.borderRadius}px`,\n                        boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                          theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                          theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                          '0 10px 15px rgba(0,0,0,0.1)'\n                      }}\n                    >\n                      <CardContent className=\"p-4\">\n                        <p className=\"text-sm\" style={{ lineHeight: theme.lineHeight }}>\n                          Sample card content\n                        </p>\n                      </CardContent>\n                    </Card>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":42815,"size_tokens":null},"client/src/pages/home/Blog.tsx":{"content":"import { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { motion } from \"framer-motion\";\nimport { Calendar, User, Eye, Clock, Search, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { useState, useMemo } from \"react\";\n\nexport default function Blog() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\n\n  const { data: posts = [], isLoading } = useQuery({\n    queryKey: ['/api/posts'],\n    queryFn: async () => {\n      const response = await fetch('/api/posts');\n      if (!response.ok) throw new Error('Failed to fetch posts');\n      return response.json();\n    }\n  });\n\n  const { data: categories = [] } = useQuery({\n    queryKey: ['/api/categories', 'post'],\n    queryFn: async () => {\n      const response = await fetch('/api/categories?type=post');\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    }\n  });\n\n  const publishedPosts = posts.filter((post: any) => post.status === 'Published');\n\n  const filteredPosts = useMemo(() => {\n    return publishedPosts.filter((post: any) => {\n      const matchesSearch = post.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        post.excerpt?.toLowerCase().includes(searchQuery.toLowerCase());\n      const matchesCategory = !selectedCategory || post.category === selectedCategory;\n      return matchesSearch && matchesCategory;\n    });\n  }, [publishedPosts, searchQuery, selectedCategory]);\n\n  const uniqueCategories: string[] = Array.from(new Set(publishedPosts.map((p: any) => p.category))).sort() as string[];\n\n  const formatDate = (date: string | null) => {\n    if (!date) return 'N/A';\n    return new Date(date).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          {/* Header */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12\"\n          >\n            <div className=\"max-w-4xl\">\n              <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n                Blog & <span className=\"text-primary\">Articles</span>\n              </h1>\n              <p className=\"text-xl text-muted-foreground\">\n                Thoughts on web development, design, and creative coding.\n              </p>\n            </div>\n          </motion.div>\n\n          {/* Search and Filters */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n            className=\"mb-12 space-y-6\"\n          >\n            {/* Search */}\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search articles...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10 max-w-md\"\n                data-testid=\"input-search-blog\"\n              />\n            </div>\n\n            {/* Categories */}\n            <div className=\"flex flex-wrap gap-2\">\n              <Button\n                variant={selectedCategory === null ? \"default\" : \"outline\"}\n                onClick={() => setSelectedCategory(null)}\n                data-testid=\"button-filter-all\"\n              >\n                All Articles\n              </Button>\n              {uniqueCategories.map((cat: string) => (\n                <Button\n                  key={cat}\n                  variant={selectedCategory === cat ? \"default\" : \"outline\"}\n                  onClick={() => setSelectedCategory(cat)}\n                  data-testid={`button-filter-${cat}`}\n                >\n                  {cat}\n                </Button>\n              ))}\n            </div>\n          </motion.div>\n\n          {/* Posts List */}\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-16\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n          ) : filteredPosts.length === 0 ? (\n            <div className=\"text-center py-16\">\n              <p className=\"text-lg text-muted-foreground mb-4\">No articles found</p>\n              <Button variant=\"outline\" onClick={() => {\n                setSearchQuery(\"\");\n                setSelectedCategory(null);\n              }} data-testid=\"button-clear-filters\">\n                Clear filters\n              </Button>\n            </div>\n          ) : (\n            <div className=\"space-y-6 max-w-4xl\">\n              {filteredPosts.map((post: any, index: number) => (\n                <motion.div\n                  key={post.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.3, delay: index * 0.05 }}\n                  data-testid={`card-blog-${post.id}`}\n                >\n                  <Link href={`/blog/${post.slug}`}>\n                    <Card className=\"hover:shadow-lg transition-shadow duration-300 cursor-pointer\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex flex-wrap gap-2\">\n                            <Badge variant=\"secondary\">{post.category}</Badge>\n                            {post.status === 'Draft' && (\n                              <Badge variant=\"outline\" className=\"text-yellow-500 border-yellow-500\">\n                                Draft\n                              </Badge>\n                            )}\n                          </div>\n                          <span className=\"text-sm text-muted-foreground whitespace-nowrap\">\n                            {formatDate(post.publishedAt)}\n                          </span>\n                        </div>\n                        <h2 className=\"text-2xl font-bold hover:text-primary transition-colors\">\n                          {post.title}\n                        </h2>\n                        <p className=\"text-muted-foreground mt-2\">\n                          {post.excerpt}\n                        </p>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground border-t pt-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <User className=\"w-4 h-4\" />\n                            <span>{post.author || 'Unknown'}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Eye className=\"w-4 h-4\" />\n                            <span>{post.views || 0} views</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Clock className=\"w-4 h-4\" />\n                            <span>\n                              {post.content \n                                ? Math.ceil(post.content.split(/\\s+/).length / 200) \n                                : 1} min read\n                            </span>\n                          </div>\n                        </div>\n\n                        {/* Tags */}\n                        {post.tags && post.tags.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2 mt-4\">\n                            {post.tags.slice(0, 3).map((tag: string) => (\n                              <Badge key={tag} variant=\"outline\" className=\"text-xs\">\n                                {tag}\n                              </Badge>\n                            ))}\n                            {post.tags.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{post.tags.length - 3}\n                              </Badge>\n                            )}\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  </Link>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":8876,"size_tokens":null},"client/src/pages/admin/settings/Theme.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  Palette, \n  Type, \n  Layout, \n  Monitor, \n  Smartphone, \n  Tablet,\n  Save, \n  RotateCcw, \n  Download, \n  Upload,\n  Check,\n  Loader2,\n  Sun,\n  Moon,\n  Eye\n} from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { ThemeComparison } from \"./ThemeComparison\";\n\nconst THEME_PRESETS = [\n  { \n    name: \"Modern\", \n    description: \"Clean and professional\",\n    colors: { primary: \"#7c3aed\", secondary: \"#ec4899\", accent: \"#f59e0b\" } \n  },\n  { \n    name: \"Classic\", \n    description: \"Timeless elegance\",\n    colors: { primary: \"#1f2937\", secondary: \"#374151\", accent: \"#6366f1\" } \n  },\n  { \n    name: \"Minimal\", \n    description: \"Simple and focused\",\n    colors: { primary: \"#000000\", secondary: \"#666666\", accent: \"#3b82f6\" } \n  },\n  { \n    name: \"Vibrant\", \n    description: \"Bold and energetic\",\n    colors: { primary: \"#ff6b6b\", secondary: \"#4ecdc4\", accent: \"#95e1d3\" } \n  },\n  { \n    name: \"Ocean\", \n    description: \"Calm and serene\",\n    colors: { primary: \"#0ea5e9\", secondary: \"#06b6d4\", accent: \"#22d3ee\" } \n  },\n  { \n    name: \"Forest\", \n    description: \"Natural and organic\",\n    colors: { primary: \"#059669\", secondary: \"#10b981\", accent: \"#34d399\" } \n  },\n];\n\nconst FONT_OPTIONS = {\n  heading: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Space Grotesk\", label: \"Space Grotesk\" },\n    { value: \"Outfit\", label: \"Outfit\" },\n    { value: \"Poppins\", label: \"Poppins\" },\n    { value: \"Plus Jakarta Sans\", label: \"Plus Jakarta Sans\" },\n    { value: \"Montserrat\", label: \"Montserrat\" },\n  ],\n  body: [\n    { value: \"Inter\", label: \"Inter\" },\n    { value: \"Roboto\", label: \"Roboto\" },\n    { value: \"Open Sans\", label: \"Open Sans\" },\n    { value: \"Lato\", label: \"Lato\" },\n    { value: \"Source Sans Pro\", label: \"Source Sans Pro\" },\n  ]\n};\n\ntype ThemeSettings = {\n  primaryColor: string;\n  secondaryColor: string;\n  accentColor: string;\n  headingFont: string;\n  bodyFont: string;\n  fontScale: string;\n  lineHeight: string;\n  letterSpacing: string;\n  containerWidth: string;\n  borderRadius: string;\n  animationSpeed: string;\n  shadowPreset: string;\n  stickyHeader: boolean;\n  darkModeEnabled: boolean;\n  darkModeDefault: string;\n  selectedPreset: string;\n  customCSS: string;\n};\n\nconst defaultTheme: ThemeSettings = {\n  primaryColor: \"#7c3aed\",\n  secondaryColor: \"#ec4899\",\n  accentColor: \"#f59e0b\",\n  headingFont: \"Inter\",\n  bodyFont: \"Inter\",\n  fontScale: \"1\",\n  lineHeight: \"1.5\",\n  letterSpacing: \"0\",\n  containerWidth: \"1440\",\n  borderRadius: \"8\",\n  animationSpeed: \"300\",\n  shadowPreset: \"soft\",\n  stickyHeader: true,\n  darkModeEnabled: true,\n  darkModeDefault: \"system\",\n  selectedPreset: \"Modern\",\n  customCSS: \"\",\n};\n\nexport default function AdminThemeEnhanced() {\n  const { toast } = useToast();\n  const [theme, setTheme] = useState<ThemeSettings>(defaultTheme);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [previewMode, setPreviewMode] = useState<\"desktop\" | \"tablet\" | \"mobile\">(\"desktop\");\n\n  const { data: savedSettings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: ['/api/settings'],\n  });\n\n  useEffect(() => {\n    if (savedSettings) {\n      // If theme is stored as a string (JSON), parse it\n      if (typeof (savedSettings as any).theme === 'string') {\n        try {\n          const parsedTheme = JSON.parse((savedSettings as any).theme);\n          setTheme({ ...defaultTheme, ...parsedTheme });\n          setHasChanges(false);\n        } catch (e) {\n          console.error('Failed to parse theme:', e);\n        }\n      } else if ((savedSettings as any).theme && typeof (savedSettings as any).theme === 'object') {\n        // If it's already an object, use it directly\n        setTheme({ ...defaultTheme, ...(savedSettings as any).theme });\n        setHasChanges(false);\n      }\n    }\n  }, [savedSettings]);\n\n  const saveMutation = useMutation({\n    mutationFn: async (settings: ThemeSettings) => {\n      const res = await apiRequest('PUT', '/api/settings/theme', { value: JSON.stringify(settings) });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      setHasChanges(false);\n      toast({\n        title: \"Theme saved\",\n        description: \"Your theme settings have been saved successfully.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error saving theme\",\n        description: error.message || \"Failed to save theme settings.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateTheme = (updates: Partial<ThemeSettings>) => {\n    setTheme(prev => ({ ...prev, ...updates }));\n    setHasChanges(true);\n  };\n\n  const applyPreset = (preset: typeof THEME_PRESETS[0]) => {\n    updateTheme({\n      primaryColor: preset.colors.primary,\n      secondaryColor: preset.colors.secondary,\n      accentColor: preset.colors.accent,\n      selectedPreset: preset.name,\n    });\n  };\n\n  const handleReset = () => {\n    if (hasChanges) {\n      if (!confirm(\"You have unsaved changes. Reset anyway?\")) {\n        return;\n      }\n    }\n    setTheme(defaultTheme);\n    setHasChanges(true);\n    toast({\n      title: \"Theme reset\",\n      description: \"Theme has been reset to default settings.\",\n    });\n  };\n\n  const handleExport = () => {\n    const blob = new Blob([JSON.stringify(theme, null, 2)], { type: 'application/json' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `theme-settings-${new Date().toISOString().slice(0, 10)}.json`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleImport = () => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          try {\n            const imported = JSON.parse(e.target?.result as string);\n            setTheme({ ...defaultTheme, ...imported });\n            setHasChanges(true);\n            toast({\n              title: \"Theme imported\",\n              description: \"Theme settings have been imported successfully.\",\n            });\n          } catch {\n            toast({\n              title: \"Import failed\",\n              description: \"Invalid theme file format.\",\n              variant: \"destructive\",\n            });\n          }\n        };\n        reader.readAsText(file);\n      }\n    };\n    input.click();\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Theme Customization</h1>\n            <p className=\"text-muted-foreground\">Customize the look and feel of your website</p>\n          </div>\n          <div className=\"flex gap-2 flex-wrap\">\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleExport}\n              data-testid=\"button-export\"\n            >\n              <Download className=\"w-4 h-4\" /> Export\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleImport}\n              data-testid=\"button-import\"\n            >\n              <Upload className=\"w-4 h-4\" /> Import\n            </Button>\n            <Button \n              variant=\"outline\" \n              className=\"gap-2\"\n              onClick={handleReset}\n              data-testid=\"button-reset\"\n            >\n              <RotateCcw className=\"w-4 h-4\" /> Reset\n            </Button>\n            <Button \n              className=\"gap-2\"\n              onClick={() => saveMutation.mutate(theme)}\n              disabled={saveMutation.isPending || !hasChanges}\n              data-testid=\"button-save\"\n            >\n              {saveMutation.isPending ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4\" />\n              )}\n              Save Changes\n              {hasChanges && <Badge variant=\"secondary\" className=\"ml-1\">Unsaved</Badge>}\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"colors\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-2xl grid-cols-5\">\n            <TabsTrigger value=\"colors\" data-testid=\"tab-colors\">Colors</TabsTrigger>\n            <TabsTrigger value=\"typography\" data-testid=\"tab-typography\">Typography</TabsTrigger>\n            <TabsTrigger value=\"layout\" data-testid=\"tab-layout\">Layout</TabsTrigger>\n            <TabsTrigger value=\"presets\" data-testid=\"tab-presets\">Presets</TabsTrigger>\n            <TabsTrigger value=\"preview\" data-testid=\"tab-preview\">Preview</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"colors\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Palette className=\"w-5 h-5\" /> Color Scheme\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Primary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.primaryColor}\n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-primary-color\"\n                      />\n                      <Input \n                        value={theme.primaryColor} \n                        onChange={(e) => updateTheme({ primaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for buttons, links, and main highlights</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Secondary Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.secondaryColor}\n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-secondary-color\"\n                      />\n                      <Input \n                        value={theme.secondaryColor} \n                        onChange={(e) => updateTheme({ secondaryColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for secondary actions and backgrounds</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Accent Color</label>\n                    <div className=\"flex gap-2 items-center\">\n                      <Input\n                        type=\"color\"\n                        value={theme.accentColor}\n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"w-16 h-10 p-1 border rounded cursor-pointer\"\n                        data-testid=\"input-accent-color\"\n                      />\n                      <Input \n                        value={theme.accentColor} \n                        onChange={(e) => updateTheme({ accentColor: e.target.value })}\n                        className=\"font-mono text-sm\" \n                      />\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Used for accents and notifications</p>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-3\">Quick Color Presets</label>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {[\"#7c3aed\", \"#3b82f6\", \"#10b981\", \"#f59e0b\", \"#ef4444\", \"#ec4899\", \"#8b5cf6\", \"#06b6d4\"].map((color) => (\n                        <button\n                          key={color}\n                          className={`w-8 h-8 rounded-full border-2 transition-all ${theme.primaryColor === color ? 'border-foreground scale-110' : 'border-transparent'}`}\n                          style={{ backgroundColor: color }}\n                          onClick={() => updateTheme({ primaryColor: color })}\n                          data-testid={`color-preset-${color}`}\n                        />\n                      ))}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sun className=\"w-5 h-5\" /> Dark Mode Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Enable Dark Mode</label>\n                      <p className=\"text-xs text-muted-foreground\">Allow users to switch to dark mode</p>\n                    </div>\n                    <Switch \n                      checked={theme.darkModeEnabled}\n                      onCheckedChange={(checked) => updateTheme({ darkModeEnabled: checked })}\n                      data-testid=\"switch-dark-mode\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Default Mode</label>\n                    <Select \n                      value={theme.darkModeDefault} \n                      onValueChange={(value) => updateTheme({ darkModeDefault: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-dark-mode-default\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"system\">System Preference</SelectItem>\n                        <SelectItem value=\"light\">Light Mode</SelectItem>\n                        <SelectItem value=\"dark\">Dark Mode</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"p-4 bg-muted rounded-lg\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <Check className=\"w-4 h-4 text-green-500\" />\n                      <p className=\"text-sm font-medium\">Contrast Check</p>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">WCAG AA compliant</p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"typography\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Type className=\"w-5 h-5\" /> Font Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Heading Font</label>\n                    <Select \n                      value={theme.headingFont}\n                      onValueChange={(value) => updateTheme({ headingFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-heading-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.heading.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Body Font</label>\n                    <Select \n                      value={theme.bodyFont}\n                      onValueChange={(value) => updateTheme({ bodyFont: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-body-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {FONT_OPTIONS.body.map(font => (\n                          <SelectItem key={font.value} value={font.value}>{font.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Font Size Scale</label>\n                    <Select \n                      value={theme.fontScale}\n                      onValueChange={(value) => updateTheme({ fontScale: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-font-scale\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0.875\">Small (0.875x)</SelectItem>\n                        <SelectItem value=\"1\">Normal (1x)</SelectItem>\n                        <SelectItem value=\"1.125\">Large (1.125x)</SelectItem>\n                        <SelectItem value=\"1.25\">Extra Large (1.25x)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Spacing</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Line Height</label>\n                    <Input \n                      value={theme.lineHeight}\n                      onChange={(e) => updateTheme({ lineHeight: e.target.value })}\n                      data-testid=\"input-line-height\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Letter Spacing (px)</label>\n                    <Input \n                      value={theme.letterSpacing}\n                      onChange={(e) => updateTheme({ letterSpacing: e.target.value })}\n                      data-testid=\"input-letter-spacing\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"lg:col-span-2\">\n                <CardHeader>\n                  <CardTitle>Typography Preview</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div \n                    className=\"p-6 bg-muted rounded-lg space-y-4\"\n                    style={{ fontFamily: theme.bodyFont, lineHeight: theme.lineHeight }}\n                  >\n                    <h1 \n                      className=\"text-4xl font-bold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      The Quick Brown Fox\n                    </h1>\n                    <h2 \n                      className=\"text-2xl font-semibold\" \n                      style={{ fontFamily: theme.headingFont }}\n                    >\n                      Jumps Over The Lazy Dog\n                    </h2>\n                    <p className=\"text-base\">\n                      Lorem ipsum dolor sit amet, consectetur adipiscing elit. \n                      Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\n                    </p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      This is how your body text will appear with the selected typography settings.\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"layout\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Layout className=\"w-5 h-5\" /> Layout Settings\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Container Width</label>\n                    <Select \n                      value={theme.containerWidth}\n                      onValueChange={(value) => updateTheme({ containerWidth: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-container-width\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"1200\">Boxed (1200px)</SelectItem>\n                        <SelectItem value=\"1440\">Wide (1440px)</SelectItem>\n                        <SelectItem value=\"100%\">Full Width</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <label className=\"text-sm font-medium\">Sticky Header</label>\n                      <p className=\"text-xs text-muted-foreground\">Keep header visible on scroll</p>\n                    </div>\n                    <Switch \n                      checked={theme.stickyHeader}\n                      onCheckedChange={(checked) => updateTheme({ stickyHeader: checked })}\n                      data-testid=\"switch-sticky-header\"\n                    />\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Border Radius</label>\n                    <Select \n                      value={theme.borderRadius}\n                      onValueChange={(value) => updateTheme({ borderRadius: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-border-radius\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"0\">Sharp (0px)</SelectItem>\n                        <SelectItem value=\"4\">Small (4px)</SelectItem>\n                        <SelectItem value=\"8\">Medium (8px)</SelectItem>\n                        <SelectItem value=\"12\">Large (12px)</SelectItem>\n                        <SelectItem value=\"16\">Extra Large (16px)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Animation & Effects</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Animation Speed</label>\n                    <Select \n                      value={theme.animationSpeed}\n                      onValueChange={(value) => updateTheme({ animationSpeed: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-animation-speed\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"400\">Slow (400ms)</SelectItem>\n                        <SelectItem value=\"300\">Normal (300ms)</SelectItem>\n                        <SelectItem value=\"200\">Fast (200ms)</SelectItem>\n                        <SelectItem value=\"0\">Instant (0ms)</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-medium block mb-2\">Shadow Preset</label>\n                    <Select \n                      value={theme.shadowPreset}\n                      onValueChange={(value) => updateTheme({ shadowPreset: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-shadow-preset\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"none\">None</SelectItem>\n                        <SelectItem value=\"soft\">Soft</SelectItem>\n                        <SelectItem value=\"medium\">Medium</SelectItem>\n                        <SelectItem value=\"bold\">Bold</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"grid grid-cols-4 gap-2 pt-2\">\n                    {['none', 'soft', 'medium', 'bold'].map((shadow) => (\n                      <button\n                        key={shadow}\n                        onClick={() => updateTheme({ shadowPreset: shadow })}\n                        className={`p-4 bg-card rounded-lg border transition-all ${\n                          theme.shadowPreset === shadow ? 'border-primary ring-2 ring-primary/20' : 'border-border'\n                        }`}\n                        style={{\n                          boxShadow: shadow === 'none' ? 'none' :\n                            shadow === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                            shadow === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                            '0 10px 15px rgba(0,0,0,0.1)'\n                        }}\n                      >\n                        <span className=\"text-xs capitalize\">{shadow}</span>\n                      </button>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"presets\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Theme Presets</CardTitle>\n                <CardDescription>Choose from pre-designed theme combinations</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {THEME_PRESETS.map((preset) => (\n                    <button\n                      key={preset.name}\n                      onClick={() => applyPreset(preset)}\n                      className={`p-4 rounded-lg border-2 transition text-left ${\n                        theme.selectedPreset === preset.name\n                          ? \"border-primary bg-primary/5\"\n                          : \"border-border hover:border-primary/50\"\n                      }`}\n                      data-testid={`preset-${preset.name.toLowerCase()}`}\n                    >\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className=\"flex gap-1\">\n                          {Object.values(preset.colors).map((color, i) => (\n                            <div\n                              key={i}\n                              className=\"w-6 h-6 rounded-full border border-border\"\n                              style={{ backgroundColor: color }}\n                            />\n                          ))}\n                        </div>\n                        {theme.selectedPreset === preset.name && (\n                          <Badge className=\"ml-auto\">Active</Badge>\n                        )}\n                      </div>\n                      <h4 className=\"font-medium\">{preset.name}</h4>\n                      <p className=\"text-xs text-muted-foreground\">{preset.description}</p>\n                    </button>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Custom CSS</CardTitle>\n                <CardDescription>Add custom CSS to override theme styles</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <textarea\n                  className=\"w-full p-3 border rounded-md font-mono text-sm bg-muted/50 min-h-[200px] focus:outline-none focus:ring-2 focus:ring-primary\"\n                  placeholder={`:root {\n  --primary: ${theme.primaryColor};\n  --secondary: ${theme.secondaryColor};\n}`}\n                  value={theme.customCSS}\n                  onChange={(e) => updateTheme({ customCSS: e.target.value })}\n                  data-testid=\"textarea-custom-css\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"preview\" className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4\">\n              <div>\n                <h3 className=\"font-medium\">Live Preview</h3>\n                <p className=\"text-sm text-muted-foreground\">Changes are applied in real-time</p>\n              </div>\n              <div className=\"flex gap-2 flex-wrap\">\n                <Button\n                  variant={previewMode === \"desktop\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"desktop\")}\n                  data-testid=\"button-preview-desktop\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Monitor className=\"w-4 h-4\" />\n                  <span>Desktop</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"tablet\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"tablet\")}\n                  data-testid=\"button-preview-tablet\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Tablet className=\"w-4 h-4\" />\n                  <span>Tablet</span>\n                </Button>\n                <Button\n                  variant={previewMode === \"mobile\" ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setPreviewMode(\"mobile\")}\n                  data-testid=\"button-preview-mobile\"\n                  className=\"gap-2 flex-1 sm:flex-initial\"\n                >\n                  <Smartphone className=\"w-4 h-4\" />\n                  <span>Mobile</span>\n                </Button>\n              </div>\n            </div>\n\n            <Card className=\"overflow-hidden\">\n              <CardContent className=\"p-6 bg-muted/30\">\n                <div \n                  className={`mx-auto transition-all duration-300 overflow-y-auto max-h-[600px] ${\n                    previewMode === 'desktop' ? 'max-w-full' :\n                    previewMode === 'tablet' ? 'max-w-[768px]' :\n                    'max-w-[375px]'\n                  }`}\n                  style={{\n                    fontFamily: theme.bodyFont,\n                    fontSize: `${parseFloat(theme.fontScale) * 16}px`,\n                    lineHeight: theme.lineHeight,\n                    letterSpacing: `${theme.letterSpacing}px`,\n                  }}\n                >\n                  <div \n                    className=\"border overflow-hidden shadow-lg bg-background\"\n                    style={{ \n                      borderRadius: `${theme.borderRadius}px`,\n                      transition: `all ${theme.animationSpeed}ms ease`,\n                      boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                        theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                        theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                        '0 10px 15px rgba(0,0,0,0.1)'\n                    }}\n                  >\n                    {/* Navbar */}\n                    <div \n                      className=\"h-14 border-b flex items-center justify-between px-4 sticky top-0 z-10\"\n                      style={{ \n                        backgroundColor: `${theme.primaryColor}10`,\n                        borderColor: `${theme.primaryColor}20`\n                      }}\n                    >\n                      <div className=\"font-bold text-lg\" style={{ color: theme.primaryColor, fontFamily: theme.headingFont }}>\n                        Loi Developer\n                      </div>\n                      <div className=\"flex gap-4 text-xs\">\n                        <span>Portfolio</span>\n                        <span>Blog</span>\n                        <span>Contact</span>\n                      </div>\n                    </div>\n\n                    {/* Hero Section */}\n                    <div className=\"p-8 text-center space-y-3 bg-gradient-to-b from-background to-muted/20\">\n                      <h1 \n                        className=\"text-3xl font-bold\" \n                        style={{ fontFamily: theme.headingFont, color: theme.primaryColor }}\n                      >\n                        Hello, I'm Loi Developer\n                      </h1>\n                      <p className=\"text-sm text-muted-foreground max-w-md mx-auto\">\n                        Full-stack Developer | UI/UX Enthusiast | Creative Thinker\n                      </p>\n                      <Button \n                        size=\"sm\" \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        View My Work\n                      </Button>\n                    </div>\n\n                    {/* Services Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Featured Services</h2>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {[\n                          'Web Development',\n                          'UI/UX Design',\n                          'Backend APIs',\n                          'DevOps'\n                        ].map(service => (\n                          <div \n                            key={service}\n                            className=\"p-3 border bg-card\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}30`,\n                              boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                                theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                                theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                                '0 10px 15px rgba(0,0,0,0.1)'\n                            }}\n                          >\n                            <div className=\"text-xs text-center font-medium\" style={{ color: theme.primaryColor }}>\n                              {service}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Projects Section */}\n                    <div className=\"p-6 space-y-3 border-t\">\n                      <h2 className=\"text-xl font-bold\" style={{ fontFamily: theme.headingFont }}>Latest Projects</h2>\n                      <div className=\"space-y-2\">\n                        {[1, 2, 3].map(i => (\n                          <div \n                            key={i}\n                            className=\"p-3 border bg-card flex items-start gap-2\"\n                            style={{ \n                              borderRadius: `${theme.borderRadius}px`,\n                              borderColor: `${theme.primaryColor}20`\n                            }}\n                          >\n                            <div \n                              className=\"w-12 h-12 rounded flex-shrink-0\" \n                              style={{ \n                                backgroundColor: `${theme.primaryColor}20`,\n                                borderRadius: `${theme.borderRadius}px`\n                              }} \n                            />\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"h-2 w-24 bg-muted rounded mb-1\" />\n                              <div className=\"h-2 w-32 bg-muted/60 rounded\" />\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Footer */}\n                    <div \n                      className=\"p-4 text-center text-xs border-t\"\n                      style={{ borderColor: `${theme.primaryColor}20` }}\n                    >\n                      <p className=\"text-muted-foreground\">\n                        2024 Loi Developer. All rights reserved.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <ThemeComparison currentTheme={theme} />\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Component Preview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Buttons</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Button \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Button>\n                      <Button \n                        style={{ \n                          backgroundColor: theme.secondaryColor,\n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Secondary\n                      </Button>\n                      <Button \n                        variant=\"outline\"\n                        style={{ \n                          borderRadius: `${theme.borderRadius}px`,\n                          transition: `all ${theme.animationSpeed}ms ease`\n                        }}\n                      >\n                        Outline\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Badges</h4>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.primaryColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Primary\n                      </Badge>\n                      <Badge \n                        style={{ \n                          backgroundColor: theme.accentColor,\n                          borderRadius: `${theme.borderRadius}px`\n                        }}\n                        className=\"text-white\"\n                      >\n                        Accent\n                      </Badge>\n                      <Badge \n                        variant=\"outline\"\n                        style={{ borderRadius: `${theme.borderRadius}px` }}\n                      >\n                        Outline\n                      </Badge>\n                    </div>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <h4 className=\"text-sm font-medium\" style={{ fontFamily: theme.headingFont }}>Cards</h4>\n                    <Card \n                      style={{ \n                        borderRadius: `${theme.borderRadius}px`,\n                        boxShadow: theme.shadowPreset === 'none' ? 'none' :\n                          theme.shadowPreset === 'soft' ? '0 1px 3px rgba(0,0,0,0.1)' :\n                          theme.shadowPreset === 'medium' ? '0 4px 6px rgba(0,0,0,0.1)' :\n                          '0 10px 15px rgba(0,0,0,0.1)'\n                      }}\n                    >\n                      <CardContent className=\"p-4\">\n                        <p className=\"text-sm\" style={{ lineHeight: theme.lineHeight }}>\n                          Sample card content\n                        </p>\n                      </CardContent>\n                    </Card>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":42815,"size_tokens":null},"server/api/storage.ts":{"content":"import { Router } from \"express\";\n\nconst router = Router();\n\n// Storage API has been removed\nexport default router;","path":null,"size_bytes":115,"size_tokens":null},"server/utils/captcha.ts":{"content":"export interface CaptchaVerifyResult {\n  success: boolean;\n  score?: number;\n  error?: string;\n}\n\nexport async function verifyCaptcha(\n  captchaToken: string | undefined, \n  captchaType: string | undefined,\n  secretKey?: string\n): Promise<CaptchaVerifyResult> {\n  if (!captchaType || captchaType === 'disabled') {\n    return { success: true };\n  }\n\n  if (captchaType === 'local') {\n    try {\n      if (!captchaToken) return { success: true };\n      const data = JSON.parse(captchaToken);\n      if (data.type === 'local' && data.timeDiff && data.timeDiff >= 2000) {\n        return { success: true };\n      }\n      return { success: false, error: 'Form submitted too quickly' };\n    } catch {\n      return { success: true };\n    }\n  }\n\n  if (!captchaToken) {\n    return { success: false, error: 'Captcha token required' };\n  }\n\n  if (captchaType === 'google') {\n    const googleSecretKey = secretKey || process.env.RECAPTCHA_SECRET_KEY;\n    if (!googleSecretKey) {\n      console.warn('Google reCAPTCHA secret key not configured');\n      return { success: true };\n    }\n\n    try {\n      const response = await fetch('https://www.google.com/recaptcha/api/siteverify', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: `secret=${googleSecretKey}&response=${captchaToken}`\n      });\n      const result = await response.json() as { success: boolean; score?: number; 'error-codes'?: string[] };\n\n      if (result.success && (result.score === undefined || result.score >= 0.5)) {\n        return { success: true, score: result.score };\n      }\n      return { success: false, error: 'reCAPTCHA verification failed', score: result.score };\n    } catch (error) {\n      console.error('reCAPTCHA verification error:', error);\n      return { success: true };\n    }\n  }\n\n  if (captchaType === 'cloudflare') {\n    const cfSecretKey = secretKey || process.env.TURNSTILE_SECRET_KEY;\n    if (!cfSecretKey) {\n      console.warn('Cloudflare Turnstile secret key not configured');\n      return { success: true };\n    }\n\n    try {\n      const formData = new URLSearchParams();\n      formData.append('secret', cfSecretKey);\n      formData.append('response', captchaToken);\n\n      const response = await fetch('https://challenges.cloudflare.com/turnstile/v0/siteverify', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: formData.toString()\n      });\n      const result = await response.json() as { success: boolean; 'error-codes'?: string[] };\n\n      if (result.success) {\n        return { success: true };\n      }\n      return { success: false, error: 'Turnstile verification failed' };\n    } catch (error) {\n      console.error('Turnstile verification error:', error);\n      return { success: true };\n    }\n  }\n\n  return { success: true };\n}\n","path":null,"size_bytes":2846,"size_tokens":null},"client/src/pages/admin/tools/Scheduler.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Clock, Plus, Play, Pause, Trash2, RefreshCw, CheckCircle, XCircle, Loader2 } from \"lucide-react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useState } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport type { ScheduledTask } from \"@shared/schema\";\n\nfunction formatDate(date: string | Date | null | undefined): string {\n  if (!date) return \"Never\";\n  const d = new Date(date);\n  return d.toLocaleString();\n}\n\nfunction parseCronExpression(cron: string): string {\n  const parts = cron.split(' ');\n  if (parts.length !== 5) return cron;\n  \n  const [minute, hour, dayOfMonth, month, dayOfWeek] = parts;\n  \n  if (minute === '0' && hour === '2' && dayOfMonth === '*' && month === '*' && dayOfWeek === '*') {\n    return 'Daily at 2:00 AM';\n  }\n  if (minute === '0' && hour === '9' && dayOfMonth === '*' && month === '*' && dayOfWeek === '1') {\n    return 'Every Monday at 9:00 AM';\n  }\n  if (minute === '0' && hour.startsWith('*/')) {\n    return `Every ${hour.replace('*/', '')} hours`;\n  }\n  if (minute.startsWith('*/')) {\n    return `Every ${minute.replace('*/', '')} minutes`;\n  }\n  \n  return cron;\n}\n\nexport default function AdminScheduler() {\n  const { toast } = useToast();\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [newTask, setNewTask] = useState({\n    name: '',\n    description: '',\n    schedule: '0 2 * * *',\n    type: 'custom',\n    command: ''\n  });\n\n  const { data: tasks = [], isLoading } = useQuery<ScheduledTask[]>({\n    queryKey: ['/api/scheduled-tasks'],\n  });\n\n  const createTaskMutation = useMutation({\n    mutationFn: (data: typeof newTask) => apiRequest('/api/scheduled-tasks', { method: 'POST', body: JSON.stringify(data) }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scheduled-tasks'] });\n      setDialogOpen(false);\n      setNewTask({ name: '', description: '', schedule: '0 2 * * *', type: 'custom', command: '' });\n      toast({ title: \"Task created\", description: \"Scheduled task has been created successfully.\" });\n    },\n    onError: () => toast({ title: \"Error\", description: \"Failed to create task\", variant: \"destructive\" })\n  });\n\n  const pauseMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(`/api/scheduled-tasks/${id}/pause`, { method: 'POST' }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scheduled-tasks'] });\n      toast({ title: \"Task paused\", description: \"The scheduled task has been paused.\" });\n    }\n  });\n\n  const resumeMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(`/api/scheduled-tasks/${id}/resume`, { method: 'POST' }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scheduled-tasks'] });\n      toast({ title: \"Task resumed\", description: \"The scheduled task has been resumed.\" });\n    }\n  });\n\n  const runMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(`/api/scheduled-tasks/${id}/run`, { method: 'POST' }),\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scheduled-tasks'] });\n      toast({ \n        title: data.result === 'success' ? \"Task completed\" : \"Task failed\",\n        description: data.result === 'success' ? \"The task ran successfully.\" : data.error,\n        variant: data.result === 'success' ? \"default\" : \"destructive\"\n      });\n    }\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: number) => apiRequest(`/api/scheduled-tasks/${id}`, { method: 'DELETE' }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/scheduled-tasks'] });\n      toast({ title: \"Task deleted\", description: \"The scheduled task has been deleted.\" });\n    }\n  });\n\n  const handleCreateTask = () => {\n    if (!newTask.name || !newTask.schedule) {\n      toast({ title: \"Error\", description: \"Name and schedule are required\", variant: \"destructive\" });\n      return;\n    }\n    createTaskMutation.mutate(newTask);\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between flex-wrap gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-page-title\">Scheduled Tasks</h1>\n            <p className=\"text-muted-foreground\">Manage automated tasks and cron jobs</p>\n          </div>\n          <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"bg-primary gap-2\" data-testid=\"button-new-task\">\n                <Plus className=\"w-4 h-4\" /> New Task\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Create Scheduled Task</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 pt-4\">\n                <div>\n                  <Label htmlFor=\"name\">Task Name</Label>\n                  <Input \n                    id=\"name\"\n                    data-testid=\"input-task-name\"\n                    value={newTask.name}\n                    onChange={(e) => setNewTask({ ...newTask, name: e.target.value })}\n                    placeholder=\"e.g., Daily Database Backup\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea \n                    id=\"description\"\n                    data-testid=\"input-task-description\"\n                    value={newTask.description}\n                    onChange={(e) => setNewTask({ ...newTask, description: e.target.value })}\n                    placeholder=\"What does this task do?\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"schedule\">Schedule (Cron Expression)</Label>\n                  <Input \n                    id=\"schedule\"\n                    data-testid=\"input-task-schedule\"\n                    value={newTask.schedule}\n                    onChange={(e) => setNewTask({ ...newTask, schedule: e.target.value })}\n                    placeholder=\"0 2 * * *\"\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">Format: minute hour day month weekday</p>\n                </div>\n                <div>\n                  <Label htmlFor=\"type\">Type</Label>\n                  <Select value={newTask.type} onValueChange={(value) => setNewTask({ ...newTask, type: value })}>\n                    <SelectTrigger data-testid=\"select-task-type\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"backup\">Backup</SelectItem>\n                      <SelectItem value=\"email\">Email</SelectItem>\n                      <SelectItem value=\"maintenance\">Maintenance</SelectItem>\n                      <SelectItem value=\"custom\">Custom</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <Button \n                  onClick={handleCreateTask} \n                  disabled={createTaskMutation.isPending}\n                  className=\"w-full\"\n                  data-testid=\"button-create-task\"\n                >\n                  {createTaskMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Create Task\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : tasks.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <Clock className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\n              <h3 className=\"font-semibold text-lg mb-2\">No scheduled tasks</h3>\n              <p className=\"text-muted-foreground mb-4\">Create your first scheduled task to automate recurring jobs</p>\n              <Button onClick={() => setDialogOpen(true)} data-testid=\"button-create-first-task\">\n                <Plus className=\"w-4 h-4 mr-2\" /> Create Task\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"space-y-4\">\n            {tasks.map((task) => (\n              <Card key={task.id} data-testid={`card-task-${task.id}`}>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2 flex-wrap\">\n                        <Clock className=\"w-5 h-5 text-primary\" />\n                        <h3 className=\"font-bold\" data-testid={`text-task-name-${task.id}`}>{task.name}</h3>\n                        <Badge variant={task.status === \"active\" ? \"default\" : \"secondary\"} data-testid={`badge-task-status-${task.id}`}>\n                          {task.status}\n                        </Badge>\n                        <Badge variant=\"outline\">{task.type}</Badge>\n                        {task.lastResult && (\n                          <Badge variant={task.lastResult === 'success' ? 'default' : 'destructive'} className=\"gap-1\">\n                            {task.lastResult === 'success' ? <CheckCircle className=\"w-3 h-3\" /> : <XCircle className=\"w-3 h-3\" />}\n                            {task.lastResult}\n                          </Badge>\n                        )}\n                      </div>\n                      \n                      {task.description && (\n                        <p className=\"text-sm text-muted-foreground mb-3\">{task.description}</p>\n                      )}\n                      \n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 text-sm\">\n                        <div>\n                          <p className=\"text-muted-foreground text-xs\">Schedule</p>\n                          <code className=\"font-mono text-xs\">{task.schedule}</code>\n                          <p className=\"text-xs text-muted-foreground\">{parseCronExpression(task.schedule)}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-muted-foreground text-xs\">Last Run</p>\n                          <p className=\"font-medium text-sm\">{formatDate(task.lastRun)}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-muted-foreground text-xs\">Next Run</p>\n                          <p className=\"font-medium text-sm\">{formatDate(task.nextRun)}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-muted-foreground text-xs\">Run Count</p>\n                          <p className=\"font-medium text-sm\">{task.runCount || 0}</p>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-2\">\n                      <Button \n                        variant=\"outline\" \n                        size=\"icon\"\n                        onClick={() => runMutation.mutate(task.id)}\n                        disabled={runMutation.isPending}\n                        title=\"Run now\"\n                        data-testid={`button-run-task-${task.id}`}\n                      >\n                        <RefreshCw className={`w-4 h-4 ${runMutation.isPending ? 'animate-spin' : ''}`} />\n                      </Button>\n                      <Button \n                        variant=\"outline\" \n                        size=\"icon\"\n                        onClick={() => task.status === \"active\" ? pauseMutation.mutate(task.id) : resumeMutation.mutate(task.id)}\n                        title={task.status === \"active\" ? \"Pause\" : \"Resume\"}\n                        data-testid={`button-toggle-task-${task.id}`}\n                      >\n                        {task.status === \"active\" ? <Pause className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4\" />}\n                      </Button>\n                      <Button \n                        variant=\"outline\" \n                        size=\"icon\" \n                        className=\"text-destructive\"\n                        onClick={() => {\n                          if (confirm(\"Are you sure you want to delete this task?\")) {\n                            deleteMutation.mutate(task.id);\n                          }\n                        }}\n                        data-testid={`button-delete-task-${task.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":13538,"size_tokens":null},"client/src/pages/admin/dashboard/Dashboard.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport {\n  Users,\n  Eye,\n  Activity,\n  Clock,\n  AlertTriangle,\n  FileText,\n  Briefcase,\n  MessageSquare,\n  CheckCircle,\n  XCircle,\n  Info,\n  Zap,\n  Star,\n  Settings,\n  Mail,\n  TrendingUp,\n  ArrowUpRight,\n  ArrowDownRight,\n} from \"lucide-react\";\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n  BarChart,\n  Bar,\n} from \"recharts\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport type {\n  Post,\n  Project,\n  Message,\n  Comment,\n  Review,\n  ActivityLog,\n  Skill,\n  Service,\n  Testimonial,\n} from \"@shared/schema\";\nimport { Link } from \"wouter\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/hooks/use-auth\";\n\n\nexport default function AdminDashboard() {\n  const { user } = useAuth();\n\n  const { data: posts = [] } = useQuery<Post[]>({\n    queryKey: [\"/api/posts\"],\n  });\n\n  const { data: projects = [] } = useQuery<Project[]>({\n    queryKey: [\"/api/projects\"],\n  });\n\n  const {\n    data: messages = [],\n    isLoading: messagesLoading,\n    isError: messagesError,\n  } = useQuery<Message[]>({\n    queryKey: [\"/api/messages\"],\n    retry: false,\n    enabled: !!user,\n  });\n\n  const { data: comments = [] } = useQuery<Comment[]>({\n    queryKey: [\"/api/comments\"],\n  });\n\n  const { data: reviews = [] } = useQuery<Review[]>({\n    queryKey: [\"/api/reviews\"],\n  });\n\n  const { data: activityLogs = [] } = useQuery<ActivityLog[]>({\n    queryKey: [\"/api/activity-logs\"],\n  });\n\n  const { data: skills = [] } = useQuery<Skill[]>({\n    queryKey: [\"/api/skills\"],\n  });\n\n  const { data: services = [] } = useQuery<Service[]>({\n    queryKey: [\"/api/services\"],\n  });\n\n  const { data: testimonials = [] } = useQuery<Testimonial[]>({\n    queryKey: [\"/api/testimonials\"],\n  });\n\n  const { data: users = [] } = useQuery<any[]>({\n    queryKey: [\"/api/users\"],\n  });\n\n  const unreadMessages = messages.filter((m) => !m.read).length;\n  const unreadComments = comments.filter((c) => !c.read).length;\n  const unreadReviews = reviews.filter((r) => !r.read).length;\n  const totalUnread = unreadMessages + unreadComments + unreadReviews;\n\n  const publishedPosts = posts.filter((p) => p.status === \"Published\").length;\n  const publishedProjects = projects.filter(\n    (p) => p.status === \"Published\",\n  ).length;\n  const pendingComments = comments.filter((c) => c.status === \"Pending\").length;\n  const pendingReviews = reviews.filter((r) => r.status === \"Pending\").length;\n  const activeServices = services.filter((s) => s.active).length;\n  const activeTestimonials = testimonials.filter((t) => t.active).length;\n\n  const totalViews =\n    projects.reduce((sum, p) => sum + (p.views || 0), 0) +\n    posts.reduce((sum, p) => sum + (p.views || 0), 0);\n\n  const avgRating =\n    reviews.length > 0\n      ? (\n          reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length\n        ).toFixed(1)\n      : \"0.0\";\n\n  const recentLogs = activityLogs.slice(0, 6);\n\n  const statusDistribution = [\n    { name: \"Published\", value: publishedPosts + publishedProjects, color: \"hsl(var(--primary))\" },\n    { name: \"Draft\", value: posts.filter(p => p.status === \"Draft\").length + projects.filter(p => p.status === \"Draft\").length, color: \"hsl(var(--chart-2))\" },\n    { name: \"Pending\", value: posts.filter(p => p.status === \"Pending\" || p.status === \"Review\").length + projects.filter(p => p.status === \"Pending\" || p.status === \"Review\").length, color: \"hsl(var(--chart-3))\" },\n  ];\n\n  const contentDistribution = [\n    { name: \"Posts\", value: posts.length, color: \"hsl(var(--primary))\" },\n    { name: \"Projects\", value: projects.length, color: \"hsl(var(--chart-2))\" },\n    { name: \"Services\", value: services.length, color: \"hsl(var(--chart-3))\" },\n    { name: \"Skills\", value: skills.length, color: \"hsl(var(--chart-4))\" },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-8 animate-in fade-in duration-500\">\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n          <div>\n            <h1\n              className=\"text-3xl font-heading font-bold\"\n              data-testid=\"text-dashboard-title\"\n            >\n              Dashboard\n            </h1>\n            <p className=\"text-muted-foreground\">\n              Welcome back! Here's what's happening with your portfolio.\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2 text-sm bg-green-500/10 text-green-500 px-3 py-1 rounded-full border border-green-500/20\">\n            <span className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\n            System Operational\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <Card\n            className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\"\n            data-testid=\"card-total-views\"\n          >\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Total Views\n              </CardTitle>\n              <Eye className=\"h-4 w-4 text-blue-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {totalViews.toLocaleString()}\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                <span className=\"text-green-500 flex items-center gap-1\">\n                  <ArrowUpRight className=\"h-3 w-3\" /> +12%\n                </span>\n                from last month\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card\n            className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\"\n            data-testid=\"card-total-content\"\n          >\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Total Content\n              </CardTitle>\n              <FileText className=\"h-4 w-4 text-green-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {posts.length + projects.length}\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                {publishedPosts} posts, {publishedProjects} projects published\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card\n            className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\"\n            data-testid=\"card-unread\"\n          >\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Unread Items\n              </CardTitle>\n              <MessageSquare className=\"h-4 w-4 text-yellow-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{totalUnread}</div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                {unreadMessages} messages, {unreadComments} comments,{\" \"}\n                {unreadReviews} reviews\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card\n            className=\"bg-card/50 backdrop-blur-sm border-primary/10 hover:border-primary/30 transition-all hover:-translate-y-1 duration-300\"\n            data-testid=\"card-avg-rating\"\n          >\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground\">\n                Avg. Rating\n              </CardTitle>\n              <Star className=\"h-4 w-4 text-purple-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold flex items-center gap-1\">\n                {avgRating}\n                <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                Based on {reviews.length} reviews\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <Card className=\"md:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Content Overview</CardTitle>\n              <CardDescription>\n                Quick summary of your content status\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4\">\n                <Link href=\"/admin/posts\">\n                  <div\n                    className=\"p-4 rounded-xl bg-primary/5 border border-primary/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-primary/10 transition-colors cursor-pointer\"\n                    data-testid=\"card-posts-count\"\n                  >\n                    <FileText className=\"h-8 w-8 text-primary mb-1\" />\n                    <span className=\"text-2xl font-bold\">{posts.length}</span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      Blog Posts\n                    </span>\n                  </div>\n                </Link>\n                <Link href=\"/admin/projects\">\n                  <div\n                    className=\"p-4 rounded-xl bg-blue-500/5 border border-blue-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-blue-500/10 transition-colors cursor-pointer\"\n                    data-testid=\"card-projects-count\"\n                  >\n                    <Briefcase className=\"h-8 w-8 text-blue-500 mb-1\" />\n                    <span className=\"text-2xl font-bold\">\n                      {projects.length}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      Projects\n                    </span>\n                  </div>\n                </Link>\n                <Link href=\"/admin/comments\">\n                  <div\n                    className=\"p-4 rounded-xl bg-yellow-500/5 border border-yellow-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-yellow-500/10 transition-colors cursor-pointer\"\n                    data-testid=\"card-pending-count\"\n                  >\n                    <MessageSquare className=\"h-8 w-8 text-yellow-500 mb-1\" />\n                    <span className=\"text-2xl font-bold\">\n                      {pendingComments + pendingReviews}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      Pending\n                    </span>\n                  </div>\n                </Link>\n                <Link href=\"/admin/inbox\">\n                  <div\n                    className=\"p-4 rounded-xl bg-purple-500/5 border border-purple-500/10 flex flex-col items-center justify-center text-center gap-2 hover:bg-purple-500/10 transition-colors cursor-pointer\"\n                    data-testid=\"card-messages-count\"\n                  >\n                    <Mail className=\"h-8 w-8 text-purple-500 mb-1\" />\n                    <span className=\"text-2xl font-bold\">\n                      {messages.length}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      Messages\n                    </span>\n                  </div>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10 flex flex-col justify-center relative overflow-hidden\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-10\">\n              <Zap size={120} />\n            </div>\n            <CardHeader>\n              <CardTitle>Portfolio Stats</CardTitle>\n              <CardDescription>Skills & Services</CardDescription>\n            </CardHeader>\n            <CardContent className=\"flex flex-col gap-4\">\n              <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                <span className=\"text-sm\">Skills</span>\n                <Badge variant=\"secondary\">{skills.length}</Badge>\n              </div>\n              <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                <span className=\"text-sm\">Active Services</span>\n                <Badge variant=\"secondary\">\n                  {activeServices} / {services.length}\n                </Badge>\n              </div>\n              <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                <span className=\"text-sm\">Testimonials</span>\n                <Badge variant=\"secondary\">{activeTestimonials}</Badge>\n              </div>\n              <div className=\"flex justify-between items-center p-3 rounded-lg bg-muted/50\">\n                <span className=\"text-sm\">Users</span>\n                <Badge variant=\"secondary\">{users.length}</Badge>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <Card className=\"lg:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Content Distribution</CardTitle>\n              <CardDescription>\n                Overview of your portfolio content\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-[300px]\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={contentDistribution}>\n                    <CartesianGrid\n                      strokeDasharray=\"3 3\"\n                      stroke=\"hsl(var(--border))\"\n                    />\n                    <XAxis\n                      dataKey=\"name\"\n                      stroke=\"hsl(var(--muted-foreground))\"\n                    />\n                    <YAxis stroke=\"hsl(var(--muted-foreground))\" />\n                    <Tooltip\n                      contentStyle={{\n                        backgroundColor: \"hsl(var(--card))\",\n                        border: \"1px solid hsl(var(--border))\",\n                        borderRadius: \"8px\",\n                      }}\n                    />\n                    <Bar\n                      dataKey=\"value\"\n                      fill=\"hsl(var(--primary))\"\n                      radius={[4, 4, 0, 0]}\n                    />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Quick Actions</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <Link href=\"/admin/posts\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start gap-2\"\n                  data-testid=\"button-new-post\"\n                >\n                  <FileText className=\"h-4 w-4\" /> New Blog Post\n                </Button>\n              </Link>\n              <Link href=\"/admin/projects\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start gap-2\"\n                  data-testid=\"button-new-project\"\n                >\n                  <Briefcase className=\"h-4 w-4\" /> New Project\n                </Button>\n              </Link>\n              <Link href=\"/admin/inbox\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start gap-2\"\n                  data-testid=\"button-view-messages\"\n                >\n                  <Mail className=\"h-4 w-4\" /> View Messages\n                  {unreadMessages > 0 && (\n                    <Badge variant=\"destructive\" className=\"ml-auto\">\n                      {unreadMessages}\n                    </Badge>\n                  )}\n                </Button>\n              </Link>\n              <Link href=\"/admin/settings\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start gap-2\"\n                  data-testid=\"button-settings\"\n                >\n                  <Settings className=\"h-4 w-4\" /> Site Settings\n                </Button>\n              </Link>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <Card className=\"lg:col-span-2 bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2\">\n              <div>\n                <CardTitle>Recent Activity</CardTitle>\n                <CardDescription>Latest system actions</CardDescription>\n              </div>\n              <Link href=\"/admin/activity\">\n                <Button variant=\"ghost\" size=\"sm\">\n                  View All\n                </Button>\n              </Link>\n            </CardHeader>\n            <CardContent>\n              {recentLogs.length === 0 ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Activity className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                  <p>No recent activity</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {recentLogs.map((log) => (\n                    <div\n                      key={log.id}\n                      className=\"flex items-start gap-4 pb-4 border-b border-border/50 last:border-0 last:pb-0\"\n                      data-testid={`activity-log-${log.id}`}\n                    >\n                      <div\n                        className={`mt-1 p-2 rounded-full ${\n                          log.type === \"success\"\n                            ? \"bg-green-500/10 text-green-500\"\n                            : log.type === \"warning\"\n                              ? \"bg-yellow-500/10 text-yellow-500\"\n                              : log.type === \"error\"\n                                ? \"bg-red-500/10 text-red-500\"\n                                : \"bg-blue-500/10 text-blue-500\"\n                        }`}\n                      >\n                        {log.type === \"success\" ? (\n                          <CheckCircle size={16} />\n                        ) : log.type === \"warning\" ? (\n                          <AlertTriangle size={16} />\n                        ) : log.type === \"error\" ? (\n                          <XCircle size={16} />\n                        ) : (\n                          <Info size={16} />\n                        )}\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium\">{log.action}</p>\n                        <div className=\"flex items-center gap-2 text-xs text-muted-foreground mt-1\">\n                          <span>{log.userName || \"System\"}</span>\n                          <span>â€¢</span>\n                          <span>\n                            {log.createdAt &&\n                              formatDistanceToNow(new Date(log.createdAt), {\n                                addSuffix: true,\n                              })}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-card/50 backdrop-blur-sm border-primary/10\">\n            <CardHeader>\n              <CardTitle>Recent Messages</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {messages.length === 0 && !messagesLoading && !messagesError ? (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  <Mail className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                  <p>No messages yet</p>\n                </div>\n              ) : messagesError ? (\n                <div className=\"text-center py-8 text-red-500\">\n                  <AlertTriangle className=\"w-12 h-12 mx-auto mb-4\" />\n                  <p>Could not load messages.</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Please ensure you are logged in as an admin.\n                  </p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {messages.slice(0, 4).map((msg) => (\n                    <div\n                      key={msg.id}\n                      className=\"p-3 rounded-lg bg-muted/50 border border-border\"\n                      data-testid={`message-${msg.id}`}\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-sm font-medium truncate\">\n                            {msg.sender}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground truncate\">\n                            {msg.email}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground mt-1 line-clamp-2\">\n                            {msg.message}\n                          </p>\n                        </div>\n                        {!msg.read && (\n                          <Badge\n                            variant=\"secondary\"\n                            className=\"text-xs shrink-0\"\n                          >\n                            New\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                  <Link href=\"/admin/inbox\">\n                    <div className=\"p-3 rounded-lg bg-primary/10 border border-primary/20 text-center cursor-pointer hover:bg-primary/20 transition-colors\">\n                      <span className=\"text-xs font-medium text-primary\">\n                        View All Messages\n                      </span>\n                    </div>\n                  </Link>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":22854,"size_tokens":null},"client/src/pages/admin/settings/SettingsIntegrations.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Plug, Plus, Settings, ExternalLink, Check, X, Github, Mail, BarChart3, CreditCard, MessageSquare } from \"lucide-react\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst integrations = [\n  { \n    id: \"google_analytics\",\n    name: \"Google Analytics\", \n    description: \"Track website traffic and user behavior\", \n    icon: BarChart3,\n    configKey: \"googleAnalyticsId\" as const,\n    placeholder: \"G-XXXXXXXXXX\"\n  },\n  { \n    id: \"github\",\n    name: \"GitHub\", \n    description: \"Display repositories and contribution stats\", \n    icon: Github,\n    configKey: \"socialGithub\" as const,\n    placeholder: \"https://github.com/username\"\n  },\n  { \n    id: \"smtp\",\n    name: \"Email (SMTP)\", \n    description: \"Send contact form notifications\", \n    icon: Mail,\n    configKey: \"smtpHost\" as const,\n    placeholder: \"smtp.gmail.com\",\n    linkTo: \"email\"\n  },\n  { \n    id: \"disqus\",\n    name: \"Disqus Comments\", \n    description: \"Third-party commenting system\", \n    icon: MessageSquare,\n    configKey: \"disqusShortname\" as const,\n    placeholder: \"your-site-shortname\"\n  },\n];\n\nexport function SettingsIntegrations() {\n  const { toast } = useToast();\n  const { settings, updateSettings, saveSettings, isSaving } = useSiteSettings();\n  \n  const isConfigured = (configKey: keyof typeof settings) => {\n    return !!(settings[configKey]);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n        <div>\n          <h3 className=\"font-medium\">Third-Party Integrations</h3>\n          <p className=\"text-sm text-muted-foreground\">Connect external services to enhance your portfolio</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        {integrations.map((integration) => {\n          const configured = isConfigured(integration.configKey);\n          const Icon = integration.icon;\n          \n          return (\n            <Card key={integration.id} data-testid={`card-integration-${integration.id}`}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex gap-3\">\n                    <div className=\"p-2 bg-muted rounded-lg\">\n                      <Icon className=\"w-5 h-5\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium\">{integration.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">{integration.description}</p>\n                    </div>\n                  </div>\n                  <Badge variant={configured ? \"default\" : \"outline\"}>\n                    {configured ? (\n                      <><Check className=\"w-3 h-3 mr-1\" /> Connected</>\n                    ) : (\n                      <><X className=\"w-3 h-3 mr-1\" /> Not configured</>\n                    )}\n                  </Badge>\n                </div>\n                <div className=\"mt-4 space-y-3\">\n                  <div className=\"space-y-1\">\n                    <Label className=\"text-xs\">{integration.name} {integration.configKey.includes(\"Id\") ? \"ID\" : \"Config\"}</Label>\n                    <Input \n                      placeholder={integration.placeholder}\n                      value={String(settings[integration.configKey] || \"\")}\n                      onChange={(e) => updateSettings({ [integration.configKey]: e.target.value })}\n                      data-testid={`input-${integration.id}`}\n                    />\n                  </div>\n                  {integration.linkTo && (\n                    <p className=\"text-xs text-muted-foreground\">\n                      Configure additional settings in the {integration.linkTo.charAt(0).toUpperCase() + integration.linkTo.slice(1)} tab\n                    </p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Plug className=\"w-5 h-5\" /> Social Media Links\n          </CardTitle>\n          <CardDescription>Connect your social media profiles</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>GitHub URL</Label>\n              <Input \n                placeholder=\"https://github.com/username\"\n                value={settings.socialGithub || \"\"}\n                onChange={(e) => updateSettings({ socialGithub: e.target.value })}\n                data-testid=\"input-github-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>LinkedIn URL</Label>\n              <Input \n                placeholder=\"https://linkedin.com/in/username\"\n                value={settings.socialLinkedin || \"\"}\n                onChange={(e) => updateSettings({ socialLinkedin: e.target.value })}\n                data-testid=\"input-linkedin-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Twitter/X URL</Label>\n              <Input \n                placeholder=\"https://twitter.com/username\"\n                value={settings.socialTwitter || \"\"}\n                onChange={(e) => updateSettings({ socialTwitter: e.target.value })}\n                data-testid=\"input-twitter-url\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>YouTube URL</Label>\n              <Input \n                placeholder=\"https://youtube.com/@channel\"\n                value={settings.socialYoutube || \"\"}\n                onChange={(e) => updateSettings({ socialYoutube: e.target.value })}\n                data-testid=\"input-youtube-url\"\n              />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Webhook Notifications</CardTitle>\n          <CardDescription>Send notifications to external services when events occur</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label>Webhook URL</Label>\n            <Input \n              placeholder=\"https://hooks.slack.com/services/...\"\n              value={settings.webhookUrl || \"\"}\n              onChange={(e) => updateSettings({ webhookUrl: e.target.value })}\n              data-testid=\"input-webhook-url\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Receive notifications for new messages and comments</p>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <Label>Enable Webhook Notifications</Label>\n              <p className=\"text-xs text-muted-foreground\">Send POST requests when events occur</p>\n            </div>\n            <Switch \n              checked={settings.enableWebhook === true}\n              onCheckedChange={(checked) => updateSettings({ enableWebhook: checked })}\n              data-testid=\"switch-enable-webhook\"\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg\">\n        <p className=\"text-xs text-blue-700 dark:text-blue-400\">\n          All changes are automatically tracked and saved using the \"Save Changes\" button in the header.\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7894,"size_tokens":null},"server/api/notifications.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { insertNotificationSchema } from \"@shared/schema\";\n\nconst router = Router();\n\nrouter.get(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const userId = req.query.userId ? parseInt(req.query.userId as string) : undefined;\n    const notifications = await storage.getAllNotifications(userId);\n    res.json(notifications);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const parsed = insertNotificationSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const notification = await storage.createNotification(parsed.data);\n    res.status(201).json(notification);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/read\", requireAdmin, async (req, res) => {\n  try {\n    const success = await storage.markNotificationAsRead(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Notification not found\" });\n    }\n    res.json({ message: \"Notification marked as read\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1415,"size_tokens":null},"server/utils/password.ts":{"content":"import bcrypt from \"bcrypt\";\n\nconst SALT_ROUNDS = 12;\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, SALT_ROUNDS);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash);\n}\n","path":null,"size_bytes":307,"size_tokens":null},"server/utils/upload.ts":{"content":"import multer from \"multer\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nexport const uploadsDir = path.join(process.cwd(), \"uploads\");\n\nif (!fs.existsSync(uploadsDir)) {\n  fs.mkdirSync(uploadsDir, { recursive: true });\n}\n\nconst fileCounter: Record<string, number> = {};\n\nexport function generateCleanFilename(originalName: string, subDir: string): string {\n  const date = new Date();\n  const day = String(date.getDate()).padStart(2, '0');\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const year = date.getFullYear();\n  const dateStr = `${day}${month}${year}`;\n  \n  const ext = path.extname(originalName);\n  let baseName = path.basename(originalName, ext)\n    .replace(/[^a-zA-Z0-9]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .substring(0, 30);\n  \n  if (!baseName) baseName = 'file';\n  \n  const counterKey = `${subDir}_${baseName}_${dateStr}`;\n  fileCounter[counterKey] = (fileCounter[counterKey] || 0) + 1;\n  const counter = fileCounter[counterKey];\n  \n  return `${baseName}_${counter}_${dateStr}${ext.toLowerCase()}`;\n}\n\nexport function getSubdirectory(mimetype: string): string {\n  if (mimetype.startsWith(\"image/\")) {\n    return \"images\";\n  } else if (\n    mimetype === \"application/pdf\" ||\n    mimetype === \"application/msword\" ||\n    mimetype === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" ||\n    mimetype === \"application/vnd.ms-excel\" ||\n    mimetype === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" ||\n    mimetype === \"application/vnd.ms-powerpoint\" ||\n    mimetype === \"application/vnd.openxmlformats-officedocument.presentationml.presentation\" ||\n    mimetype === \"text/plain\"\n  ) {\n    return \"documents\";\n  }\n  return \"media\";\n}\n\nconst multerStorage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    const subDir = getSubdirectory(file.mimetype);\n    const targetDir = path.join(uploadsDir, subDir);\n    if (!fs.existsSync(targetDir)) {\n      fs.mkdirSync(targetDir, { recursive: true });\n    }\n    cb(null, targetDir);\n  },\n  filename: (req, file, cb) => {\n    const subDir = getSubdirectory(file.mimetype);\n    const cleanName = generateCleanFilename(file.originalname, subDir);\n    cb(null, cleanName);\n  }\n});\n\nexport const allowedMimeTypes = [\n  'image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/svg+xml',\n  'application/pdf',\n  'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  'application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'text/plain'\n];\n\nexport const upload = multer({\n  storage: multerStorage,\n  limits: {\n    fileSize: 50 * 1024 * 1024,\n  },\n  fileFilter: (req, file, cb) => {\n    if (allowedMimeTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error(`File type ${file.mimetype} not allowed`));\n    }\n  }\n});\n","path":null,"size_bytes":3011,"size_tokens":null},"client/src/pages/admin/pages/Editor.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Code, Play, Save, Loader2, Check, RotateCcw } from \"lucide-react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst DEFAULT_CSS = `/* Add your custom CSS here */\n\n.custom-hero-title {\n  background: linear-gradient(to right, #ff00cc, #333399);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n\n.custom-section {\n  padding: 2rem;\n}`;\n\nconst DEFAULT_JS = `// Add your custom JS here\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Your code here\n});`;\n\nconst DEFAULT_HEADER = `<!-- Google Analytics -->\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-Y\"></script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'UA-XXXXX-Y');\n</script>`;\n\nexport default function AdminEditor() {\n  const { toast } = useToast();\n  const [customCSS, setCustomCSS] = useState(DEFAULT_CSS);\n  const [customJS, setCustomJS] = useState(DEFAULT_JS);\n  const [headerScripts, setHeaderScripts] = useState(DEFAULT_HEADER);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [previewOpen, setPreviewOpen] = useState(false);\n\n  const { data: settings, isLoading } = useQuery<Record<string, any>>({\n    queryKey: ['/api/settings'],\n  });\n\n  useEffect(() => {\n    if (settings) {\n      if (settings.customCSS !== undefined) setCustomCSS(settings.customCSS || DEFAULT_CSS);\n      if (settings.customJS !== undefined) setCustomJS(settings.customJS || DEFAULT_JS);\n      if (settings.headerScripts !== undefined) setHeaderScripts(settings.headerScripts || DEFAULT_HEADER);\n    }\n  }, [settings]);\n\n  const saveMutation = useMutation({\n    mutationFn: async () => {\n      return api.updateSettings({\n        customCSS,\n        customJS,\n        headerScripts,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/settings'] });\n      setHasChanges(false);\n      toast({\n        title: \"Saved\",\n        description: \"Custom code saved successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to save custom code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCSSChange = (value: string) => {\n    setCustomCSS(value);\n    setHasChanges(true);\n  };\n\n  const handleJSChange = (value: string) => {\n    setCustomJS(value);\n    setHasChanges(true);\n  };\n\n  const handleHeaderChange = (value: string) => {\n    setHeaderScripts(value);\n    setHasChanges(true);\n  };\n\n  const handleReset = (type: 'css' | 'js' | 'header') => {\n    switch (type) {\n      case 'css':\n        setCustomCSS(DEFAULT_CSS);\n        break;\n      case 'js':\n        setCustomJS(DEFAULT_JS);\n        break;\n      case 'header':\n        setHeaderScripts(DEFAULT_HEADER);\n        break;\n    }\n    setHasChanges(true);\n  };\n\n  const handlePreview = () => {\n    const previewWindow = window.open('', '_blank');\n    if (previewWindow) {\n      previewWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Preview</title>\n          ${headerScripts}\n          <style>\n            body { font-family: system-ui, sans-serif; padding: 2rem; background: #1a1a2e; color: #fff; }\n            ${customCSS}\n          </style>\n        </head>\n        <body>\n          <h1 class=\"custom-hero-title\">Custom CSS Preview</h1>\n          <div class=\"custom-section\">\n            <p>This is a preview of your custom styles.</p>\n          </div>\n          <script>\n            ${customJS}\n          </script>\n        </body>\n        </html>\n      `);\n      previewWindow.document.close();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6 h-[calc(100vh-8rem)] flex flex-col\">\n        <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"text-editor-title\">Code Editor</h1>\n            <p className=\"text-muted-foreground\">Customize your site's code directly</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handlePreview} data-testid=\"button-preview\">\n              <Play className=\"w-4 h-4 mr-2\" /> Preview\n            </Button>\n            <Button \n              onClick={() => saveMutation.mutate()}\n              disabled={saveMutation.isPending || !hasChanges}\n              data-testid=\"button-save\"\n            >\n              {saveMutation.isPending ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : hasChanges ? (\n                <Save className=\"w-4 h-4 mr-2\" />\n              ) : (\n                <Check className=\"w-4 h-4 mr-2\" />\n              )}\n              {saveMutation.isPending ? \"Saving...\" : hasChanges ? \"Save Changes\" : \"Saved\"}\n            </Button>\n          </div>\n        </div>\n\n        <Tabs defaultValue=\"css\" className=\"flex-1 flex flex-col\">\n          <TabsList>\n            <TabsTrigger value=\"css\" data-testid=\"tab-css\">Custom CSS</TabsTrigger>\n            <TabsTrigger value=\"js\" data-testid=\"tab-js\">Custom JS</TabsTrigger>\n            <TabsTrigger value=\"header\" data-testid=\"tab-header\">Header Scripts</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"css\" className=\"flex-1 mt-4\">\n            <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <CardTitle className=\"text-sm font-mono\">style.css</CardTitle>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('css')}\n                  data-testid=\"button-reset-css\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={customCSS}\n                  onChange={(e) => handleCSSChange(e.target.value)}\n                  placeholder=\"/* Enter your custom CSS here */\"\n                  spellCheck={false}\n                  data-testid=\"textarea-css\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          <TabsContent value=\"js\" className=\"flex-1 mt-4\">\n            <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <CardTitle className=\"text-sm font-mono\">script.js</CardTitle>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('js')}\n                  data-testid=\"button-reset-js\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={customJS}\n                  onChange={(e) => handleJSChange(e.target.value)}\n                  placeholder=\"// Enter your custom JavaScript here\"\n                  spellCheck={false}\n                  data-testid=\"textarea-js\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"header\" className=\"flex-1 mt-4\">\n             <Card className=\"h-full flex flex-col\">\n              <CardHeader className=\"py-3 border-b border-border flex flex-row items-center justify-between gap-2\">\n                <div>\n                  <CardTitle className=\"text-sm font-mono\">head-scripts.html</CardTitle>\n                  <CardDescription>Google Analytics, Meta Tags, etc.</CardDescription>\n                </div>\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={() => handleReset('header')}\n                  data-testid=\"button-reset-header\"\n                >\n                  <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-0 flex-1 bg-[#1e1e1e]\">\n                <textarea \n                  className=\"w-full h-full min-h-[400px] bg-transparent text-white font-mono text-sm p-4 focus:outline-none resize-none\"\n                  value={headerScripts}\n                  onChange={(e) => handleHeaderChange(e.target.value)}\n                  placeholder=\"<!-- Enter your header scripts here -->\"\n                  spellCheck={false}\n                  data-testid=\"textarea-header\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9842,"size_tokens":null},"client/src/pages/admin/settings/SettingsEnhanced.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Save,\n  Upload,\n  Mail,\n  Database,\n  Zap,\n  Key,\n  Plug,\n  Bell,\n  Code2,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  Clock,\n  Globe,\n  DollarSign,\n  Hash,\n  Languages,\n  HardDrive,\n  RefreshCw,\n  Download,\n  Trash2,\n  Terminal,\n  Bug,\n  Gauge,\n  Server,\n  X,\n  ImageIcon,\n  Eye,\n  EyeOff,\n  Loader2,\n} from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { SettingsPerformance } from \"./SettingsPerformance\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { StorageTab } from \"@/components/admin/StorageTab\";\nimport { DatabaseTab } from \"@/components/admin/DatabaseTab\";\nimport { useSiteSettings } from \"@/context/SiteContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\n\ninterface EmailTemplate {\n  subject: string;\n  body: string;\n}\n\nexport default function AdminSettingsEnhanced() {\n  const [logoFile, setLogoFile] = useState<string | null>(null);\n  const [profileImageUploading, setProfileImageUploading] = useState(false);\n  const [cvFileUploading, setCVFileUploading] = useState(false);\n  const [brandingUploading, setBrandingUploading] = useState(false);\n  const [showSmtpPassword, setShowSmtpPassword] = useState(false);\n  const [editingTemplate, setEditingTemplate] = useState<string | null>(null);\n  const [templateSubject, setTemplateSubject] = useState(\"\");\n  const [templateBody, setTemplateBody] = useState(\"\");\n  const profileImageInputRef = useRef<HTMLInputElement>(null);\n  const cvFileInputRef = useRef<HTMLInputElement>(null);\n  const { settings, updateSettings, saveSettings, isSaving } =\n    useSiteSettings();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch email templates with TanStack Query\n  const { data: emailTemplates = {}, isLoading: templatesLoading } = useQuery({\n    queryKey: ['/api/email/templates'],\n    queryFn: () => api.getEmailTemplates()\n  });\n\n  // Mutation for updating email templates\n  const updateTemplateMutation = useMutation({\n    mutationFn: ({ name, data }: { name: string; data: { subject: string; body: string } }) =>\n      api.updateEmailTemplate(name, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/email/templates'] });\n      toast({ title: \"Success\", description: \"Email template saved successfully\" });\n      setEditingTemplate(null);\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    }\n  });\n\n  const openTemplateEditor = (templateName: string) => {\n    const template = emailTemplates[templateName];\n    if (template) {\n      setTemplateSubject(template.subject);\n      setTemplateBody(template.body);\n    } else {\n      setTemplateSubject(\"\");\n      setTemplateBody(\"\");\n    }\n    setEditingTemplate(templateName);\n  };\n\n  const saveTemplate = () => {\n    if (!editingTemplate) return;\n    updateTemplateMutation.mutate({\n      name: editingTemplate,\n      data: { subject: templateSubject, body: templateBody }\n    });\n  };\n\n  const templateLabels: Record<string, string> = {\n    welcome: \"Welcome Email\",\n    notification: \"Notification Email\",\n    newsletter: \"Newsletter Template\",\n    contact: \"Contact Form Email\",\n    comment: \"Comment Notification\"\n  };\n\n  const handleBrandingUpload = async (\n    file: File,\n    settingKey: \"logoUrl\" | \"faviconUrl\"\n  ) => {\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setBrandingUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n\n      const response = await fetch(\"/api/storage/upload\", {\n        method: \"POST\",\n        body: formData,\n        credentials: \"include\",\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(errorText || \"Upload failed\");\n      }\n\n      const data = await response.json();\n      updateSettings({ [settingKey]: data.url });\n      toast({\n        title: \"Success\",\n        description: \"Image uploaded successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setBrandingUploading(false);\n    }\n  };\n\n  const handleProfileImageUpload = async (\n    e: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_IMAGE_SIZE = 5 * 1024 * 1024; // 5MB\n    if (!file.type.startsWith(\"image/\")) {\n      toast({\n        title: \"Error\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_IMAGE_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 5MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setProfileImageUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ aboutImage: base64 });\n        toast({ title: \"Success\", description: `Image uploaded successfully (${(file.size / 1024).toFixed(2)}KB)` });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload image\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setProfileImageUploading(false);\n    }\n  };\n\n  const handleCVFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const MAX_PDF_SIZE = 10 * 1024 * 1024; // 10MB\n    if (file.type !== \"application/pdf\") {\n      toast({\n        title: \"Error\",\n        description: \"Please select a PDF file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (file.size > MAX_PDF_SIZE) {\n      toast({\n        title: \"Error\",\n        description: `File size exceeds 10MB limit (${(file.size / 1024 / 1024).toFixed(2)}MB)`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setCVFileUploading(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (event) => {\n        const base64 = event.target?.result as string;\n        updateSettings({ cvFileUrl: base64 });\n        toast({\n          title: \"Success\",\n          description: `CV file uploaded successfully (${(file.size / 1024).toFixed(2)}KB)`,\n        });\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to upload CV file\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setCVFileUploading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    console.log(\"handleSave called with current settings:\", settings);\n    const result = await saveSettings();\n    console.log(\"Save result:\", result);\n    if (result?.success) {\n      toast({ \n        title: \"ThÃ nh cÃ´ng âœ“\", \n        description: \"CÃ i Ä‘áº·t Ä‘Æ°á»£c lÆ°u thÃ nh cÃ´ng\" \n      });\n    } else {\n      toast({\n        title: \"Lá»—i\",\n        description: result?.error || \"KhÃ´ng thá»ƒ lÆ°u cÃ i Ä‘áº·t\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Settings</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your website configuration\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary hover:bg-primary/90\"\n            onClick={handleSave}\n            disabled={isSaving}\n          >\n            {isSaving ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              <>\n                <Save className=\"w-4 h-4 mr-2\" />\n                Save Changes\n              </>\n            )}\n          </Button>\n        </div>\n\n        <Tabs defaultValue=\"general\" className=\"space-y-6\">\n          <div className=\"w-full overflow-x-auto\">\n            <TabsList className=\"inline-flex gap-1 h-auto p-1 min-w-full\">\n              <TabsTrigger value=\"general\">General</TabsTrigger>\n              <TabsTrigger value=\"branding\">Branding</TabsTrigger>\n              <TabsTrigger value=\"seo\">SEO</TabsTrigger>\n              <TabsTrigger value=\"email\">Email</TabsTrigger>\n              <TabsTrigger value=\"storage\">Storage</TabsTrigger>\n              <TabsTrigger value=\"performance\">Performance</TabsTrigger>\n              <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\n              <TabsTrigger value=\"developer\">Developer</TabsTrigger>\n              <TabsTrigger value=\"localization\">Localization</TabsTrigger>\n              <TabsTrigger value=\"database\">Database</TabsTrigger>\n            </TabsList>\n          </div>\n\n          {/* GENERAL TAB */}\n          <TabsContent value=\"general\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Site Information</CardTitle>\n                <CardDescription>\n                  Basic information about your portfolio website.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Site Title (Homepage & Admin)</Label>\n                  <Input\n                    value={settings.siteTitle}\n                    onChange={(e) =>\n                      updateSettings({ siteTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Loi Developer - Full-stack Creative\"\n                    data-testid=\"input-site-title\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Appears in browser tab and header\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Tagline</Label>\n                  <Input\n                    value={settings.tagline}\n                    onChange={(e) =>\n                      updateSettings({ tagline: e.target.value })\n                    }\n                    placeholder=\"e.g., Building digital experiences with code.\"\n                    data-testid=\"input-tagline\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle>Hero Section</CardTitle>\n                <CardDescription>\n                  Main heading and call-to-action on homepage.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Hero Title</Label>\n                  <Input\n                    value={settings.heroTitle}\n                    onChange={(e) =>\n                      updateSettings({ heroTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Hello, I'm Loi Developer\"\n                    data-testid=\"input-hero-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Hero Subtitle</Label>\n                  <Textarea\n                    value={settings.heroSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ heroSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer | UI/UX Enthusiast\"\n                    rows={2}\n                    data-testid=\"input-hero-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>View Projects CTA Button Text</Label>\n                  <Input\n                    value={settings.heroCTA}\n                    onChange={(e) =>\n                      updateSettings({ heroCTA: e.target.value })\n                    }\n                    placeholder=\"e.g., View My Work\"\n                    data-testid=\"input-hero-cta\"\n                  />\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label className=\"text-base font-semibold\">\n                    CV File Management\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Upload a PDF or paste a link for your CV Download button\n                  </p>\n                  {settings.cvFileUrl && (\n                    <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-muted/50\">\n                      <div className=\"flex items-center gap-2 min-w-0\">\n                        <FileText className=\"w-4 h-4 flex-shrink-0 text-primary\" />\n                        <span\n                          className=\"text-sm font-medium truncate\"\n                          data-testid=\"text-cv-file-name\"\n                        >\n                          {settings.cvFileUrl.startsWith(\"data:\")\n                            ? \"CV.pdf\"\n                            : settings.cvFileUrl.split(\"/\").pop() || \"CV file\"}\n                        </span>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={() => updateSettings({ cvFileUrl: \"\" })}\n                        data-testid=\"button-remove-cv\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  )}\n                  {!settings.cvFileUrl && (\n                    <div className=\"border-2 border-dashed rounded-lg p-4 text-center hover:bg-muted/50 transition-colors\">\n                      <FileText className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                      <p className=\"text-sm text-muted-foreground mb-3\">\n                        No CV uploaded\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mb-2\">\n                        Upload from device or paste a PDF link\n                      </p>\n                    </div>\n                  )}\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => cvFileInputRef.current?.click()}\n                      disabled={cvFileUploading}\n                      data-testid=\"button-upload-cv\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />{\" \"}\n                      {cvFileUploading ? \"Uploading...\" : \"Upload PDF\"}\n                    </Button>\n                    <input\n                      ref={cvFileInputRef}\n                      type=\"file\"\n                      accept=\".pdf,application/pdf\"\n                      onChange={handleCVFileUpload}\n                      className=\"hidden\"\n                      data-testid=\"input-cv-file-upload\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or Paste PDF URL</Label>\n                    <Input\n                      value={settings.cvFileUrl}\n                      onChange={(e) =>\n                        updateSettings({ cvFileUrl: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/CV.pdf or /uploads/CV.pdf\"\n                      data-testid=\"input-cv-file-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Paste a direct link to your CV PDF file\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>About Me Section</CardTitle>\n                <CardDescription>\n                  Complete information about yourself with professional\n                  formatting.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.aboutTitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., About Me\"\n                    data-testid=\"input-about-title\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Profile Image</Label>\n                  <div className=\"flex flex-col gap-3\">\n                    {settings.aboutImage && (\n                      <div className=\"relative w-full max-w-xs\">\n                        <img\n                          src={settings.aboutImage}\n                          alt=\"Profile preview\"\n                          className=\"w-full h-64 object-cover rounded-lg border border-border\"\n                        />\n                        <Button\n                          size=\"icon\"\n                          variant=\"destructive\"\n                          className=\"absolute top-2 right-2\"\n                          onClick={() => updateSettings({ aboutImage: \"\" })}\n                          data-testid=\"button-remove-profile-image\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    )}\n                    {!settings.aboutImage && (\n                      <div className=\"border-2 border-dashed rounded-lg p-8 text-center hover:bg-muted/50 transition-colors\">\n                        <ImageIcon className=\"w-8 h-8 mx-auto mb-2 text-muted-foreground\" />\n                        <p className=\"text-sm text-muted-foreground mb-3\">\n                          No image selected\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => profileImageInputRef.current?.click()}\n                      disabled={profileImageUploading}\n                      data-testid=\"button-upload-profile-image\"\n                    >\n                      <Upload className=\"w-4 h-4 mr-2\" />\n                      Upload Image\n                    </Button>\n                    <input\n                      ref={profileImageInputRef}\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      onChange={handleProfileImageUpload}\n                      data-testid=\"input-profile-image-file\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label className=\"text-sm\">Or paste image URL</Label>\n                    <Input\n                      value={settings.aboutImage}\n                      onChange={(e) =>\n                        updateSettings({ aboutImage: e.target.value })\n                      }\n                      placeholder=\"e.g., https://example.com/image.jpg or /uploads/profile.jpg\"\n                      data-testid=\"input-about-image-url\"\n                    />\n                    <p className=\"text-xs text-muted-foreground\">\n                      Supports any image format (JPG, PNG, GIF, WebP, etc.)\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Your Name</Label>\n                  <Input\n                    value={settings.aboutName}\n                    onChange={(e) =>\n                      updateSettings({ aboutName: e.target.value })\n                    }\n                    placeholder=\"e.g., Nguyen Thanh Loi\"\n                    data-testid=\"input-about-name\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From (Location)</Label>\n                    <Input\n                      value={settings.aboutLocation}\n                      onChange={(e) =>\n                        updateSettings({ aboutLocation: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City\"\n                      data-testid=\"input-about-location\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Freelance Status</Label>\n                    <Input\n                      value={settings.aboutFreelance}\n                      onChange={(e) =>\n                        updateSettings({ aboutFreelance: e.target.value })\n                      }\n                      placeholder=\"e.g., Available\"\n                      data-testid=\"input-about-freelance\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Subtitle</Label>\n                  <Input\n                    value={settings.aboutSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ aboutSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Full-stack Developer based in Vietnam\"\n                    data-testid=\"input-about-subtitle\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>First Paragraph (Description)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use the rich text editor to format your content with\n                    headings, lists, links, and more.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription: value })\n                    }\n                    placeholder=\"Write your first paragraph about yourself...\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Second Paragraph (Philosophy/Additional Info)</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Add your philosophy or additional information in the second\n                    paragraph.\n                  </p>\n                  <RichTextEditor\n                    value={settings.aboutDescription2}\n                    onChange={(value) =>\n                      updateSettings({ aboutDescription2: value })\n                    }\n                    placeholder=\"Write your philosophy or additional information...\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Contact Section</CardTitle>\n                <CardDescription>\n                  Contact form and information display.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Section Title</Label>\n                  <Input\n                    value={settings.contactTitle}\n                    onChange={(e) =>\n                      updateSettings({ contactTitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Let's Talk\"\n                    data-testid=\"input-contact-title\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Section Subtitle</Label>\n                  <Textarea\n                    value={settings.contactSubtitle}\n                    onChange={(e) =>\n                      updateSettings({ contactSubtitle: e.target.value })\n                    }\n                    placeholder=\"e.g., Have a project in mind?\"\n                    rows={2}\n                    data-testid=\"input-contact-subtitle\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Contact Email</Label>\n                  <Input\n                    type=\"email\"\n                    value={settings.contactEmail}\n                    onChange={(e) =>\n                      updateSettings({ contactEmail: e.target.value })\n                    }\n                    placeholder=\"e.g., hello@example.com\"\n                    data-testid=\"input-contact-email\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    This email is used in both About and Contact sections\n                  </p>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Phone Number</Label>\n                    <Input\n                      value={settings.contactPhone}\n                      onChange={(e) =>\n                        updateSettings({ contactPhone: e.target.value })\n                      }\n                      placeholder=\"e.g., +84 123 456 789\"\n                      data-testid=\"input-contact-phone\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Address</Label>\n                    <Input\n                      value={settings.contactAddress}\n                      onChange={(e) =>\n                        updateSettings({ contactAddress: e.target.value })\n                      }\n                      placeholder=\"e.g., Ho Chi Minh City, Vietnam\"\n                      data-testid=\"input-contact-address\"\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Social Media Links (Follow Me)</CardTitle>\n                <CardDescription>\n                  Add your social media profiles.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"space-y-2\">\n                  <Label>Facebook URL</Label>\n                  <Input\n                    value={settings.socialFacebook}\n                    onChange={(e) =>\n                      updateSettings({ socialFacebook: e.target.value })\n                    }\n                    placeholder=\"https://facebook.com/username\"\n                    data-testid=\"input-social-facebook\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter/X URL</Label>\n                  <Input\n                    value={settings.socialTwitter}\n                    onChange={(e) =>\n                      updateSettings({ socialTwitter: e.target.value })\n                    }\n                    placeholder=\"https://twitter.com/username\"\n                    data-testid=\"input-social-twitter\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Instagram URL</Label>\n                  <Input\n                    value={settings.socialInstagram}\n                    onChange={(e) =>\n                      updateSettings({ socialInstagram: e.target.value })\n                    }\n                    placeholder=\"https://instagram.com/username\"\n                    data-testid=\"input-social-instagram\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>LinkedIn URL</Label>\n                  <Input\n                    value={settings.socialLinkedin}\n                    onChange={(e) =>\n                      updateSettings({ socialLinkedin: e.target.value })\n                    }\n                    placeholder=\"https://linkedin.com/in/username\"\n                    data-testid=\"input-social-linkedin\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>GitHub URL</Label>\n                  <Input\n                    value={settings.socialGithub}\n                    onChange={(e) =>\n                      updateSettings({ socialGithub: e.target.value })\n                    }\n                    placeholder=\"https://github.com/username\"\n                    data-testid=\"input-social-github\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>YouTube URL</Label>\n                  <Input\n                    value={settings.socialYoutube}\n                    onChange={(e) =>\n                      updateSettings({ socialYoutube: e.target.value })\n                    }\n                    placeholder=\"https://youtube.com/@username\"\n                    data-testid=\"input-social-youtube\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Footer</CardTitle>\n                <CardDescription>\n                  Footer content and copyright information.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Footer Text</Label>\n                  <Input\n                    value={settings.footerText}\n                    onChange={(e) =>\n                      updateSettings({ footerText: e.target.value })\n                    }\n                    placeholder=\"e.g., Crafted with love & countless cups of coffee\"\n                    data-testid=\"input-footer-text\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Copyright Notice</Label>\n                  <Input\n                    value={settings.footerCopyright}\n                    onChange={(e) =>\n                      updateSettings({ footerCopyright: e.target.value })\n                    }\n                    placeholder=\"e.g., 2024 Loi Developer. All rights reserved.\"\n                    data-testid=\"input-footer-copyright\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Maintenance Mode</CardTitle>\n                <CardDescription>\n                  Temporarily disable access to the public site.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex items-center justify-between\">\n                <div className=\"space-y-0.5\">\n                  <Label>Enable Maintenance Mode</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Visitors will see a \"Coming Soon\" page.\n                  </p>\n                </div>\n                <Switch\n                  checked={settings.maintenanceMode}\n                  onCheckedChange={(checked) =>\n                    updateSettings({ maintenanceMode: checked })\n                  }\n                  data-testid=\"toggle-maintenance-mode\"\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* BRANDING TAB */}\n          <TabsContent value=\"branding\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Logo & Favicon</CardTitle>\n                <CardDescription>\n                  Upload your site logo and favicon from the uploads folder.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"logo-upload\">Site Logo</Label>\n                  <div\n                    className=\"border-2 border-dashed rounded-lg p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-accent/50 transition\"\n                    onClick={() => {\n                      const input = document.getElementById(\"logo-upload\") as HTMLInputElement;\n                      input?.click();\n                    }}\n                  >\n                    <input\n                      id=\"logo-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"logoUrl\");\n                        }\n                      }}\n                      data-testid=\"input-logo-upload\"\n                    />\n                    {settings.logoUrl ? (\n                      <div className=\"flex flex-col items-center gap-2\">\n                        <img\n                          src={settings.logoUrl}\n                          alt=\"Logo\"\n                          className=\"h-12 w-auto\"\n                        />\n                        <p className=\"text-xs text-muted-foreground\">\n                          {brandingUploading ? \"Uploading...\" : \"Click to replace\"}\n                        </p>\n                      </div>\n                    ) : (\n                      <>\n                        <Upload className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                        <p className=\"text-sm font-medium\">\n                          Drop image or click to upload\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          PNG, SVG, JPG (Max 2MB)\n                        </p>\n                      </>\n                    )}\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-3\">\n                  <Label htmlFor=\"favicon-upload\">Favicon</Label>\n                  <div className=\"flex gap-2\">\n                    <div className=\"w-16 h-16 rounded-lg border border-border flex items-center justify-center bg-muted overflow-hidden\">\n                      {settings.faviconUrl ? (\n                        <img\n                          src={settings.faviconUrl}\n                          alt=\"Favicon\"\n                          className=\"w-full h-full object-cover\"\n                        />\n                      ) : (\n                        <span className=\"text-2xl\">âœ¨</span>\n                      )}\n                    </div>\n                    <input\n                      id=\"favicon-upload\"\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      disabled={brandingUploading}\n                      onChange={(e) => {\n                        const file = e.target.files?.[0];\n                        if (file) {\n                          handleBrandingUpload(file, \"faviconUrl\");\n                        }\n                      }}\n                      data-testid=\"input-favicon-upload\"\n                    />\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      disabled={brandingUploading}\n                      onClick={() => {\n                        const input = document.getElementById(\"favicon-upload\") as HTMLInputElement;\n                        input?.click();\n                      }}\n                    >\n                      {brandingUploading\n                        ? \"Uploading...\"\n                        : settings.faviconUrl\n                          ? \"Change Favicon\"\n                          : \"Upload Favicon\"}\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* SEO TAB */}\n          <TabsContent value=\"seo\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>SEO Configuration</CardTitle>\n                <CardDescription>\n                  Optimize your site for search engines.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Meta Description (Default)</Label>\n                  <Input\n                    placeholder=\"Describe your website...\"\n                    value={settings.metaDescription || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaDescription: e.target.value })\n                    }\n                    data-testid=\"input-meta-description\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Keywords</Label>\n                  <Input\n                    placeholder=\"web development, full-stack, react, node.js\"\n                    value={settings.metaKeywords || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ metaKeywords: e.target.value })\n                    }\n                    data-testid=\"input-meta-keywords\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Google Analytics ID</Label>\n                  <Input\n                    placeholder=\"G-XXXXXXXXXX or UA-XXXXXXXXX-X\"\n                    value={settings.googleAnalyticsId || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ googleAnalyticsId: e.target.value })\n                    }\n                    data-testid=\"input-google-analytics\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Open Graph & Twitter Cards</CardTitle>\n                <CardDescription>\n                  Control how your site appears on social media.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Open Graph Image URL</Label>\n                  <Input\n                    placeholder=\"https://example.com/og-image.png\"\n                    value={settings.ogImageUrl || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ ogImageUrl: e.target.value })\n                    }\n                    data-testid=\"input-og-image\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Twitter Card Type</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.twitterCardType || \"summary_large_image\"}\n                    onChange={(e) =>\n                      updateSettings({ twitterCardType: e.target.value })\n                    }\n                    data-testid=\"select-twitter-card\"\n                  >\n                    <option value=\"summary_large_image\">\n                      summary_large_image\n                    </option>\n                    <option value=\"summary\">summary</option>\n                    <option value=\"app\">app</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Robots.txt & Sitemap</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-edit-robots\"\n                >\n                  Edit robots.txt\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full justify-start\"\n                  data-testid=\"button-regenerate-sitemap\"\n                >\n                  Regenerate Sitemap\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* EMAIL TAB */}\n          <TabsContent value=\"email\" className=\"space-y-4\">\n            <Card className=\"border-amber-500/20 bg-amber-500/5\">\n              <CardContent className=\"flex items-center gap-3 py-3\">\n                <AlertCircle className=\"w-5 h-5 text-amber-500\" />\n                <div>\n                  <p className=\"text-sm font-medium\">Configuration Required</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    SMTP settings are saved but email sending requires a mail\n                    server integration.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-5 h-5\" /> SMTP Configuration\n                </CardTitle>\n                <CardDescription>\n                  Configure email settings for notifications and newsletters.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>From Name</Label>\n                    <Input\n                      placeholder=\"Loi Developer\"\n                      value={settings.emailFromName || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromName: e.target.value })\n                      }\n                      data-testid=\"input-email-from-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>From Email Address</Label>\n                    <Input\n                      placeholder=\"noreply@example.com\"\n                      value={settings.emailFromAddress || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ emailFromAddress: e.target.value })\n                      }\n                      data-testid=\"input-email-from-address\"\n                    />\n                  </div>\n                </div>\n                <Separator />\n                <div className=\"space-y-2\">\n                  <Label>SMTP Host</Label>\n                  <Input\n                    placeholder=\"smtp.gmail.com\"\n                    value={settings.smtpHost || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ smtpHost: e.target.value })\n                    }\n                    data-testid=\"input-smtp-host\"\n                  />\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>SMTP Port</Label>\n                    <Input\n                      placeholder=\"587\"\n                      value={settings.smtpPort || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPort: e.target.value })\n                      }\n                      data-testid=\"input-smtp-port\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>SMTP User</Label>\n                    <Input\n                      placeholder=\"your-email@gmail.com\"\n                      value={settings.smtpUser || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpUser: e.target.value })\n                      }\n                      data-testid=\"input-smtp-user\"\n                    />\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>SMTP Password</Label>\n                  <div className=\"flex gap-2\">\n                    <Input\n                      type={showSmtpPassword ? \"text\" : \"password\"}\n                      placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                      value={settings.smtpPassword || \"\"}\n                      onChange={(e) =>\n                        updateSettings({ smtpPassword: e.target.value })\n                      }\n                      data-testid=\"input-smtp-password\"\n                    />\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      onClick={() => setShowSmtpPassword(!showSmtpPassword)}\n                      data-testid=\"button-toggle-smtp-password\"\n                    >\n                      {showSmtpPassword ? (\n                        <EyeOff className=\"w-4 h-4\" />\n                      ) : (\n                        <Eye className=\"w-4 h-4\" />\n                      )}\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Use TLS/SSL</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Encrypt email transmission\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.smtpSecure ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ smtpSecure: checked })\n                    }\n                    data-testid=\"switch-smtp-secure\"\n                  />\n                </div>\n                <Button\n                  variant=\"outline\"\n                  className=\"w-full\"\n                  data-testid=\"button-test-email\"\n                  onClick={async () => {\n                    try {\n                      const testEmail = prompt(\"Enter email address to send test email to:\");\n                      if (!testEmail) return;\n                      \n                      await api.sendTestEmail({\n                        to: testEmail,\n                        subject: \"Test Email from Portfolio\",\n                        body: \"<h1>Test Email</h1><p>This is a test email from your portfolio admin panel.</p>\"\n                      });\n                      \n                      toast({\n                        title: \"Success\",\n                        description: \"Test email sent successfully\"\n                      });\n                    } catch (error: any) {\n                      toast({\n                        title: \"Error\",\n                        description: error.message || \"Failed to send test email\",\n                        variant: \"destructive\"\n                      });\n                    }\n                  }}\n                >\n                  <Mail className=\"w-4 h-4 mr-2\" /> Send Test Email\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Email Templates</CardTitle>\n                <CardDescription>\n                  Customize email templates for different notifications. Use placeholders like {\"{{siteName}}\"}, {\"{{userName}}\"}, {\"{{date}}\"} etc.\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                {templatesLoading ? (\n                  <div className=\"text-center py-4 text-muted-foreground\">Loading templates...</div>\n                ) : (\n                  Object.entries(templateLabels).map(([key, label]) => (\n                    <Button\n                      key={key}\n                      variant=\"outline\"\n                      className=\"w-full justify-start\"\n                      onClick={() => openTemplateEditor(key)}\n                      data-testid={`button-edit-${key}-email`}\n                    >\n                      <FileText className=\"w-4 h-4 mr-2\" />\n                      {label}\n                      {emailTemplates[key] && (\n                        <Badge variant=\"secondary\" className=\"ml-auto\">Configured</Badge>\n                      )}\n                    </Button>\n                  ))\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Email Template Editor Dialog */}\n            <Dialog open={!!editingTemplate} onOpenChange={(open) => !open && setEditingTemplate(null)}>\n              <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>Edit {editingTemplate && templateLabels[editingTemplate]}</DialogTitle>\n                  <DialogDescription>\n                    Customize the email template. Use placeholders that will be replaced with actual values.\n                  </DialogDescription>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Subject</Label>\n                    <Input\n                      value={templateSubject}\n                      onChange={(e) => setTemplateSubject(e.target.value)}\n                      placeholder=\"Email subject...\"\n                      data-testid=\"input-template-subject\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Body (HTML)</Label>\n                    <Textarea\n                      value={templateBody}\n                      onChange={(e) => setTemplateBody(e.target.value)}\n                      placeholder=\"<h1>Hello {{userName}}</h1>...\"\n                      className=\"min-h-[300px] font-mono text-sm\"\n                      data-testid=\"input-template-body\"\n                    />\n                  </div>\n                  <div className=\"bg-muted p-3 rounded-lg\">\n                    <p className=\"text-sm font-medium mb-2\">Available Placeholders:</p>\n                    <div className=\"flex flex-wrap gap-2 text-xs\">\n                      <Badge variant=\"outline\">{\"{{siteName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{userName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{date}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderName}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{senderEmail}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{messageContent}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{postTitle}}\"}</Badge>\n                      <Badge variant=\"outline\">{\"{{commentContent}}\"}</Badge>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2 justify-end\">\n                    <Button variant=\"outline\" onClick={() => setEditingTemplate(null)}>\n                      Cancel\n                    </Button>\n                    <Button onClick={saveTemplate} disabled={updateTemplateMutation.isPending}>\n                      {updateTemplateMutation.isPending ? \"Saving...\" : \"Save Template\"}\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          </TabsContent>\n\n          {/* STORAGE TAB */}\n          <TabsContent value=\"storage\" className=\"space-y-4\">\n            <StorageTab />\n          </TabsContent>\n\n          {/* PERFORMANCE TAB */}\n          <TabsContent value=\"performance\" className=\"space-y-4\">\n            <SettingsPerformance />\n          </TabsContent>\n\n          {/* NOTIFICATIONS & ALERTS TAB */}\n          <TabsContent value=\"notifications\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Notification preferences are saved. Email notifications require SMTP configuration in the Email tab.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bell className=\"w-5 h-5\" /> Notification Preferences\n                </CardTitle>\n                <CardDescription>\n                  Configure how and when you receive notifications\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Email Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          New contact form submissions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Receive email when someone contacts you\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewContact ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewContact: checked })\n                        }\n                        data-testid=\"switch-notify-contact\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">New comments</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Get notified when comments are posted\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewComment ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewComment: checked })\n                        }\n                        data-testid=\"switch-notify-comment\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Security alerts</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Important security-related notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifySecurityAlert ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifySecurityAlert: checked })\n                        }\n                        data-testid=\"switch-notify-security\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Newsletter subscriptions\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          When new users subscribe\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyNewsletter ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyNewsletter: checked })\n                        }\n                        data-testid=\"switch-notify-newsletter\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Weekly analytics summary\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Weekly report of site performance\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.emailNotifyWeeklySummary ?? true}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ emailNotifyWeeklySummary: checked })\n                        }\n                        data-testid=\"switch-notify-weekly\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Push Notifications</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">\n                          Browser notifications\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Show desktop notifications\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyBrowser ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyBrowser: checked })\n                        }\n                        data-testid=\"switch-push-browser\"\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-sm\">Mobile push</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Send to mobile devices\n                        </p>\n                      </div>\n                      <Switch\n                        checked={settings.pushNotifyMobile ?? false}\n                        onCheckedChange={(checked) =>\n                          updateSettings({ pushNotifyMobile: checked })\n                        }\n                        data-testid=\"switch-push-mobile\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Channel Priority & Routing</CardTitle>\n                <CardDescription>\n                  Configure notification delivery channels and priority\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  {[\n                    {\n                      channel: \"Email\",\n                      priority: 1,\n                      enabled: true,\n                      desc: \"Primary notification channel\",\n                    },\n                    {\n                      channel: \"Browser Push\",\n                      priority: 2,\n                      enabled: false,\n                      desc: \"Desktop notifications\",\n                    },\n                    {\n                      channel: \"SMS\",\n                      priority: 3,\n                      enabled: false,\n                      desc: \"Text messages for critical alerts\",\n                    },\n                    {\n                      channel: \"Slack\",\n                      priority: 4,\n                      enabled: true,\n                      desc: \"Team notifications\",\n                    },\n                    {\n                      channel: \"Discord\",\n                      priority: 5,\n                      enabled: true,\n                      desc: \"Community updates\",\n                    },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-xs font-bold\">\n                          {item.priority}\n                        </div>\n                        <div>\n                          <p className=\"font-medium text-sm\">{item.channel}</p>\n                          <p className=\"text-xs text-muted-foreground\">\n                            {item.desc}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†‘\n                        </Button>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          â†“\n                        </Button>\n                        <Switch defaultChecked={item.enabled} />\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-muted/50\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Fallback Routing</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Try next channel if delivery fails\n                    </p>\n                  </div>\n                  <Switch defaultChecked />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Alert Thresholds</CardTitle>\n                <CardDescription>\n                  Set triggers for automatic alerts\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Storage Usage Alert (%)</Label>\n                    <Input type=\"number\" defaultValue=\"80\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Failed Login Attempts</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Error Rate Threshold (%)</Label>\n                    <Input type=\"number\" defaultValue=\"5\" />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Response Time (ms)</Label>\n                    <Input type=\"number\" defaultValue=\"3000\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification History</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {[\n                  {\n                    message: \"Storage usage reached 75%\",\n                    time: \"2 hours ago\",\n                    type: \"warning\",\n                  },\n                  {\n                    message: \"Weekly backup completed successfully\",\n                    time: \"Yesterday\",\n                    type: \"success\",\n                  },\n                  {\n                    message: \"3 failed login attempts detected\",\n                    time: \"2 days ago\",\n                    type: \"error\",\n                  },\n                ].map((notif, i) => (\n                  <div\n                    key={i}\n                    className=\"flex items-center gap-3 p-3 border rounded-lg\"\n                  >\n                    {notif.type === \"warning\" && (\n                      <AlertCircle className=\"w-5 h-5 text-yellow-500\" />\n                    )}\n                    {notif.type === \"success\" && (\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                    )}\n                    {notif.type === \"error\" && (\n                      <AlertCircle className=\"w-5 h-5 text-red-500\" />\n                    )}\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm\">{notif.message}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {notif.time}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DEVELOPER SETTINGS TAB */}\n          <TabsContent value=\"developer\" className=\"space-y-4\">\n            <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/30 flex items-start gap-2\">\n              <AlertCircle className=\"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm\">\n                <p className=\"font-medium text-blue-700 dark:text-blue-400\">Settings Only</p>\n                <p className=\"text-muted-foreground text-xs\">Developer settings are saved to database. Actual logic application requires backend implementation.</p>\n              </div>\n            </div>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bug className=\"w-5 h-5\" /> Debug Mode\n                </CardTitle>\n                <CardDescription>\n                  Enable debugging features for development\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg bg-yellow-500/5 border-yellow-500/20\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable Debug Mode</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Shows detailed error messages and stack traces\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.debugMode ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ debugMode: checked })\n                    }\n                    data-testid=\"switch-debug-mode\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to Console</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Output logs to browser/server console\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToConsole ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToConsole: checked })\n                    }\n                    data-testid=\"switch-log-console\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Log to File</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Save logs to file system\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.logToFile ?? false}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ logToFile: checked })\n                    }\n                    data-testid=\"switch-log-file\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Gauge className=\"w-5 h-5\" /> API Rate Limits\n                </CardTitle>\n                <CardDescription>\n                  Configure rate limiting for API endpoints\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Requests per minute (global)</Label>\n                  <Input\n                    type=\"number\"\n                    value={settings.apiRateLimit ?? 100}\n                    onChange={(e) =>\n                      updateSettings({\n                        apiRateLimit: parseInt(e.target.value) || 100,\n                      })\n                    }\n                    data-testid=\"input-api-rate-limit\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Maximum API requests per minute across all endpoints\n                  </p>\n                </div>\n                <div className=\"space-y-3\">\n                  <h4 className=\"font-medium text-sm\">\n                    Endpoint-specific limits (read-only)\n                  </h4>\n                  {[\n                    { endpoint: \"/api/contact\", limit: 5, window: \"1 hour\" },\n                    {\n                      endpoint: \"/api/auth/login\",\n                      limit: 10,\n                      window: \"15 mins\",\n                    },\n                    { endpoint: \"/api/upload\", limit: 20, window: \"1 hour\" },\n                  ].map((item, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center justify-between p-2 border rounded text-sm\"\n                    >\n                      <code className=\"text-xs bg-muted px-2 py-1 rounded\">\n                        {item.endpoint}\n                      </code>\n                      <span>\n                        {item.limit} requests / {item.window}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Terminal className=\"w-5 h-5\" /> Advanced Options\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">Enable CORS</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Allow cross-origin requests\n                    </p>\n                  </div>\n                  <Switch\n                    checked={settings.corsEnabled ?? true}\n                    onCheckedChange={(checked) =>\n                      updateSettings({ corsEnabled: checked })\n                    }\n                    data-testid=\"switch-cors-enabled\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Allowed Origins (CORS)</Label>\n                  <Input\n                    placeholder=\"* (all origins) or https://example.com, https://app.example.com\"\n                    value={settings.corsOrigins || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ corsOrigins: e.target.value })\n                    }\n                    data-testid=\"input-cors-origins\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Use * to allow all origins, or specify comma-separated\n                    domains\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Custom Headers</Label>\n                  <Textarea\n                    placeholder=\"X-Custom-Header: value&#10;X-Another-Header: value\"\n                    className=\"font-mono text-sm\"\n                    rows={3}\n                    value={settings.customHeaders || \"\"}\n                    onChange={(e) =>\n                      updateSettings({ customHeaders: e.target.value })\n                    }\n                    data-testid=\"input-custom-headers\"\n                  />\n                  <p className=\"text-xs text-muted-foreground\">\n                    Add custom HTTP headers to all responses\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* LOCALIZATION TAB (Enhanced) */}\n          <TabsContent value=\"localization\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"w-5 h-5\" /> Regional Settings\n                </CardTitle>\n                <CardDescription>\n                  Configure timezone and language preferences\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Timezone</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timezone || \"Asia/Ho_Chi_Minh\"}\n                    onChange={(e) =>\n                      updateSettings({ timezone: e.target.value })\n                    }\n                    data-testid=\"select-timezone\"\n                  >\n                    <option value=\"Asia/Ho_Chi_Minh\">\n                      UTC+07:00 (Vietnam)\n                    </option>\n                    <option value=\"Asia/Shanghai\">UTC+08:00 (Shanghai)</option>\n                    <option value=\"Asia/Tokyo\">UTC+09:00 (Tokyo)</option>\n                    <option value=\"Europe/London\">UTC+00:00 (London)</option>\n                    <option value=\"America/New_York\">\n                      UTC-05:00 (New York)\n                    </option>\n                    <option value=\"America/Los_Angeles\">\n                      UTC-08:00 (Los Angeles)\n                    </option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Default Language</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.language || \"en\"}\n                    onChange={(e) =>\n                      updateSettings({ language: e.target.value })\n                    }\n                    data-testid=\"select-language\"\n                  >\n                    <option value=\"en\">English</option>\n                    <option value=\"vi\">Tiáº¿ng Viá»‡t</option>\n                    <option value=\"zh\">ä¸­æ–‡</option>\n                    <option value=\"ja\">æ—¥æœ¬èªž</option>\n                    <option value=\"ko\">í•œêµ­ì–´</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Date Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.dateFormat || \"MM/DD/YYYY\"}\n                    onChange={(e) =>\n                      updateSettings({ dateFormat: e.target.value })\n                    }\n                    data-testid=\"select-date-format\"\n                  >\n                    <option value=\"MM/DD/YYYY\">MM/DD/YYYY</option>\n                    <option value=\"DD/MM/YYYY\">DD/MM/YYYY</option>\n                    <option value=\"YYYY-MM-DD\">YYYY-MM-DD</option>\n                  </select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Time Format</Label>\n                  <select\n                    className=\"w-full p-2 rounded-md border border-input bg-background\"\n                    value={settings.timeFormat || \"12h\"}\n                    onChange={(e) =>\n                      updateSettings({ timeFormat: e.target.value })\n                    }\n                    data-testid=\"select-time-format\"\n                  >\n                    <option value=\"12h\">12 Hour (AM/PM)</option>\n                    <option value=\"24h\">24 Hour</option>\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Languages className=\"w-5 h-5\" /> Custom Translations\n                </CardTitle>\n                <CardDescription>\n                  Manage custom translation strings for multi-language support\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2 flex-wrap\">\n                  <Button variant=\"outline\" size=\"sm\">\n                    Import Translations\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\">\n                    Export Translations\n                  </Button>\n                </div>\n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-3 gap-2 p-2 bg-muted rounded text-sm font-medium\">\n                    <span>Key</span>\n                    <span>English</span>\n                    <span>Vietnamese</span>\n                  </div>\n                  <div className=\"max-h-[400px] overflow-y-auto space-y-1\">\n                    {[\n                      { key: \"site.title\", en: \"Loi Developer\", vi: \"Loi Developer\" },\n                      { key: \"site.tagline\", en: \"Full-stack Developer\", vi: \"Láº­p trÃ¬nh viÃªn Full-stack\" },\n                      { key: \"nav.home\", en: \"Home\", vi: \"Trang chá»§\" },\n                      { key: \"nav.about\", en: \"About\", vi: \"Giá»›i thiá»‡u\" },\n                      { key: \"nav.projects\", en: \"Projects\", vi: \"Dá»± Ã¡n\" },\n                      { key: \"nav.blog\", en: \"Blog\", vi: \"BÃ i viáº¿t\" },\n                      { key: \"nav.services\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"nav.contact\", en: \"Contact\", vi: \"LiÃªn há»‡\" },\n                      { key: \"hero.greeting\", en: \"Hello, I'm\", vi: \"Xin chÃ o, tÃ´i lÃ \" },\n                      { key: \"hero.cta\", en: \"View My Work\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"hero.download_cv\", en: \"Download CV\", vi: \"Táº£i CV\" },\n                      { key: \"about.title\", en: \"About Me\", vi: \"Vá» tÃ´i\" },\n                      { key: \"about.experience\", en: \"Years of Experience\", vi: \"NÄƒm kinh nghiá»‡m\" },\n                      { key: \"about.projects\", en: \"Projects Completed\", vi: \"Dá»± Ã¡n hoÃ n thÃ nh\" },\n                      { key: \"projects.title\", en: \"My Projects\", vi: \"Dá»± Ã¡n cá»§a tÃ´i\" },\n                      { key: \"projects.view\", en: \"View Project\", vi: \"Xem dá»± Ã¡n\" },\n                      { key: \"projects.all\", en: \"All Projects\", vi: \"Táº¥t cáº£\" },\n                      { key: \"blog.title\", en: \"Latest Posts\", vi: \"BÃ i viáº¿t má»›i\" },\n                      { key: \"blog.read_more\", en: \"Read More\", vi: \"Äá»c thÃªm\" },\n                      { key: \"services.title\", en: \"Services\", vi: \"Dá»‹ch vá»¥\" },\n                      { key: \"services.learn_more\", en: \"Learn More\", vi: \"TÃ¬m hiá»ƒu thÃªm\" },\n                      { key: \"contact.title\", en: \"Get In Touch\", vi: \"LiÃªn há»‡\" },\n                      { key: \"contact.name\", en: \"Your Name\", vi: \"Há» tÃªn\" },\n                      { key: \"contact.email\", en: \"Your Email\", vi: \"Email\" },\n                      { key: \"contact.message\", en: \"Your Message\", vi: \"Ná»™i dung\" },\n                      { key: \"contact.send\", en: \"Send Message\", vi: \"Gá»­i tin nháº¯n\" },\n                      { key: \"contact.success\", en: \"Message sent successfully!\", vi: \"Gá»­i thÃ nh cÃ´ng!\" },\n                      { key: \"footer.copyright\", en: \"All rights reserved\", vi: \"Báº£n quyá»n thuá»™c vá»\" },\n                      { key: \"common.loading\", en: \"Loading...\", vi: \"Äang táº£i...\" },\n                      { key: \"common.error\", en: \"Something went wrong\", vi: \"ÄÃ£ xáº£y ra lá»—i\" },\n                      { key: \"common.save\", en: \"Save\", vi: \"LÆ°u\" },\n                      { key: \"common.cancel\", en: \"Cancel\", vi: \"Há»§y\" },\n                      { key: \"common.delete\", en: \"Delete\", vi: \"XÃ³a\" },\n                      { key: \"common.edit\", en: \"Edit\", vi: \"Sá»­a\" },\n                    ].map((item, i) => (\n                      <div\n                        key={i}\n                        className=\"grid grid-cols-3 gap-2 p-2 border rounded text-sm\"\n                      >\n                        <code className=\"text-xs bg-muted px-2 py-1 rounded truncate\">\n                          {item.key}\n                        </code>\n                        <Input defaultValue={item.en} className=\"h-8\" />\n                        <Input defaultValue={item.vi} className=\"h-8\" />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 justify-end\">\n                  <Button variant=\"outline\">\n                    + Add Translation Key\n                  </Button>\n                  <Button>\n                    Save Translations\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* DATABASE MANAGEMENT TAB */}\n          <TabsContent value=\"database\" className=\"space-y-4\">\n            <DatabaseTab />\n          </TabsContent>\n\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}","path":null,"size_bytes":82788,"size_tokens":null},"client/src/pages/admin/tools/ImageOptimizer.tsx":{"content":"\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { \n  Upload, \n  Image as ImageIcon,\n  Zap,\n  Download,\n  Trash2,\n  Settings,\n  CheckCircle\n} from \"lucide-react\";\nimport { useState } from \"react\";\n\nexport default function AdminImageOptimizer() {\n  const [quality, setQuality] = useState([80]);\n  const [images] = useState([\n    { id: 1, name: \"hero-bg.jpg\", original: \"2.4 MB\", optimized: \"456 KB\", saved: \"81%\", status: \"completed\" },\n    { id: 2, name: \"project-1.png\", original: \"1.8 MB\", optimized: \"340 KB\", saved: \"81%\", status: \"completed\" },\n    { id: 3, name: \"avatar.jpg\", original: \"890 KB\", optimized: \"180 KB\", saved: \"80%\", status: \"processing\" },\n  ]);\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Image Optimizer</h1>\n            <p className=\"text-muted-foreground\">Compress and optimize images for better performance</p>\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Total Images</p>\n              <p className=\"font-bold text-2xl\">156</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Optimized</p>\n              <p className=\"font-bold text-2xl text-green-600\">142</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Space Saved</p>\n              <p className=\"font-bold text-2xl\">45.2 MB</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <p className=\"text-xs text-muted-foreground\">Avg Compression</p>\n              <p className=\"font-bold text-2xl\">78%</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Upload Area */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"border-2 border-dashed rounded-lg p-12 flex flex-col items-center justify-center cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all\">\n              <Upload className=\"w-12 h-12 text-muted-foreground mb-3\" />\n              <h3 className=\"font-bold mb-1\">Drop images here or click to upload</h3>\n              <p className=\"text-sm text-muted-foreground\">JPG, PNG, WebP (Max 10MB each)</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Settings */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Settings className=\"w-5 h-5\" /> Optimization Settings\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div>\n                <div className=\"flex justify-between mb-2\">\n                  <label className=\"text-sm font-medium\">Quality</label>\n                  <span className=\"text-sm text-muted-foreground\">{quality[0]}%</span>\n                </div>\n                <Slider value={quality} onValueChange={setQuality} min={1} max={100} step={1} />\n              </div>\n              \n              <div>\n                <label className=\"text-sm font-medium block mb-2\">Output Format</label>\n                <select className=\"w-full p-2 border rounded-md bg-background\">\n                  <option>Auto (Recommended)</option>\n                  <option>WebP</option>\n                  <option>JPEG</option>\n                  <option>PNG</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-medium block mb-2\">Max Width (px)</label>\n                <input type=\"number\" defaultValue=\"1920\" className=\"w-full p-2 border rounded-md\" />\n              </div>\n\n              <Button className=\"w-full\">\n                <Zap className=\"w-4 h-4 mr-2\" /> Optimize All\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Processing Queue</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {images.map((img) => (\n                  <div key={img.id} className=\"border rounded-lg p-3\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <ImageIcon className=\"w-4 h-4 text-muted-foreground\" />\n                        <span className=\"font-medium text-sm\">{img.name}</span>\n                      </div>\n                      {img.status === \"completed\" ? (\n                        <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                      ) : (\n                        <Badge variant=\"secondary\">Processing</Badge>\n                      )}\n                    </div>\n                    \n                    {img.status === \"processing\" ? (\n                      <Progress value={65} className=\"h-1\" />\n                    ) : (\n                      <div className=\"flex justify-between text-xs text-muted-foreground\">\n                        <span>{img.original} â†’ {img.optimized}</span>\n                        <span className=\"text-green-600 font-medium\">-{img.saved}</span>\n                      </div>\n                    )}\n\n                    {img.status === \"completed\" && (\n                      <div className=\"flex gap-2 mt-2\">\n                        <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                          <Download className=\"w-3 h-3 mr-1\" /> Download\n                        </Button>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          <Trash2 className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":6600,"size_tokens":null},"server/api/comments.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth, requireAdmin } from \"../middleware/auth\";\nimport { insertCommentSchema } from \"@shared/schema\";\nimport { broadcastNotification } from \"../websocket\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const postId = req.query.postId ? parseInt(req.query.postId as string) : undefined;\n    const projectId = req.query.projectId ? parseInt(req.query.projectId as string) : undefined;\n    const pending = req.query.pending === \"true\";\n    const approved = req.query.approved === \"true\";\n\n    let comments;\n    if (pending) {\n      comments = await storage.getPendingComments();\n    } else if (postId && approved) {\n      comments = await storage.getApprovedCommentsByPost(postId);\n    } else if (projectId && approved) {\n      comments = await storage.getApprovedCommentsByProject(projectId);\n    } else if (postId) {\n      comments = await storage.getCommentsByPost(postId);\n    } else if (projectId) {\n      comments = await storage.getCommentsByProject(projectId);\n    } else {\n      comments = await storage.getAllComments();\n    }\n    res.json(comments);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/unread\", requireAdmin, async (req, res) => {\n  try {\n    const comments = await storage.getUnreadComments();\n    res.json(comments);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const comment = await storage.getComment(parseInt(req.params.id));\n    if (!comment) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json(comment);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", async (req, res) => {\n  try {\n    const parsed = insertCommentSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const comment = await storage.createComment(parsed.data);\n\n    const post = comment.postId ? await storage.getPost(comment.postId) : null;\n    const project = comment.projectId ? await storage.getProject(comment.projectId) : null;\n    const target = post?.title || project?.title || \"Unknown\";\n\n    await storage.createNotification({\n      message: `New comment from ${comment.authorName} on \"${target}\"`,\n      type: \"comment\"\n    });\n\n    broadcastNotification({\n      type: \"NEW_COMMENT\",\n      message: `New comment from ${comment.authorName}`,\n      data: comment\n    });\n\n    res.status(201).json(comment);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const comment = await storage.updateComment(parseInt(req.params.id), req.body);\n    if (!comment) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json(comment);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/approve\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.approveComment(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json({ message: \"Comment approved\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/read\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.markCommentAsRead(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json({ message: \"Comment marked as read\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:id/archive\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.archiveComment(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json({ message: \"Comment archived\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deleteComment(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Comment not found\" });\n    }\n    res.json({ message: \"Comment deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":4637,"size_tokens":null},"server/api/settings.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const settings = await storage.getAllSettings();\n    const settingsObj: Record<string, any> = {};\n    settings.forEach(s => { settingsObj[s.key] = s.value; });\n    res.json(settingsObj);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/:key\", async (req, res) => {\n  try {\n    const setting = await storage.getSetting(req.params.key);\n    if (!setting) {\n      return res.status(404).json({ message: \"Setting not found\" });\n    }\n    res.json(setting.value);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/:key\", requireAuth, async (req, res) => {\n  try {\n    const setting = await storage.upsertSetting(req.params.key, req.body.value);\n    res.json(setting);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/\", requireAuth, async (req, res) => {\n  try {\n    const updates = req.body;\n    const results = [];\n    for (const [key, value] of Object.entries(updates)) {\n      const setting = await storage.upsertSetting(key, value);\n      results.push(setting);\n    }\n    res.json(results);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":1456,"size_tokens":null},"server/api/pages.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAuth } from \"../middleware/auth\";\nimport { insertPageSchema } from \"@shared/schema\";\n\nconst router = Router();\n\n// Get all pages\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const pages = req.query.published === \"true\"\n      ? await storage.getPublishedPages()\n      : await storage.getAllPages();\n    res.json(pages);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Get page by ID or slug\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const page = isNaN(parseInt(req.params.id))\n      ? await storage.getPageBySlug(req.params.id)\n      : await storage.getPage(parseInt(req.params.id));\n    if (!page) {\n      return res.status(404).json({ message: \"Page not found\" });\n    }\n    res.json(page);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Create page\nrouter.post(\"/\", requireAuth, async (req, res) => {\n  try {\n    const parsed = insertPageSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const page = await storage.createPage(parsed.data);\n    res.status(201).json(page);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Update page\nrouter.put(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const page = await storage.updatePage(parseInt(req.params.id), req.body);\n    if (!page) {\n      return res.status(404).json({ message: \"Page not found\" });\n    }\n    res.json(page);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Delete page\nrouter.delete(\"/:id\", requireAuth, async (req, res) => {\n  try {\n    const success = await storage.deletePage(parseInt(req.params.id));\n    if (!success) {\n      return res.status(404).json({ message: \"Page not found\" });\n    }\n    res.json({ message: \"Page deleted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Increment page views\nrouter.post(\"/:id/view\", async (req, res) => {\n  try {\n    await storage.incrementPageViews(parseInt(req.params.id));\n    res.json({ message: \"View counted\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2383,"size_tokens":null},"client/src/pages/admin/system/APIDocs.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Code, Server, Shield, Database, FileText, Users, Briefcase, MessageSquare, Settings, Activity } from \"lucide-react\";\n\ninterface APIEndpoint {\n  method: \"GET\" | \"POST\" | \"PUT\" | \"DELETE\" | \"PATCH\";\n  path: string;\n  description: string;\n  auth: boolean;\n}\n\nconst apiEndpoints: Record<string, APIEndpoint[]> = {\n  auth: [\n    { method: \"POST\", path: \"/api/auth/login\", description: \"User login with username and password\", auth: false },\n    { method: \"POST\", path: \"/api/auth/logout\", description: \"User logout\", auth: true },\n    { method: \"GET\", path: \"/api/auth/me\", description: \"Get current user info\", auth: true },\n    { method: \"PUT\", path: \"/api/auth/profile\", description: \"Update user profile\", auth: true },\n    { method: \"PUT\", path: \"/api/auth/password\", description: \"Change password\", auth: true },\n    { method: \"POST\", path: \"/api/auth/register\", description: \"Register new user\", auth: false },\n  ],\n  posts: [\n    { method: \"GET\", path: \"/api/posts\", description: \"Get all posts\", auth: false },\n    { method: \"GET\", path: \"/api/posts/:id\", description: \"Get post by ID or slug\", auth: false },\n    { method: \"POST\", path: \"/api/posts\", description: \"Create new post\", auth: true },\n    { method: \"PUT\", path: \"/api/posts/:id\", description: \"Update post\", auth: true },\n    { method: \"DELETE\", path: \"/api/posts/:id\", description: \"Delete post\", auth: true },\n    { method: \"POST\", path: \"/api/posts/:id/view\", description: \"Increment post view count\", auth: false },\n  ],\n  projects: [\n    { method: \"GET\", path: \"/api/projects\", description: \"Get all projects\", auth: false },\n    { method: \"GET\", path: \"/api/projects/:id\", description: \"Get project by ID\", auth: false },\n    { method: \"POST\", path: \"/api/projects\", description: \"Create new project\", auth: true },\n    { method: \"PUT\", path: \"/api/projects/:id\", description: \"Update project\", auth: true },\n    { method: \"DELETE\", path: \"/api/projects/:id\", description: \"Delete project\", auth: true },\n  ],\n  users: [\n    { method: \"GET\", path: \"/api/users\", description: \"Get all users\", auth: true },\n    { method: \"GET\", path: \"/api/users/:id\", description: \"Get user by ID\", auth: true },\n    { method: \"PUT\", path: \"/api/users/:id\", description: \"Update user\", auth: true },\n    { method: \"DELETE\", path: \"/api/users/:id\", description: \"Delete user\", auth: true },\n  ],\n  settings: [\n    { method: \"GET\", path: \"/api/settings\", description: \"Get all settings\", auth: false },\n    { method: \"PUT\", path: \"/api/settings\", description: \"Update settings\", auth: true },\n  ],\n  messages: [\n    { method: \"GET\", path: \"/api/messages\", description: \"Get all messages\", auth: true },\n    { method: \"POST\", path: \"/api/messages\", description: \"Send new message\", auth: false },\n    { method: \"PUT\", path: \"/api/messages/:id/read\", description: \"Mark message as read\", auth: true },\n    { method: \"DELETE\", path: \"/api/messages/:id\", description: \"Delete message\", auth: true },\n  ],\n};\n\nconst methodColors: Record<string, string> = {\n  GET: \"bg-blue-500/10 text-blue-500 border-blue-500/20\",\n  POST: \"bg-green-500/10 text-green-500 border-green-500/20\",\n  PUT: \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\",\n  PATCH: \"bg-orange-500/10 text-orange-500 border-orange-500/20\",\n  DELETE: \"bg-red-500/10 text-red-500 border-red-500/20\",\n};\n\nfunction EndpointList({ endpoints }: { endpoints: APIEndpoint[] }) {\n  return (\n    <div className=\"space-y-2\">\n      {endpoints.map((endpoint, index) => (\n        <div\n          key={index}\n          className=\"flex items-center gap-3 p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors\"\n          data-testid={`api-endpoint-${endpoint.method.toLowerCase()}-${index}`}\n        >\n          <Badge className={`${methodColors[endpoint.method]} font-mono text-xs min-w-[60px] justify-center`}>\n            {endpoint.method}\n          </Badge>\n          <code className=\"font-mono text-sm flex-1\">{endpoint.path}</code>\n          <span className=\"text-sm text-muted-foreground hidden md:block\">{endpoint.description}</span>\n          {endpoint.auth && (\n            <Shield className=\"w-4 h-4 text-muted-foreground\" />\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default function APIDocs() {\n  const categories = [\n    { id: \"auth\", label: \"Authentication\", icon: Shield },\n    { id: \"posts\", label: \"Posts\", icon: FileText },\n    { id: \"projects\", label: \"Projects\", icon: Briefcase },\n    { id: \"users\", label: \"Users\", icon: Users },\n    { id: \"settings\", label: \"Settings\", icon: Settings },\n    { id: \"messages\", label: \"Messages\", icon: MessageSquare },\n  ];\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Server className=\"w-5 h-5\" />\n              API Overview\n            </CardTitle>\n            <CardDescription>\n              All API endpoints are prefixed with <code className=\"bg-muted px-1 rounded\">/api</code>. \n              Endpoints marked with a shield icon require authentication.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <div className=\"p-4 rounded-lg bg-muted/50 text-center\">\n                <div className=\"text-2xl font-bold text-primary\">\n                  {Object.values(apiEndpoints).flat().length}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">Total Endpoints</div>\n              </div>\n              <div className=\"p-4 rounded-lg bg-muted/50 text-center\">\n                <div className=\"text-2xl font-bold text-blue-500\">\n                  {Object.values(apiEndpoints).flat().filter(e => e.method === \"GET\").length}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">GET Requests</div>\n              </div>\n              <div className=\"p-4 rounded-lg bg-muted/50 text-center\">\n                <div className=\"text-2xl font-bold text-green-500\">\n                  {Object.values(apiEndpoints).flat().filter(e => e.method === \"POST\").length}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">POST Requests</div>\n              </div>\n              <div className=\"p-4 rounded-lg bg-muted/50 text-center\">\n                <div className=\"text-2xl font-bold text-yellow-500\">\n                  {Object.values(apiEndpoints).flat().filter(e => e.auth).length}\n                </div>\n                <div className=\"text-sm text-muted-foreground\">Protected</div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Tabs defaultValue=\"auth\" className=\"w-full\">\n          <TabsList className=\"w-full justify-start flex-wrap h-auto gap-1 bg-transparent p-0\">\n            {categories.map((cat) => (\n              <TabsTrigger\n                key={cat.id}\n                value={cat.id}\n                className=\"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground\"\n                data-testid={`tab-${cat.id}`}\n              >\n                <cat.icon className=\"w-4 h-4 mr-2\" />\n                {cat.label}\n              </TabsTrigger>\n            ))}\n          </TabsList>\n\n          {categories.map((cat) => (\n            <TabsContent key={cat.id} value={cat.id} className=\"mt-4\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <cat.icon className=\"w-5 h-5\" />\n                    {cat.label} Endpoints\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <ScrollArea className=\"h-[400px]\">\n                    <EndpointList endpoints={apiEndpoints[cat.id] || []} />\n                  </ScrollArea>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          ))}\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":8338,"size_tokens":null},"client/src/components/layout/LanguageSwitcher.tsx":{"content":"import { Globe } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useLanguage } from \"@/context/LanguageContext\";\n\nexport function LanguageSwitcher() {\n  const { languages, currentLanguage, setCurrentLanguage } = useLanguage();\n  \n  const currentLang = languages.find(l => l.code === currentLanguage);\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\n          <Globe className=\"w-4 h-4\" />\n          <span className=\"hidden sm:inline\">{currentLang?.nativeName || currentLang?.name}</span>\n          <span className=\"sm:hidden\">{currentLanguage.toUpperCase()}</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        {languages.map((lang) => (\n          <DropdownMenuItem\n            key={lang.code}\n            onClick={() => setCurrentLanguage(lang.code)}\n            className={currentLanguage === lang.code ? \"bg-primary/10\" : \"\"}\n          >\n            <span className=\"font-medium\">{lang.nativeName}</span>\n            <span className=\"ml-2 text-muted-foreground text-xs\">({lang.code.toUpperCase()})</span>\n          </DropdownMenuItem>\n        ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","path":null,"size_bytes":1397,"size_tokens":null},"client/src/pages/admin/users/Roles.tsx":{"content":"// This file has been removed as part of cleanup\nexport default function AdminRoles() {\n  return null;\n}","path":null,"size_bytes":104,"size_tokens":null},"client/src/pages/admin/users/Users.tsx":{"content":"// This file has been removed as part of cleanup\nexport default function AdminUsers() {\n  return null;\n}","path":null,"size_bytes":104,"size_tokens":null},"client/src/pages/admin/pages/PageBuilder.tsx":{"content":"import { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useState } from \"react\";\nimport { \n  Layout, \n  Type, \n  Image as ImageIcon, \n  Columns, \n  Plus, \n  Trash2, \n  GripVertical,\n  Eye,\n  Save,\n  ArrowLeft,\n  Settings,\n  Palette,\n  Code,\n  FileText\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\n\ninterface PageBlock {\n  id: string;\n  type: \"text\" | \"image\" | \"columns\" | \"hero\" | \"cta\";\n  content: Record<string, any>;\n}\n\nconst blockTypes = [\n  { id: \"text\", label: \"Text Block\", icon: Type, description: \"Add a text section\" },\n  { id: \"image\", label: \"Image\", icon: ImageIcon, description: \"Add an image\" },\n  { id: \"columns\", label: \"Columns\", icon: Columns, description: \"Multi-column layout\" },\n  { id: \"hero\", label: \"Hero Section\", icon: Layout, description: \"Large hero banner\" },\n  { id: \"cta\", label: \"Call to Action\", icon: FileText, description: \"CTA button section\" },\n];\n\nexport default function PageBuilder() {\n  const [pageTitle, setPageTitle] = useState(\"\");\n  const [pageSlug, setPageSlug] = useState(\"\");\n  const [isPublished, setIsPublished] = useState(false);\n  const [blocks, setBlocks] = useState<PageBlock[]>([]);\n\n  const generateId = () => {\n    return `block-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n  };\n\n  const addBlock = (type: PageBlock[\"type\"]) => {\n    const newBlock: PageBlock = {\n      id: generateId(),\n      type,\n      content: {},\n    };\n    setBlocks([...blocks, newBlock]);\n  };\n\n  const removeBlock = (id: string) => {\n    setBlocks(blocks.filter(block => block.id !== id));\n  };\n\n  const handleSave = () => {\n    // TODO: Implement page save functionality\n  };\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between gap-4\">\n          <Link href=\"/admin/pages\">\n            <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-back-to-pages\">\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Pages\n            </Button>\n          </Link>\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"outline\" size=\"sm\" data-testid=\"button-preview-page\">\n              <Eye className=\"w-4 h-4 mr-2\" />\n              Preview\n            </Button>\n            <Button onClick={handleSave} data-testid=\"button-save-page\">\n              <Save className=\"w-4 h-4 mr-2\" />\n              Save Page\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          <div className=\"lg:col-span-3 space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Settings className=\"w-5 h-5\" />\n                  Page Settings\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"title\">Page Title</Label>\n                    <Input\n                      id=\"title\"\n                      value={pageTitle}\n                      onChange={(e) => setPageTitle(e.target.value)}\n                      placeholder=\"Enter page title\"\n                      data-testid=\"input-page-title\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"slug\">URL Slug</Label>\n                    <Input\n                      id=\"slug\"\n                      value={pageSlug}\n                      onChange={(e) => setPageSlug(e.target.value)}\n                      placeholder=\"page-url-slug\"\n                      data-testid=\"input-page-slug\"\n                    />\n                  </div>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Switch\n                    id=\"published\"\n                    checked={isPublished}\n                    onCheckedChange={setIsPublished}\n                    data-testid=\"switch-page-published\"\n                  />\n                  <Label htmlFor=\"published\">Publish page</Label>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Layout className=\"w-5 h-5\" />\n                  Page Content\n                </CardTitle>\n                <CardDescription>\n                  Drag and drop blocks to build your page\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {blocks.length === 0 ? (\n                  <div className=\"text-center py-12 border-2 border-dashed rounded-lg\">\n                    <Layout className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n                    <h3 className=\"text-lg font-medium mb-2\">No blocks yet</h3>\n                    <p className=\"text-muted-foreground mb-4\">\n                      Add blocks from the sidebar to start building your page\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {blocks.map((block, index) => (\n                      <div\n                        key={block.id}\n                        className=\"flex items-start gap-3 p-4 border rounded-lg bg-card\"\n                        data-testid={`block-${block.type}-${index}`}\n                      >\n                        <GripVertical className=\"w-5 h-5 text-muted-foreground cursor-grab mt-1\" />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium capitalize\">{block.type} Block</div>\n                          <div className=\"text-sm text-muted-foreground\">\n                            Configure this block in the settings panel\n                          </div>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => removeBlock(block.id)}\n                          data-testid={`button-remove-block-${index}`}\n                        >\n                          <Trash2 className=\"w-4 h-4 text-destructive\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Plus className=\"w-5 h-5\" />\n                  Add Blocks\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ScrollArea className=\"h-[300px]\">\n                  <div className=\"space-y-2\">\n                    {blockTypes.map((block) => (\n                      <Button\n                        key={block.id}\n                        variant=\"outline\"\n                        className=\"w-full justify-start\"\n                        onClick={() => addBlock(block.id as PageBlock[\"type\"])}\n                        data-testid={`button-add-${block.id}`}\n                      >\n                        <block.icon className=\"w-4 h-4 mr-2\" />\n                        {block.label}\n                      </Button>\n                    ))}\n                  </div>\n                </ScrollArea>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":8068,"size_tokens":null},"client/src/components/ui/error-boundary.tsx":{"content":"import React, { Component, ErrorInfo, ReactNode } from \"react\";\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  public state: State = {\n    hasError: false\n  };\n\n  public static getDerivedStateFromError(_: Error): State {\n    return { hasError: true };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error(\"ErrorBoundary caught an error:\", error, errorInfo);\n  }\n\n  public render() {\n    if (this.state.hasError) {\n      return this.props.fallback || null;\n    }\n\n    return this.props.children;\n  }\n}\n","path":null,"size_bytes":663,"size_tokens":null},"client/src/components/sections/ReviewSection.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Star, Send, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport type { Review } from \"@shared/schema\";\n\ninterface ReviewSectionProps {\n  projectId: number;\n  title?: string;\n  compact?: boolean;\n}\n\nconst reviewFormSchema = z.object({\n  authorName: z.string().min(2, \"Name must be at least 2 characters\"),\n  authorEmail: z.string().email(\"Please enter a valid email\"),\n  content: z.string().min(10, \"Review must be at least 10 characters\"),\n  rating: z.number().min(1).max(5),\n});\n\ntype ReviewFormValues = z.infer<typeof reviewFormSchema>;\n\nexport function ReviewSection({ projectId, title = \"Reviews\", compact = false }: ReviewSectionProps) {\n  const { toast } = useToast();\n  const [showForm, setShowForm] = useState(false);\n  const [hoverRating, setHoverRating] = useState(0);\n\n  const { data: reviews = [], isLoading } = useQuery<Review[]>({\n    queryKey: ['/api/reviews', { projectId, approved: true }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      params.append('projectId', projectId.toString());\n      params.append('approved', 'true');\n      const response = await fetch(`/api/reviews?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch reviews');\n      return response.json();\n    }\n  });\n\n  const averageRating = reviews.length > 0 \n    ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length \n    : 0;\n\n  const form = useForm<ReviewFormValues>({\n    resolver: zodResolver(reviewFormSchema),\n    defaultValues: {\n      authorName: \"\",\n      authorEmail: \"\",\n      content: \"\",\n      rating: 5,\n    },\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: ReviewFormValues) => {\n      const payload = {\n        ...data,\n        projectId,\n        status: 'Approved',\n      };\n      const response = await fetch('/api/reviews', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n      const responseText = await response.text();\n      if (!response.ok) {\n        throw new Error(`Failed to submit review: ${responseText}`);\n      }\n      return JSON.parse(responseText);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Review submitted\",\n        description: \"Your review is pending approval and will appear shortly.\",\n      });\n      form.reset();\n      setShowForm(false);\n      queryClient.invalidateQueries({ queryKey: ['/api/reviews'] });\n    },\n    onError: (error: any) => {\n      console.error('Review submission error:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit review. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ReviewFormValues) => {\n    submitMutation.mutate(data);\n  };\n\n  const StarRating = ({ rating, interactive = false, size = \"md\" }: { rating: number; interactive?: boolean; size?: \"sm\" | \"md\" }) => {\n    const starSize = size === \"sm\" ? \"w-4 h-4\" : \"w-5 h-5\";\n    return (\n      <div className=\"flex gap-1\">\n        {[1, 2, 3, 4, 5].map((star) => (\n          <Star\n            key={star}\n            className={`${starSize} ${\n              star <= (interactive ? hoverRating || rating : rating)\n                ? \"text-yellow-500 fill-yellow-500\"\n                : \"text-gray-300 dark:text-gray-600\"\n            } ${interactive ? \"cursor-pointer transition-colors\" : \"\"}`}\n            onMouseEnter={() => interactive && setHoverRating(star)}\n            onMouseLeave={() => interactive && setHoverRating(0)}\n            onClick={() => {\n              if (interactive) {\n                form.setValue(\"rating\", star);\n                setHoverRating(0);\n              }\n            }}\n          />\n        ))}\n      </div>\n    );\n  };\n\n  if (compact) {\n    return (\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center gap-2\">\n          <StarRating rating={Math.round(averageRating)} size=\"sm\" />\n          <span className=\"text-sm text-muted-foreground\">\n            ({reviews.length} review{reviews.length !== 1 ? 's' : ''})\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"mt-4\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4 pb-4\">\n        <div>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Star className=\"w-5 h-5\" />\n            {title}\n          </CardTitle>\n          {reviews.length > 0 && (\n            <div className=\"flex items-center gap-2 mt-1\">\n              <StarRating rating={Math.round(averageRating)} size=\"sm\" />\n              <span className=\"text-sm text-muted-foreground\">\n                {averageRating.toFixed(1)} ({reviews.length} review{reviews.length !== 1 ? 's' : ''})\n              </span>\n            </div>\n          )}\n        </div>\n        <Button \n          variant=\"outline\" \n          size=\"sm\"\n          onClick={() => setShowForm(!showForm)}\n          data-testid=\"button-add-review\"\n        >\n          {showForm ? \"Cancel\" : \"Add Review\"}\n        </Button>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {showForm && (\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 p-4 bg-muted/50 rounded-lg\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"authorName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"Your name\" {...field} data-testid=\"input-review-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"authorEmail\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"your@email.com\" {...field} data-testid=\"input-review-email\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"rating\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Rating</FormLabel>\n                    <FormControl>\n                      <StarRating rating={field.value} interactive />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Your Review</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"Share your experience...\" \n                        className=\"min-h-[100px]\" \n                        {...field} \n                        data-testid=\"textarea-review-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button \n                type=\"submit\" \n                disabled={submitMutation.isPending}\n                data-testid=\"button-submit-review\"\n              >\n                {submitMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                Submit Review\n              </Button>\n            </form>\n          </Form>\n        )}\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : reviews.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <Star className=\"w-10 h-10 mx-auto mb-3 opacity-50\" />\n            <p>No reviews yet. Be the first to share your experience!</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {reviews.map((review) => (\n              <div \n                key={review.id} \n                className=\"flex gap-4 p-4 rounded-lg bg-muted/30\"\n                data-testid={`review-${review.id}`}\n              >\n                <Avatar className=\"w-10 h-10\">\n                  <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n                    {review.authorName.charAt(0).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n                    <span className=\"font-semibold\">{review.authorName}</span>\n                    <StarRating rating={review.rating} size=\"sm\" />\n                    <span className=\"text-xs text-muted-foreground\">\n                      {review.createdAt && formatDistanceToNow(new Date(review.createdAt), { addSuffix: true })}\n                    </span>\n                  </div>\n                  <p className=\"text-foreground/90\">{review.content}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":10484,"size_tokens":null},"client/src/components/sections/CommentSection.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { MessageSquare, Send, Loader2, Reply, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport type { Comment } from \"@shared/schema\";\n\ninterface CommentSectionProps {\n  postId?: number;\n  projectId?: number;\n  title?: string;\n}\n\ninterface CommentWithReplies extends Comment {\n  replies?: CommentWithReplies[];\n}\n\nconst commentFormSchema = z.object({\n  authorName: z.string().min(2, \"Name must be at least 2 characters\"),\n  authorEmail: z.string().email(\"Please enter a valid email\"),\n  content: z.string().min(10, \"Comment must be at least 10 characters\"),\n});\n\ntype CommentFormValues = z.infer<typeof commentFormSchema>;\n\nfunction organizeComments(comments: Comment[]): CommentWithReplies[] {\n  const commentMap = new Map<number, CommentWithReplies>();\n  const rootComments: CommentWithReplies[] = [];\n\n  comments.forEach(comment => {\n    commentMap.set(comment.id, { ...comment, replies: [] });\n  });\n\n  comments.forEach(comment => {\n    const commentWithReplies = commentMap.get(comment.id)!;\n    if (comment.parentId && commentMap.has(comment.parentId)) {\n      commentMap.get(comment.parentId)!.replies!.push(commentWithReplies);\n    } else {\n      rootComments.push(commentWithReplies);\n    }\n  });\n\n  return rootComments;\n}\n\ninterface CommentItemProps {\n  comment: CommentWithReplies;\n  depth: number;\n  replyingTo: number | null;\n  setReplyingTo: (id: number | null) => void;\n  expandedReplies: Set<number>;\n  toggleReplies: (id: number) => void;\n  replyForm: ReturnType<typeof useForm<CommentFormValues>>;\n  onReplySubmit: (data: CommentFormValues, parentId: number) => void;\n  submitMutation: any;\n}\n\nfunction CommentItem({\n  comment,\n  depth,\n  replyingTo,\n  setReplyingTo,\n  expandedReplies,\n  toggleReplies,\n  replyForm,\n  onReplySubmit,\n  submitMutation,\n}: CommentItemProps) {\n  const hasReplies = comment.replies && comment.replies.length > 0;\n  const isExpanded = expandedReplies.has(comment.id);\n  const isReplying = replyingTo === comment.id;\n  const maxDepth = 3;\n\n  return (\n    <div \n      className={`${depth > 0 ? 'ml-6 pl-4 border-l-2 border-muted' : ''}`}\n      data-testid={`comment-${comment.id}`}\n    >\n      <div className=\"flex gap-4 p-4 rounded-lg bg-muted/30\">\n        <Avatar className=\"w-10 h-10 shrink-0\">\n          <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n            {comment.authorName.charAt(0).toUpperCase()}\n          </AvatarFallback>\n        </Avatar>\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n            <span className=\"font-semibold\">{comment.authorName}</span>\n            <span className=\"text-xs text-muted-foreground\">\n              {comment.createdAt && formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}\n            </span>\n          </div>\n          <p className=\"text-foreground/90 mb-2\">{comment.content}</p>\n          \n          <div className=\"flex items-center gap-2 flex-wrap\">\n            {depth < maxDepth && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setReplyingTo(isReplying ? null : comment.id)}\n                data-testid={`button-reply-${comment.id}`}\n              >\n                <Reply className=\"w-4 h-4 mr-1\" />\n                {isReplying ? \"Cancel\" : \"Reply\"}\n              </Button>\n            )}\n            {hasReplies && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => toggleReplies(comment.id)}\n                data-testid={`button-toggle-replies-${comment.id}`}\n              >\n                {isExpanded ? (\n                  <>\n                    <ChevronUp className=\"w-4 h-4 mr-1\" />\n                    Hide {comment.replies!.length} {comment.replies!.length === 1 ? 'reply' : 'replies'}\n                  </>\n                ) : (\n                  <>\n                    <ChevronDown className=\"w-4 h-4 mr-1\" />\n                    Show {comment.replies!.length} {comment.replies!.length === 1 ? 'reply' : 'replies'}\n                  </>\n                )}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {isReplying && (\n        <div className=\"mt-3 ml-14\">\n          <Form {...replyForm}>\n            <form \n              onSubmit={replyForm.handleSubmit((data) => onReplySubmit(data, comment.id))} \n              className=\"space-y-3 p-3 bg-muted/30 rounded-lg\"\n            >\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                <FormField\n                  control={replyForm.control}\n                  name=\"authorName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-sm\">Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"Your name\" {...field} data-testid={`input-reply-name-${comment.id}`} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={replyForm.control}\n                  name=\"authorEmail\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"text-sm\">Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"your@email.com\" {...field} data-testid={`input-reply-email-${comment.id}`} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={replyForm.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-sm\">Reply</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder={`Reply to ${comment.authorName}...`}\n                        className=\"min-h-[80px]\" \n                        {...field} \n                        data-testid={`textarea-reply-content-${comment.id}`}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button \n                type=\"submit\" \n                size=\"sm\"\n                disabled={submitMutation.isPending}\n                data-testid={`button-submit-reply-${comment.id}`}\n              >\n                {submitMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                Post Reply\n              </Button>\n            </form>\n          </Form>\n        </div>\n      )}\n\n      {hasReplies && isExpanded && (\n        <div className=\"mt-3 space-y-3\">\n          {comment.replies!.map((reply) => (\n            <CommentItem\n              key={reply.id}\n              comment={reply}\n              depth={depth + 1}\n              replyingTo={replyingTo}\n              setReplyingTo={setReplyingTo}\n              expandedReplies={expandedReplies}\n              toggleReplies={toggleReplies}\n              replyForm={replyForm}\n              onReplySubmit={onReplySubmit}\n              submitMutation={submitMutation}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport function CommentSection({ postId, projectId, title = \"Comments\" }: CommentSectionProps) {\n  const { toast } = useToast();\n  const [showForm, setShowForm] = useState(false);\n  const [replyingTo, setReplyingTo] = useState<number | null>(null);\n  const [expandedReplies, setExpandedReplies] = useState<Set<number>>(new Set());\n\n  const queryKey = postId \n    ? ['/api/comments', { postId, approved: true }]\n    : ['/api/comments', { projectId, approved: true }];\n\n  const { data: comments = [], isLoading } = useQuery<Comment[]>({\n    queryKey,\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (postId) params.append('postId', postId.toString());\n      if (projectId) params.append('projectId', projectId.toString());\n      params.append('approved', 'true');\n      const response = await fetch(`/api/comments?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch comments');\n      return response.json();\n    }\n  });\n\n  const organizedComments = organizeComments(comments);\n\n  const form = useForm<CommentFormValues>({\n    resolver: zodResolver(commentFormSchema),\n    defaultValues: {\n      authorName: \"\",\n      authorEmail: \"\",\n      content: \"\",\n    },\n  });\n\n  const replyForm = useForm<CommentFormValues>({\n    resolver: zodResolver(commentFormSchema),\n    defaultValues: {\n      authorName: \"\",\n      authorEmail: \"\",\n      content: \"\",\n    },\n  });\n\n  const submitMutation = useMutation({\n    mutationFn: async (data: CommentFormValues & { parentId?: number | null }) => {\n      const payload = {\n        ...data,\n        postId: postId || null,\n        projectId: projectId || null,\n        parentId: data.parentId || null,\n        status: 'Approved',\n      };\n      const response = await fetch('/api/comments', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify(payload),\n      });\n      const responseText = await response.text();\n      if (!response.ok) {\n        throw new Error(`Failed to submit comment: ${responseText}`);\n      }\n      return JSON.parse(responseText);\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Comment submitted\",\n        description: \"Your comment has been posted successfully.\",\n      });\n      form.reset();\n      replyForm.reset();\n      setShowForm(false);\n      setReplyingTo(null);\n      queryClient.invalidateQueries({ queryKey: ['/api/comments'] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit comment. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CommentFormValues) => {\n    submitMutation.mutate(data);\n  };\n\n  const onReplySubmit = (data: CommentFormValues, parentId: number) => {\n    submitMutation.mutate({ ...data, parentId });\n  };\n\n  const toggleReplies = (commentId: number) => {\n    setExpandedReplies(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(commentId)) {\n        newSet.delete(commentId);\n      } else {\n        newSet.add(commentId);\n      }\n      return newSet;\n    });\n  };\n\n  return (\n    <Card className=\"mt-8\">\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4 pb-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <MessageSquare className=\"w-5 h-5\" />\n          {title} ({comments.length})\n        </CardTitle>\n        <Button \n          variant=\"outline\" \n          size=\"sm\"\n          onClick={() => setShowForm(!showForm)}\n          data-testid=\"button-add-comment\"\n        >\n          {showForm ? \"Cancel\" : \"Add Comment\"}\n        </Button>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {showForm && (\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4 p-4 bg-muted/50 rounded-lg\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"authorName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"Your name\" {...field} data-testid=\"input-comment-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"authorEmail\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input type=\"email\" placeholder=\"your@email.com\" {...field} data-testid=\"input-comment-email\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Comment</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"Share your thoughts...\" \n                        className=\"min-h-[100px]\" \n                        {...field} \n                        data-testid=\"textarea-comment-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button \n                type=\"submit\" \n                disabled={submitMutation.isPending}\n                data-testid=\"button-submit-comment\"\n              >\n                {submitMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                Submit Comment\n              </Button>\n            </form>\n          </Form>\n        )}\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        ) : organizedComments.length === 0 ? (\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <MessageSquare className=\"w-10 h-10 mx-auto mb-3 opacity-50\" />\n            <p>No comments yet. Be the first to share your thoughts!</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {organizedComments.map((comment) => (\n              <CommentItem\n                key={comment.id}\n                comment={comment}\n                depth={0}\n                replyingTo={replyingTo}\n                setReplyingTo={setReplyingTo}\n                expandedReplies={expandedReplies}\n                toggleReplies={toggleReplies}\n                replyForm={replyForm}\n                onReplySubmit={onReplySubmit}\n                submitMutation={submitMutation}\n              />\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":15606,"size_tokens":null},"client/src/pages/home/FAQs.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { HelpCircle, ChevronDown, Loader2 } from \"lucide-react\";\nimport { Navbar } from \"@/components/layout/Navbar\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport type { FAQ } from \"@shared/schema\";\n\nexport default function FAQs() {\n  const { data: faqs = [], isLoading } = useQuery<FAQ[]>({\n    queryKey: [\"/api/faqs\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/faqs?visible=true\");\n      if (!response.ok) throw new Error(\"Failed to fetch FAQs\");\n      return response.json();\n    },\n  });\n\n  const sortedFaqs = [...faqs].sort((a, b) => a.order - b.order);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"pt-24 pb-16\">\n        <div className=\"container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"mb-12 text-center max-w-3xl mx-auto\"\n          >\n            <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-6\">\n              <HelpCircle className=\"w-8 h-8 text-primary\" />\n            </div>\n            <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">\n              Frequently Asked <span className=\"text-primary\">Questions</span>\n            </h1>\n            <p className=\"text-xl text-muted-foreground\">\n              Find answers to common questions about my services and work process\n            </p>\n          </motion.div>\n\n          {sortedFaqs.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <HelpCircle className=\"w-16 h-16 mx-auto mb-4 text-muted-foreground opacity-50\" />\n              <p className=\"text-muted-foreground text-lg\">No FAQs available at the moment</p>\n            </div>\n          ) : (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n              className=\"max-w-3xl mx-auto\"\n            >\n              <Accordion type=\"single\" collapsible className=\"space-y-4\">\n                {sortedFaqs.map((faq, index) => (\n                  <motion.div\n                    key={faq.id}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ duration: 0.3, delay: index * 0.1 }}\n                  >\n                    <AccordionItem\n                      value={`faq-${faq.id}`}\n                      className=\"border rounded-lg px-6 bg-card data-[state=open]:shadow-md transition-shadow\"\n                      data-testid={`accordion-faq-${faq.id}`}\n                    >\n                      <AccordionTrigger className=\"text-left font-semibold text-lg hover:no-underline py-5\" data-testid={`trigger-faq-${faq.id}`}>\n                        {faq.question}\n                      </AccordionTrigger>\n                      <AccordionContent className=\"text-muted-foreground pb-5 text-base leading-relaxed\" data-testid={`content-faq-${faq.id}`}>\n                        <div \n                          dangerouslySetInnerHTML={{ __html: faq.answer }}\n                          className=\"\n                            [&_p]:mb-3\n                            [&_ul]:list-disc [&_ul]:ml-4 [&_ul]:mb-3\n                            [&_ol]:list-decimal [&_ol]:ml-4 [&_ol]:mb-3\n                            [&_li]:mb-1\n                            [&_a]:text-primary [&_a]:underline\n                            [&_strong]:font-semibold\n                          \"\n                        />\n                      </AccordionContent>\n                    </AccordionItem>\n                  </motion.div>\n                ))}\n              </Accordion>\n            </motion.div>\n          )}\n\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ duration: 0.5, delay: 0.4 }}\n            className=\"mt-16 text-center max-w-2xl mx-auto\"\n          >\n            <div className=\"p-8 rounded-xl bg-muted/50 border\">\n              <h2 className=\"text-2xl font-bold mb-3\">Still have questions?</h2>\n              <p className=\"text-muted-foreground mb-6\">\n                Can't find the answer you're looking for? Feel free to reach out to me directly.\n              </p>\n              <a\n                href=\"/#contact\"\n                className=\"inline-flex items-center justify-center px-6 py-3 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors\"\n                data-testid=\"link-contact-faq\"\n              >\n                Contact Me\n              </a>\n            </div>\n          </motion.div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","path":null,"size_bytes":5210,"size_tokens":null},"client/src/hooks/useDebounce.ts":{"content":"import { useState, useEffect } from \"react\";\n\nexport function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n","path":null,"size_bytes":386,"size_tokens":null},"client/src/components/sections/NewsletterSection.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { Mail, Send, Loader2, CheckCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface NewsletterSettings {\n  enabled: boolean;\n  title: string;\n  subtitle: string;\n  description: string;\n  placeholder: string;\n  buttonText: string;\n  successMessage: string;\n}\n\nexport function NewsletterSection() {\n  const [email, setEmail] = useState(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const { toast } = useToast();\n\n  const { data: settings } = useQuery<NewsletterSettings>({\n    queryKey: ['/api/newsletter/settings'],\n  });\n\n  if (!settings?.enabled) return null;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email || isSubmitting) return;\n\n    setIsSubmitting(true);\n    try {\n      const response = await fetch('/api/newsletter/subscribe', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ email }),\n      });\n\n      if (response.ok) {\n        setIsSubmitted(true);\n        setEmail(\"\");\n        toast({\n          title: \"Successfully subscribed!\",\n          description: settings.successMessage,\n        });\n      } else {\n        const data = await response.json();\n        toast({\n          title: \"Subscription failed\",\n          description: data.message || \"Please try again later.\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to subscribe. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <section className=\"py-16 bg-muted/30\" id=\"newsletter\">\n      <div className=\"container mx-auto px-4\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          whileInView={{ opacity: 1, y: 0 }}\n          viewport={{ once: true }}\n          transition={{ duration: 0.5 }}\n          className=\"max-w-3xl mx-auto text-center\"\n        >\n          <div className=\"inline-flex items-center justify-center w-14 h-14 rounded-full bg-primary/10 mb-6\">\n            <Mail className=\"w-7 h-7 text-primary\" />\n          </div>\n          \n          <h2 className=\"text-3xl md:text-4xl font-bold mb-3\" data-testid=\"newsletter-section-title\">\n            {settings.title}\n          </h2>\n          <p className=\"text-lg text-muted-foreground mb-2\" data-testid=\"newsletter-section-subtitle\">\n            {settings.subtitle}\n          </p>\n          <p className=\"text-muted-foreground mb-8\" data-testid=\"newsletter-section-description\">\n            {settings.description}\n          </p>\n\n          {isSubmitted ? (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9 }}\n              animate={{ opacity: 1, scale: 1 }}\n              className=\"flex items-center justify-center gap-3 p-6 bg-green-500/10 rounded-lg border border-green-500/20\"\n            >\n              <CheckCircle className=\"w-6 h-6 text-green-500\" />\n              <span className=\"text-green-600 dark:text-green-400 font-medium\" data-testid=\"newsletter-section-success\">\n                {settings.successMessage}\n              </span>\n            </motion.div>\n          ) : (\n            <form onSubmit={handleSubmit} className=\"flex flex-col sm:flex-row gap-3 max-w-lg mx-auto\">\n              <Input\n                type=\"email\"\n                placeholder={settings.placeholder}\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"flex-1\"\n                data-testid=\"input-newsletter-section-email\"\n              />\n              <Button \n                type=\"submit\" \n                disabled={isSubmitting}\n                className=\"sm:w-auto\"\n                data-testid=\"button-newsletter-section-subscribe\"\n              >\n                {isSubmitting ? (\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4 mr-2\" />\n                )}\n                {settings.buttonText}\n              </Button>\n            </form>\n          )}\n\n          <p className=\"text-xs text-muted-foreground mt-4\">\n            We respect your privacy. Unsubscribe at any time.\n          </p>\n        </motion.div>\n      </div>\n    </section>\n  );\n}\n","path":null,"size_bytes":4655,"size_tokens":null},"client/src/components/layout/GlobalSearch.tsx":{"content":"import { useState, useEffect, useCallback } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Search, X, FileText, Folder, Globe, Briefcase, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useDebounce } from \"@/hooks/use-debounce\";\n\ninterface SearchResult {\n  type: 'post' | 'project' | 'page' | 'service';\n  id: number;\n  title: string;\n  slug: string;\n  excerpt?: string;\n  thumbnail?: string;\n}\n\ninterface SearchResponse {\n  results: SearchResult[];\n  total: number;\n  query: string;\n}\n\nexport function GlobalSearch() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [query, setQuery] = useState(\"\");\n  const debouncedQuery = useDebounce(query, 300);\n\n  const { data, isLoading } = useQuery<SearchResponse>({\n    queryKey: ['/api/search', debouncedQuery],\n    queryFn: async () => {\n      if (!debouncedQuery || debouncedQuery.length < 2) {\n        return { results: [], total: 0, query: \"\" };\n      }\n      const response = await fetch(`/api/search?q=${encodeURIComponent(debouncedQuery)}&limit=8`);\n      if (!response.ok) throw new Error(\"Search failed\");\n      return response.json();\n    },\n    enabled: debouncedQuery.length >= 2,\n  });\n\n  const handleKeyDown = useCallback((e: KeyboardEvent) => {\n    if ((e.metaKey || e.ctrlKey) && e.key === \"k\") {\n      e.preventDefault();\n      setIsOpen(true);\n    }\n    if (e.key === \"Escape\") {\n      setIsOpen(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [handleKeyDown]);\n\n  const getIcon = (type: string) => {\n    switch (type) {\n      case 'post':\n        return <FileText className=\"w-4 h-4\" />;\n      case 'project':\n        return <Folder className=\"w-4 h-4\" />;\n      case 'page':\n        return <Globe className=\"w-4 h-4\" />;\n      case 'service':\n        return <Briefcase className=\"w-4 h-4\" />;\n      default:\n        return <FileText className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getLink = (result: SearchResult) => {\n    switch (result.type) {\n      case 'post':\n        return `/blog/${result.slug}`;\n      case 'project':\n        return `/projects#project-${result.id}`;\n      case 'page':\n        return `/page/${result.slug}`;\n      case 'service':\n        return `/#services`;\n      default:\n        return \"/\";\n    }\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'post':\n        return 'Blog Post';\n      case 'project':\n        return 'Project';\n      case 'page':\n        return 'Page';\n      case 'service':\n        return 'Service';\n      default:\n        return type;\n    }\n  };\n\n  return (\n    <>\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={() => setIsOpen(true)}\n        className=\"relative\"\n        data-testid=\"button-global-search\"\n      >\n        <Search className=\"w-5 h-5\" />\n      </Button>\n\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\n        <DialogContent className=\"max-w-2xl p-0 gap-0 overflow-hidden\">\n          <DialogHeader className=\"p-4 pb-0\">\n            <DialogTitle className=\"sr-only\">Search</DialogTitle>\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search posts, projects, pages...\"\n                value={query}\n                onChange={(e) => setQuery(e.target.value)}\n                className=\"pl-10 pr-10\"\n                autoFocus\n                data-testid=\"input-global-search\"\n              />\n              {query && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"absolute right-1 top-1/2 -translate-y-1/2\"\n                  onClick={() => setQuery(\"\")}\n                  data-testid=\"button-clear-search\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              )}\n            </div>\n          </DialogHeader>\n\n          <div className=\"p-4 max-h-[60vh] overflow-y-auto\">\n            {isLoading && debouncedQuery.length >= 2 && (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n              </div>\n            )}\n\n            {!isLoading && debouncedQuery.length >= 2 && data?.results.length === 0 && (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <Search className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                <p>No results found for \"{debouncedQuery}\"</p>\n              </div>\n            )}\n\n            {!isLoading && debouncedQuery.length < 2 && (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <p className=\"text-sm\">Type at least 2 characters to search</p>\n                <p className=\"text-xs mt-2\">\n                  Press <kbd className=\"px-1.5 py-0.5 rounded bg-muted text-xs\">Ctrl</kbd> + <kbd className=\"px-1.5 py-0.5 rounded bg-muted text-xs\">K</kbd> to open search\n                </p>\n              </div>\n            )}\n\n            <AnimatePresence>\n              {data?.results && data.results.length > 0 && (\n                <motion.div\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  exit={{ opacity: 0 }}\n                  className=\"space-y-2\"\n                >\n                  {data.results.map((result, index) => (\n                    <motion.div\n                      key={`${result.type}-${result.id}`}\n                      initial={{ opacity: 0, y: 10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: index * 0.05 }}\n                    >\n                      <Link href={getLink(result)} onClick={() => setIsOpen(false)}>\n                        <div \n                          className=\"flex items-start gap-3 p-3 rounded-lg hover-elevate cursor-pointer\"\n                          data-testid={`search-result-${result.type}-${result.id}`}\n                        >\n                          <div className=\"flex-shrink-0 p-2 bg-muted rounded-md\">\n                            {getIcon(result.type)}\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              <h4 className=\"font-medium truncate\">{result.title}</h4>\n                              <Badge variant=\"secondary\" className=\"text-xs flex-shrink-0\">\n                                {getTypeLabel(result.type)}\n                              </Badge>\n                            </div>\n                            {result.excerpt && (\n                              <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                                {result.excerpt}\n                              </p>\n                            )}\n                          </div>\n                          {result.thumbnail && (\n                            <img\n                              src={result.thumbnail}\n                              alt=\"\"\n                              className=\"w-12 h-12 rounded object-cover flex-shrink-0\"\n                            />\n                          )}\n                        </div>\n                      </Link>\n                    </motion.div>\n                  ))}\n                  \n                  {data.total > data.results.length && (\n                    <p className=\"text-center text-sm text-muted-foreground pt-2\">\n                      Showing {data.results.length} of {data.total} results\n                    </p>\n                  )}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n","path":null,"size_bytes":8216,"size_tokens":null},"client/src/components/common/LazyImage.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\n\ninterface LazyImageProps extends React.ImgHTMLAttributes<HTMLImageElement> {\n  src: string;\n  alt: string;\n  placeholder?: string;\n  aspectRatio?: string;\n  objectFit?: \"cover\" | \"contain\" | \"fill\" | \"none\";\n  blurDataURL?: string;\n}\n\nexport function LazyImage({\n  src,\n  alt,\n  placeholder,\n  aspectRatio,\n  objectFit = \"cover\",\n  blurDataURL,\n  className,\n  ...props\n}: LazyImageProps) {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [isInView, setIsInView] = useState(false);\n  const [hasError, setHasError] = useState(false);\n  const imgRef = useRef<HTMLImageElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setIsInView(true);\n          observer.disconnect();\n        }\n      },\n      {\n        rootMargin: \"100px\",\n        threshold: 0.1,\n      }\n    );\n\n    if (containerRef.current) {\n      observer.observe(containerRef.current);\n    }\n\n    return () => observer.disconnect();\n  }, []);\n\n  const handleLoad = () => {\n    setIsLoaded(true);\n  };\n\n  const handleError = () => {\n    setHasError(true);\n    setIsLoaded(true);\n  };\n\n  const defaultPlaceholder = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect fill='%23f0f0f0' width='100' height='100'/%3E%3C/svg%3E\";\n\n  const placeholderSrc = blurDataURL || placeholder || defaultPlaceholder;\n\n  return (\n    <div\n      ref={containerRef}\n      className={cn(\n        \"relative overflow-hidden bg-muted\",\n        className\n      )}\n      style={{\n        aspectRatio: aspectRatio,\n      }}\n    >\n      {!isLoaded && (\n        <motion.div\n          initial={{ opacity: 1 }}\n          animate={{ opacity: isLoaded ? 0 : 1 }}\n          className=\"absolute inset-0 animate-pulse bg-muted\"\n        />\n      )}\n      \n      {isInView && !hasError && (\n        <motion.img\n          ref={imgRef}\n          src={src}\n          alt={alt}\n          initial={{ opacity: 0 }}\n          animate={{ opacity: isLoaded ? 1 : 0 }}\n          transition={{ duration: 0.3 }}\n          onLoad={handleLoad}\n          onError={handleError}\n          className={cn(\n            \"w-full h-full transition-opacity duration-300\",\n            objectFit === \"cover\" && \"object-cover\",\n            objectFit === \"contain\" && \"object-contain\",\n            objectFit === \"fill\" && \"object-fill\",\n            objectFit === \"none\" && \"object-none\"\n          )}\n          loading=\"lazy\"\n        />\n      )}\n\n      {hasError && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-muted\">\n          <div className=\"text-center text-muted-foreground\">\n            <svg\n              className=\"w-12 h-12 mx-auto mb-2 opacity-50\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={1.5}\n                d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n              />\n            </svg>\n            <p className=\"text-sm\">Image not available</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":3508,"size_tokens":null},"server/api/search.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport crypto from \"crypto\";\n\nconst router = Router();\n\ninterface SearchResult {\n  type: 'post' | 'project' | 'page' | 'service';\n  id: number;\n  title: string;\n  slug: string;\n  excerpt?: string;\n  thumbnail?: string;\n  createdAt?: Date;\n}\n\nfunction getVisitorId(req: any): string {\n  const ip = req.ip || req.socket.remoteAddress || 'unknown';\n  const userAgent = req.get('User-Agent') || 'unknown';\n  return crypto.createHash('md5').update(`${ip}-${userAgent}`).digest('hex').substring(0, 16);\n}\n\nrouter.get(\"/\", async (req: Request, res: Response) => {\n  try {\n    const query = (req.query.q as string || \"\").toLowerCase().trim();\n    const limit = parseInt(req.query.limit as string) || 10;\n    \n    if (!query || query.length < 2) {\n      return res.json({ results: [], total: 0 });\n    }\n\n    const results: SearchResult[] = [];\n\n    const posts = await storage.getAllPosts();\n    const publishedPosts = posts.filter(p => p.status?.toLowerCase() === 'published');\n    for (const post of publishedPosts) {\n      if (\n        post.title.toLowerCase().includes(query) ||\n        (post.excerpt && post.excerpt.toLowerCase().includes(query)) ||\n        (post.content && post.content.toLowerCase().includes(query))\n      ) {\n        results.push({\n          type: 'post',\n          id: post.id,\n          title: post.title,\n          slug: post.slug,\n          excerpt: post.excerpt || undefined,\n          thumbnail: post.featuredImage || undefined,\n          createdAt: post.createdAt || undefined,\n        });\n      }\n    }\n\n    const projects = await storage.getAllProjects();\n    for (const project of projects) {\n      if (\n        project.title.toLowerCase().includes(query) ||\n        (project.description && project.description.toLowerCase().includes(query)) ||\n        (project.tech && project.tech.some((t: string) => t.toLowerCase().includes(query)))\n      ) {\n        results.push({\n          type: 'project',\n          id: project.id,\n          title: project.title,\n          slug: project.title.toLowerCase().replace(/\\s+/g, '-'),\n          excerpt: project.description || undefined,\n          thumbnail: project.image || undefined,\n        });\n      }\n    }\n\n    const pages = await storage.getAllPages();\n    const publishedPages = pages.filter(p => p.status?.toLowerCase() === 'published');\n    for (const page of publishedPages) {\n      if (\n        page.title.toLowerCase().includes(query) ||\n        (page.content && page.content.toLowerCase().includes(query))\n      ) {\n        results.push({\n          type: 'page',\n          id: page.id,\n          title: page.title,\n          slug: page.slug,\n          excerpt: page.metaDescription || undefined,\n          thumbnail: page.featuredImage || undefined,\n        });\n      }\n    }\n\n    const services = await storage.getAllServices();\n    for (const service of services) {\n      if (\n        service.title.toLowerCase().includes(query) ||\n        (service.description && service.description.toLowerCase().includes(query))\n      ) {\n        results.push({\n          type: 'service',\n          id: service.id,\n          title: service.title,\n          slug: service.title.toLowerCase().replace(/\\s+/g, '-'),\n          excerpt: service.description || undefined,\n          thumbnail: service.icon || undefined,\n        });\n      }\n    }\n\n    results.sort((a, b) => {\n      const aTitle = a.title.toLowerCase().includes(query) ? 1 : 0;\n      const bTitle = b.title.toLowerCase().includes(query) ? 1 : 0;\n      return bTitle - aTitle;\n    });\n\n    const limitedResults = results.slice(0, limit);\n\n    try {\n      const visitorId = getVisitorId(req);\n      await storage.createSearchHistory({\n        query: req.query.q as string,\n        resultsCount: results.length,\n        visitorId,\n        userId: (req.session as any)?.userId || null,\n      });\n    } catch (e) {\n      console.error(\"Failed to log search history:\", e);\n    }\n\n    res.json({\n      results: limitedResults,\n      total: results.length,\n      query,\n    });\n  } catch (error: any) {\n    console.error(\"Search error:\", error);\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/autocomplete\", async (req: Request, res: Response) => {\n  try {\n    const query = (req.query.q as string || \"\").toLowerCase().trim();\n    \n    if (!query || query.length < 2) {\n      return res.json({ suggestions: [] });\n    }\n\n    const suggestions: string[] = [];\n\n    const posts = await storage.getAllPosts();\n    const publishedPosts = posts.filter(p => p.status?.toLowerCase() === 'published');\n    for (const post of publishedPosts) {\n      if (post.title.toLowerCase().includes(query) && !suggestions.includes(post.title)) {\n        suggestions.push(post.title);\n      }\n    }\n\n    const projects = await storage.getAllProjects();\n    for (const project of projects) {\n      if (project.title.toLowerCase().includes(query) && !suggestions.includes(project.title)) {\n        suggestions.push(project.title);\n      }\n      if (project.tech) {\n        for (const tech of project.tech as string[]) {\n          if (tech.toLowerCase().includes(query) && !suggestions.includes(tech)) {\n            suggestions.push(tech);\n          }\n        }\n      }\n    }\n\n    res.json({ suggestions: suggestions.slice(0, 10) });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/popular\", async (req: Request, res: Response) => {\n  try {\n    const popular = await storage.getPopularSearches(10);\n    res.json(popular);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/history\", async (req: Request, res: Response) => {\n  try {\n    if (!(req.session as any)?.userId) {\n      return res.json({ history: [] });\n    }\n    const history = await storage.getUserSearchHistory((req.session as any).userId, 10);\n    res.json({ history });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/admin/stats\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const popular = await storage.getPopularSearches(20);\n    res.json({ popularSearches: popular });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":6394,"size_tokens":null},"client/src/components/common/SocialShare.tsx":{"content":"import { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { Share2, Link as LinkIcon, Check, X } from \"lucide-react\";\nimport { SiFacebook, SiX, SiLinkedin, SiWhatsapp, SiTelegram, SiReddit } from \"react-icons/si\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface SocialShareProps {\n  url: string;\n  title: string;\n  description?: string;\n  image?: string;\n  compact?: boolean;\n}\n\nexport function SocialShare({ url, title, description, image, compact = false }: SocialShareProps) {\n  const [copied, setCopied] = useState(false);\n  const [isOpen, setIsOpen] = useState(false);\n  const { toast } = useToast();\n\n  const fullUrl = url.startsWith(\"http\") ? url : `${window.location.origin}${url}`;\n  const encodedUrl = encodeURIComponent(fullUrl);\n  const encodedTitle = encodeURIComponent(title);\n  const encodedDescription = encodeURIComponent(description || \"\");\n\n  const shareLinks = [\n    {\n      name: \"Facebook\",\n      icon: SiFacebook,\n      href: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,\n      color: \"hover:text-[#1877F2]\",\n    },\n    {\n      name: \"X\",\n      icon: SiX,\n      href: `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`,\n      color: \"hover:text-foreground\",\n    },\n    {\n      name: \"LinkedIn\",\n      icon: SiLinkedin,\n      href: `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`,\n      color: \"hover:text-[#0A66C2]\",\n    },\n    {\n      name: \"WhatsApp\",\n      icon: SiWhatsapp,\n      href: `https://wa.me/?text=${encodedTitle}%20${encodedUrl}`,\n      color: \"hover:text-[#25D366]\",\n    },\n    {\n      name: \"Telegram\",\n      icon: SiTelegram,\n      href: `https://t.me/share/url?url=${encodedUrl}&text=${encodedTitle}`,\n      color: \"hover:text-[#26A5E4]\",\n    },\n    {\n      name: \"Reddit\",\n      icon: SiReddit,\n      href: `https://www.reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`,\n      color: \"hover:text-[#FF4500]\",\n    },\n  ];\n\n  const copyToClipboard = async () => {\n    try {\n      await navigator.clipboard.writeText(fullUrl);\n      setCopied(true);\n      toast({\n        title: \"Link copied!\",\n        description: \"The link has been copied to your clipboard.\",\n      });\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      toast({\n        title: \"Failed to copy\",\n        description: \"Please try again or copy manually.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleShare = (href: string) => {\n    window.open(href, \"_blank\", \"width=600,height=400,noopener,noreferrer\");\n    setIsOpen(false);\n  };\n\n  if (compact) {\n    return (\n      <Popover open={isOpen} onOpenChange={setIsOpen}>\n        <PopoverTrigger asChild>\n          <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-share\">\n            <Share2 className=\"w-4 h-4\" />\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-auto p-2\" align=\"end\">\n          <div className=\"flex items-center gap-1\">\n            {shareLinks.slice(0, 4).map((link) => (\n              <Button\n                key={link.name}\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => handleShare(link.href)}\n                className={`${link.color} transition-colors`}\n                data-testid={`button-share-${link.name.toLowerCase()}`}\n              >\n                <link.icon className=\"w-4 h-4\" />\n              </Button>\n            ))}\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={copyToClipboard}\n              className=\"transition-colors\"\n              data-testid=\"button-copy-link\"\n            >\n              {copied ? <Check className=\"w-4 h-4 text-green-500\" /> : <LinkIcon className=\"w-4 h-4\" />}\n            </Button>\n          </div>\n        </PopoverContent>\n      </Popover>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-wrap items-center gap-2\">\n      <span className=\"text-sm text-muted-foreground mr-1\">Share:</span>\n      {shareLinks.map((link) => (\n        <Button\n          key={link.name}\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={() => handleShare(link.href)}\n          className={`${link.color} transition-colors`}\n          title={`Share on ${link.name}`}\n          data-testid={`button-share-${link.name.toLowerCase()}`}\n        >\n          <link.icon className=\"w-4 h-4\" />\n        </Button>\n      ))}\n      <Button\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={copyToClipboard}\n        className=\"transition-colors\"\n        title=\"Copy link\"\n        data-testid=\"button-copy-link\"\n      >\n        {copied ? <Check className=\"w-4 h-4 text-green-500\" /> : <LinkIcon className=\"w-4 h-4\" />}\n      </Button>\n    </div>\n  );\n}\n","path":null,"size_bytes":4909,"size_tokens":null},"client/src/components/common/SEOHead.tsx":{"content":"import { useEffect } from \"react\";\n\ninterface SEOHeadProps {\n  title: string;\n  description?: string;\n  image?: string;\n  url?: string;\n  type?: \"website\" | \"article\" | \"profile\";\n  author?: string;\n  publishedTime?: string;\n  modifiedTime?: string;\n  tags?: string[];\n}\n\nexport function SEOHead({\n  title,\n  description,\n  image,\n  url,\n  type = \"website\",\n  author,\n  publishedTime,\n  modifiedTime,\n  tags,\n}: SEOHeadProps) {\n  useEffect(() => {\n    const siteName = document.querySelector('meta[property=\"og:site_name\"]')?.getAttribute('content') || \"Portfolio\";\n    const fullUrl = url || window.location.href;\n    const fullImage = image?.startsWith(\"http\") ? image : image ? `${window.location.origin}${image}` : undefined;\n\n    document.title = title;\n\n    const updateOrCreateMeta = (property: string, content: string | undefined, isName = false) => {\n      if (!content) return;\n      const attr = isName ? \"name\" : \"property\";\n      let element = document.querySelector(`meta[${attr}=\"${property}\"]`);\n      if (!element) {\n        element = document.createElement(\"meta\");\n        element.setAttribute(attr, property);\n        document.head.appendChild(element);\n      }\n      element.setAttribute(\"content\", content);\n    };\n\n    updateOrCreateMeta(\"description\", description, true);\n    updateOrCreateMeta(\"og:title\", title);\n    updateOrCreateMeta(\"og:description\", description);\n    updateOrCreateMeta(\"og:url\", fullUrl);\n    updateOrCreateMeta(\"og:type\", type);\n    updateOrCreateMeta(\"og:site_name\", siteName);\n    if (fullImage) {\n      updateOrCreateMeta(\"og:image\", fullImage);\n      updateOrCreateMeta(\"og:image:width\", \"1200\");\n      updateOrCreateMeta(\"og:image:height\", \"630\");\n    }\n\n    updateOrCreateMeta(\"twitter:card\", fullImage ? \"summary_large_image\" : \"summary\");\n    updateOrCreateMeta(\"twitter:title\", title);\n    updateOrCreateMeta(\"twitter:description\", description);\n    if (fullImage) {\n      updateOrCreateMeta(\"twitter:image\", fullImage);\n    }\n\n    if (type === \"article\") {\n      updateOrCreateMeta(\"article:author\", author);\n      updateOrCreateMeta(\"article:published_time\", publishedTime);\n      updateOrCreateMeta(\"article:modified_time\", modifiedTime);\n      tags?.forEach((tag, index) => {\n        updateOrCreateMeta(`article:tag:${index}`, tag);\n      });\n    }\n\n    return () => {\n    };\n  }, [title, description, image, url, type, author, publishedTime, modifiedTime, tags]);\n\n  return null;\n}\n","path":null,"size_bytes":2445,"size_tokens":null},"server/api/comments-extended.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport crypto from \"crypto\";\n\nconst router = Router();\n\nfunction getVisitorId(req: any): string {\n  const ip = req.ip || req.socket.remoteAddress || 'unknown';\n  const userAgent = req.get('User-Agent') || 'unknown';\n  return crypto.createHash('md5').update(`${ip}-${userAgent}`).digest('hex').substring(0, 16);\n}\n\nrouter.get(\"/:commentId/likes\", async (req: Request, res: Response) => {\n  try {\n    const commentId = parseInt(req.params.commentId);\n    const visitorId = getVisitorId(req);\n    \n    const likes = await storage.getCommentLikes(commentId);\n    const userLike = await storage.getVisitorCommentLike(commentId, visitorId);\n    \n    res.json({\n      ...likes,\n      userVote: userLike ? (userLike.isLike ? 'like' : 'dislike') : null,\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/:commentId/like\", async (req: Request, res: Response) => {\n  try {\n    const commentId = parseInt(req.params.commentId);\n    const visitorId = getVisitorId(req);\n    \n    await storage.upsertCommentLike({\n      commentId,\n      visitorId,\n      isLike: true,\n    });\n    \n    const likes = await storage.getCommentLikes(commentId);\n    res.json({ ...likes, userVote: 'like' });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/:commentId/dislike\", async (req: Request, res: Response) => {\n  try {\n    const commentId = parseInt(req.params.commentId);\n    const visitorId = getVisitorId(req);\n    \n    await storage.upsertCommentLike({\n      commentId,\n      visitorId,\n      isLike: false,\n    });\n    \n    const likes = await storage.getCommentLikes(commentId);\n    res.json({ ...likes, userVote: 'dislike' });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:commentId/vote\", async (req: Request, res: Response) => {\n  try {\n    const commentId = parseInt(req.params.commentId);\n    const visitorId = getVisitorId(req);\n    \n    await storage.deleteCommentLike(commentId, visitorId);\n    \n    const likes = await storage.getCommentLikes(commentId);\n    res.json({ ...likes, userVote: null });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/:commentId/report\", async (req: Request, res: Response) => {\n  try {\n    const commentId = parseInt(req.params.commentId);\n    const { reason, reporterEmail } = req.body;\n    \n    if (!reason) {\n      return res.status(400).json({ message: \"Reason is required\" });\n    }\n    \n    await storage.createCommentReport({\n      commentId,\n      reason,\n      reporterEmail: reporterEmail || null,\n    });\n    \n    await storage.createActivityLog({\n      action: `Comment #${commentId} was reported: ${reason}`,\n      type: 'warning'\n    });\n    \n    res.json({ message: \"Report submitted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/reports\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { status } = req.query;\n    \n    if (status === 'pending') {\n      const reports = await storage.getPendingCommentReports();\n      return res.json(reports);\n    }\n    \n    const reports = await storage.getAllCommentReports();\n    res.json(reports);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/reports/:id\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const reportId = parseInt(req.params.id);\n    const { status } = req.body;\n    \n    if (!status || !['reviewed', 'dismissed'].includes(status)) {\n      return res.status(400).json({ message: \"Valid status is required\" });\n    }\n    \n    const report = await storage.updateCommentReportStatus(\n      reportId, \n      status, \n      (req.session as any).userId!\n    );\n    \n    if (!report) {\n      return res.status(404).json({ message: \"Report not found\" });\n    }\n    \n    res.json(report);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/reports/:id/delete-comment\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const reportId = parseInt(req.params.id);\n    \n    const report = await storage.getCommentReport(reportId);\n    if (!report) {\n      return res.status(404).json({ message: \"Report not found\" });\n    }\n    \n    await storage.deleteComment(report.commentId);\n    await storage.updateCommentReportStatus(reportId, 'reviewed', (req.session as any).userId!);\n    \n    await storage.createActivityLog({\n      action: `Deleted comment #${report.commentId} after reviewing report`,\n      userId: (req.session as any).userId,\n      userName: (req.session as any).username,\n      type: 'warning'\n    });\n    \n    res.json({ message: \"Comment deleted and report reviewed\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":5086,"size_tokens":null},"server/api/email-campaigns.ts":{"content":"import { Router, Request } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { insertEmailCampaignSchema, insertEmailTemplateSchema } from \"@shared/schema\";\nimport nodemailer from \"nodemailer\";\n\nconst router = Router();\n\nfunction getBaseUrl(req: Request): string {\n  if (process.env.SITE_URL) return process.env.SITE_URL;\n  const protocol = req.headers['x-forwarded-proto'] || req.protocol || 'https';\n  const host = req.headers['x-forwarded-host'] || req.headers.host || 'localhost:5000';\n  return `${protocol}://${host}`;\n}\n\nasync function getSmtpTransporter() {\n  const smtpHost = await storage.getSetting(\"smtpHost\");\n  const smtpPort = await storage.getSetting(\"smtpPort\");\n  const smtpUser = await storage.getSetting(\"smtpUser\");\n  const smtpPassword = await storage.getSetting(\"smtpPassword\");\n  const smtpSecure = await storage.getSetting(\"smtpSecure\");\n\n  if (!smtpHost?.value || !smtpPort?.value || !smtpUser?.value || !smtpPassword?.value) {\n    return null;\n  }\n\n  const port = typeof smtpPort.value === 'string' ? parseInt(smtpPort.value) : smtpPort.value;\n  const secure = smtpSecure?.value === true || smtpSecure?.value === 'true';\n\n  return nodemailer.createTransport({\n    host: smtpHost.value as string,\n    port: port as number,\n    secure: secure,\n    auth: {\n      user: smtpUser.value as string,\n      pass: smtpPassword.value as string,\n    },\n    requireTLS: !secure,\n  });\n}\n\nrouter.get(\"/templates\", requireAdmin, async (req, res) => {\n  try {\n    const templates = await storage.getAllEmailTemplates();\n    res.json(templates);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const template = await storage.getEmailTemplate(parseInt(req.params.id));\n    if (!template) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/templates\", requireAdmin, async (req, res) => {\n  try {\n    const parsed = insertEmailTemplateSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const template = await storage.createEmailTemplate(parsed.data);\n    res.status(201).json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const template = await storage.updateEmailTemplate(parseInt(req.params.id), req.body);\n    if (!template) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const deleted = await storage.deleteEmailTemplate(parseInt(req.params.id));\n    if (!deleted) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json({ message: \"Template deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/campaigns\", requireAdmin, async (req, res) => {\n  try {\n    const campaigns = await storage.getAllEmailCampaigns();\n    res.json(campaigns);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/campaigns/:id\", requireAdmin, async (req, res) => {\n  try {\n    const campaign = await storage.getEmailCampaign(parseInt(req.params.id));\n    if (!campaign) {\n      return res.status(404).json({ message: \"Campaign not found\" });\n    }\n    res.json(campaign);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/campaigns\", requireAdmin, async (req, res) => {\n  try {\n    const parsed = insertEmailCampaignSchema.safeParse(req.body);\n    if (!parsed.success) {\n      return res.status(400).json({ message: \"Invalid data\", errors: parsed.error.errors });\n    }\n    const campaign = await storage.createEmailCampaign(parsed.data);\n    res.status(201).json(campaign);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/campaigns/:id\", requireAdmin, async (req, res) => {\n  try {\n    const campaign = await storage.updateEmailCampaign(parseInt(req.params.id), req.body);\n    if (!campaign) {\n      return res.status(404).json({ message: \"Campaign not found\" });\n    }\n    res.json(campaign);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/campaigns/:id\", requireAdmin, async (req, res) => {\n  try {\n    const deleted = await storage.deleteEmailCampaign(parseInt(req.params.id));\n    if (!deleted) {\n      return res.status(404).json({ message: \"Campaign not found\" });\n    }\n    res.json({ message: \"Campaign deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/campaigns/:id/send\", requireAdmin, async (req, res) => {\n  try {\n    const campaignId = parseInt(req.params.id);\n    const campaign = await storage.getEmailCampaign(campaignId);\n    \n    if (!campaign) {\n      return res.status(404).json({ message: \"Campaign not found\" });\n    }\n\n    if (campaign.status === 'sent') {\n      return res.status(400).json({ message: \"Campaign has already been sent\" });\n    }\n\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.status(400).json({ message: \"SMTP is not configured\" });\n    }\n\n    const subscribers = await storage.getActiveSubscribers();\n    if (subscribers.length === 0) {\n      return res.status(400).json({ message: \"No active subscribers found\" });\n    }\n\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n\n    await storage.updateEmailCampaign(campaignId, {\n      status: 'sending',\n    });\n\n    let sent = 0;\n    for (const subscriber of subscribers) {\n      try {\n        const baseUrl = getBaseUrl(req);\n        const unsubscribeUrl = `${baseUrl}/api/subscribers/unsubscribe/${subscriber.unsubscribeToken}`;\n\n        let htmlContent = campaign.content;\n        htmlContent = htmlContent.replace(/\\{\\{name\\}\\}/g, subscriber.name || 'Subscriber');\n        htmlContent = htmlContent.replace(/\\{\\{email\\}\\}/g, subscriber.email);\n        htmlContent = htmlContent.replace(/\\{\\{unsubscribe_url\\}\\}/g, unsubscribeUrl);\n\n        const fullHtml = `\n          <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n            ${htmlContent}\n            <div style=\"padding: 20px; text-align: center; background: #f3f4f6; color: #6b7280; font-size: 12px; margin-top: 30px;\">\n              <p style=\"margin: 0 0 10px 0;\">You received this email because you subscribed to our newsletter.</p>\n              <a href=\"${unsubscribeUrl}\" style=\"color: #6b7280;\">Unsubscribe</a>\n            </div>\n          </div>\n        `;\n\n        await transporter.sendMail({\n          from: `\"${emailFromName?.value || siteTitle?.value || 'Newsletter'}\" <${emailFromAddress?.value || smtpUser?.value}>`,\n          to: subscriber.email,\n          subject: campaign.subject,\n          html: fullHtml,\n        });\n        sent++;\n      } catch (emailError) {\n        console.error(`Failed to send email to ${subscriber.email}:`, emailError);\n      }\n    }\n\n    await storage.updateEmailCampaign(campaignId, {\n      status: 'sent',\n      sentAt: new Date(),\n      recipientCount: sent,\n    });\n\n    await storage.createActivityLog({\n      action: `Email campaign \"${campaign.name}\" sent to ${sent} subscribers`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: 'success'\n    });\n\n    res.json({ message: `Campaign sent to ${sent} subscribers`, sent });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/campaigns/:id/test\", requireAdmin, async (req, res) => {\n  try {\n    const { testEmail } = req.body;\n    const campaignId = parseInt(req.params.id);\n    \n    if (!testEmail) {\n      return res.status(400).json({ message: \"Test email is required\" });\n    }\n\n    const campaign = await storage.getEmailCampaign(campaignId);\n    if (!campaign) {\n      return res.status(404).json({ message: \"Campaign not found\" });\n    }\n\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.status(400).json({ message: \"SMTP is not configured\" });\n    }\n\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n\n    let htmlContent = campaign.content;\n    htmlContent = htmlContent.replace(/\\{\\{name\\}\\}/g, 'Test User');\n    htmlContent = htmlContent.replace(/\\{\\{email\\}\\}/g, testEmail);\n    htmlContent = htmlContent.replace(/\\{\\{unsubscribe_url\\}\\}/g, '#');\n\n    const fullHtml = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: #fef3c7; color: #92400e; padding: 10px; text-align: center; font-size: 12px;\">\n          This is a test email\n        </div>\n        ${htmlContent}\n      </div>\n    `;\n\n    await transporter.sendMail({\n      from: `\"${emailFromName?.value || siteTitle?.value || 'Newsletter'}\" <${emailFromAddress?.value || smtpUser?.value}>`,\n      to: testEmail,\n      subject: `[TEST] ${campaign.subject}`,\n      html: fullHtml,\n    });\n\n    res.json({ message: `Test email sent to ${testEmail}` });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":10061,"size_tokens":null},"server/api/translations.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req: Request, res: Response) => {\n  try {\n    const { locale, namespace } = req.query;\n    \n    if (!locale) {\n      return res.status(400).json({ message: \"Locale is required\" });\n    }\n    \n    const translations = await storage.getTranslationsByLocale(\n      locale as string, \n      namespace as string | undefined\n    );\n    \n    const translationMap: Record<string, string> = {};\n    for (const t of translations) {\n      translationMap[t.key] = t.value;\n    }\n    \n    res.json(translationMap);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/all\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { locale, namespace } = req.query;\n    \n    if (locale) {\n      const translations = await storage.getTranslationsByLocale(\n        locale as string, \n        namespace as string | undefined\n      );\n      return res.json(translations);\n    }\n    \n    const enTranslations = await storage.getTranslationsByLocale('en');\n    const viTranslations = await storage.getTranslationsByLocale('vi');\n    \n    res.json({\n      en: enTranslations,\n      vi: viTranslations,\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { key, locale, value, namespace } = req.body;\n    \n    if (!key || !locale || !value) {\n      return res.status(400).json({ message: \"Key, locale, and value are required\" });\n    }\n    \n    const translation = await storage.upsertTranslation({\n      key,\n      locale,\n      value,\n      namespace: namespace || 'common',\n    });\n    \n    res.json(translation);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/bulk\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { translations, locale, namespace } = req.body;\n    \n    if (!translations || !locale || typeof translations !== 'object') {\n      return res.status(400).json({ message: \"Translations object and locale are required\" });\n    }\n    \n    const results = [];\n    for (const [key, value] of Object.entries(translations)) {\n      if (typeof value === 'string') {\n        const translation = await storage.upsertTranslation({\n          key,\n          locale,\n          value,\n          namespace: namespace || 'common',\n        });\n        results.push(translation);\n      }\n    }\n    \n    res.json({ updated: results.length });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const deleted = await storage.deleteTranslation(id);\n    \n    if (!deleted) {\n      return res.status(404).json({ message: \"Translation not found\" });\n    }\n    \n    res.json({ message: \"Translation deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/export\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { locale } = req.query;\n    \n    if (!locale) {\n      return res.status(400).json({ message: \"Locale is required\" });\n    }\n    \n    const translations = await storage.getTranslationsByLocale(locale as string);\n    \n    const exportData: Record<string, Record<string, string>> = {};\n    for (const t of translations) {\n      const ns = t.namespace || 'common';\n      if (!exportData[ns]) {\n        exportData[ns] = {};\n      }\n      exportData[ns][t.key] = t.value;\n    }\n    \n    res.setHeader('Content-Type', 'application/json');\n    res.setHeader('Content-Disposition', `attachment; filename=translations-${locale}.json`);\n    res.json(exportData);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/import\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { locale, data } = req.body;\n    \n    if (!locale || !data) {\n      return res.status(400).json({ message: \"Locale and data are required\" });\n    }\n    \n    let imported = 0;\n    \n    for (const [namespace, translations] of Object.entries(data)) {\n      if (typeof translations === 'object' && translations !== null) {\n        for (const [key, value] of Object.entries(translations as Record<string, string>)) {\n          if (typeof value === 'string') {\n            await storage.upsertTranslation({\n              key,\n              locale,\n              value,\n              namespace,\n            });\n            imported++;\n          }\n        }\n      }\n    }\n    \n    res.json({ message: `Imported ${imported} translations`, imported });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":5005,"size_tokens":null},"server/api/password-reset.ts":{"content":"import { Router, Request } from \"express\";\nimport { storage } from \"../storage\";\nimport { hashPassword } from \"../utils/password\";\nimport nodemailer from \"nodemailer\";\nimport crypto from \"crypto\";\n\nconst router = Router();\n\nfunction getBaseUrl(req: Request): string {\n  if (process.env.SITE_URL) return process.env.SITE_URL;\n  const protocol = req.headers['x-forwarded-proto'] || req.protocol || 'https';\n  const host = req.headers['x-forwarded-host'] || req.headers.host || 'localhost:5000';\n  return `${protocol}://${host}`;\n}\n\nasync function getSmtpTransporter() {\n  const smtpHost = await storage.getSetting(\"smtpHost\");\n  const smtpPort = await storage.getSetting(\"smtpPort\");\n  const smtpUser = await storage.getSetting(\"smtpUser\");\n  const smtpPassword = await storage.getSetting(\"smtpPassword\");\n  const smtpSecure = await storage.getSetting(\"smtpSecure\");\n\n  if (!smtpHost?.value || !smtpPort?.value || !smtpUser?.value || !smtpPassword?.value) {\n    return null;\n  }\n\n  const port = typeof smtpPort.value === 'string' ? parseInt(smtpPort.value) : smtpPort.value;\n  const secure = smtpSecure?.value === true || smtpSecure?.value === 'true';\n\n  return nodemailer.createTransport({\n    host: smtpHost.value as string,\n    port: port as number,\n    secure: secure,\n    auth: {\n      user: smtpUser.value as string,\n      pass: smtpPassword.value as string,\n    },\n    requireTLS: !secure,\n    connectionTimeout: 10000,\n    greetingTimeout: 10000,\n    socketTimeout: 10000,\n  });\n}\n\nrouter.post(\"/forgot-password\", async (req, res) => {\n  try {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ message: \"Email is required\" });\n    }\n\n    const user = await storage.getUserByEmail(email);\n    \n    // Always return the same message for security (prevent email enumeration)\n    const successMessage = \"If an account exists with this email, a password reset link has been sent.\";\n    \n    if (!user) {\n      // User doesn't exist - don't send email, but return success message\n      console.log(`Password reset requested for non-existent email: ${email}`);\n      return res.json({ message: successMessage });\n    }\n\n    const token = crypto.randomBytes(32).toString('hex');\n    const expiresAt = new Date(Date.now() + 60 * 60 * 1000);\n\n    await storage.createPasswordResetToken({\n      userId: user.id,\n      token,\n      expiresAt,\n    });\n\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      console.log('SMTP not configured, skipping password reset email');\n      return res.json({ message: successMessage });\n    }\n\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n\n    const baseUrl = getBaseUrl(req);\n    const resetUrl = `${baseUrl}/reset-password?token=${token}`;\n\n    const htmlBody = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; color: white; text-align: center;\">\n          <h2 style=\"margin: 0;\">${siteTitle?.value || 'Portfolio'}</h2>\n        </div>\n        <div style=\"padding: 30px; background: #f9fafb;\">\n          <p style=\"color: #374151;\">Hello ${user.name},</p>\n          <p style=\"color: #374151;\">You have requested to reset your password. Click the button below to set a new password:</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${resetUrl}\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; display: inline-block;\">Reset Password</a>\n          </div>\n          <p style=\"color: #6b7280; font-size: 14px;\">This link will expire in 1 hour.</p>\n          <p style=\"color: #6b7280; font-size: 14px;\">If you didn't request a password reset, please ignore this email.</p>\n        </div>\n        <div style=\"padding: 20px; text-align: center; background: #374151; color: #9ca3af; font-size: 12px;\">\n          <p style=\"margin: 0;\">Sent from ${siteTitle?.value || 'Portfolio'}</p>\n        </div>\n      </div>\n    `;\n\n    await transporter.sendMail({\n      from: `\"${emailFromName?.value || siteTitle?.value || 'Portfolio'}\" <${emailFromAddress?.value || smtpUser?.value}>`,\n      to: user.email,\n      subject: \"Password Reset Request\",\n      html: htmlBody,\n    });\n\n    await storage.createActivityLog({\n      action: `Password reset requested for ${user.email}`,\n      userId: user.id,\n      userName: user.username,\n      type: 'info'\n    });\n\n    res.json({ message: successMessage });\n  } catch (error: any) {\n    console.error('Forgot password error:', error);\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/reset-password\", async (req, res) => {\n  try {\n    const { token, newPassword } = req.body;\n\n    if (!token || !newPassword) {\n      return res.status(400).json({ message: \"Token and new password are required\" });\n    }\n\n    if (newPassword.length < 8) {\n      return res.status(400).json({ message: \"Password must be at least 8 characters long\" });\n    }\n\n    const resetToken = await storage.getPasswordResetToken(token);\n    if (!resetToken) {\n      return res.status(400).json({ message: \"Invalid or expired reset token\" });\n    }\n\n    if (resetToken.used) {\n      return res.status(400).json({ message: \"This reset token has already been used\" });\n    }\n\n    if (new Date() > resetToken.expiresAt) {\n      return res.status(400).json({ message: \"Reset token has expired\" });\n    }\n\n    const hashedPassword = await hashPassword(newPassword);\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + 90 * 24 * 60 * 60 * 1000);\n\n    await storage.updateUser(resetToken.userId, {\n      password: hashedPassword,\n      passwordUpdatedAt: now,\n      passwordExpiresAt: expiresAt,\n    });\n\n    await storage.markPasswordResetTokenUsed(resetToken.id);\n\n    const user = await storage.getUser(resetToken.userId);\n\n    await storage.createActivityLog({\n      action: `Password reset completed for ${user?.username || 'unknown'}`,\n      userId: resetToken.userId,\n      userName: user?.username || 'unknown',\n      type: 'success'\n    });\n\n    await storage.createSecurityLog({\n      eventType: 'password_reset',\n      action: 'Password reset via email link',\n      userId: resetToken.userId,\n      userName: user?.username || 'unknown',\n      ipAddress: req.ip || 'unknown',\n      userAgent: req.get('User-Agent') || 'unknown',\n      blocked: false,\n    });\n\n    res.json({ message: \"Password has been reset successfully. You can now log in with your new password.\" });\n  } catch (error: any) {\n    console.error('Reset password error:', error);\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/verify-token/:token\", async (req, res) => {\n  try {\n    const { token } = req.params;\n\n    const resetToken = await storage.getPasswordResetToken(token);\n    if (!resetToken) {\n      return res.status(400).json({ valid: false, message: \"Invalid reset token\" });\n    }\n\n    if (resetToken.used) {\n      return res.status(400).json({ valid: false, message: \"This reset token has already been used\" });\n    }\n\n    if (new Date() > resetToken.expiresAt) {\n      return res.status(400).json({ valid: false, message: \"Reset token has expired\" });\n    }\n\n    res.json({ valid: true });\n  } catch (error: any) {\n    res.status(500).json({ valid: false, message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":7666,"size_tokens":null},"server/api/sitemap.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\n\nconst router = Router();\n\nfunction getBaseUrl(req: Request): string {\n  if (process.env.SITE_URL) return process.env.SITE_URL;\n  const protocol = req.headers['x-forwarded-proto'] || req.protocol || 'https';\n  const host = req.headers['x-forwarded-host'] || req.headers.host || 'localhost:5000';\n  return `${protocol}://${host}`;\n}\n\nrouter.get(\"/sitemap.xml\", async (req: Request, res: Response) => {\n  try {\n    const baseUrl = getBaseUrl(req);\n\n    const posts = await storage.getPublishedPosts();\n    const projects = await storage.getPublishedProjects();\n    const pages = await storage.getPublishedPages();\n    \n    let sitemap = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n  <url>\n    <loc>${baseUrl}/</loc>\n    <changefreq>daily</changefreq>\n    <priority>1.0</priority>\n  </url>\n  <url>\n    <loc>${baseUrl}/blog</loc>\n    <changefreq>daily</changefreq>\n    <priority>0.9</priority>\n  </url>\n  <url>\n    <loc>${baseUrl}/projects</loc>\n    <changefreq>weekly</changefreq>\n    <priority>0.9</priority>\n  </url>\n  <url>\n    <loc>${baseUrl}/contact</loc>\n    <changefreq>monthly</changefreq>\n    <priority>0.7</priority>\n  </url>`;\n\n    for (const post of posts) {\n      const lastmod = post.updatedAt || post.publishedAt || post.createdAt;\n      sitemap += `\n  <url>\n    <loc>${baseUrl}/blog/${post.slug}</loc>\n    <lastmod>${lastmod ? new Date(lastmod).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]}</lastmod>\n    <changefreq>weekly</changefreq>\n    <priority>0.8</priority>\n  </url>`;\n    }\n\n    for (const project of projects) {\n      const lastmod = project.updatedAt || project.createdAt;\n      sitemap += `\n  <url>\n    <loc>${baseUrl}/projects/${project.id}</loc>\n    <lastmod>${lastmod ? new Date(lastmod).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]}</lastmod>\n    <changefreq>monthly</changefreq>\n    <priority>0.8</priority>\n  </url>`;\n    }\n\n    for (const page of pages) {\n      if (page.slug !== 'home') {\n        const lastmod = page.updatedAt || page.publishedAt || page.createdAt;\n        sitemap += `\n  <url>\n    <loc>${baseUrl}/pages/${page.slug}</loc>\n    <lastmod>${lastmod ? new Date(lastmod).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]}</lastmod>\n    <changefreq>monthly</changefreq>\n    <priority>0.6</priority>\n  </url>`;\n      }\n    }\n\n    sitemap += `\n</urlset>`;\n\n    res.set('Content-Type', 'application/xml');\n    res.send(sitemap);\n  } catch (error: any) {\n    console.error(\"Sitemap error:\", error);\n    res.status(500).send('Error generating sitemap');\n  }\n});\n\nrouter.get(\"/rss.xml\", async (req: Request, res: Response) => {\n  try {\n    const baseUrl = getBaseUrl(req);\n\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n    const siteDescription = await storage.getSetting(\"siteDescription\");\n    const posts = await storage.getPublishedPosts();\n\n    let rss = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<rss version=\"2.0\" xmlns:atom=\"http://www.w3.org/2005/Atom\" xmlns:content=\"http://purl.org/rss/1.0/modules/content/\">\n  <channel>\n    <title>${siteTitle?.value || 'Portfolio'}</title>\n    <link>${baseUrl}</link>\n    <description>${siteDescription?.value || 'Blog and Portfolio'}</description>\n    <language>en-us</language>\n    <lastBuildDate>${new Date().toUTCString()}</lastBuildDate>\n    <atom:link href=\"${baseUrl}/rss.xml\" rel=\"self\" type=\"application/rss+xml\"/>`;\n\n    for (const post of posts.slice(0, 20)) {\n      const pubDate = post.publishedAt || post.createdAt;\n      const excerpt = post.excerpt || (post.content ? post.content.substring(0, 200) + '...' : '');\n      \n      rss += `\n    <item>\n      <title><![CDATA[${post.title}]]></title>\n      <link>${baseUrl}/blog/${post.slug}</link>\n      <guid isPermaLink=\"true\">${baseUrl}/blog/${post.slug}</guid>\n      <pubDate>${pubDate ? new Date(pubDate).toUTCString() : new Date().toUTCString()}</pubDate>\n      <description><![CDATA[${excerpt}]]></description>\n      <content:encoded><![CDATA[${post.content || ''}]]></content:encoded>\n    </item>`;\n    }\n\n    rss += `\n  </channel>\n</rss>`;\n\n    res.set('Content-Type', 'application/rss+xml');\n    res.send(rss);\n  } catch (error: any) {\n    console.error(\"RSS error:\", error);\n    res.status(500).send('Error generating RSS feed');\n  }\n});\n\nrouter.get(\"/robots.txt\", async (req: Request, res: Response) => {\n  try {\n    const baseUrl = getBaseUrl(req);\n\n    const robots = `User-agent: *\nAllow: /\nDisallow: /admin\nDisallow: /api\n\nSitemap: ${baseUrl}/sitemap.xml\n`;\n\n    res.set('Content-Type', 'text/plain');\n    res.send(robots);\n  } catch (error: any) {\n    res.status(500).send('Error generating robots.txt');\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":4828,"size_tokens":null},"server/api/content-management.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin, requireAuth } from \"../middleware/auth\";\n\nconst router = Router();\n\nrouter.get(\"/drafts/:contentType\", requireAuth, async (req, res) => {\n  try {\n    const { contentType } = req.params;\n    const contentId = req.query.contentId ? parseInt(req.query.contentId as string) : undefined;\n    \n    const draft = await storage.getContentDraft(req.session.userId!, contentType, contentId);\n    res.json(draft || null);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/drafts\", requireAuth, async (req, res) => {\n  try {\n    const { contentType, contentId, title, content, metadata } = req.body;\n    \n    if (!contentType) {\n      return res.status(400).json({ message: \"Content type is required\" });\n    }\n\n    const draft = await storage.upsertContentDraft({\n      contentType,\n      contentId: contentId || null,\n      title: title || null,\n      content: content || null,\n      metadata: metadata || null,\n      userId: req.session.userId!,\n    });\n\n    res.json(draft);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/drafts/:id\", requireAuth, async (req, res) => {\n  try {\n    const deleted = await storage.deleteContentDraft(parseInt(req.params.id));\n    if (!deleted) {\n      return res.status(404).json({ message: \"Draft not found\" });\n    }\n    res.json({ message: \"Draft deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/versions/:contentType/:contentId\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, contentId } = req.params;\n    const versions = await storage.getContentVersions(contentType, parseInt(contentId));\n    res.json(versions);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/versions\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, contentId, title, content, metadata } = req.body;\n    \n    if (!contentType || !contentId || !title) {\n      return res.status(400).json({ message: \"Content type, content ID, and title are required\" });\n    }\n\n    const latestVersion = await storage.getLatestVersionNumber(contentType, contentId);\n\n    const version = await storage.createContentVersion({\n      contentType,\n      contentId,\n      version: latestVersion + 1,\n      title,\n      content: content || null,\n      metadata: metadata || null,\n      createdBy: req.session.userId,\n    });\n\n    res.status(201).json(version);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/scheduled\", requireAdmin, async (req, res) => {\n  try {\n    const scheduled = await storage.getAllScheduledContent();\n    res.json(scheduled);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/scheduled\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, contentId, action, scheduledAt } = req.body;\n    \n    if (!contentType || !contentId || !action || !scheduledAt) {\n      return res.status(400).json({ message: \"All fields are required\" });\n    }\n\n    const scheduled = await storage.createScheduledContent({\n      contentType,\n      contentId,\n      action,\n      scheduledAt: new Date(scheduledAt),\n      createdBy: req.session.userId,\n    });\n\n    await storage.createActivityLog({\n      action: `Scheduled ${action} for ${contentType} #${contentId} at ${scheduledAt}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: 'info'\n    });\n\n    res.status(201).json(scheduled);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/scheduled/:id\", requireAdmin, async (req, res) => {\n  try {\n    const deleted = await storage.deleteScheduledContent(parseInt(req.params.id));\n    if (!deleted) {\n      return res.status(404).json({ message: \"Scheduled content not found\" });\n    }\n    res.json({ message: \"Scheduled content cancelled successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/templates\", requireAdmin, async (req, res) => {\n  try {\n    const { type } = req.query;\n    const templates = type \n      ? await storage.getContentTemplatesByType(type as string)\n      : await storage.getAllContentTemplates();\n    res.json(templates);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const template = await storage.getContentTemplate(parseInt(req.params.id));\n    if (!template) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/templates\", requireAdmin, async (req, res) => {\n  try {\n    const { name, type, content, metadata, isDefault } = req.body;\n    \n    if (!name || !type) {\n      return res.status(400).json({ message: \"Name and type are required\" });\n    }\n\n    const template = await storage.createContentTemplate({\n      name,\n      type,\n      content: content || null,\n      metadata: metadata || null,\n      isDefault: isDefault || false,\n    });\n\n    res.status(201).json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const template = await storage.updateContentTemplate(parseInt(req.params.id), req.body);\n    if (!template) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json(template);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/templates/:id\", requireAdmin, async (req, res) => {\n  try {\n    const deleted = await storage.deleteContentTemplate(parseInt(req.params.id));\n    if (!deleted) {\n      return res.status(404).json({ message: \"Template not found\" });\n    }\n    res.json({ message: \"Template deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/bulk-delete\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, ids } = req.body;\n    \n    if (!contentType || !Array.isArray(ids) || ids.length === 0) {\n      return res.status(400).json({ message: \"Content type and IDs are required\" });\n    }\n\n    let deleted = 0;\n    for (const id of ids) {\n      let result = false;\n      switch (contentType) {\n        case 'post':\n          result = await storage.deletePost(id);\n          break;\n        case 'page':\n          result = await storage.deletePage(id);\n          break;\n        case 'project':\n          result = await storage.deleteProject(id);\n          break;\n      }\n      if (result) deleted++;\n    }\n\n    await storage.createActivityLog({\n      action: `Bulk deleted ${deleted} ${contentType}s`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: 'warning'\n    });\n\n    res.json({ message: `${deleted} items deleted successfully`, deleted });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/bulk-publish\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, ids } = req.body;\n    \n    if (!contentType || !Array.isArray(ids) || ids.length === 0) {\n      return res.status(400).json({ message: \"Content type and IDs are required\" });\n    }\n\n    let updated = 0;\n    for (const id of ids) {\n      let result;\n      switch (contentType) {\n        case 'post':\n          result = await storage.updatePost(id, { status: 'Published', publishedAt: new Date() });\n          break;\n        case 'page':\n          result = await storage.updatePage(id, { status: 'Published', publishedAt: new Date() });\n          break;\n        case 'project':\n          result = await storage.updateProject(id, { status: 'Published' });\n          break;\n      }\n      if (result) updated++;\n    }\n\n    await storage.createActivityLog({\n      action: `Bulk published ${updated} ${contentType}s`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: 'success'\n    });\n\n    res.json({ message: `${updated} items published successfully`, updated });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":8536,"size_tokens":null},"server/api/analytics.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport crypto from \"crypto\";\n\nconst router = Router();\n\nfunction getVisitorId(req: any): string {\n  const ip = req.ip || req.socket.remoteAddress || 'unknown';\n  const userAgent = req.get('User-Agent') || 'unknown';\n  return crypto.createHash('md5').update(`${ip}-${userAgent}`).digest('hex').substring(0, 16);\n}\n\nfunction parseUserAgent(ua: string): { device: string; browser: string; os: string } {\n  let device = 'desktop';\n  let browser = 'unknown';\n  let os = 'unknown';\n\n  if (/mobile/i.test(ua)) device = 'mobile';\n  else if (/tablet|ipad/i.test(ua)) device = 'tablet';\n\n  if (/chrome/i.test(ua) && !/edge/i.test(ua)) browser = 'Chrome';\n  else if (/firefox/i.test(ua)) browser = 'Firefox';\n  else if (/safari/i.test(ua) && !/chrome/i.test(ua)) browser = 'Safari';\n  else if (/edge/i.test(ua)) browser = 'Edge';\n  else if (/msie|trident/i.test(ua)) browser = 'IE';\n\n  if (/windows/i.test(ua)) os = 'Windows';\n  else if (/mac/i.test(ua)) os = 'macOS';\n  else if (/linux/i.test(ua)) os = 'Linux';\n  else if (/android/i.test(ua)) os = 'Android';\n  else if (/iphone|ipad/i.test(ua)) os = 'iOS';\n\n  return { device, browser, os };\n}\n\nrouter.post(\"/track\", async (req, res) => {\n  try {\n    const { path, contentType, contentId, referrer, sessionDuration } = req.body;\n    \n    if (!path) {\n      return res.status(400).json({ message: \"Path is required\" });\n    }\n\n    const visitorId = getVisitorId(req);\n    const userAgent = req.get('User-Agent') || 'unknown';\n    const ipAddress = req.ip || req.socket.remoteAddress || 'unknown';\n    const { device, browser, os } = parseUserAgent(userAgent);\n\n    await storage.createPageView({\n      path,\n      contentType: contentType || null,\n      contentId: contentId || null,\n      visitorId,\n      referrer: referrer || req.get('Referer') || null,\n      userAgent,\n      ipAddress,\n      device,\n      browser,\n      os,\n      sessionDuration: sessionDuration || null,\n    });\n\n    if (contentType && contentId) {\n      switch (contentType) {\n        case 'post':\n          await storage.incrementPostViews(contentId);\n          break;\n        case 'page':\n          await storage.incrementPageViews(contentId);\n          break;\n        case 'project':\n          await storage.incrementProjectViews(contentId);\n          break;\n      }\n    }\n\n    res.json({ success: true });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/overview\", requireAdmin, async (req, res) => {\n  try {\n    const { startDate, endDate } = req.query;\n    \n    const start = startDate ? new Date(startDate as string) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n    const end = endDate ? new Date(endDate as string) : new Date();\n\n    const pageViewStats = await storage.getPageViewStats(start, end);\n    const popularContent = await storage.getPopularContent(undefined, 10);\n    const referrerStats = await storage.getReferrerStats(10);\n    const deviceStats = await storage.getDeviceStats();\n    const browserStats = await storage.getBrowserStats();\n    const countryStats = await storage.getCountryStats();\n\n    const totalViews = pageViewStats.reduce((acc, pv) => acc + pv.views, 0);\n\n    res.json({\n      totalViews,\n      pageViewStats: pageViewStats.slice(0, 20),\n      popularContent,\n      referrerStats,\n      deviceStats,\n      browserStats,\n      countryStats,\n      dateRange: { start, end },\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/popular-content\", requireAdmin, async (req, res) => {\n  try {\n    const { contentType, limit } = req.query;\n    const popular = await storage.getPopularContent(\n      contentType as string | undefined, \n      parseInt(limit as string) || 10\n    );\n    res.json(popular);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/referrers\", requireAdmin, async (req, res) => {\n  try {\n    const { limit } = req.query;\n    const referrers = await storage.getReferrerStats(parseInt(limit as string) || 10);\n    res.json(referrers);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/devices\", requireAdmin, async (req, res) => {\n  try {\n    const devices = await storage.getDeviceStats();\n    res.json(devices);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/browsers\", requireAdmin, async (req, res) => {\n  try {\n    const browsers = await storage.getBrowserStats();\n    res.json(browsers);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/countries\", requireAdmin, async (req, res) => {\n  try {\n    const countries = await storage.getCountryStats();\n    res.json(countries);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/daily\", requireAdmin, async (req, res) => {\n  try {\n    const { days } = req.query;\n    const numDays = parseInt(days as string) || 30;\n    const dailyViews = await storage.getDailyPageViews(numDays);\n    res.json(dailyViews);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/export\", requireAdmin, async (req, res) => {\n  try {\n    const { startDate, endDate, format } = req.query;\n    \n    const start = startDate ? new Date(startDate as string) : new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n    const end = endDate ? new Date(endDate as string) : new Date();\n\n    const pageViewStats = await storage.getPageViewStats(start, end);\n    const popularContent = await storage.getPopularContent(undefined, 50);\n    const referrerStats = await storage.getReferrerStats(50);\n\n    if (format === 'csv') {\n      const csv = ['Page,Views'];\n      for (const pv of pageViewStats) {\n        csv.push(`\"${pv.path}\",${pv.views}`);\n      }\n      \n      res.setHeader('Content-Type', 'text/csv');\n      res.setHeader('Content-Disposition', 'attachment; filename=analytics.csv');\n      res.send(csv.join('\\n'));\n    } else {\n      res.json({\n        pageViewStats,\n        popularContent,\n        referrerStats,\n        dateRange: { start, end },\n      });\n    }\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":6410,"size_tokens":null},"server/api/subscribers.ts":{"content":"import { Router } from \"express\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { insertSubscriberSchema } from \"@shared/schema\";\nimport crypto from \"crypto\";\n\nconst router = Router();\n\nrouter.get(\"/\", requireAdmin, async (req, res) => {\n  try {\n    const subscribers = await storage.getAllSubscribers();\n    res.json(subscribers);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/stats\", requireAdmin, async (req, res) => {\n  try {\n    const all = await storage.getAllSubscribers();\n    const active = all.filter(s => s.status === 'active');\n    const unsubscribed = all.filter(s => s.status === 'unsubscribed');\n    \n    res.json({\n      total: all.length,\n      active: active.length,\n      unsubscribed: unsubscribed.length,\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/subscribe\", async (req, res) => {\n  try {\n    const { email, name, source } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ message: \"Email is required\" });\n    }\n\n    const existing = await storage.getSubscriberByEmail(email);\n    if (existing) {\n      if (existing.status === 'unsubscribed') {\n        await storage.updateSubscriber(existing.id, {\n          status: 'active',\n          unsubscribedAt: null,\n          confirmedAt: new Date(),\n        });\n        return res.json({ message: \"Welcome back! You have been resubscribed.\" });\n      }\n      return res.json({ message: \"You are already subscribed.\" });\n    }\n\n    const unsubscribeToken = crypto.randomBytes(32).toString('hex');\n\n    await storage.createSubscriber({\n      email,\n      name: name || null,\n      status: 'active',\n      source: source || 'website',\n      unsubscribeToken,\n      confirmedAt: new Date(),\n    });\n\n    await storage.createActivityLog({\n      action: `New subscriber: ${email}`,\n      type: 'info'\n    });\n\n    res.json({ message: \"Successfully subscribed to newsletter\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/unsubscribe/:token\", async (req, res) => {\n  try {\n    const { token } = req.params;\n\n    const subscribers = await storage.getAllSubscribers();\n    const subscriber = subscribers.find(s => s.unsubscribeToken === token);\n\n    if (!subscriber) {\n      return res.status(400).json({ message: \"Invalid unsubscribe link\" });\n    }\n\n    await storage.updateSubscriber(subscriber.id, {\n      status: 'unsubscribed',\n      unsubscribedAt: new Date(),\n    });\n\n    await storage.createActivityLog({\n      action: `Subscriber unsubscribed: ${subscriber.email}`,\n      type: 'info'\n    });\n\n    res.json({ message: \"You have been successfully unsubscribed.\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.delete(\"/:id\", requireAdmin, async (req, res) => {\n  try {\n    const id = parseInt(req.params.id);\n    const deleted = await storage.deleteSubscriber(id);\n    \n    if (!deleted) {\n      return res.status(404).json({ message: \"Subscriber not found\" });\n    }\n\n    res.json({ message: \"Subscriber deleted successfully\" });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/bulk-delete\", requireAdmin, async (req, res) => {\n  try {\n    const { ids } = req.body;\n    \n    if (!Array.isArray(ids) || ids.length === 0) {\n      return res.status(400).json({ message: \"No subscribers selected\" });\n    }\n\n    let deleted = 0;\n    for (const id of ids) {\n      const result = await storage.deleteSubscriber(id);\n      if (result) deleted++;\n    }\n\n    res.json({ message: `${deleted} subscribers deleted successfully` });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.post(\"/import\", requireAdmin, async (req, res) => {\n  try {\n    const { emails, source } = req.body;\n    \n    if (!Array.isArray(emails) || emails.length === 0) {\n      return res.status(400).json({ message: \"No emails provided\" });\n    }\n\n    let imported = 0;\n    let skipped = 0;\n\n    for (const email of emails) {\n      const trimmedEmail = email.trim().toLowerCase();\n      if (!trimmedEmail || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(trimmedEmail)) {\n        skipped++;\n        continue;\n      }\n\n      const existing = await storage.getSubscriberByEmail(trimmedEmail);\n      if (existing) {\n        skipped++;\n        continue;\n      }\n\n      const unsubscribeToken = crypto.randomBytes(32).toString('hex');\n      await storage.createSubscriber({\n        email: trimmedEmail,\n        status: 'active',\n        source: source || 'import',\n        unsubscribeToken,\n        confirmedAt: new Date(),\n      });\n      imported++;\n    }\n\n    res.json({ \n      message: `Imported ${imported} subscribers, skipped ${skipped} (invalid or existing)`,\n      imported,\n      skipped,\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/export\", requireAdmin, async (req, res) => {\n  try {\n    const subscribers = await storage.getActiveSubscribers();\n    const csv = ['email,name,status,source,subscribed_at'];\n    \n    for (const sub of subscribers) {\n      csv.push(`${sub.email},\"${sub.name || ''}\",${sub.status},${sub.source || ''},${sub.createdAt?.toISOString() || ''}`);\n    }\n\n    res.setHeader('Content-Type', 'text/csv');\n    res.setHeader('Content-Disposition', 'attachment; filename=subscribers.csv');\n    res.send(csv.join('\\n'));\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":5636,"size_tokens":null},"client/src/pages/admin/auth/ForgotPassword.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Mail, ArrowLeft, Loader2, CheckCircle, Shield } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function ForgotPassword() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [submitted, setSubmitted] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!email.trim()) {\n      toast({\n        title: \"Email Required\",\n        description: \"Please enter your email address\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      const response = await fetch(\"/api/password-reset/forgot-password\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ email }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setSubmitted(true);\n        toast({\n          title: \"Email Sent\",\n          description: \"Check your inbox for password reset instructions\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: data.message || \"Failed to send reset email\",\n          variant: \"destructive\",\n        });\n      }\n    } catch {\n      toast({\n        title: \"Error\",\n        description: \"Network error. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div \n      className=\"min-h-screen flex items-center justify-center p-4\"\n      style={{\n        background: `linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.95) 100%), url(${loginBg})`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n      }}\n    >\n      <div className=\"absolute inset-0 bg-gradient-to-br from-purple-900/20 via-transparent to-blue-900/20 pointer-events-none\" />\n      \n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md relative z-10\"\n      >\n        <Card className=\"backdrop-blur-xl bg-black/50 border-white/10 shadow-2xl\">\n          <CardHeader className=\"text-center space-y-4\">\n            <div className=\"mx-auto w-16 h-16 bg-gradient-to-br from-primary/80 to-purple-600/80 rounded-xl flex items-center justify-center shadow-lg\">\n              <Shield className=\"w-8 h-8 text-white\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold text-white\">\n                {submitted ? \"Check Your Email\" : \"Forgot Password?\"}\n              </CardTitle>\n              <CardDescription className=\"text-white/60 mt-2\">\n                {submitted \n                  ? \"We've sent password reset instructions to your email\"\n                  : \"Enter your email address and we'll send you reset instructions\"\n                }\n              </CardDescription>\n            </div>\n          </CardHeader>\n          \n          <CardContent className=\"space-y-6\">\n            {submitted ? (\n              <div className=\"space-y-6\">\n                <div className=\"flex justify-center\">\n                  <div className=\"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center\">\n                    <CheckCircle className=\"w-8 h-8 text-green-500\" />\n                  </div>\n                </div>\n                <p className=\"text-white/60 text-center text-sm\">\n                  If an account exists for <span className=\"text-white font-medium\">{email}</span>, \n                  you will receive an email with instructions to reset your password.\n                </p>\n                <p className=\"text-white/40 text-center text-xs\">\n                  Didn't receive the email? Check your spam folder or try again.\n                </p>\n                <div className=\"space-y-3\">\n                  <Button \n                    onClick={() => setSubmitted(false)}\n                    variant=\"outline\"\n                    className=\"w-full border-white/20 text-white/80 hover:bg-white/10\"\n                    data-testid=\"button-try-again\"\n                  >\n                    Try Again\n                  </Button>\n                  <Button \n                    onClick={() => setLocation(\"/admin/login\")}\n                    className=\"w-full bg-primary hover:bg-primary/90 text-white\"\n                    data-testid=\"button-back-to-login\"\n                  >\n                    <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                    Back to Login\n                  </Button>\n                </div>\n              </div>\n            ) : (\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label className=\"text-white/80\">Email Address</Label>\n                  <div className=\"relative\">\n                    <Mail className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                    <Input \n                      type=\"email\" \n                      placeholder=\"admin@example.com\" \n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      className=\"pl-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                      required \n                      data-testid=\"input-email\"\n                    />\n                  </div>\n                </div>\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2\"\n                  disabled={isLoading}\n                  data-testid=\"button-submit\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Sending...\n                    </>\n                  ) : (\n                    \"Send Reset Link\"\n                  )}\n                </Button>\n\n                <Button \n                  type=\"button\"\n                  onClick={() => setLocation(\"/admin/login\")}\n                  variant=\"ghost\"\n                  className=\"w-full text-white/60 hover:text-white hover:bg-white/10\"\n                  data-testid=\"button-back\"\n                >\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Back to Login\n                </Button>\n              </form>\n            )}\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7072,"size_tokens":null},"server/api/email.ts":{"content":"import { Router } from \"express\";\nimport nodemailer from \"nodemailer\";\nimport { storage } from \"../storage\";\nimport { requireAdmin } from \"../middleware/auth\";\n\nconst router = Router();\n\nasync function getSmtpTransporter() {\n  const smtpHost = await storage.getSetting(\"smtpHost\");\n  const smtpPort = await storage.getSetting(\"smtpPort\");\n  const smtpUser = await storage.getSetting(\"smtpUser\");\n  const smtpPassword = await storage.getSetting(\"smtpPassword\");\n  const smtpSecure = await storage.getSetting(\"smtpSecure\");\n\n  if (!smtpHost?.value || !smtpPort?.value || !smtpUser?.value || !smtpPassword?.value) {\n    return null;\n  }\n\n  const port = typeof smtpPort.value === 'string' ? parseInt(smtpPort.value) : smtpPort.value;\n  const secure = smtpSecure?.value === true || smtpSecure?.value === 'true';\n\n  return nodemailer.createTransport({\n    host: smtpHost.value as string,\n    port: port as number,\n    secure: secure,\n    auth: {\n      user: smtpUser.value as string,\n      pass: smtpPassword.value as string,\n    },\n    requireTLS: !secure,\n    connectionTimeout: 10000,\n    greetingTimeout: 10000,\n    socketTimeout: 10000,\n  });\n}\n\nrouter.post(\"/test\", requireAdmin, async (req, res) => {\n  try {\n    const { to, subject, body } = req.body;\n\n    if (!to) {\n      return res.status(400).json({ message: \"Email address is required\" });\n    }\n\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.status(400).json({ message: \"SMTP is not configured. Please configure SMTP settings first.\" });\n    }\n\n    const siteTitle = await storage.getSetting(\"siteTitle\");\n    const emailFromName = await storage.getSetting(\"emailFromName\");\n    const emailFromAddress = await storage.getSetting(\"emailFromAddress\");\n    const smtpUser = await storage.getSetting(\"smtpUser\");\n\n    const fromName = emailFromName?.value || siteTitle?.value || 'Portfolio';\n    const fromEmail = emailFromAddress?.value || smtpUser?.value || '';\n\n    await transporter.sendMail({\n      from: `\"${fromName}\" <${fromEmail}>`,\n      to: to,\n      subject: subject || \"Test Email from Portfolio\",\n      html: body || \"<h1>Test Email</h1><p>This is a test email from your portfolio admin panel.</p>\",\n    });\n\n    await storage.createActivityLog({\n      action: `Test email sent to ${to}`,\n      userId: req.session.userId,\n      userName: req.session.username,\n      type: 'success'\n    });\n\n    res.json({ message: `Test email sent successfully to ${to}` });\n  } catch (error: any) {\n    console.error(\"Test email error:\", error);\n    res.status(500).json({ message: error.message || \"Failed to send test email\" });\n  }\n});\n\nrouter.get(\"/status\", requireAdmin, async (req, res) => {\n  try {\n    const transporter = await getSmtpTransporter();\n    if (!transporter) {\n      return res.json({ configured: false, message: \"SMTP is not configured\" });\n    }\n    \n    try {\n      await transporter.verify();\n      res.json({ configured: true, active: true, message: \"SMTP is configured and active\" });\n    } catch (verifyError: any) {\n      res.json({ configured: true, active: false, message: `SMTP configured but not active: ${verifyError.message}` });\n    }\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.get(\"/templates\", requireAdmin, async (req, res) => {\n  try {\n    const templates = await storage.getAllEmailTemplates();\n    const result: Record<string, { subject: string; body: string }> = {};\n    templates.forEach(t => {\n      result[t.name] = { subject: t.subject, body: t.htmlContent };\n    });\n    res.json(result);\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nrouter.put(\"/templates/:name\", requireAdmin, async (req, res) => {\n  try {\n    const { name } = req.params;\n    const { subject, body } = req.body;\n    \n    const templates = await storage.getAllEmailTemplates();\n    const existing = templates.find(t => t.name === name);\n    \n    if (existing) {\n      await storage.updateEmailTemplate(existing.id, { subject, htmlContent: body });\n    } else {\n      await storage.createEmailTemplate({ name, subject, htmlContent: body });\n    }\n    \n    res.json({ \n      message: \"Template saved successfully\",\n      template: { subject, body }\n    });\n  } catch (error: any) {\n    res.status(500).json({ message: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":4379,"size_tokens":null},"client/src/pages/admin/auth/ResetPassword.tsx":{"content":"\nimport { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { Lock, ArrowLeft, Loader2, CheckCircle, AlertCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst loginBg = \"/uploads/images/admin_login_background.png\";\n\nexport default function ResetPassword() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [isVerifying, setIsVerifying] = useState(true);\n  const [tokenValid, setTokenValid] = useState(false);\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [resetComplete, setResetComplete] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  // Get token from URL\n  const searchParams = new URLSearchParams(window.location.search);\n  const token = searchParams.get(\"token\");\n\n  useEffect(() => {\n    if (!token) {\n      toast({\n        title: \"Invalid Link\",\n        description: \"No reset token found in the URL\",\n        variant: \"destructive\",\n      });\n      setIsVerifying(false);\n      return;\n    }\n\n    // Verify token\n    const verifyToken = async () => {\n      try {\n        const response = await fetch(`/api/password-reset/verify-token/${token}`);\n        const data = await response.json();\n\n        if (data.valid) {\n          setTokenValid(true);\n        } else {\n          toast({\n            title: \"Invalid or Expired Link\",\n            description: data.message || \"This password reset link is no longer valid\",\n            variant: \"destructive\",\n          });\n        }\n      } catch (error) {\n        toast({\n          title: \"Error\",\n          description: \"Failed to verify reset link\",\n          variant: \"destructive\",\n        });\n      } finally {\n        setIsVerifying(false);\n      }\n    };\n\n    verifyToken();\n  }, [token, toast]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!newPassword || !confirmPassword) {\n      toast({\n        title: \"Missing Information\",\n        description: \"Please fill in all fields\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 8) {\n      toast({\n        title: \"Weak Password\",\n        description: \"Password must be at least 8 characters long\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"Passwords Don't Match\",\n        description: \"Please make sure both passwords are identical\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(\"/api/password-reset/reset-password\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          token,\n          newPassword,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setResetComplete(true);\n        toast({\n          title: \"Success!\",\n          description: \"Your password has been reset successfully\",\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: data.message || \"Failed to reset password\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Network error. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isVerifying) {\n    return (\n      <div \n        className=\"min-h-screen flex items-center justify-center p-4\"\n        style={{\n          background: `linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.95) 100%), url(${loginBg})`,\n          backgroundSize: 'cover',\n          backgroundPosition: 'center',\n        }}\n      >\n        <Card className=\"backdrop-blur-xl bg-black/50 border-white/10 shadow-2xl w-full max-w-md\">\n          <CardContent className=\"py-12 flex flex-col items-center gap-4\">\n            <Loader2 className=\"w-12 h-12 text-primary animate-spin\" />\n            <p className=\"text-white/60\">Verifying reset link...</p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!token || !tokenValid) {\n    return (\n      <div \n        className=\"min-h-screen flex items-center justify-center p-4\"\n        style={{\n          background: `linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.95) 100%), url(${loginBg})`,\n          backgroundSize: 'cover',\n          backgroundPosition: 'center',\n        }}\n      >\n        <Card className=\"backdrop-blur-xl bg-black/50 border-white/10 shadow-2xl w-full max-w-md\">\n          <CardHeader className=\"text-center space-y-4\">\n            <div className=\"mx-auto w-16 h-16 bg-red-500/20 rounded-xl flex items-center justify-center\">\n              <AlertCircle className=\"w-8 h-8 text-red-500\" />\n            </div>\n            <CardTitle className=\"text-2xl font-bold text-white\">Invalid Link</CardTitle>\n            <CardDescription className=\"text-white/60\">\n              This password reset link is invalid or has expired\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Button \n              onClick={() => setLocation(\"/admin/forgot-password\")}\n              className=\"w-full bg-primary hover:bg-primary/90 text-white\"\n            >\n              Request New Link\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div \n      className=\"min-h-screen flex items-center justify-center p-4\"\n      style={{\n        background: `linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.95) 100%), url(${loginBg})`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n      }}\n    >\n      <div className=\"absolute inset-0 bg-gradient-to-br from-purple-900/20 via-transparent to-blue-900/20 pointer-events-none\" />\n      \n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md relative z-10\"\n      >\n        <Card className=\"backdrop-blur-xl bg-black/50 border-white/10 shadow-2xl\">\n          <CardHeader className=\"text-center space-y-4\">\n            <div className=\"mx-auto w-16 h-16 bg-gradient-to-br from-primary/80 to-purple-600/80 rounded-xl flex items-center justify-center shadow-lg\">\n              {resetComplete ? (\n                <CheckCircle className=\"w-8 h-8 text-white\" />\n              ) : (\n                <Lock className=\"w-8 h-8 text-white\" />\n              )}\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold text-white\">\n                {resetComplete ? \"Password Reset Complete\" : \"Reset Your Password\"}\n              </CardTitle>\n              <CardDescription className=\"text-white/60 mt-2\">\n                {resetComplete \n                  ? \"You can now log in with your new password\"\n                  : \"Enter your new password below\"\n                }\n              </CardDescription>\n            </div>\n          </CardHeader>\n          \n          <CardContent className=\"space-y-6\">\n            {resetComplete ? (\n              <div className=\"space-y-6\">\n                <div className=\"flex justify-center\">\n                  <div className=\"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center\">\n                    <CheckCircle className=\"w-8 h-8 text-green-500\" />\n                  </div>\n                </div>\n                <p className=\"text-white/60 text-center text-sm\">\n                  Your password has been successfully reset. You can now log in to your account with your new password.\n                </p>\n                <Button \n                  onClick={() => setLocation(\"/admin/login\")}\n                  className=\"w-full bg-primary hover:bg-primary/90 text-white\"\n                  data-testid=\"button-login\"\n                >\n                  Go to Login\n                </Button>\n              </div>\n            ) : (\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label className=\"text-white/80\">New Password</Label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                    <Input \n                      type=\"password\" \n                      placeholder=\"Enter new password\" \n                      value={newPassword}\n                      onChange={(e) => setNewPassword(e.target.value)}\n                      className=\"pl-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                      required \n                      minLength={8}\n                      data-testid=\"input-new-password\"\n                    />\n                  </div>\n                  <p className=\"text-xs text-white/40\">Must be at least 8 characters</p>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label className=\"text-white/80\">Confirm Password</Label>\n                  <div className=\"relative\">\n                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-white/40\" />\n                    <Input \n                      type=\"password\" \n                      placeholder=\"Confirm new password\" \n                      value={confirmPassword}\n                      onChange={(e) => setConfirmPassword(e.target.value)}\n                      className=\"pl-9 bg-white/5 border-white/10 text-white placeholder:text-white/20 focus:border-primary/50 focus:bg-white/10 transition-all\"\n                      required \n                      data-testid=\"input-confirm-password\"\n                    />\n                  </div>\n                </div>\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full bg-primary hover:bg-primary/90 text-white h-11 mt-2\"\n                  disabled={isLoading}\n                  data-testid=\"button-submit\"\n                >\n                  {isLoading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Resetting Password...\n                    </>\n                  ) : (\n                    \"Reset Password\"\n                  )}\n                </Button>\n\n                <Button \n                  type=\"button\"\n                  onClick={() => setLocation(\"/admin/login\")}\n                  variant=\"ghost\"\n                  className=\"w-full text-white/60 hover:text-white hover:bg-white/10\"\n                  data-testid=\"button-back\"\n                >\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Back to Login\n                </Button>\n              </form>\n            )}\n          </CardContent>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11257,"size_tokens":null},"server/api/cache.ts":{"content":"\nimport { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\n\nconst router = Router();\n\ninterface CacheItem {\n  data: any;\n  expires: number;\n  size: number;\n  createdAt: number;\n}\n\nconst cacheStore: Map<string, CacheItem> = new Map();\n\nfunction getCacheStats() {\n  let totalSize = 0;\n  let expiredCount = 0;\n  const now = Date.now();\n  const items: { key: string; type: string; size: number; expires: Date; isExpired: boolean }[] = [];\n  \n  for (const [key, value] of cacheStore.entries()) {\n    totalSize += value.size;\n    const isExpired = value.expires < now;\n    if (isExpired) expiredCount++;\n    \n    items.push({\n      key,\n      type: key.split(':')[0] || 'general',\n      size: value.size,\n      expires: new Date(value.expires),\n      isExpired\n    });\n  }\n  \n  const typeStats: Record<string, { count: number; size: number }> = {};\n  for (const item of items) {\n    if (!typeStats[item.type]) {\n      typeStats[item.type] = { count: 0, size: 0 };\n    }\n    typeStats[item.type].count++;\n    typeStats[item.type].size += item.size;\n  }\n  \n  return {\n    totalSize,\n    itemCount: cacheStore.size,\n    expiredCount,\n    items,\n    typeStats\n  };\n}\n\nrouter.get(\"/stats\", async (req: Request, res: Response) => {\n  try {\n    const stats = getCacheStats();\n    \n    const cacheTypes = [\n      { name: \"Application Cache\", type: \"app\", size: 0, items: 0 },\n      { name: \"Database Queries\", type: \"db\", size: 0, items: 0 },\n      { name: \"Image Cache\", type: \"image\", size: 0, items: 0 },\n      { name: \"Page Cache\", type: \"page\", size: 0, items: 0 },\n    ];\n\n    for (const cacheType of cacheTypes) {\n      const typeStat = stats.typeStats[cacheType.type];\n      if (typeStat) {\n        cacheType.size = typeStat.size;\n        cacheType.items = typeStat.count;\n      }\n    }\n\n    res.json({\n      totalSize: stats.totalSize,\n      itemCount: stats.itemCount,\n      expiredCount: stats.expiredCount,\n      cacheTypes,\n      lastCleared: null\n    });\n  } catch (error) {\n    console.error(\"Error getting cache stats:\", error);\n    res.status(500).json({ error: \"Failed to get cache stats\" });\n  }\n});\n\nrouter.get(\"/items\", async (req: Request, res: Response) => {\n  try {\n    const stats = getCacheStats();\n    res.json(stats.items);\n  } catch (error) {\n    console.error(\"Error getting cache items:\", error);\n    res.status(500).json({ error: \"Failed to get cache items\" });\n  }\n});\n\nrouter.post(\"/clear\", async (req: Request, res: Response) => {\n  try {\n    const { type } = req.body;\n    \n    if (type) {\n      let cleared = 0;\n      for (const key of Array.from(cacheStore.keys())) {\n        if (key.startsWith(type + ':')) {\n          cacheStore.delete(key);\n          cleared++;\n        }\n      }\n      \n      await storage.createActivityLog({\n        action: `Cleared ${cleared} items from ${type} cache`,\n        userId: (req as any).user?.id,\n        userName: (req as any).user?.name || \"System\",\n        type: \"system\"\n      });\n      \n      res.json({ success: true, message: `Cleared ${cleared} items from ${type} cache` });\n    } else {\n      const count = cacheStore.size;\n      cacheStore.clear();\n      \n      await storage.createActivityLog({\n        action: `Cleared all cache (${count} items)`,\n        userId: (req as any).user?.id,\n        userName: (req as any).user?.name || \"System\",\n        type: \"system\"\n      });\n      \n      res.json({ success: true, message: `All cache cleared (${count} items)` });\n    }\n  } catch (error) {\n    console.error(\"Error clearing cache:\", error);\n    res.status(500).json({ error: \"Failed to clear cache\" });\n  }\n});\n\nrouter.post(\"/clear/:key\", async (req: Request, res: Response) => {\n  try {\n    const key = req.params.key;\n    const deleted = cacheStore.delete(key);\n    \n    if (deleted) {\n      await storage.createActivityLog({\n        action: `Cleared cache key: ${key}`,\n        userId: (req as any).user?.id,\n        userName: (req as any).user?.name || \"System\",\n        type: \"system\"\n      });\n    }\n    \n    res.json({ success: deleted });\n  } catch (error) {\n    console.error(\"Error clearing cache key:\", error);\n    res.status(500).json({ error: \"Failed to clear cache key\" });\n  }\n});\n\nrouter.post(\"/warmup\", async (req: Request, res: Response) => {\n  try {\n    const projects = await storage.getAllProjects();\n    const posts = await storage.getAllPosts();\n    const pages = await storage.getAllPages();\n    const settings = await storage.getAllSettings();\n    \n    setCache('app:projects:all', projects, 3600000);\n    setCache('app:posts:all', posts, 3600000);\n    setCache('page:all', pages, 3600000);\n    setCache('app:settings:all', settings, 3600000);\n    \n    await storage.createActivityLog({\n      action: \"Cache warmed up with projects, posts, pages, and settings\",\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"system\"\n    });\n    \n    res.json({ \n      success: true, \n      message: \"Cache warmed up\",\n      cached: ['projects', 'posts', 'pages', 'settings']\n    });\n  } catch (error) {\n    console.error(\"Error warming up cache:\", error);\n    res.status(500).json({ error: \"Failed to warm up cache\" });\n  }\n});\n\nexport function setCache(key: string, data: any, ttl: number = 3600000): void {\n  cacheStore.set(key, {\n    data,\n    expires: Date.now() + ttl,\n    size: JSON.stringify(data).length,\n    createdAt: Date.now()\n  });\n}\n\nexport function getCache(key: string): any | null {\n  const item = cacheStore.get(key);\n  if (!item) return null;\n  if (item.expires < Date.now()) {\n    cacheStore.delete(key);\n    return null;\n  }\n  return item.data;\n}\n\nexport function invalidateCache(pattern: string): void {\n  for (const key of cacheStore.keys()) {\n    if (key.startsWith(pattern)) {\n      cacheStore.delete(key);\n    }\n  }\n}\n\nexport default router;\n","path":null,"size_bytes":5837,"size_tokens":null},"client/src/hooks/use-theme-settings.ts":{"content":"\nimport { useEffect } from 'react';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface ThemeSettings {\n  primaryColor?: string;\n  secondaryColor?: string;\n  accentColor?: string;\n  headingFont?: string;\n  bodyFont?: string;\n  borderRadius?: string;\n  [key: string]: any;\n}\n\nfunction loadGoogleFont(fontName: string) {\n  const fontId = `google-font-${fontName.replace(/\\s+/g, '-')}`;\n  if (document.getElementById(fontId)) return;\n  \n  const link = document.createElement('link');\n  link.id = fontId;\n  link.rel = 'stylesheet';\n  link.href = `https://fonts.googleapis.com/css2?family=${fontName.replace(/\\s+/g, '+')}:wght@300;400;500;600;700&display=swap`;\n  document.head.appendChild(link);\n}\n\nfunction hexToHsl(hex: string): string {\n  const r = parseInt(hex.slice(1, 3), 16) / 255;\n  const g = parseInt(hex.slice(3, 5), 16) / 255;\n  const b = parseInt(hex.slice(5, 7), 16) / 255;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h = 0, s = 0;\n  const l = (max + min) / 2;\n\n  if (max !== min) {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    \n    switch (max) {\n      case r:\n        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n        break;\n      case g:\n        h = ((b - r) / d + 2) / 6;\n        break;\n      case b:\n        h = ((r - g) / d + 4) / 6;\n        break;\n    }\n  }\n\n  const hDeg = Math.round(h * 360);\n  const sPct = Math.round(s * 100);\n  const lPct = Math.round(l * 100);\n\n  return `${hDeg} ${sPct}% ${lPct}%`;\n}\n\nexport function useThemeSettings() {\n  const { data: settings, isLoading } = useQuery({\n    queryKey: ['/api/settings'],\n    refetchInterval: false,\n    staleTime: 1000 * 60 * 5, // 5 minutes\n  });\n\n  useEffect(() => {\n    if (!settings || isLoading) return;\n\n    let theme = (settings as any).theme;\n    \n    // If theme is a JSON string, parse it\n    if (typeof theme === 'string') {\n      try {\n        theme = JSON.parse(theme);\n      } catch (e) {\n        console.error('Failed to parse theme from settings:', e);\n        return;\n      }\n    }\n    \n    if (!theme || typeof theme !== 'object') return;\n\n    try {\n      const root = document.documentElement;\n    \n      if (theme.primaryColor) {\n        const rgb = hexToHsl(theme.primaryColor);\n        root.style.setProperty('--primary', rgb);\n      }\n      \n      if (theme.secondaryColor) {\n        const rgb = hexToHsl(theme.secondaryColor);\n        root.style.setProperty('--secondary', rgb);\n      }\n      \n      if (theme.accentColor) {\n        const rgb = hexToHsl(theme.accentColor);\n        root.style.setProperty('--accent', rgb);\n      }\n\n      // Apply font settings\n      if (theme.bodyFont) {\n        loadGoogleFont(theme.bodyFont);\n        root.style.setProperty('--font-sans', `\"${theme.bodyFont}\", sans-serif`);\n      }\n\n      if (theme.headingFont) {\n        loadGoogleFont(theme.headingFont);\n        root.style.setProperty('--font-heading', `\"${theme.headingFont}\", sans-serif`);\n      }\n\n      // Apply border radius\n      if (theme.borderRadius) {\n        root.style.setProperty('--radius', `${theme.borderRadius}px`);\n      }\n\n      // Apply animation speed\n      if (theme.animationSpeed) {\n        root.style.setProperty('--animation-speed', `${theme.animationSpeed}ms`);\n      }\n\n      // Apply line height\n      if (theme.lineHeight) {\n        root.style.setProperty('--line-height', theme.lineHeight);\n      }\n\n      // Apply letter spacing\n      if (theme.letterSpacing) {\n        root.style.setProperty('--letter-spacing', `${theme.letterSpacing}px`);\n      }\n\n      // Apply container width\n      if (theme.containerWidth) {\n        root.style.setProperty('--container-width', theme.containerWidth === '100%' ? '100%' : `${theme.containerWidth}px`);\n      }\n\n      // Apply shadow preset\n      if (theme.shadowPreset) {\n        const shadowValues = {\n          none: 'none',\n          soft: '0 1px 3px rgba(0,0,0,0.1)',\n          medium: '0 4px 6px rgba(0,0,0,0.1)',\n          bold: '0 10px 15px rgba(0,0,0,0.1)',\n        };\n        root.style.setProperty('--shadow', shadowValues[theme.shadowPreset as keyof typeof shadowValues] || shadowValues.soft);\n      }\n\n      // Apply custom CSS if provided\n      if (theme.customCSS) {\n        let styleElement = document.getElementById('custom-theme-css');\n        if (!styleElement) {\n          styleElement = document.createElement('style');\n          styleElement.id = 'custom-theme-css';\n          document.head.appendChild(styleElement);\n        }\n        styleElement.textContent = theme.customCSS;\n      }\n    } catch (error) {\n      console.error('Error applying theme settings:', error);\n    }\n  }, [settings, isLoading]);\n}\n","path":null,"size_bytes":4668,"size_tokens":null},"server/api/webhooks.ts":{"content":"import { Router } from \"express\";\n\nconst router = Router();\n\n// Webhooks API has been removed\nexport default router;\n\nexport async function triggerWebhooks(event: string, payload: any): Promise<void> {\n  // Webhooks functionality has been removed\n}","path":null,"size_bytes":248,"size_tokens":null},"server/api/image-optimizer.ts":{"content":"\nimport { Router, Request, Response } from \"express\";\nimport { requireAdmin } from \"../middleware/auth\";\nimport { storage } from \"../storage\";\nimport sharp from \"sharp\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\n\nconst router = Router();\n\ninterface OptimizationJob {\n  id: string;\n  filename: string;\n  originalSize: number;\n  optimizedSize: number;\n  status: 'pending' | 'processing' | 'completed' | 'failed';\n  savedPercentage: number;\n  error?: string;\n}\n\nconst optimizationQueue: Map<string, OptimizationJob> = new Map();\n\nrouter.get(\"/stats\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const uploadsDir = path.join(process.cwd(), \"uploads\", \"images\");\n    const files = await fs.readdir(uploadsDir);\n    \n    let totalSize = 0;\n    let optimizedCount = 0;\n    \n    for (const file of files) {\n      const filePath = path.join(uploadsDir, file);\n      const stats = await fs.stat(filePath);\n      totalSize += stats.size;\n    }\n    \n    const jobs = Array.from(optimizationQueue.values());\n    const completedJobs = jobs.filter(j => j.status === 'completed');\n    optimizedCount = completedJobs.length;\n    \n    const totalSaved = completedJobs.reduce((sum, job) => \n      sum + (job.originalSize - job.optimizedSize), 0\n    );\n    \n    const avgCompression = completedJobs.length > 0\n      ? completedJobs.reduce((sum, job) => sum + job.savedPercentage, 0) / completedJobs.length\n      : 0;\n    \n    res.json({\n      totalImages: files.length,\n      optimizedImages: optimizedCount,\n      totalSize,\n      savedSpace: totalSaved,\n      avgCompression: Math.round(avgCompression)\n    });\n  } catch (error: any) {\n    res.status(500).json({ error: error.message });\n  }\n});\n\nrouter.get(\"/jobs\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const jobs = Array.from(optimizationQueue.values());\n    res.json(jobs);\n  } catch (error: any) {\n    res.status(500).json({ error: error.message });\n  }\n});\n\nrouter.post(\"/optimize\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { filename, quality = 80, maxWidth = 1920 } = req.body;\n    \n    if (!filename) {\n      return res.status(400).json({ error: \"Filename is required\" });\n    }\n    \n    const jobId = `job-${Date.now()}-${Math.random().toString(36).substring(7)}`;\n    const inputPath = path.join(process.cwd(), \"uploads\", \"images\", filename);\n    \n    const originalStats = await fs.stat(inputPath);\n    const originalSize = originalStats.size;\n    \n    const job: OptimizationJob = {\n      id: jobId,\n      filename,\n      originalSize,\n      optimizedSize: originalSize,\n      status: 'processing',\n      savedPercentage: 0\n    };\n    \n    optimizationQueue.set(jobId, job);\n    \n    // Optimize in background\n    (async () => {\n      try {\n        const image = sharp(inputPath);\n        const metadata = await image.metadata();\n        \n        let processedImage = image;\n        \n        if (metadata.width && metadata.width > maxWidth) {\n          processedImage = processedImage.resize(maxWidth);\n        }\n        \n        const outputPath = inputPath;\n        \n        if (metadata.format === 'jpeg' || metadata.format === 'jpg') {\n          await processedImage.jpeg({ quality }).toFile(outputPath + '.tmp');\n        } else if (metadata.format === 'png') {\n          await processedImage.png({ quality }).toFile(outputPath + '.tmp');\n        } else if (metadata.format === 'webp') {\n          await processedImage.webp({ quality }).toFile(outputPath + '.tmp');\n        } else {\n          await processedImage.toFile(outputPath + '.tmp');\n        }\n        \n        const optimizedStats = await fs.stat(outputPath + '.tmp');\n        const optimizedSize = optimizedStats.size;\n        \n        await fs.rename(outputPath + '.tmp', outputPath);\n        \n        const savedPercentage = Math.round(((originalSize - optimizedSize) / originalSize) * 100);\n        \n        job.optimizedSize = optimizedSize;\n        job.savedPercentage = savedPercentage;\n        job.status = 'completed';\n        optimizationQueue.set(jobId, job);\n        \n        await storage.createActivityLog({\n          action: `Optimized image ${filename} (saved ${savedPercentage}%)`,\n          userId: (req as any).user?.id,\n          userName: (req as any).user?.name || \"Admin\",\n          type: \"info\"\n        });\n      } catch (error: any) {\n        job.status = 'failed';\n        job.error = error.message;\n        optimizationQueue.set(jobId, job);\n      }\n    })();\n    \n    res.json({ jobId, message: \"Optimization started\" });\n  } catch (error: any) {\n    res.status(500).json({ error: error.message });\n  }\n});\n\nrouter.post(\"/optimize-all\", requireAdmin, async (req: Request, res: Response) => {\n  try {\n    const { quality = 80, maxWidth = 1920 } = req.body;\n    const uploadsDir = path.join(process.cwd(), \"uploads\", \"images\");\n    const files = await fs.readdir(uploadsDir);\n    \n    const imageFiles = files.filter(f => \n      /\\.(jpg|jpeg|png|webp)$/i.test(f)\n    );\n    \n    const jobIds = [];\n    \n    for (const filename of imageFiles) {\n      const jobId = `job-${Date.now()}-${Math.random().toString(36).substring(7)}`;\n      jobIds.push(jobId);\n      \n      // Queue optimization jobs\n      setTimeout(() => {\n        req.body = { filename, quality, maxWidth };\n        // Process each file\n      }, 100 * jobIds.length);\n    }\n    \n    res.json({ \n      message: `Queued ${imageFiles.length} images for optimization`,\n      count: imageFiles.length\n    });\n  } catch (error: any) {\n    res.status(500).json({ error: error.message });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":5608,"size_tokens":null},"server/api/scheduled-tasks.ts":{"content":"import { Router, Request, Response } from \"express\";\nimport { storage } from \"../storage\";\nimport { insertScheduledTaskSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req: Request, res: Response) => {\n  try {\n    const tasks = await storage.getAllScheduledTasks();\n    res.json(tasks);\n  } catch (error) {\n    console.error(\"Error fetching scheduled tasks:\", error);\n    res.status(500).json({ error: \"Failed to fetch scheduled tasks\" });\n  }\n});\n\nrouter.get(\"/active\", async (req: Request, res: Response) => {\n  try {\n    const tasks = await storage.getActiveScheduledTasks();\n    res.json(tasks);\n  } catch (error) {\n    console.error(\"Error fetching active scheduled tasks:\", error);\n    res.status(500).json({ error: \"Failed to fetch active scheduled tasks\" });\n  }\n});\n\nrouter.get(\"/:id\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.getScheduledTask(id);\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    res.json(task);\n  } catch (error) {\n    console.error(\"Error fetching scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to fetch scheduled task\" });\n  }\n});\n\nrouter.post(\"/\", async (req: Request, res: Response) => {\n  try {\n    const data = insertScheduledTaskSchema.parse(req.body);\n    const task = await storage.createScheduledTask(data);\n    \n    await storage.createActivityLog({\n      action: `Created scheduled task: ${task.name}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"create\"\n    });\n    \n    res.status(201).json(task);\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ error: \"Validation error\", details: error.errors });\n    }\n    console.error(\"Error creating scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to create scheduled task\" });\n  }\n});\n\nrouter.patch(\"/:id\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.updateScheduledTask(id, req.body);\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    \n    await storage.createActivityLog({\n      action: `Updated scheduled task: ${task.name}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"update\"\n    });\n    \n    res.json(task);\n  } catch (error) {\n    console.error(\"Error updating scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to update scheduled task\" });\n  }\n});\n\nrouter.post(\"/:id/run\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.getScheduledTask(id);\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    \n    let result: 'success' | 'failed' = 'success';\n    let error: string | undefined;\n    \n    try {\n      switch (task.type) {\n        case 'backup':\n          break;\n        case 'email':\n          break;\n        case 'maintenance':\n          break;\n        default:\n          break;\n      }\n    } catch (e) {\n      result = 'failed';\n      error = e instanceof Error ? e.message : 'Unknown error';\n    }\n    \n    const updatedTask = await storage.updateScheduledTaskRun(id, result, error);\n    \n    await storage.createActivityLog({\n      action: `Ran scheduled task: ${task.name} - Result: ${result}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: result === 'success' ? 'info' : 'error'\n    });\n    \n    res.json({ task: updatedTask, result, error });\n  } catch (error) {\n    console.error(\"Error running scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to run scheduled task\" });\n  }\n});\n\nrouter.post(\"/:id/pause\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.updateScheduledTask(id, { status: \"paused\" });\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    \n    await storage.createActivityLog({\n      action: `Paused scheduled task: ${task.name}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"update\"\n    });\n    \n    res.json(task);\n  } catch (error) {\n    console.error(\"Error pausing scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to pause scheduled task\" });\n  }\n});\n\nrouter.post(\"/:id/resume\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.updateScheduledTask(id, { status: \"active\" });\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    \n    await storage.createActivityLog({\n      action: `Resumed scheduled task: ${task.name}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"update\"\n    });\n    \n    res.json(task);\n  } catch (error) {\n    console.error(\"Error resuming scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to resume scheduled task\" });\n  }\n});\n\nrouter.delete(\"/:id\", async (req: Request, res: Response) => {\n  try {\n    const id = parseInt(req.params.id);\n    const task = await storage.getScheduledTask(id);\n    if (!task) {\n      return res.status(404).json({ error: \"Scheduled task not found\" });\n    }\n    \n    const deleted = await storage.deleteScheduledTask(id);\n    \n    await storage.createActivityLog({\n      action: `Deleted scheduled task: ${task.name}`,\n      userId: (req as any).user?.id,\n      userName: (req as any).user?.name || \"System\",\n      type: \"delete\"\n    });\n    \n    res.json({ success: deleted });\n  } catch (error) {\n    console.error(\"Error deleting scheduled task:\", error);\n    res.status(500).json({ error: \"Failed to delete scheduled task\" });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":6064,"size_tokens":null},"README.md":{"content":"# Loi Developer Portfolio - Full-Stack CMS Platform\n\n## Giá»›i Thiá»‡u\n\n**Loi Developer Portfolio** lÃ  má»™t ná»n táº£ng website portfolio hiá»‡n Ä‘áº¡i, Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng Ä‘Æ°á»£c xÃ¢y dá»±ng cho nhÃ  phÃ¡t triá»ƒn full-stack. Há»‡ thá»‘ng bao gá»“m má»™t frontend dark-theme Ä‘áº¹p máº¯t vá»›i cÃ¡c hiá»‡u á»©ng 3D, animations vÃ  má»™t báº£ng Ä‘iá»u khiá»ƒn admin toÃ n diá»‡n Ä‘á»ƒ quáº£n lÃ½ ná»™i dung.\n\n### CÃ´ng Nghá»‡ Sá»­ Dá»¥ng\n\n| PhÃ¢n loáº¡i | CÃ´ng nghá»‡ |\n|-----------|-----------|\n| **Frontend** | React 18, TypeScript, Vite, Tailwind CSS v4 |\n| **UI Components** | Radix UI, shadcn/ui, Framer Motion |\n| **3D Graphics** | React Three Fiber, Three.js |\n| **State Management** | TanStack Query, React Context API |\n| **Routing** | Wouter |\n| **Backend** | Node.js, Express, TypeScript |\n| **Database** | PostgreSQL vá»›i Drizzle ORM |\n| **Authentication** | Passport.js, Express Session |\n| **Real-time** | WebSocket |\n\n---\n\n## Cáº¥u TrÃºc Dá»± Ãn\n\n```\nâ”œâ”€â”€ client/                     # Frontend React application\nâ”‚   â”œâ”€â”€ src/\nâ”‚   â”‚   â”œâ”€â”€ components/         # Reusable UI components\nâ”‚   â”‚   â”‚   â”œâ”€â”€ admin/          # Admin-specific components\nâ”‚   â”‚   â”‚   â”œâ”€â”€ common/         # Common utilities (LazyImage, SEO, SocialShare)\nâ”‚   â”‚   â”‚   â”œâ”€â”€ layout/         # Layout components (Navbar, Footer)\nâ”‚   â”‚   â”‚   â”œâ”€â”€ sections/       # Homepage sections\nâ”‚   â”‚   â”‚   â””â”€â”€ ui/             # shadcn/ui components\nâ”‚   â”‚   â”œâ”€â”€ context/            # React Context providers\nâ”‚   â”‚   â”œâ”€â”€ hooks/              # Custom React hooks\nâ”‚   â”‚   â”œâ”€â”€ layouts/            # Page layouts\nâ”‚   â”‚   â”œâ”€â”€ lib/                # Utility functions\nâ”‚   â”‚   â””â”€â”€ pages/              # Page components\nâ”‚   â”‚       â”œâ”€â”€ admin/          # Admin dashboard pages\nâ”‚   â”‚       â””â”€â”€ home/           # Public-facing pages\nâ”œâ”€â”€ server/                     # Backend Express application\nâ”‚   â”œâ”€â”€ api/                    # API route handlers\nâ”‚   â”œâ”€â”€ middleware/             # Express middlewares\nâ”‚   â”œâ”€â”€ utils/                  # Utility functions\nâ”‚   â””â”€â”€ ...\nâ”œâ”€â”€ shared/                     # Shared types and schemas\nâ””â”€â”€ uploads/                    # Uploaded media files\n```\n\n---\n\n## Danh SÃ¡ch Chá»©c NÄƒng\n\n### 1. TRANG CÃ”NG Cá»˜NG (Public Pages)\n\n#### 1.1 Trang Chá»§ (Homepage)\n- **Hero Section**: Banner chÃ­nh vá»›i tiÃªu Ä‘á», subtitle vÃ  call-to-action\n- **About Section**: Giá»›i thiá»‡u cÃ¡ nhÃ¢n vá»›i avatar vÃ  thÃ´ng tin liÃªn há»‡\n- **Skills Section**: Hiá»ƒn thá»‹ ká»¹ nÄƒng vá»›i thanh tiáº¿n trÃ¬nh vÃ  phÃ¢n loáº¡i\n- **Projects Section**: Showcase dá»± Ã¡n vá»›i bá»™ lá»c theo danh má»¥c\n- **Services Section**: Danh sÃ¡ch dá»‹ch vá»¥ cung cáº¥p\n- **Testimonials Section**: ÄÃ¡nh giÃ¡ tá»« khÃ¡ch hÃ ng\n- **Blog Section**: BÃ i viáº¿t blog má»›i nháº¥t\n- **Contact Section**: Form liÃªn há»‡\n- **Newsletter Section**: ÄÄƒng kÃ½ nháº­n báº£n tin\n\n#### 1.2 Trang Blog\n- Danh sÃ¡ch bÃ i viáº¿t vá»›i phÃ¢n trang\n- Lá»c theo danh má»¥c\n- TÃ¬m kiáº¿m bÃ i viáº¿t\n- Chi tiáº¿t bÃ i viáº¿t vá»›i hÃ¬nh áº£nh, ná»™i dung rich-text\n- Há»‡ thá»‘ng bÃ¬nh luáº­n\n\n#### 1.3 Trang Dá»± Ãn\n- Gallery dá»± Ã¡n vá»›i bá»™ lá»c\n- Chi tiáº¿t dá»± Ã¡n vá»›i hÃ¬nh áº£nh, mÃ´ táº£, cÃ´ng nghá»‡ sá»­ dá»¥ng\n- Link demo vÃ  GitHub\n- Há»‡ thá»‘ng Ä‘Ã¡nh giÃ¡ (reviews)\n\n#### 1.4 Trang FAQs\n- CÃ¢u há»i thÆ°á»ng gáº·p vá»›i accordion\n\n#### 1.5 Trang CMS Äá»™ng\n- Trang tÄ©nh Ä‘Æ°á»£c táº¡o tá»« admin\n\n#### 1.6 Cháº¿ Äá»™ Báº£o TrÃ¬\n- Hiá»ƒn thá»‹ trang báº£o trÃ¬ khi admin báº­t cháº¿ Ä‘á»™ maintenance\n\n---\n\n### 2. Báº¢NG ÄIá»€U KHIá»‚N ADMIN (Admin Dashboard)\n\n#### 2.1 Dashboard ChÃ­nh\n- **Thá»‘ng kÃª tá»•ng quan**: Sá»‘ lÆ°á»£ng projects, posts, comments, messages\n- **Biá»ƒu Ä‘á»“**: Xu hÆ°á»›ng views theo thá»i gian\n- **Hoáº¡t Ä‘á»™ng gáº§n Ä‘Ã¢y**: Activity log\n- **Tin nháº¯n má»›i**: Danh sÃ¡ch tin nháº¯n chÆ°a Ä‘á»c\n\n#### 2.2 Quáº£n LÃ½ Ná»™i Dung (Content Management)\n\n##### Blog Posts\n- Táº¡o, sá»­a, xÃ³a bÃ i viáº¿t\n- Rich-text editor vá»›i TipTap\n- HÃ¬nh áº£nh Ä‘áº¡i diá»‡n\n- Tags vÃ  danh má»¥c\n- Tráº¡ng thÃ¡i: Draft, Published\n- ÄÃ¡nh dáº¥u bÃ i viáº¿t ná»•i báº­t\n\n##### Projects\n- Táº¡o, sá»­a, xÃ³a dá»± Ã¡n\n- HÃ¬nh áº£nh showcase\n- MÃ´ táº£ ngáº¯n vÃ  chi tiáº¿t\n- CÃ´ng nghá»‡ sá»­ dá»¥ng (tags)\n- Link demo vÃ  GitHub\n- Tráº¡ng thÃ¡i vÃ  featured\n\n##### Pages (CMS)\n- Táº¡o trang tÄ©nh tÃ¹y chá»‰nh\n- URL slug tá»± Ä‘á»™ng\n- Meta title vÃ  description cho SEO\n- Tráº¡ng thÃ¡i xuáº¥t báº£n\n\n##### Categories\n- Quáº£n lÃ½ danh má»¥c cho Posts\n- Quáº£n lÃ½ danh má»¥c cho Projects\n- Slug tá»± Ä‘á»™ng tá»« tÃªn\n\n##### Services\n- Danh sÃ¡ch dá»‹ch vá»¥ cung cáº¥p\n- Icon, mÃ´ táº£, tÃ­nh nÄƒng\n- GiÃ¡ cáº£\n- Thá»© tá»± hiá»ƒn thá»‹\n\n##### Skills\n- Ká»¹ nÄƒng vá»›i má»©c Ä‘á»™ thÃ nh tháº¡o (%)\n- PhÃ¢n loáº¡i (Frontend, Backend, Database, DevOps)\n- Icon tÃ¹y chá»‰nh\n\n##### Testimonials\n- ÄÃ¡nh giÃ¡ tá»« khÃ¡ch hÃ ng\n- TÃªn, vai trÃ², cÃ´ng ty\n- Avatar\n- Sá»‘ sao Ä‘Ã¡nh giÃ¡\n\n##### FAQs\n- CÃ¢u há»i vÃ  tráº£ lá»i\n- Thá»© tá»± hiá»ƒn thá»‹\n- áº¨n/hiá»‡n\n\n---\n\n#### 2.3 Giao Tiáº¿p (Communications)\n\n##### Inbox (Há»™p ThÆ°)\n- Nháº­n tin nháº¯n tá»« form liÃªn há»‡\n- ÄÃ¡nh dáº¥u Ä‘Ã£ Ä‘á»c/chÆ°a Ä‘á»c\n- LÆ°u trá»¯ (archive)\n- Gáº¯n tháº» (tags)\n- XÃ³a tin nháº¯n\n\n##### Comments\n- Quáº£n lÃ½ bÃ¬nh luáº­n bÃ i viáº¿t vÃ  dá»± Ã¡n\n- PhÃª duyá»‡t/tá»« chá»‘i\n- Tráº£ lá»i bÃ¬nh luáº­n\n- ÄÃ¡nh dáº¥u Ä‘Ã£ Ä‘á»c\n- Há»— trá»£ nested replies\n\n##### Reviews\n- Quáº£n lÃ½ Ä‘Ã¡nh giÃ¡ dá»± Ã¡n\n- PhÃª duyá»‡t/tá»« chá»‘i\n- Xem rating\n\n##### Newsletter\n- Quáº£n lÃ½ subscribers\n- Táº¡o vÃ  gá»­i email campaigns\n- Email templates tÃ¹y chá»‰nh\n- Thá»‘ng kÃª open/click rate\n- Unsubscribe handling\n\n##### Notifications\n- ThÃ´ng bÃ¡o real-time qua WebSocket\n- Badge Ä‘áº¿m sá»‘ thÃ´ng bÃ¡o chÆ°a Ä‘á»c\n- Lá»‹ch sá»­ thÃ´ng bÃ¡o\n\n##### Email Templates\n- Templates cho newsletter\n- Templates cho transactional emails\n- Variables Ä‘á»™ng ({{name}}, {{site_name}}, etc.)\n\n---\n\n#### 2.4 Media & Assets\n\n##### Media Library\n- Upload hÃ¬nh áº£nh vÃ  documents\n- Gallery view\n- Xem thÃ´ng tin file (size, type, dimensions)\n- XÃ³a files\n- Copy URL\n\n##### Image Optimizer\n- Tá»‘i Æ°u hÃ³a hÃ¬nh áº£nh\n- Resize, compress\n- Chuyá»ƒn Ä‘á»•i format\n\n##### File Manager\n- Quáº£n lÃ½ files trong thÆ° má»¥c uploads\n- Tá»• chá»©c theo folders\n\n---\n\n#### 2.5 Báº£o Máº­t (Security Center)\n\n##### Authentication\n- ÄÄƒng nháº­p báº±ng username/password\n- Two-Factor Authentication (2FA) vá»›i TOTP\n- WebAuthn/Biometric login\n- QuÃªn máº­t kháº©u vÃ  reset\n\n##### Session Management\n- Xem sessions Ä‘ang hoáº¡t Ä‘á»™ng\n- ÄÄƒng xuáº¥t tá»« xa\n- Session timeout tá»± Ä‘á»™ng\n\n##### IP Rules\n- IP Whitelist\n- IP Blacklist\n- Auto-block sau nhiá»u láº§n Ä‘Äƒng nháº­p tháº¥t báº¡i\n\n##### Enhanced Firewall (NÃ¢ng cao)\n- **Custom Firewall Rules**: Táº¡o quy táº¯c tÃ¹y chá»‰nh dá»±a trÃªn IP, URL path, HTTP header, query string, method\n- **Geographic Blocking**: Cháº·n traffic tá»« cÃ¡c quá»‘c gia cá»¥ thá»ƒ vá»›i há»— trá»£ CAPTCHA challenge\n- **Rate Limits Per Endpoint**: Cáº¥u hÃ¬nh rate limiting cho tá»«ng endpoint API cá»¥ thá»ƒ\n- **User Agent Filtering**: Cháº·n bots, crawlers, scrapers dá»±a trÃªn User-Agent patterns\n- **Blocked Requests Log**: Xem lá»‹ch sá»­ cÃ¡c requests bá»‹ cháº·n vá»›i chi tiáº¿t IP, path, reason\n- **Firewall Statistics Dashboard**: Thá»‘ng kÃª tá»•ng quan vá» blocked requests vÃ  active rules\n\n##### Rate Limiting\n- Giá»›i háº¡n requests per minute\n- Báº£o vá»‡ API endpoints\n- Cáº¥u hÃ¬nh linh hoáº¡t theo endpoint\n\n##### CAPTCHA Integration\n- Local CAPTCHA\n- Google reCAPTCHA v3\n- Cloudflare Turnstile\n\n##### Security Logs\n- Lá»‹ch sá»­ Ä‘Äƒng nháº­p\n- Bot blocked events\n- Suspicious activities\n\n##### Password Policy\n- YÃªu cáº§u Ä‘á»™ phá»©c táº¡p máº­t kháº©u\n- Password expiration\n- Password history\n\n---\n\n#### 2.6 Há»‡ Thá»‘ng (System)\n\n##### System Info\n- ThÃ´ng tin server\n- Database status\n- Storage usage\n- Memory/CPU stats\n\n##### Activity Log\n- Lá»‹ch sá»­ hoáº¡t Ä‘á»™ng admin\n- Ai lÃ m gÃ¬, khi nÃ o\n- Filter theo loáº¡i hoáº¡t Ä‘á»™ng\n\n##### System Logs\n- Error logs\n- Access logs\n- Debug logs\n\n##### Cache Management\n- Clear cache\n- Cache statistics\n\n##### Database Management\n- Database backup\n- Seed data\n\n##### Export/Import\n- Export dá»¯ liá»‡u ra JSON\n- Import dá»¯ liá»‡u tá»« backup\n\n##### API Documentation\n- TÃ i liá»‡u API endpoints\n- Interactive testing\n\n##### Scheduled Tasks\n- Quáº£n lÃ½ cron jobs\n- Task scheduling\n\n##### Webhooks\n- Táº¡o webhooks cho events\n- Webhook logs\n\n---\n\n#### 2.7 CÃ i Äáº·t (Settings)\n\n##### General Settings\n- Site title vÃ  tagline\n- Contact email\n- Maintenance mode\n\n##### Hero Section\n- Hero title vÃ  subtitle\n- Call-to-action text\n- CV file upload\n\n##### About Section\n- About title vÃ  description\n- Personal info (name, location)\n- Avatar image\n\n##### Contact Section\n- Contact info (phone, address)\n- Social media links\n\n##### Branding\n- Logo upload\n- Favicon\n- Site colors\n\n##### SEO\n- Meta title vÃ  description máº·c Ä‘á»‹nh\n- Open Graph settings\n- Sitemap generation\n\n##### Email Settings\n- SMTP configuration\n- Email sender info\n- Email templates\n\n##### Storage\n- Local storage settings\n- Cloud storage (AWS S3, Cloudflare R2)\n\n##### Performance\n- Lazy loading\n- Image optimization\n- Caching options\n\n##### Localization\n- Language selection\n- Translation management\n- Date/time format\n\n##### Developer Options\n- Debug mode\n- API keys\n- Custom CSS/JavaScript injection\n\n##### Notifications Settings\n- Email notifications\n- Browser notifications\n- Auto-approve comments/reviews\n\n---\n\n#### 2.8 CÃ´ng Cá»¥ (Tools)\n\n##### Code Editor\n- Chá»‰nh sá»­a custom CSS\n- Chá»‰nh sá»­a custom JavaScript\n- Syntax highlighting\n\n##### Page Builder\n- Drag-and-drop page builder\n- Pre-built blocks\n\n##### Theme Customization\n- Color palette\n- Typography\n- Spacing\n- Dark/Light mode\n\n##### Analytics\n- Page views statistics\n- Popular content\n- Traffic sources\n- User engagement\n\n---\n\n### 3. TÃNH NÄ‚NG Ká»¸ THUáº¬T\n\n#### 3.1 Authentication & Authorization\n- Session-based authentication vá»›i Express Session\n- Password hashing vá»›i bcrypt\n- Two-Factor Authentication (TOTP)\n- WebAuthn/Passkeys support\n- Role-based access control\n- Protected API routes\n\n#### 3.2 Real-time Features\n- WebSocket integration\n- Real-time notifications\n- Live updates cho comments/reviews\n\n#### 3.3 Database\n- PostgreSQL vá»›i Drizzle ORM\n- Type-safe queries\n- Relationship handling\n- Automatic migrations\n\n#### 3.4 API Architecture\n- RESTful API design\n- Request validation vá»›i Zod\n- Error handling middleware\n- Rate limiting\n\n#### 3.5 Frontend Features\n- Server-side state vá»›i TanStack Query\n- Lazy loading cho pages\n- Optimistic updates\n- Toast notifications\n- Form validation\n- Responsive design\n- Dark/Light theme\n\n#### 3.6 SEO Optimization\n- Meta tags management\n- Open Graph support\n- Sitemap generation\n- Semantic HTML\n\n#### 3.7 Performance\n- Code splitting\n- Lazy loading images\n- Caching strategies\n- Optimized bundles\n\n---\n\n## HÆ°á»›ng Dáº«n CÃ i Äáº·t\n\n### YÃªu Cáº§u\n- Node.js 18+\n- PostgreSQL database\n- npm hoáº·c yarn\n\n### CÃ i Äáº·t\n\n1. Clone repository\n2. CÃ i Ä‘áº·t dependencies:\n   ```bash\n   npm install\n   ```\n\n3. Táº¡o database PostgreSQL vÃ  cáº¥u hÃ¬nh biáº¿n mÃ´i trÆ°á»ng:\n   ```\n   DATABASE_URL=postgresql://user:password@host:port/database\n   ```\n\n4. Cháº¡y database migrations:\n   ```bash\n   npm run db:push\n   ```\n\n5. (TÃ¹y chá»n) Seed dá»¯ liá»‡u máº«u:\n   ```bash\n   npm run seed\n   ```\n\n6. Khá»Ÿi Ä‘á»™ng development server:\n   ```bash\n   npm run dev\n   ```\n\n7. Truy cáº­p:\n   - Website: http://localhost:5000\n   - Admin: http://localhost:5000/admin\n\n### TÃ i Khoáº£n Admin Máº·c Äá»‹nh\n- Username: `admin`\n- Password: `admin123`\n\n---\n\n## API Endpoints\n\n### Authentication\n| Method | Endpoint | MÃ´ táº£ |\n|--------|----------|-------|\n| POST | `/api/auth/login` | ÄÄƒng nháº­p |\n| POST | `/api/auth/logout` | ÄÄƒng xuáº¥t |\n| GET | `/api/auth/me` | Láº¥y thÃ´ng tin user hiá»‡n táº¡i |\n| POST | `/api/auth/2fa/setup` | Thiáº¿t láº­p 2FA |\n| POST | `/api/auth/2fa/verify` | XÃ¡c minh 2FA |\n\n### Content\n| Method | Endpoint | MÃ´ táº£ |\n|--------|----------|-------|\n| GET/POST | `/api/projects` | Quáº£n lÃ½ dá»± Ã¡n |\n| GET/POST | `/api/posts` | Quáº£n lÃ½ bÃ i viáº¿t |\n| GET/POST | `/api/pages` | Quáº£n lÃ½ trang CMS |\n| GET/POST | `/api/services` | Quáº£n lÃ½ dá»‹ch vá»¥ |\n| GET/POST | `/api/skills` | Quáº£n lÃ½ ká»¹ nÄƒng |\n| GET/POST | `/api/testimonials` | Quáº£n lÃ½ testimonials |\n| GET/POST | `/api/categories` | Quáº£n lÃ½ danh má»¥c |\n| GET/POST | `/api/faqs` | Quáº£n lÃ½ FAQs |\n\n### Communications\n| Method | Endpoint | MÃ´ táº£ |\n|--------|----------|-------|\n| GET/POST | `/api/messages` | Quáº£n lÃ½ tin nháº¯n |\n| GET/POST | `/api/comments` | Quáº£n lÃ½ bÃ¬nh luáº­n |\n| GET/POST | `/api/reviews` | Quáº£n lÃ½ Ä‘Ã¡nh giÃ¡ |\n| GET/POST | `/api/subscribers` | Quáº£n lÃ½ subscribers |\n| GET/POST | `/api/email-campaigns` | Quáº£n lÃ½ email campaigns |\n| GET/POST | `/api/notifications` | Quáº£n lÃ½ thÃ´ng bÃ¡o |\n\n### System\n| Method | Endpoint | MÃ´ táº£ |\n|--------|----------|-------|\n| GET/PUT | `/api/settings` | CÃ i Ä‘áº·t website |\n| GET | `/api/dashboard` | Dashboard statistics |\n| GET | `/api/activity-logs` | Activity logs |\n| GET/POST | `/api/security/*` | Security settings |\n| GET/POST | `/api/media` | Media management |\n| GET | `/api/analytics` | Analytics data |\n\n---\n\n## Báº£o Máº­t\n\nHá»‡ thá»‘ng Ä‘Æ°á»£c trang bá»‹ nhiá»u lá»›p báº£o máº­t:\n\n1. **Authentication**: Session-based vá»›i secure cookies\n2. **Password Security**: Bcrypt hashing, password policy\n3. **2FA**: TOTP vÃ  WebAuthn support\n4. **Rate Limiting**: Chá»‘ng brute-force\n5. **IP Filtering**: Whitelist/Blacklist\n6. **CAPTCHA**: Chá»‘ng bot\n7. **XSS/SQL Injection Protection**: Input validation\n8. **CSRF Protection**: Session tokens\n9. **Security Logging**: Audit trail\n\n---\n\n## License\n\nMIT License\n\n---\n\n## TÃ¡c Giáº£\n\n**Loi Developer** - Full-stack Developer\n\n- Website: [loideveloper.com](https://loideveloper.com)\n- Email: loideveloper@example.com\n- GitHub: [@loideveloper](https://github.com/loideveloper)\n","path":null,"size_bytes":14238,"size_tokens":null},"client/src/components/admin/EnhancedFirewall.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Globe, Shield, Ban, Plus, Trash2, Edit, Clock, AlertTriangle,\n  Loader2, Filter, Activity, BarChart3, Server, Zap, RefreshCw,\n  CheckCircle, XCircle, MapPin\n} from \"lucide-react\";\n\ninterface FirewallRule {\n  id: number;\n  name: string;\n  description?: string;\n  ruleType: string;\n  condition: string;\n  value: string;\n  action: string;\n  priority: number;\n  enabled: boolean;\n  hitCount: number;\n  lastHit?: string;\n  expiresAt?: string;\n  createdAt?: string;\n}\n\ninterface GeoBlockingRule {\n  id: number;\n  countryCode: string;\n  countryName: string;\n  action: string;\n  enabled: boolean;\n  createdAt?: string;\n}\n\ninterface RateLimitRule {\n  id: number;\n  name: string;\n  path: string;\n  method: string;\n  maxRequests: number;\n  windowSeconds: number;\n  blockDuration: number;\n  enabled: boolean;\n  createdAt?: string;\n}\n\ninterface UserAgentRule {\n  id: number;\n  name: string;\n  pattern: string;\n  matchType: string;\n  action: string;\n  category?: string;\n  enabled: boolean;\n  createdAt?: string;\n}\n\ninterface BlockedRequest {\n  id: number;\n  ipAddress: string;\n  path: string;\n  method: string;\n  reason: string;\n  countryCode?: string;\n  userAgent?: string;\n  createdAt?: string;\n}\n\ninterface IpRule {\n  id: number;\n  ipAddress: string;\n  type: 'whitelist' | 'blacklist';\n  createdAt?: string;\n}\n\nconst COUNTRY_LIST = [\n  { code: 'CN', name: 'China' },\n  { code: 'RU', name: 'Russia' },\n  { code: 'KP', name: 'North Korea' },\n  { code: 'IR', name: 'Iran' },\n  { code: 'IN', name: 'India' },\n  { code: 'BR', name: 'Brazil' },\n  { code: 'NG', name: 'Nigeria' },\n  { code: 'PK', name: 'Pakistan' },\n  { code: 'ID', name: 'Indonesia' },\n  { code: 'VN', name: 'Vietnam' },\n  { code: 'UA', name: 'Ukraine' },\n  { code: 'TH', name: 'Thailand' },\n  { code: 'EG', name: 'Egypt' },\n  { code: 'RO', name: 'Romania' },\n  { code: 'BD', name: 'Bangladesh' },\n];\n\nconst USER_AGENT_PRESETS = [\n  { name: 'Block Common Bots', pattern: 'bot|crawler|spider|scraper', matchType: 'regex', category: 'bot' },\n  { name: 'Block curl/wget', pattern: 'curl|wget', matchType: 'regex', category: 'tool' },\n  { name: 'Block Python Requests', pattern: 'python-requests|httpx', matchType: 'regex', category: 'tool' },\n  { name: 'Block Headless Browsers', pattern: 'HeadlessChrome|PhantomJS', matchType: 'regex', category: 'automation' },\n  { name: 'Block Empty User Agent', pattern: '^$', matchType: 'regex', category: 'suspicious' },\n];\n\nexport function EnhancedFirewall() {\n  const { toast } = useToast();\n  const [activeSubTab, setActiveSubTab] = useState(\"ip-rules\");\n  const [newWhitelistIp, setNewWhitelistIp] = useState(\"\");\n  const [newBlacklistIp, setNewBlacklistIp] = useState(\"\");\n  const [showFirewallRuleDialog, setShowFirewallRuleDialog] = useState(false);\n  const [showGeoBlockDialog, setShowGeoBlockDialog] = useState(false);\n  const [showRateLimitDialog, setShowRateLimitDialog] = useState(false);\n  const [showUserAgentDialog, setShowUserAgentDialog] = useState(false);\n  const [editingRule, setEditingRule] = useState<FirewallRule | null>(null);\n\n  const [newFirewallRule, setNewFirewallRule] = useState({\n    name: '',\n    description: '',\n    ruleType: 'ip',\n    condition: 'equals',\n    value: '',\n    action: 'block',\n    priority: 100,\n    enabled: true\n  });\n\n  const [selectedCountry, setSelectedCountry] = useState('');\n  const [geoAction, setGeoAction] = useState<'block' | 'challenge'>('block');\n\n  const [newRateLimit, setNewRateLimit] = useState({\n    name: '',\n    path: '/api/*',\n    method: '*',\n    maxRequests: 100,\n    windowSeconds: 60,\n    blockDuration: 300\n  });\n\n  const [newUserAgent, setNewUserAgent] = useState({\n    name: '',\n    pattern: '',\n    matchType: 'contains',\n    action: 'block',\n    category: ''\n  });\n\n  const { data: ipRules = [] } = useQuery<IpRule[]>({\n    queryKey: ['/api/security/ip-rules']\n  });\n\n  const { data: firewallRules = [] } = useQuery<FirewallRule[]>({\n    queryKey: ['/api/security/firewall-rules']\n  });\n\n  const { data: geoBlockingRules = [] } = useQuery<GeoBlockingRule[]>({\n    queryKey: ['/api/security/geo-blocking']\n  });\n\n  const { data: rateLimitRules = [] } = useQuery<RateLimitRule[]>({\n    queryKey: ['/api/security/rate-limit-rules']\n  });\n\n  const { data: userAgentRules = [] } = useQuery<UserAgentRule[]>({\n    queryKey: ['/api/security/user-agent-rules']\n  });\n\n  const { data: blockedRequests = [] } = useQuery<BlockedRequest[]>({\n    queryKey: ['/api/security/blocked-requests']\n  });\n\n  const { data: blockedStats } = useQuery<{\n    total: number;\n    byReason: { reason: string; count: number }[];\n    byCountry: { country: string; count: number }[];\n  }>({\n    queryKey: ['/api/security/blocked-requests/stats']\n  });\n\n  const whitelistIps = ipRules.filter(r => r.type === 'whitelist');\n  const blacklistIps = ipRules.filter(r => r.type === 'blacklist');\n\n  const addIpRuleMutation = useMutation({\n    mutationFn: (data: { ipAddress: string; type: 'whitelist' | 'blacklist' }) =>\n      apiRequest('POST', '/api/security/ip-rules', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/ip-rules'] });\n      setNewWhitelistIp(\"\");\n      setNewBlacklistIp(\"\");\n      toast({ title: \"IP rule added successfully\" });\n    },\n    onError: () => toast({ title: \"Failed to add IP rule\", variant: \"destructive\" })\n  });\n\n  const deleteIpRuleMutation = useMutation({\n    mutationFn: (id: number) =>\n      apiRequest('DELETE', `/api/security/ip-rules/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/ip-rules'] });\n      toast({ title: \"IP rule removed\" });\n    }\n  });\n\n  const createFirewallRuleMutation = useMutation({\n    mutationFn: (data: typeof newFirewallRule) =>\n      apiRequest('POST', '/api/security/firewall-rules', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/firewall-rules'] });\n      setShowFirewallRuleDialog(false);\n      setNewFirewallRule({ name: '', description: '', ruleType: 'ip', condition: 'equals', value: '', action: 'block', priority: 100, enabled: true });\n      toast({ title: \"Firewall rule created\" });\n    }\n  });\n\n  const updateFirewallRuleMutation = useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<FirewallRule> }) =>\n      apiRequest('PATCH', `/api/security/firewall-rules/${id}`, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/firewall-rules'] });\n      toast({ title: \"Rule updated\" });\n    }\n  });\n\n  const deleteFirewallRuleMutation = useMutation({\n    mutationFn: (id: number) =>\n      apiRequest('DELETE', `/api/security/firewall-rules/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/firewall-rules'] });\n      toast({ title: \"Rule deleted\" });\n    }\n  });\n\n  const createGeoBlockMutation = useMutation({\n    mutationFn: (data: { countryCode: string; countryName: string; action: string }) =>\n      apiRequest('POST', '/api/security/geo-blocking', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/geo-blocking'] });\n      setShowGeoBlockDialog(false);\n      setSelectedCountry('');\n      toast({ title: \"Country block rule added\" });\n    }\n  });\n\n  const deleteGeoBlockMutation = useMutation({\n    mutationFn: (id: number) =>\n      apiRequest('DELETE', `/api/security/geo-blocking/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/geo-blocking'] });\n      toast({ title: \"Country block removed\" });\n    }\n  });\n\n  const toggleGeoBlockMutation = useMutation({\n    mutationFn: ({ id, enabled }: { id: number; enabled: boolean }) =>\n      apiRequest('PATCH', `/api/security/geo-blocking/${id}`, { enabled }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/geo-blocking'] });\n    }\n  });\n\n  const createRateLimitMutation = useMutation({\n    mutationFn: (data: typeof newRateLimit) =>\n      apiRequest('POST', '/api/security/rate-limit-rules', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/rate-limit-rules'] });\n      setShowRateLimitDialog(false);\n      setNewRateLimit({ name: '', path: '/api/*', method: '*', maxRequests: 100, windowSeconds: 60, blockDuration: 300 });\n      toast({ title: \"Rate limit rule created\" });\n    }\n  });\n\n  const deleteRateLimitMutation = useMutation({\n    mutationFn: (id: number) =>\n      apiRequest('DELETE', `/api/security/rate-limit-rules/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/rate-limit-rules'] });\n      toast({ title: \"Rate limit rule deleted\" });\n    }\n  });\n\n  const toggleRateLimitMutation = useMutation({\n    mutationFn: ({ id, enabled }: { id: number; enabled: boolean }) =>\n      apiRequest('PATCH', `/api/security/rate-limit-rules/${id}`, { enabled }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/rate-limit-rules'] });\n    }\n  });\n\n  const createUserAgentMutation = useMutation({\n    mutationFn: (data: typeof newUserAgent) =>\n      apiRequest('POST', '/api/security/user-agent-rules', data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/user-agent-rules'] });\n      setShowUserAgentDialog(false);\n      setNewUserAgent({ name: '', pattern: '', matchType: 'contains', action: 'block', category: '' });\n      toast({ title: \"User agent rule created\" });\n    }\n  });\n\n  const deleteUserAgentMutation = useMutation({\n    mutationFn: (id: number) =>\n      apiRequest('DELETE', `/api/security/user-agent-rules/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/user-agent-rules'] });\n      toast({ title: \"User agent rule deleted\" });\n    }\n  });\n\n  const toggleUserAgentMutation = useMutation({\n    mutationFn: ({ id, enabled }: { id: number; enabled: boolean }) =>\n      apiRequest('PATCH', `/api/security/user-agent-rules/${id}`, { enabled }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/security/user-agent-rules'] });\n    }\n  });\n\n  const validateIP = (ip: string) => {\n    const ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\\/(?:3[0-2]|[12]?[0-9]))?$/;\n    const ipv6Regex = /^(?:(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4})(?:\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9]))?$/;\n    return ipv4Regex.test(ip) || ipv6Regex.test(ip);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card data-testid=\"stat-card-blocked\">\n          <CardContent className=\"pt-4\">\n            <div className=\"flex items-center gap-2\">\n              <Ban className=\"w-5 h-5 text-red-500\" />\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-blocked-count\">{blockedStats?.total || 0}</p>\n                <p className=\"text-xs text-muted-foreground\">Total Blocked</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card data-testid=\"stat-card-active-rules\">\n          <CardContent className=\"pt-4\">\n            <div className=\"flex items-center gap-2\">\n              <Shield className=\"w-5 h-5 text-green-500\" />\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-active-rules\">{firewallRules.filter(r => r.enabled).length}</p>\n                <p className=\"text-xs text-muted-foreground\">Active Rules</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card data-testid=\"stat-card-geo-blocked\">\n          <CardContent className=\"pt-4\">\n            <div className=\"flex items-center gap-2\">\n              <MapPin className=\"w-5 h-5 text-orange-500\" />\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-geo-blocked\">{geoBlockingRules.filter(r => r.enabled).length}</p>\n                <p className=\"text-xs text-muted-foreground\">Countries Blocked</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card data-testid=\"stat-card-rate-limits\">\n          <CardContent className=\"pt-4\">\n            <div className=\"flex items-center gap-2\">\n              <Zap className=\"w-5 h-5 text-blue-500\" />\n              <div>\n                <p className=\"text-2xl font-bold\" data-testid=\"text-rate-limits\">{rateLimitRules.filter(r => r.enabled).length}</p>\n                <p className=\"text-xs text-muted-foreground\">Rate Limits</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Tabs value={activeSubTab} onValueChange={setActiveSubTab}>\n        <TabsList className=\"grid grid-cols-5 w-full\">\n          <TabsTrigger value=\"ip-rules\" data-testid=\"tab-ip-rules\">\n            <Globe className=\"w-4 h-4 mr-1\" /> IP Rules\n          </TabsTrigger>\n          <TabsTrigger value=\"custom-rules\" data-testid=\"tab-custom-rules\">\n            <Filter className=\"w-4 h-4 mr-1\" /> Custom Rules\n          </TabsTrigger>\n          <TabsTrigger value=\"geo-blocking\" data-testid=\"tab-geo-blocking\">\n            <MapPin className=\"w-4 h-4 mr-1\" /> Geo Blocking\n          </TabsTrigger>\n          <TabsTrigger value=\"rate-limits\" data-testid=\"tab-rate-limits\">\n            <Zap className=\"w-4 h-4 mr-1\" /> Rate Limits\n          </TabsTrigger>\n          <TabsTrigger value=\"user-agents\" data-testid=\"tab-user-agents\">\n            <Server className=\"w-4 h-4 mr-1\" /> User Agents\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"ip-rules\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Globe className=\"w-5 h-5\" /> IP Whitelist / Blacklist\n              </CardTitle>\n              <CardDescription>Control which IP addresses can access the system</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" /> IP Whitelist\n                </h4>\n                <div className=\"space-y-2 mb-3\">\n                  {whitelistIps.length === 0 ? (\n                    <p className=\"text-sm text-muted-foreground\">No whitelisted IPs</p>\n                  ) : (\n                    whitelistIps.map((rule) => (\n                      <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-green-500/5 border-green-500/20\">\n                        <span className=\"text-sm font-mono\">{rule.ipAddress}</span>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-destructive\"\n                          onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                          data-testid={`button-remove-whitelist-${rule.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))\n                  )}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add IP address (e.g., 192.168.1.1 or 10.0.0.0/8)\"\n                    value={newWhitelistIp}\n                    onChange={(e) => setNewWhitelistIp(e.target.value)}\n                    data-testid=\"input-whitelist-ip\"\n                  />\n                  <Button\n                    onClick={() => {\n                      if (newWhitelistIp && validateIP(newWhitelistIp)) {\n                        addIpRuleMutation.mutate({ ipAddress: newWhitelistIp, type: 'whitelist' });\n                      } else {\n                        toast({ title: \"Invalid IP address format\", variant: \"destructive\" });\n                      }\n                    }}\n                    disabled={!newWhitelistIp || addIpRuleMutation.isPending}\n                    data-testid=\"button-add-whitelist\"\n                  >\n                    <Plus className=\"w-4 h-4 mr-1\" /> Add\n                  </Button>\n                </div>\n              </div>\n\n              <Separator />\n\n              <div>\n                <h4 className=\"font-medium mb-2 flex items-center gap-2\">\n                  <XCircle className=\"w-4 h-4 text-red-500\" /> IP Blacklist\n                </h4>\n                <div className=\"space-y-2 mb-3\">\n                  {blacklistIps.length === 0 ? (\n                    <p className=\"text-sm text-muted-foreground\">No blacklisted IPs</p>\n                  ) : (\n                    blacklistIps.map((rule) => (\n                      <div key={rule.id} className=\"flex items-center justify-between p-2 border rounded bg-red-500/5 border-red-500/20\">\n                        <span className=\"text-sm font-mono\">{rule.ipAddress}</span>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-destructive\"\n                          onClick={() => deleteIpRuleMutation.mutate(rule.id)}\n                          data-testid={`button-remove-blacklist-${rule.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))\n                  )}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add IP to block...\"\n                    value={newBlacklistIp}\n                    onChange={(e) => setNewBlacklistIp(e.target.value)}\n                    data-testid=\"input-blacklist-ip\"\n                  />\n                  <Button\n                    variant=\"destructive\"\n                    onClick={() => {\n                      if (newBlacklistIp && validateIP(newBlacklistIp)) {\n                        addIpRuleMutation.mutate({ ipAddress: newBlacklistIp, type: 'blacklist' });\n                      } else {\n                        toast({ title: \"Invalid IP address format\", variant: \"destructive\" });\n                      }\n                    }}\n                    disabled={!newBlacklistIp || addIpRuleMutation.isPending}\n                    data-testid=\"button-add-blacklist\"\n                  >\n                    <Ban className=\"w-4 h-4 mr-1\" /> Block\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"custom-rules\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Filter className=\"w-5 h-5\" /> Custom Firewall Rules\n                  </CardTitle>\n                  <CardDescription>Create advanced rules based on multiple conditions</CardDescription>\n                </div>\n                <Button onClick={() => setShowFirewallRuleDialog(true)} data-testid=\"button-add-custom-rule\">\n                  <Plus className=\"w-4 h-4 mr-1\" /> Add Rule\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Name</TableHead>\n                    <TableHead>Type</TableHead>\n                    <TableHead>Condition</TableHead>\n                    <TableHead>Action</TableHead>\n                    <TableHead>Priority</TableHead>\n                    <TableHead>Hits</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead className=\"w-[100px]\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {firewallRules.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={8} className=\"text-center text-muted-foreground\">\n                        No custom rules configured\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    firewallRules.map((rule) => (\n                      <TableRow key={rule.id}>\n                        <TableCell className=\"font-medium\">{rule.name}</TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">{rule.ruleType}</Badge>\n                        </TableCell>\n                        <TableCell className=\"font-mono text-xs\">\n                          {rule.condition} {rule.value}\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant={rule.action === 'block' ? 'destructive' : rule.action === 'allow' ? 'default' : 'secondary'}>\n                            {rule.action}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>{rule.priority}</TableCell>\n                        <TableCell>{rule.hitCount}</TableCell>\n                        <TableCell>\n                          <Switch\n                            checked={rule.enabled}\n                            onCheckedChange={(enabled) => updateFirewallRuleMutation.mutate({ id: rule.id, data: { enabled } })}\n                          />\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex gap-1\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              onClick={() => deleteFirewallRuleMutation.mutate(rule.id)}\n                              data-testid={`button-delete-rule-${rule.id}`}\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"geo-blocking\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <MapPin className=\"w-5 h-5\" /> Geographic Blocking\n                  </CardTitle>\n                  <CardDescription>Block or challenge traffic from specific countries</CardDescription>\n                </div>\n                <Button onClick={() => setShowGeoBlockDialog(true)} data-testid=\"button-add-geo-block\">\n                  <Plus className=\"w-4 h-4 mr-1\" /> Add Country\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n                {geoBlockingRules.length === 0 ? (\n                  <p className=\"text-sm text-muted-foreground col-span-full text-center py-4\">\n                    No countries blocked\n                  </p>\n                ) : (\n                  geoBlockingRules.map((rule) => (\n                    <div\n                      key={rule.id}\n                      className={`flex items-center justify-between p-3 border rounded-lg ${\n                        rule.enabled ? 'bg-red-500/5 border-red-500/20' : 'bg-muted/50'\n                      }`}\n                      data-testid={`geo-block-card-${rule.id}`}\n                    >\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-xl\">{getCountryFlag(rule.countryCode)}</span>\n                        <div>\n                          <p className=\"font-medium text-sm\" data-testid={`text-country-name-${rule.id}`}>{rule.countryName}</p>\n                          <p className=\"text-xs text-muted-foreground\">{rule.countryCode}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant={rule.action === 'block' ? 'destructive' : 'secondary'}>\n                          {rule.action}\n                        </Badge>\n                        <Switch\n                          checked={rule.enabled}\n                          onCheckedChange={(enabled) => toggleGeoBlockMutation.mutate({ id: rule.id, enabled })}\n                          data-testid={`switch-geo-block-${rule.id}`}\n                        />\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => deleteGeoBlockMutation.mutate(rule.id)}\n                          data-testid={`button-delete-geo-block-${rule.id}`}\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"rate-limits\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Zap className=\"w-5 h-5\" /> Rate Limiting Rules\n                  </CardTitle>\n                  <CardDescription>Configure per-endpoint request limits</CardDescription>\n                </div>\n                <Button onClick={() => setShowRateLimitDialog(true)} data-testid=\"button-add-rate-limit\">\n                  <Plus className=\"w-4 h-4 mr-1\" /> Add Rule\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Name</TableHead>\n                    <TableHead>Path</TableHead>\n                    <TableHead>Method</TableHead>\n                    <TableHead>Limit</TableHead>\n                    <TableHead>Window</TableHead>\n                    <TableHead>Block Duration</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead className=\"w-[80px]\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {rateLimitRules.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={8} className=\"text-center text-muted-foreground\">\n                        No rate limit rules configured\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    rateLimitRules.map((rule) => (\n                      <TableRow key={rule.id} data-testid={`row-rate-limit-${rule.id}`}>\n                        <TableCell className=\"font-medium\" data-testid={`text-rate-limit-name-${rule.id}`}>{rule.name}</TableCell>\n                        <TableCell className=\"font-mono text-xs\">{rule.path}</TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">{rule.method}</Badge>\n                        </TableCell>\n                        <TableCell>{rule.maxRequests} req</TableCell>\n                        <TableCell>{rule.windowSeconds}s</TableCell>\n                        <TableCell>{rule.blockDuration}s</TableCell>\n                        <TableCell>\n                          <Switch\n                            checked={rule.enabled}\n                            onCheckedChange={(enabled) => toggleRateLimitMutation.mutate({ id: rule.id, enabled })}\n                            data-testid={`switch-rate-limit-${rule.id}`}\n                          />\n                        </TableCell>\n                        <TableCell>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => deleteRateLimitMutation.mutate(rule.id)}\n                            data-testid={`button-delete-rate-limit-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"user-agents\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Server className=\"w-5 h-5\" /> User Agent Filtering\n                  </CardTitle>\n                  <CardDescription>Block requests based on User-Agent patterns</CardDescription>\n                </div>\n                <Button onClick={() => setShowUserAgentDialog(true)} data-testid=\"button-add-user-agent\">\n                  <Plus className=\"w-4 h-4 mr-1\" /> Add Rule\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex flex-wrap gap-2\">\n                <span className=\"text-sm text-muted-foreground\">Quick add presets:</span>\n                {USER_AGENT_PRESETS.map((preset, index) => (\n                  <Button\n                    key={preset.name}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => createUserAgentMutation.mutate({\n                      name: preset.name,\n                      pattern: preset.pattern,\n                      matchType: preset.matchType,\n                      action: 'block',\n                      category: preset.category\n                    })}\n                    disabled={createUserAgentMutation.isPending}\n                    data-testid={`button-preset-${index}`}\n                  >\n                    {preset.name}\n                  </Button>\n                ))}\n              </div>\n\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Name</TableHead>\n                    <TableHead>Pattern</TableHead>\n                    <TableHead>Match Type</TableHead>\n                    <TableHead>Category</TableHead>\n                    <TableHead>Action</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead className=\"w-[80px]\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {userAgentRules.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={7} className=\"text-center text-muted-foreground\">\n                        No user agent rules configured\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    userAgentRules.map((rule) => (\n                      <TableRow key={rule.id} data-testid={`row-user-agent-${rule.id}`}>\n                        <TableCell className=\"font-medium\" data-testid={`text-user-agent-name-${rule.id}`}>{rule.name}</TableCell>\n                        <TableCell className=\"font-mono text-xs max-w-[200px] truncate\">{rule.pattern}</TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">{rule.matchType}</Badge>\n                        </TableCell>\n                        <TableCell>{rule.category || '-'}</TableCell>\n                        <TableCell>\n                          <Badge variant={rule.action === 'block' ? 'destructive' : 'secondary'}>\n                            {rule.action}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <Switch\n                            checked={rule.enabled}\n                            onCheckedChange={(enabled) => toggleUserAgentMutation.mutate({ id: rule.id, enabled })}\n                            data-testid={`switch-user-agent-${rule.id}`}\n                          />\n                        </TableCell>\n                        <TableCell>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => deleteUserAgentMutation.mutate(rule.id)}\n                            data-testid={`button-delete-user-agent-${rule.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Activity className=\"w-5 h-5\" /> Recent Blocked Requests\n          </CardTitle>\n          <CardDescription>View the latest blocked requests and their details</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Time</TableHead>\n                <TableHead>IP Address</TableHead>\n                <TableHead>Path</TableHead>\n                <TableHead>Method</TableHead>\n                <TableHead>Reason</TableHead>\n                <TableHead>Country</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {blockedRequests.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={6} className=\"text-center text-muted-foreground\">\n                    No blocked requests\n                  </TableCell>\n                </TableRow>\n              ) : (\n                blockedRequests.slice(0, 10).map((request) => (\n                  <TableRow key={request.id} data-testid={`row-blocked-request-${request.id}`}>\n                    <TableCell className=\"text-xs\" data-testid={`text-blocked-time-${request.id}`}>\n                      {request.createdAt ? new Date(request.createdAt).toLocaleString() : '-'}\n                    </TableCell>\n                    <TableCell className=\"font-mono text-xs\" data-testid={`text-blocked-ip-${request.id}`}>{request.ipAddress}</TableCell>\n                    <TableCell className=\"font-mono text-xs max-w-[200px] truncate\">{request.path}</TableCell>\n                    <TableCell>\n                      <Badge variant=\"outline\">{request.method}</Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Badge variant=\"destructive\" data-testid={`badge-blocked-reason-${request.id}`}>{request.reason}</Badge>\n                    </TableCell>\n                    <TableCell>{request.countryCode || '-'}</TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      <Dialog open={showFirewallRuleDialog} onOpenChange={setShowFirewallRuleDialog}>\n        <DialogContent data-testid=\"dialog-firewall-rule\">\n          <DialogHeader>\n            <DialogTitle>Add Custom Firewall Rule</DialogTitle>\n            <DialogDescription>Create a new firewall rule with custom conditions</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium\">Rule Name</label>\n              <Input\n                value={newFirewallRule.name}\n                onChange={(e) => setNewFirewallRule(prev => ({ ...prev, name: e.target.value }))}\n                placeholder=\"e.g., Block suspicious paths\"\n                data-testid=\"input-rule-name\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Description</label>\n              <Input\n                value={newFirewallRule.description}\n                onChange={(e) => setNewFirewallRule(prev => ({ ...prev, description: e.target.value }))}\n                placeholder=\"Optional description\"\n                data-testid=\"input-rule-description\"\n              />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Rule Type</label>\n                <Select value={newFirewallRule.ruleType} onValueChange={(v) => setNewFirewallRule(prev => ({ ...prev, ruleType: v }))}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"ip\">IP Address</SelectItem>\n                    <SelectItem value=\"path\">URL Path</SelectItem>\n                    <SelectItem value=\"header\">HTTP Header</SelectItem>\n                    <SelectItem value=\"query\">Query String</SelectItem>\n                    <SelectItem value=\"method\">HTTP Method</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Condition</label>\n                <Select value={newFirewallRule.condition} onValueChange={(v) => setNewFirewallRule(prev => ({ ...prev, condition: v }))}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"equals\">Equals</SelectItem>\n                    <SelectItem value=\"contains\">Contains</SelectItem>\n                    <SelectItem value=\"startsWith\">Starts With</SelectItem>\n                    <SelectItem value=\"endsWith\">Ends With</SelectItem>\n                    <SelectItem value=\"regex\">Regex Match</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Value</label>\n              <Input\n                value={newFirewallRule.value}\n                onChange={(e) => setNewFirewallRule(prev => ({ ...prev, value: e.target.value }))}\n                placeholder=\"Value to match\"\n                data-testid=\"input-rule-value\"\n              />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Action</label>\n                <Select value={newFirewallRule.action} onValueChange={(v) => setNewFirewallRule(prev => ({ ...prev, action: v }))}>\n                  <SelectTrigger data-testid=\"select-rule-action\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"block\">Block</SelectItem>\n                    <SelectItem value=\"allow\">Allow</SelectItem>\n                    <SelectItem value=\"challenge\">Challenge</SelectItem>\n                    <SelectItem value=\"log\">Log Only</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Priority</label>\n                <Input\n                  type=\"number\"\n                  value={newFirewallRule.priority}\n                  onChange={(e) => setNewFirewallRule(prev => ({ ...prev, priority: parseInt(e.target.value) || 100 }))}\n                  data-testid=\"input-rule-priority\"\n                />\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowFirewallRuleDialog(false)} data-testid=\"button-cancel-rule\">Cancel</Button>\n            <Button\n              onClick={() => createFirewallRuleMutation.mutate(newFirewallRule)}\n              disabled={!newFirewallRule.name || !newFirewallRule.value || createFirewallRuleMutation.isPending}\n              data-testid=\"button-create-rule\"\n            >\n              {createFirewallRuleMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Create Rule\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showGeoBlockDialog} onOpenChange={setShowGeoBlockDialog}>\n        <DialogContent data-testid=\"dialog-geo-block\">\n          <DialogHeader>\n            <DialogTitle>Add Country Block</DialogTitle>\n            <DialogDescription>Block or challenge traffic from a specific country</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium\">Country</label>\n              <Select value={selectedCountry} onValueChange={setSelectedCountry}>\n                <SelectTrigger data-testid=\"select-geo-country\">\n                  <SelectValue placeholder=\"Select country\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {COUNTRY_LIST.filter(c => !geoBlockingRules.some(r => r.countryCode === c.code)).map((country) => (\n                    <SelectItem key={country.code} value={country.code}>\n                      {getCountryFlag(country.code)} {country.name} ({country.code})\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Action</label>\n              <Select value={geoAction} onValueChange={(v) => setGeoAction(v as 'block' | 'challenge')}>\n                <SelectTrigger data-testid=\"select-geo-action\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"block\">Block completely</SelectItem>\n                  <SelectItem value=\"challenge\">Show CAPTCHA challenge</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowGeoBlockDialog(false)} data-testid=\"button-cancel-geo\">Cancel</Button>\n            <Button\n              onClick={() => {\n                const country = COUNTRY_LIST.find(c => c.code === selectedCountry);\n                if (country) {\n                  createGeoBlockMutation.mutate({\n                    countryCode: country.code,\n                    countryName: country.name,\n                    action: geoAction\n                  });\n                }\n              }}\n              disabled={!selectedCountry || createGeoBlockMutation.isPending}\n              data-testid=\"button-add-geo-block\"\n            >\n              {createGeoBlockMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Add Block\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showRateLimitDialog} onOpenChange={setShowRateLimitDialog}>\n        <DialogContent data-testid=\"dialog-rate-limit\">\n          <DialogHeader>\n            <DialogTitle>Add Rate Limit Rule</DialogTitle>\n            <DialogDescription>Configure rate limiting for specific endpoints</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium\">Rule Name</label>\n              <Input\n                value={newRateLimit.name}\n                onChange={(e) => setNewRateLimit(prev => ({ ...prev, name: e.target.value }))}\n                placeholder=\"e.g., Login API limit\"\n                data-testid=\"input-rate-limit-name\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Path Pattern</label>\n              <Input\n                value={newRateLimit.path}\n                onChange={(e) => setNewRateLimit(prev => ({ ...prev, path: e.target.value }))}\n                placeholder=\"/api/auth/*\"\n                data-testid=\"input-rate-limit-path\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">HTTP Method</label>\n              <Select value={newRateLimit.method} onValueChange={(v) => setNewRateLimit(prev => ({ ...prev, method: v }))}>\n                <SelectTrigger data-testid=\"select-rate-limit-method\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"*\">All Methods</SelectItem>\n                  <SelectItem value=\"GET\">GET</SelectItem>\n                  <SelectItem value=\"POST\">POST</SelectItem>\n                  <SelectItem value=\"PUT\">PUT</SelectItem>\n                  <SelectItem value=\"DELETE\">DELETE</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Max Requests</label>\n                <Input\n                  type=\"number\"\n                  value={newRateLimit.maxRequests}\n                  onChange={(e) => setNewRateLimit(prev => ({ ...prev, maxRequests: parseInt(e.target.value) || 100 }))}\n                  data-testid=\"input-rate-limit-max\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Window (seconds)</label>\n                <Input\n                  type=\"number\"\n                  value={newRateLimit.windowSeconds}\n                  onChange={(e) => setNewRateLimit(prev => ({ ...prev, windowSeconds: parseInt(e.target.value) || 60 }))}\n                  data-testid=\"input-rate-limit-window\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Block Duration (s)</label>\n                <Input\n                  type=\"number\"\n                  value={newRateLimit.blockDuration}\n                  onChange={(e) => setNewRateLimit(prev => ({ ...prev, blockDuration: parseInt(e.target.value) || 300 }))}\n                  data-testid=\"input-rate-limit-block-duration\"\n                />\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowRateLimitDialog(false)} data-testid=\"button-cancel-rate-limit\">Cancel</Button>\n            <Button\n              onClick={() => createRateLimitMutation.mutate(newRateLimit)}\n              disabled={!newRateLimit.name || !newRateLimit.path || createRateLimitMutation.isPending}\n              data-testid=\"button-create-rate-limit\"\n            >\n              {createRateLimitMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Create Rule\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showUserAgentDialog} onOpenChange={setShowUserAgentDialog}>\n        <DialogContent data-testid=\"dialog-user-agent\">\n          <DialogHeader>\n            <DialogTitle>Add User Agent Rule</DialogTitle>\n            <DialogDescription>Block requests based on User-Agent header patterns</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium\">Rule Name</label>\n              <Input\n                value={newUserAgent.name}\n                onChange={(e) => setNewUserAgent(prev => ({ ...prev, name: e.target.value }))}\n                placeholder=\"e.g., Block scrapers\"\n                data-testid=\"input-user-agent-name\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Pattern</label>\n              <Input\n                value={newUserAgent.pattern}\n                onChange={(e) => setNewUserAgent(prev => ({ ...prev, pattern: e.target.value }))}\n                placeholder=\"e.g., bot|crawler|spider\"\n                data-testid=\"input-user-agent-pattern\"\n              />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Match Type</label>\n                <Select value={newUserAgent.matchType} onValueChange={(v) => setNewUserAgent(prev => ({ ...prev, matchType: v }))}>\n                  <SelectTrigger data-testid=\"select-user-agent-match-type\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"contains\">Contains</SelectItem>\n                    <SelectItem value=\"exact\">Exact Match</SelectItem>\n                    <SelectItem value=\"regex\">Regex</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Action</label>\n                <Select value={newUserAgent.action} onValueChange={(v) => setNewUserAgent(prev => ({ ...prev, action: v }))}>\n                  <SelectTrigger data-testid=\"select-user-agent-action\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"block\">Block</SelectItem>\n                    <SelectItem value=\"challenge\">Challenge</SelectItem>\n                    <SelectItem value=\"log\">Log Only</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Category (optional)</label>\n              <Input\n                value={newUserAgent.category}\n                onChange={(e) => setNewUserAgent(prev => ({ ...prev, category: e.target.value }))}\n                placeholder=\"e.g., bot, tool, automation\"\n                data-testid=\"input-user-agent-category\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowUserAgentDialog(false)} data-testid=\"button-cancel-user-agent\">Cancel</Button>\n            <Button\n              onClick={() => createUserAgentMutation.mutate(newUserAgent)}\n              disabled={!newUserAgent.name || !newUserAgent.pattern || createUserAgentMutation.isPending}\n              data-testid=\"button-create-user-agent\"\n            >\n              {createUserAgentMutation.isPending && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n              Create Rule\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\nfunction getCountryFlag(countryCode: string): string {\n  const codePoints = countryCode\n    .toUpperCase()\n    .split('')\n    .map(char => 127397 + char.charCodeAt(0));\n  return String.fromCodePoint(...codePoints);\n}\n","path":null,"size_bytes":52197,"size_tokens":null},"client/src/pages/admin/content/adminposts/hooks.ts":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Post, InsertPost, Category } from \"./types\";\n\nexport function usePosts() {\n  return useQuery({\n    queryKey: [\"admin-posts\"],\n    queryFn: () => api.getPosts(),\n  });\n}\n\nexport function usePostCategories() {\n  return useQuery({\n    queryKey: [\"/api/categories\", \"post\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=post\", { credentials: \"include\" })\n        .then(res => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n}\n\nexport function useCreatePost() {\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (data: InsertPost) => api.createPost(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n      toast({ title: \"Success\", description: \"Post created successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useUpdatePost() {\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<Post> }) =>\n      api.updatePost(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n      toast({ title: \"Success\", description: \"Post updated successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useDeletePost() {\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (id: number) => api.deletePost(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"admin-posts\"] });\n      toast({ title: \"Success\", description: \"Post deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport async function uploadImage(file: File): Promise<string> {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n  const res = await fetch(\"/api/upload/file\", {\n    method: \"POST\",\n    body: formData,\n    credentials: \"include\",\n  });\n  if (!res.ok) throw new Error(\"Upload failed\");\n  const data = await res.json();\n  return data.url;\n}\n","path":null,"size_bytes":2506,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/components/TestimonialCard.tsx":{"content":"import { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Star, Edit, Trash } from \"lucide-react\";\nimport type { Testimonial } from \"../types\";\n\ninterface TestimonialCardProps {\n  testimonial: Testimonial;\n  onEdit: (testimonial: Testimonial) => void;\n  onDelete: (id: number) => void;\n  isDeleting: boolean;\n}\n\nexport function TestimonialCard({\n  testimonial,\n  onEdit,\n  onDelete,\n  isDeleting,\n}: TestimonialCardProps) {\n  return (\n    <Card className=\"relative\">\n      <CardHeader>\n        <div className=\"flex items-start gap-4\">\n          <Avatar className=\"w-12 h-12\">\n            <AvatarImage src={testimonial.avatar || undefined} />\n            <AvatarFallback>{testimonial.name.charAt(0)}</AvatarFallback>\n          </Avatar>\n          <div className=\"flex-1\">\n            <h3 className=\"font-semibold\">{testimonial.name}</h3>\n            <p className=\"text-sm text-muted-foreground\">\n              {testimonial.role} {testimonial.company && `at ${testimonial.company}`}\n            </p>\n            <div className=\"flex gap-1 mt-2\">\n              {[...Array(testimonial.rating || 5)].map((_, i) => (\n                <Star\n                  key={i}\n                  className=\"w-4 h-4 fill-yellow-500 text-yellow-500\"\n                  data-testid={`star-${i}`}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <p className=\"text-sm text-muted-foreground italic\">\"{testimonial.content}\"</p>\n        <div className=\"flex items-center justify-between mt-4 gap-2\">\n          <Badge variant={testimonial.active ? \"default\" : \"secondary\"}>\n            {testimonial.active ? \"Active\" : \"Inactive\"}\n          </Badge>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => onEdit(testimonial)}\n              data-testid={`button-edit-testimonial-${testimonial.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"text-destructive\"\n              onClick={() => onDelete(testimonial.id)}\n              disabled={isDeleting}\n              data-testid={`button-delete-testimonial-${testimonial.id}`}\n            >\n              <Trash className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2656,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/components/ReviewCard.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trash2, Mail, MailOpen, Star } from \"lucide-react\";\nimport type { Review } from \"../types\";\n\ninterface ReviewCardProps {\n  review: Review;\n  projects: any[];\n  onDelete: (id: number) => void;\n  onMarkAsRead: (id: number) => void;\n}\n\nexport function ReviewCard({ review, projects, onDelete, onMarkAsRead }: ReviewCardProps) {\n  const project = projects.find((p) => p.id === review.projectId);\n\n  return (\n    <Card\n      className={`${!review.read ? \"bg-muted/20\" : \"\"}`}\n      data-testid={`card-review-${review.id}`}\n    >\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <span className=\"font-medium\">{review.authorName}</span>\n              <span className=\"text-sm text-muted-foreground\">{review.authorEmail}</span>\n              <div className=\"flex items-center\">\n                {[...Array(5)].map((_, i) => (\n                  <Star\n                    key={i}\n                    className={`w-4 h-4 ${i < review.rating ? \"fill-yellow-400 text-yellow-400\" : \"text-muted-foreground\"}`}\n                  />\n                ))}\n              </div>\n              {!review.read && (\n                <Badge variant=\"outline\" className=\"text-blue-500 border-blue-500\">\n                  New\n                </Badge>\n              )}\n            </div>\n            <p className=\"text-sm mb-2\">{review.content}</p>\n            <div className=\"text-xs text-muted-foreground\">\n              <span>For: {project?.title || `Project #${review.projectId}`}</span>\n              <span className=\"mx-2\">â€¢</span>\n              <span>{review.createdAt ? new Date(review.createdAt).toLocaleDateString() : \"N/A\"}</span>\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onMarkAsRead(review.id)}\n              title={review.read ? \"Mark as unread\" : \"Mark as read\"}\n              data-testid={`button-mark-read-${review.id}`}\n            >\n              {review.read ? <MailOpen className=\"w-4 h-4\" /> : <Mail className=\"w-4 h-4\" />}\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onDelete(review.id)}\n              className=\"text-destructive hover:text-destructive\"\n              title=\"Delete\"\n              data-testid={`button-delete-${review.id}`}\n            >\n              <Trash2 className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2869,"size_tokens":null},"client/src/pages/admin/content/adminposts/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Pagination } from \"@/components/admin/pagination\";\nimport { Plus } from \"lucide-react\";\nimport { usePosts, usePostCategories, useCreatePost, useUpdatePost, useDeletePost } from \"./hooks\";\nimport { PostCard, PostForm, DeletePostDialog } from \"./components\";\nimport type { Post, PostFormData } from \"./types\";\nimport { generateSlug } from \"./types\";\n\nexport default function AdminPostsPage() {\n  const [currentPage, setCurrentPage] = useState(1);\n  const [activeTab, setActiveTab] = useState(\"published\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [editingPost, setEditingPost] = useState<Post | null>(null);\n  const [postToDelete, setPostToDelete] = useState<number | null>(null);\n\n  const postsPerPage = 5;\n\n  const { data: posts = [], isLoading } = usePosts();\n  const { data: categories = [] } = usePostCategories();\n\n  const createMutation = useCreatePost();\n  const updateMutation = useUpdatePost();\n  const deleteMutation = useDeletePost();\n\n  const filteredPosts = posts.filter((p) => {\n    if (activeTab === \"published\") return p.status === \"Published\";\n    if (activeTab === \"draft\") return p.status === \"Draft\";\n    if (activeTab === \"archived\") return p.status === \"Archived\";\n    return true;\n  });\n\n  const totalPages = Math.ceil(filteredPosts.length / postsPerPage);\n  const paginatedPosts = filteredPosts.slice(\n    (currentPage - 1) * postsPerPage,\n    currentPage * postsPerPage\n  );\n\n  const handleOpenDialog = (postId?: number) => {\n    if (postId) {\n      const post = posts.find((p) => p.id === postId);\n      if (post) {\n        setEditingPost(post);\n      }\n    } else {\n      setEditingPost(null);\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingPost(null);\n  };\n\n  const getPublishedAtForSubmit = (formData: PostFormData): string | null => {\n    if (formData.status !== \"Published\") {\n      return null;\n    }\n\n    if (formData.publishedAt instanceof Date && !isNaN(formData.publishedAt.getTime())) {\n      return formData.publishedAt.toISOString();\n    }\n\n    if (formData.publishedAt && typeof formData.publishedAt === \"string\") {\n      const date = new Date(formData.publishedAt);\n      if (!isNaN(date.getTime())) {\n        return date.toISOString();\n      }\n    }\n\n    return new Date().toISOString();\n  };\n\n  const handleSubmit = async (\n    formData: PostFormData,\n    tagsInput: string,\n    isEditing: boolean\n  ) => {\n    const tags = tagsInput\n      .split(\",\")\n      .map((t) => t.trim())\n      .filter(Boolean);\n\n    const publishedAt = getPublishedAtForSubmit(formData);\n\n    const postData = {\n      title: formData.title.trim(),\n      slug: formData.slug.trim() || generateSlug(formData.title),\n      content: formData.content.trim(),\n      excerpt: formData.excerpt.trim() || null,\n      category: formData.category,\n      author: formData.author.trim(),\n      status: formData.status,\n      tags,\n      featuredImage: formData.featuredImage,\n      publishedAt,\n    };\n\n    if (isEditing && editingPost) {\n      await updateMutation.mutateAsync({ id: editingPost.id, data: postData as any });\n    } else {\n      await createMutation.mutateAsync(postData as any);\n    }\n  };\n\n  const handleDeleteClick = (id: number) => {\n    setPostToDelete(id);\n    setIsDeleteDialogOpen(true);\n  };\n\n  const handleConfirmDelete = async () => {\n    if (postToDelete) {\n      await deleteMutation.mutateAsync(postToDelete);\n      setPostToDelete(null);\n    }\n    setIsDeleteDialogOpen(false);\n  };\n\n  const isSaving = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Blog Posts</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your blog content ({posts.length} posts)\n            </p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-new-post\"\n          >\n            <Plus className=\"w-4 h-4\" /> New Post\n          </Button>\n        </div>\n\n        <Tabs\n          value={activeTab}\n          onValueChange={(v) => {\n            setActiveTab(v);\n            setCurrentPage(1);\n          }}\n        >\n          <TabsList>\n            <TabsTrigger value=\"published\" data-testid=\"tab-published\">\n              Published ({posts.filter((p) => p.status === \"Published\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"draft\" data-testid=\"tab-draft\">\n              Drafts ({posts.filter((p) => p.status === \"Draft\").length})\n            </TabsTrigger>\n            <TabsTrigger value=\"archived\" data-testid=\"tab-archived\">\n              Archived ({posts.filter((p) => p.status === \"Archived\").length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value={activeTab} className=\"space-y-4 mt-4\">\n            {isLoading ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  Loading posts...\n                </CardContent>\n              </Card>\n            ) : paginatedPosts.length === 0 ? (\n              <Card>\n                <CardContent className=\"p-8 text-center text-muted-foreground\">\n                  No posts found. Click \"New Post\" to create one.\n                </CardContent>\n              </Card>\n            ) : (\n              <>\n                {paginatedPosts.map((post) => (\n                  <PostCard\n                    key={post.id}\n                    post={post}\n                    onEdit={handleOpenDialog}\n                    onDelete={handleDeleteClick}\n                  />\n                ))}\n                {totalPages > 1 && (\n                  <Pagination\n                    currentPage={currentPage}\n                    totalPages={totalPages}\n                    onPageChange={setCurrentPage}\n                  />\n                )}\n              </>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <PostForm\n        open={isDialogOpen}\n        onOpenChange={(open) => {\n          if (!open) handleCloseDialog();\n          else setIsDialogOpen(open);\n        }}\n        editingPost={editingPost}\n        categories={categories}\n        onSubmit={handleSubmit}\n        isPending={isSaving}\n      />\n\n      <DeletePostDialog\n        open={isDeleteDialogOpen}\n        onOpenChange={(open) => setIsDeleteDialogOpen(open)}\n        onConfirm={handleConfirmDelete}\n      />\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":7007,"size_tokens":null},"client/src/pages/admin/content/adminposts/components/PostForm.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Save, X, Loader2 } from \"lucide-react\";\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\nimport type { Post, PostFormData, Category } from \"../types\";\nimport { getEmptyPostForm, mapPostToFormData, generateSlug } from \"../types\";\nimport { uploadImage } from \"../hooks\";\n\ninterface PostFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingPost: Post | null;\n  categories: Category[];\n  onSubmit: (data: PostFormData, tagsInput: string, isEditing: boolean) => Promise<void>;\n  isPending: boolean;\n}\n\nexport function PostForm({\n  open,\n  onOpenChange,\n  editingPost,\n  categories,\n  onSubmit,\n  isPending,\n}: PostFormProps) {\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const [uploading, setUploading] = useState(false);\n  const [formData, setFormData] = useState<PostFormData>(getEmptyPostForm());\n  const [tagsInput, setTagsInput] = useState(\"\");\n  const [formError, setFormError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (open) {\n      if (editingPost) {\n        const mapped = mapPostToFormData(editingPost);\n        setFormData(mapped.formData);\n        setTagsInput(mapped.tagsInput);\n      } else {\n        setFormData(getEmptyPostForm());\n        setTagsInput(\"\");\n      }\n      setFormError(null);\n    }\n  }, [open, editingPost]);\n\n  const handleImageUpload = async (file: File) => {\n    setUploading(true);\n    try {\n      const url = await uploadImage(file);\n      setFormData((prev) => ({ ...prev, featuredImage: url }));\n    } catch (error: any) {\n      console.error(\"Upload failed:\", error);\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleTitleChange = (title: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      title,\n      slug: editingPost ? prev.slug : generateSlug(title),\n    }));\n  };\n\n  const validateForm = (): string | null => {\n    if (!formData.title.trim()) return \"Title is required\";\n    if (!formData.content.trim()) return \"Content is required\";\n    if (!formData.category.trim()) return \"Category is required\";\n    if (!formData.author.trim()) return \"Author is required\";\n    return null;\n  };\n\n  const handleSubmit = async () => {\n    const error = validateForm();\n    if (error) {\n      setFormError(error);\n      return;\n    }\n    setFormError(null);\n\n    try {\n      await onSubmit(formData, tagsInput, !!editingPost);\n      onOpenChange(false);\n    } catch (error: any) {\n      console.error(\"Error saving post:\", error);\n      setFormError(error.message || \"Failed to save post\");\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{editingPost ? \"Edit Post\" : \"Create New Post\"}</DialogTitle>\n          <DialogDescription>\n            {editingPost\n              ? \"Update the post details below.\"\n              : \"Fill in the details to create a new blog post.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"title\">Title *</Label>\n            <Input\n              id=\"title\"\n              placeholder=\"Enter post title\"\n              value={formData.title}\n              onChange={(e) => handleTitleChange(e.target.value)}\n              data-testid=\"input-post-title\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"slug\">Slug</Label>\n            <Input\n              id=\"slug\"\n              placeholder=\"post-url-slug\"\n              value={formData.slug}\n              onChange={(e) => setFormData((prev) => ({ ...prev, slug: e.target.value }))}\n              data-testid=\"input-post-slug\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"category\">Category</Label>\n              <Select\n                value={formData.category}\n                onValueChange={(v) => setFormData((prev) => ({ ...prev, category: v }))}\n              >\n                <SelectTrigger data-testid=\"select-post-category\">\n                  <SelectValue placeholder=\"Select category\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {categories.length > 0 ? (\n                    categories.map((cat: Category) => (\n                      <SelectItem key={cat.id} value={cat.slug} data-testid={`option-${cat.slug}`}>\n                        {cat.name}\n                      </SelectItem>\n                    ))\n                  ) : (\n                    <SelectItem value=\"default\" disabled>\n                      No categories available\n                    </SelectItem>\n                  )}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"status\">Status</Label>\n              <Select\n                value={formData.status}\n                onValueChange={(v: \"Published\" | \"Draft\" | \"Archived\") =>\n                  setFormData((prev) => ({ ...prev, status: v }))\n                }\n              >\n                <SelectTrigger data-testid=\"select-post-status\">\n                  <SelectValue placeholder=\"Select status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Draft\">Draft</SelectItem>\n                  <SelectItem value=\"Published\">Published</SelectItem>\n                  <SelectItem value=\"Archived\">Archived</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"content\">Content *</Label>\n            <RichTextEditor\n              value={formData.content}\n              onChange={(content) => setFormData((prev) => ({ ...prev, content }))}\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"excerpt\">Excerpt</Label>\n            <Textarea\n              id=\"excerpt\"\n              placeholder=\"Brief summary of the post\"\n              value={formData.excerpt}\n              onChange={(e) => setFormData((prev) => ({ ...prev, excerpt: e.target.value }))}\n              rows={2}\n              data-testid=\"input-post-excerpt\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"image\">Featured Image</Label>\n            <div className=\"space-y-2\">\n              <div className=\"flex gap-2\">\n                <Input\n                  id=\"image\"\n                  placeholder=\"Image URL (e.g., /uploads/images/... or https://...)\"\n                  value={formData.featuredImage || \"\"}\n                  onChange={(e) =>\n                    setFormData((prev) => ({ ...prev, featuredImage: e.target.value || null }))\n                  }\n                  data-testid=\"input-post-image\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => imageInputRef.current?.click()}\n                  disabled={uploading}\n                  data-testid=\"button-upload-image\"\n                >\n                  {uploading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Upload\"}\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setFormData((prev) => ({ ...prev, featuredImage: null }))}\n                  data-testid=\"button-clear-image\"\n                >\n                  Clear\n                </Button>\n              </div>\n              <input\n                ref={imageInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                className=\"hidden\"\n                onChange={(e) => {\n                  const file = e.target.files?.[0];\n                  if (file) {\n                    handleImageUpload(file);\n                  }\n                }}\n                data-testid=\"input-file-upload\"\n              />\n              <p className=\"text-xs text-muted-foreground\">\n                Upload from device (JPG, PNG, GIF, WebP) - saved to /uploads/images/\n              </p>\n            </div>\n            {formData.featuredImage && (\n              <div className=\"mt-2 border border-border rounded-md overflow-hidden\">\n                <img\n                  src={formData.featuredImage}\n                  alt=\"Featured preview\"\n                  className=\"w-full h-40 object-cover\"\n                  onError={(e) => {\n                    (e.target as HTMLImageElement).src = \"/images/blog/bg-1.png\";\n                  }}\n                />\n              </div>\n            )}\n            <p className=\"text-xs text-muted-foreground\">\n              Supports: Upload from device or paste image URL. Defaults: /images/blog/bg-1.png,\n              bg-2.png, bg-3.png\n            </p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"tags\">Tags (comma-separated)</Label>\n            <Input\n              id=\"tags\"\n              placeholder=\"react, javascript, web development\"\n              value={tagsInput}\n              onChange={(e) => setTagsInput(e.target.value)}\n              data-testid=\"input-post-tags\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"author\">Author</Label>\n            <Input\n              id=\"author\"\n              placeholder=\"Author name\"\n              value={formData.author}\n              onChange={(e) => setFormData((prev) => ({ ...prev, author: e.target.value }))}\n              data-testid=\"input-post-author\"\n            />\n          </div>\n        </div>\n\n        <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n          {formError && (\n            <p\n              className=\"text-destructive text-sm w-full sm:w-auto sm:flex-1\"\n              data-testid=\"text-form-error\"\n            >\n              {formError}\n            </p>\n          )}\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              data-testid=\"button-cancel\"\n            >\n              <X className=\"w-4 h-4 mr-2\" /> Cancel\n            </Button>\n            <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-save-post\">\n              {isPending ? (\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n              ) : (\n                <Save className=\"w-4 h-4 mr-2\" />\n              )}\n              {editingPost ? \"Update Post\" : \"Create Post\"}\n            </Button>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":11281,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/components/FAQForm.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { Loader2 } from \"lucide-react\";\nimport type { FAQ, FAQFormData } from \"../types\";\nimport { getEmptyFAQForm, mapFAQToFormData } from \"../types\";\n\ninterface FAQFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingFAQ: FAQ | null;\n  onSubmit: (data: FAQFormData, isEditing: boolean) => void;\n  isPending: boolean;\n  defaultOrder: number;\n}\n\nexport function FAQForm({\n  open,\n  onOpenChange,\n  editingFAQ,\n  onSubmit,\n  isPending,\n  defaultOrder,\n}: FAQFormProps) {\n  const [formData, setFormData] = useState<FAQFormData>(getEmptyFAQForm(defaultOrder));\n\n  useEffect(() => {\n    if (open) {\n      if (editingFAQ) {\n        setFormData(mapFAQToFormData(editingFAQ));\n      } else {\n        setFormData(getEmptyFAQForm(defaultOrder));\n      }\n    }\n  }, [open, editingFAQ, defaultOrder]);\n\n  const handleSubmit = () => {\n    if (!formData.question.trim() || !formData.answer.trim()) {\n      return;\n    }\n    onSubmit(formData, !!editingFAQ);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-lg\">\n        <DialogHeader>\n          <DialogTitle>{editingFAQ ? \"Edit FAQ\" : \"Create New FAQ\"}</DialogTitle>\n          <DialogDescription>\n            {editingFAQ ? \"Update the FAQ entry\" : \"Add a new frequently asked question\"}\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"question\">Question *</Label>\n            <Input\n              id=\"question\"\n              value={formData.question}\n              onChange={(e) => setFormData({ ...formData, question: e.target.value })}\n              placeholder=\"Enter the question\"\n              data-testid=\"input-question\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"answer\">Answer *</Label>\n            <Textarea\n              id=\"answer\"\n              value={formData.answer}\n              onChange={(e) => setFormData({ ...formData, answer: e.target.value })}\n              placeholder=\"Enter the answer\"\n              rows={4}\n              data-testid=\"input-answer\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"order\">Order</Label>\n              <Input\n                id=\"order\"\n                type=\"number\"\n                min=\"0\"\n                value={formData.order}\n                onChange={(e) =>\n                  setFormData({ ...formData, order: parseInt(e.target.value) || 0 })\n                }\n                data-testid=\"input-order\"\n              />\n            </div>\n\n            <div className=\"flex items-center gap-2 pt-6\">\n              <Switch\n                checked={formData.visible}\n                onCheckedChange={(checked) => setFormData({ ...formData, visible: checked })}\n                data-testid=\"switch-visible\"\n              />\n              <Label>Visible on website</Label>\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            Cancel\n          </Button>\n          <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-save-faq\">\n            {isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Saving...\n              </>\n            ) : editingFAQ ? (\n              \"Update FAQ\"\n            ) : (\n              \"Create FAQ\"\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":4078,"size_tokens":null},"client/src/pages/admin/content/adminskills/components/SkillCard.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Edit, Trash, Code, Database, Server, Wrench } from \"lucide-react\";\nimport type { Skill } from \"../types\";\nimport { getLevelLabel, getLevelColor } from \"../types\";\n\ninterface SkillCardProps {\n  skill: Skill;\n  onEdit: (skill: Skill) => void;\n  onDelete: (id: number, name: string) => void;\n}\n\nconst getCategoryIcon = (category: string) => {\n  switch (category.toLowerCase()) {\n    case \"frontend\":\n      return <Code className=\"w-6 h-6 text-blue-500\" />;\n    case \"backend\":\n      return <Server className=\"w-6 h-6 text-green-500\" />;\n    case \"database\":\n      return <Database className=\"w-6 h-6 text-yellow-500\" />;\n    case \"devops\":\n    case \"tools\":\n    default:\n      return <Wrench className=\"w-6 h-6 text-purple-500\" />;\n  }\n};\n\nexport function SkillCard({ skill, onEdit, onDelete }: SkillCardProps) {\n  return (\n    <Card\n      className=\"group hover:border-primary/50 transition-colors\"\n      data-testid={`card-skill-${skill.id}`}\n    >\n      <CardContent className=\"p-4 flex items-center justify-between gap-4\">\n        <div className=\"flex items-center gap-4 min-w-0\">\n          <div className=\"w-12 h-12 rounded-lg bg-muted flex items-center justify-center flex-shrink-0\">\n            {getCategoryIcon(skill.category)}\n          </div>\n          <div className=\"min-w-0\">\n            <h3 className=\"font-bold truncate\">{skill.name}</h3>\n            <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n              <Badge\n                variant=\"secondary\"\n                className={`text-[10px] ${getLevelColor(skill.level)}`}\n              >\n                {getLevelLabel(skill.level)}\n              </Badge>\n              <span className=\"text-xs text-muted-foreground\">{skill.level}%</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex gap-1 invisible group-hover:visible transition-all flex-shrink-0\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => onEdit(skill)}\n            data-testid={`button-edit-skill-${skill.id}`}\n          >\n            <Edit className=\"w-4 h-4\" />\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"text-destructive\"\n            onClick={() => onDelete(skill.id, skill.name)}\n            data-testid={`button-delete-skill-${skill.id}`}\n          >\n            <Trash className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2630,"size_tokens":null},"client/src/pages/admin/content/adminskills/types.ts":{"content":"export interface Skill {\n  id: number;\n  name: string;\n  category: string;\n  level: number;\n  icon: string | null;\n  order: number;\n  createdAt: Date | null;\n}\n\nexport interface SkillFormData {\n  name: string;\n  category: string;\n  level: number;\n  icon: string;\n  order: number;\n}\n\nexport const skillCategories = [\"Frontend\", \"Backend\", \"Database\", \"DevOps\", \"Tools\", \"Other\"];\n\nexport const getEmptySkillForm = (): SkillFormData => ({\n  name: \"\",\n  category: \"Frontend\",\n  level: 50,\n  icon: \"\",\n  order: 0,\n});\n\nexport const mapSkillToFormData = (skill: Skill): SkillFormData => ({\n  name: skill.name,\n  category: skill.category,\n  level: skill.level,\n  icon: skill.icon || \"\",\n  order: skill.order,\n});\n\nexport const getLevelLabel = (level: number): string => {\n  if (level >= 90) return \"Expert\";\n  if (level >= 70) return \"Advanced\";\n  if (level >= 50) return \"Intermediate\";\n  if (level >= 30) return \"Beginner\";\n  return \"Learning\";\n};\n\nexport const getLevelColor = (level: number): string => {\n  if (level >= 90) return \"bg-green-500/10 text-green-500 border-green-500/20\";\n  if (level >= 70) return \"bg-blue-500/10 text-blue-500 border-blue-500/20\";\n  if (level >= 50) return \"bg-yellow-500/10 text-yellow-600 border-yellow-500/20\";\n  return \"bg-gray-500/10 text-gray-500 border-gray-500/20\";\n};\n","path":null,"size_bytes":1306,"size_tokens":null},"client/src/pages/admin/content/adminprojects/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Plus, Loader2 } from \"lucide-react\";\nimport {\n  useProjects,\n  useProjectCategories,\n  useCreateProject,\n  useUpdateProject,\n  useDeleteProject,\n  useToggleFeatured,\n} from \"./hooks\";\nimport { ProjectCard, ProjectForm } from \"./components\";\nimport type { Project, ProjectFormData } from \"./types\";\n\nexport default function AdminProjectsPage() {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingProject, setEditingProject] = useState<Project | null>(null);\n  const [filter, setFilter] = useState(\"all\");\n\n  const { data: projects = [], isLoading } = useProjects();\n  const { data: categories = [] } = useProjectCategories();\n\n  const handleFormClose = () => {\n    setIsDialogOpen(false);\n    setEditingProject(null);\n  };\n\n  const createMutation = useCreateProject(handleFormClose);\n  const updateMutation = useUpdateProject(handleFormClose);\n  const deleteMutation = useDeleteProject();\n  const toggleFeaturedMutation = useToggleFeatured();\n\n  const openCreateDialog = () => {\n    setEditingProject(null);\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (project: Project) => {\n    setEditingProject(project);\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = (data: ProjectFormData, isEditing: boolean) => {\n    if (isEditing && editingProject) {\n      updateMutation.mutate({ id: editingProject.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    deleteMutation.mutate(id);\n  };\n\n  const handleToggleFeatured = (id: number, featured: boolean) => {\n    toggleFeaturedMutation.mutate({ id, featured });\n  };\n\n  const filteredProjects = projects.filter((project: Project) => {\n    if (filter === \"all\") return true;\n    if (filter === \"featured\") return project.featured;\n    if (filter === \"published\") return project.status === \"Published\";\n    if (filter === \"draft\") return project.status === \"Draft\";\n    return project.category === filter;\n  });\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\" data-testid=\"page-title\">\n              Projects\n            </h1>\n            <p className=\"text-muted-foreground\">Manage your portfolio projects</p>\n          </div>\n          <Button onClick={openCreateDialog} data-testid=\"button-create-project\">\n            <Plus className=\"w-4 h-4 mr-2\" /> New Project\n          </Button>\n        </div>\n\n        <div className=\"flex flex-wrap gap-2\">\n          {[\"all\", \"featured\", \"published\", \"draft\", ...categories.map((c) => c.slug)].map((f) => (\n            <Button\n              key={f}\n              variant={filter === f ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setFilter(f)}\n              data-testid={`filter-${f}`}\n            >\n              {f === \"all\"\n                ? \"All\"\n                : f === \"featured\"\n                  ? \"Featured\"\n                  : f === \"published\"\n                    ? \"Published\"\n                    : f === \"draft\"\n                      ? \"Draft\"\n                      : categories.find((c) => c.slug === f)?.name || f}\n            </Button>\n          ))}\n        </div>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No projects found</p>\n              <Button onClick={openCreateDialog}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create your first project\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project: Project) => (\n              <ProjectCard\n                key={project.id}\n                project={project}\n                categories={categories}\n                onEdit={openEditDialog}\n                onDelete={handleDelete}\n                onToggleFeatured={handleToggleFeatured}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n\n      <ProjectForm\n        open={isDialogOpen}\n        onOpenChange={(open) => {\n          if (!open) handleFormClose();\n          else setIsDialogOpen(open);\n        }}\n        editingProject={editingProject}\n        categories={categories}\n        onSubmit={handleSubmit}\n        isPending={isPending}\n      />\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":5011,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/hooks.ts":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { TestimonialFormData } from \"./types\";\n\nexport function useTestimonials() {\n  return useQuery({\n    queryKey: [\"/api/testimonials\"],\n    queryFn: () => api.getTestimonials(),\n  });\n}\n\nexport function useCreateTestimonial(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (data: TestimonialFormData) => api.createTestimonial(data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial added successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      onSuccess?.();\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to add testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n\nexport function useUpdateTestimonial(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (data: { id: number; data: Partial<TestimonialFormData> }) =>\n      api.updateTestimonial(data.id, data.data),\n    onSuccess: () => {\n      toast({ description: \"Testimonial updated successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n      onSuccess?.();\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to update testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n\nexport function useDeleteTestimonial() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (id: number) => api.deleteTestimonial(id),\n    onSuccess: () => {\n      toast({ description: \"Testimonial deleted successfully\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/testimonials\"] });\n    },\n    onError: (error) => {\n      toast({\n        description: error instanceof Error ? error.message : \"Failed to delete testimonial\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n","path":null,"size_bytes":2107,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/components/FAQCard.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Edit, Trash2, Eye, EyeOff } from \"lucide-react\";\nimport type { FAQ } from \"../types\";\n\ninterface FAQCardProps {\n  faq: FAQ;\n  onEdit: (faq: FAQ) => void;\n  onDelete: (id: number) => void;\n  onToggleVisibility: (faq: FAQ) => void;\n}\n\nexport function FAQCard({ faq, onEdit, onDelete, onToggleVisibility }: FAQCardProps) {\n  return (\n    <Card data-testid={`card-faq-${faq.id}`}>\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <span className=\"font-medium\">{faq.question}</span>\n              <Badge variant={faq.visible ? \"default\" : \"secondary\"}>\n                {faq.visible ? \"Visible\" : \"Hidden\"}\n              </Badge>\n              <Badge variant=\"outline\">Order: {faq.order}</Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground line-clamp-2\">{faq.answer}</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onToggleVisibility(faq)}\n              title={faq.visible ? \"Hide\" : \"Show\"}\n              data-testid={`button-toggle-${faq.id}`}\n            >\n              {faq.visible ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onEdit(faq)}\n              data-testid={`button-edit-${faq.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onDelete(faq.id)}\n              className=\"text-destructive hover:text-destructive\"\n              data-testid={`button-delete-${faq.id}`}\n            >\n              <Trash2 className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2223,"size_tokens":null},"client/src/pages/admin/content/adminservices/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Plus, Loader2 } from \"lucide-react\";\nimport { useServices, useCreateService, useUpdateService, useDeleteService } from \"./hooks\";\nimport { ServiceCard, ServiceComparisonTable, ServiceForm, DeleteServiceDialog } from \"./components\";\nimport type { Service, ServiceFormData } from \"./types\";\n\nexport default function AdminServicesPage() {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingService, setEditingService] = useState<Service | null>(null);\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n\n  const { data: services = [], isLoading } = useServices();\n\n  const handleFormClose = () => {\n    setIsDialogOpen(false);\n    setEditingService(null);\n  };\n\n  const createMutation = useCreateService(handleFormClose);\n  const updateMutation = useUpdateService(handleFormClose);\n  const deleteMutation = useDeleteService(() => setDeleteId(null));\n\n  const handleOpenDialog = (service?: Service) => {\n    if (service) {\n      setEditingService(service);\n    } else {\n      setEditingService(null);\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleSubmit = (data: ServiceFormData, isEditing: boolean) => {\n    if (isEditing && editingService) {\n      updateMutation.mutate({ id: editingService.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    setDeleteId(id);\n  };\n\n  const handleConfirmDelete = () => {\n    if (deleteId) {\n      deleteMutation.mutate(deleteId);\n    }\n  };\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Services</h1>\n            <p className=\"text-muted-foreground\">Manage services and pricing</p>\n          </div>\n          <Button onClick={() => handleOpenDialog()} data-testid=\"button-create-service\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add Service\n          </Button>\n        </div>\n\n        {isLoading ? (\n          <Card>\n            <CardContent className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"w-6 h-6 animate-spin\" />\n            </CardContent>\n          </Card>\n        ) : services.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No services yet</p>\n              <Button onClick={() => handleOpenDialog()}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Create first service\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            <ServiceComparisonTable services={services} />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {services\n                .sort((a, b) => a.order - b.order)\n                .map((service) => (\n                  <ServiceCard\n                    key={service.id}\n                    service={service}\n                    onEdit={handleOpenDialog}\n                    onDelete={handleDelete}\n                  />\n                ))}\n            </div>\n          </>\n        )}\n      </div>\n\n      <ServiceForm\n        open={isDialogOpen}\n        onOpenChange={(open) => {\n          if (!open) handleFormClose();\n          else setIsDialogOpen(open);\n        }}\n        editingService={editingService}\n        onSubmit={handleSubmit}\n        isPending={isPending}\n      />\n\n      <DeleteServiceDialog\n        open={deleteId !== null}\n        onOpenChange={(open) => !open && setDeleteId(null)}\n        onConfirm={handleConfirmDelete}\n      />\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":3963,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/hooks.ts":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Comment, Review, FAQ, FAQFormData } from \"./types\";\n\nexport function useComments() {\n  return useQuery<Comment[]>({\n    queryKey: [\"/api/comments\"],\n  });\n}\n\nexport function useReviews() {\n  return useQuery<Review[]>({\n    queryKey: [\"/api/reviews\"],\n  });\n}\n\nexport function useFAQs() {\n  return useQuery<FAQ[]>({\n    queryKey: [\"/api/faqs\"],\n  });\n}\n\nexport function usePosts() {\n  return useQuery<any[]>({\n    queryKey: [\"/api/posts\"],\n  });\n}\n\nexport function useProjectsList() {\n  return useQuery<any[]>({\n    queryKey: [\"/api/projects\"],\n  });\n}\n\nexport function useDeleteComment() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/comments/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/comments\"] });\n      toast({ title: \"Comment deleted\" });\n    },\n  });\n}\n\nexport function useMarkCommentAsRead() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/comments/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/comments\"] });\n      toast({ title: \"Comment marked as read\" });\n    },\n  });\n}\n\nexport function useApproveComment() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/comments/${id}/approve`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/comments\"] });\n      toast({ title: \"Comment approved\" });\n    },\n  });\n}\n\nexport function useRejectComment() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/comments/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/comments\"] });\n      toast({ title: \"Comment rejected\" });\n    },\n  });\n}\n\nexport function useDeleteReview() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/reviews/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/reviews\"] });\n      toast({ title: \"Review deleted\" });\n    },\n  });\n}\n\nexport function useMarkReviewAsRead() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"PUT\", `/api/reviews/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/reviews\"] });\n      toast({ title: \"Review marked as read\" });\n    },\n  });\n}\n\nexport function useCreateFAQ(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (data: FAQFormData) => {\n      return apiRequest(\"POST\", \"/api/faqs\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/faqs\"] });\n      toast({ title: \"FAQ created successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error creating FAQ\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useUpdateFAQ(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: Partial<FAQ> }) => {\n      return apiRequest(\"PUT\", `/api/faqs/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/faqs\"] });\n      toast({ title: \"FAQ updated successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error updating FAQ\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useDeleteFAQ() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (id: number) => {\n      return apiRequest(\"DELETE\", `/api/faqs/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/faqs\"] });\n      toast({ title: \"FAQ deleted\" });\n    },\n  });\n}\n","path":null,"size_bytes":4294,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/components/index.ts":{"content":"export { CommentCard } from \"./CommentCard\";\nexport { ReviewCard } from \"./ReviewCard\";\nexport { FAQCard } from \"./FAQCard\";\nexport { FAQForm } from \"./FAQForm\";\n","path":null,"size_bytes":162,"size_tokens":null},"client/src/pages/admin/content/adminposts/components/index.ts":{"content":"export { PostCard } from \"./PostCard\";\nexport { PostForm } from \"./PostForm\";\nexport { DeletePostDialog } from \"./DeletePostDialog\";\n","path":null,"size_bytes":133,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/components/TestimonialForm.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Loader2, Upload, X } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Testimonial, TestimonialFormData } from \"../types\";\nimport { insertTestimonialSchema, getEmptyTestimonialForm } from \"../types\";\n\ninterface TestimonialFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingTestimonial: Testimonial | null;\n  onSubmit: (data: TestimonialFormData, isEditing: boolean) => void;\n  isPending: boolean;\n}\n\nexport function TestimonialForm({\n  open,\n  onOpenChange,\n  editingTestimonial,\n  onSubmit,\n  isPending,\n}: TestimonialFormProps) {\n  const { toast } = useToast();\n  const [avatarPreview, setAvatarPreview] = useState<string | null>(null);\n\n  const form = useForm<TestimonialFormData>({\n    resolver: zodResolver(insertTestimonialSchema),\n    defaultValues: getEmptyTestimonialForm(),\n  });\n\n  useEffect(() => {\n    if (open) {\n      if (editingTestimonial) {\n        form.reset({\n          name: editingTestimonial.name,\n          role: editingTestimonial.role || \"\",\n          company: editingTestimonial.company || \"\",\n          content: editingTestimonial.content,\n          rating: editingTestimonial.rating || 5,\n          avatar: editingTestimonial.avatar || \"\",\n          active: editingTestimonial.active !== false,\n        });\n        setAvatarPreview(editingTestimonial.avatar || null);\n      } else {\n        form.reset(getEmptyTestimonialForm());\n        setAvatarPreview(null);\n      }\n    }\n  }, [open, editingTestimonial, form]);\n\n  const handleAvatarUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith(\"image/\")) {\n      toast({ description: \"Please select an image file\", variant: \"destructive\" });\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      const base64 = event.target?.result as string;\n      form.setValue(\"avatar\", base64);\n      setAvatarPreview(base64);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleClearAvatar = () => {\n    form.setValue(\"avatar\", \"\");\n    setAvatarPreview(null);\n  };\n\n  const handleFormSubmit = (data: TestimonialFormData) => {\n    onSubmit(data, !!editingTestimonial);\n  };\n\n  const handleOpenChange = (isOpen: boolean) => {\n    if (!isOpen) {\n      setAvatarPreview(null);\n    }\n    onOpenChange(isOpen);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] flex flex-col\">\n        <DialogHeader>\n          <DialogTitle>\n            {editingTestimonial ? \"Edit Testimonial\" : \"Add New Testimonial\"}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"flex-1 overflow-y-auto pr-4\">\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(handleFormSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Client Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"John Smith\" {...field} data-testid=\"input-testimonial-name\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"role\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Job Title / Role</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"CEO\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          data-testid=\"input-testimonial-role\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"company\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Company Name</FormLabel>\n                    <FormControl>\n                      <Input\n                        placeholder=\"TechCorp Inc\"\n                        {...field}\n                        value={field.value ?? \"\"}\n                        data-testid=\"input-testimonial-company\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Testimonial Text</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"What did the client say about your work?\"\n                        className=\"resize-none\"\n                        rows={4}\n                        {...field}\n                        data-testid=\"input-testimonial-content\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"rating\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Rating (Stars)</FormLabel>\n                      <Select\n                        value={(field.value ?? 5).toString()}\n                        onValueChange={(v) => field.onChange(parseInt(v))}\n                      >\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-testimonial-rating\">\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {[5, 4, 3, 2, 1].map((star) => (\n                            <SelectItem key={star} value={star.toString()}>\n                              {star} stars\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"active\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select\n                        value={field.value ? \"active\" : \"inactive\"}\n                        onValueChange={(v) => field.onChange(v === \"active\")}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"avatar\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Avatar Image (Optional)</FormLabel>\n\n                    {avatarPreview && (\n                      <div className=\"relative w-24 h-24 rounded-lg overflow-hidden border border-border\">\n                        <img\n                          src={avatarPreview}\n                          alt=\"Avatar preview\"\n                          className=\"w-full h-full object-cover\"\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={handleClearAvatar}\n                          className=\"absolute top-1 right-1 bg-destructive/90 text-white p-1 rounded hover:bg-destructive\"\n                          data-testid=\"button-clear-avatar\"\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    )}\n\n                    <div className=\"space-y-3\">\n                      <div>\n                        <label className=\"flex items-center justify-center gap-2 p-4 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors\">\n                          <Upload className=\"w-4 h-4 text-muted-foreground\" />\n                          <span className=\"text-sm text-muted-foreground\">\n                            Click to upload image\n                          </span>\n                          <input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            onChange={handleAvatarUpload}\n                            className=\"hidden\"\n                            data-testid=\"input-upload-avatar\"\n                          />\n                        </label>\n                        <p className=\"text-xs text-muted-foreground mt-1\">\n                          PNG, JPG, GIF, WebP (Max 5MB)\n                        </p>\n                      </div>\n\n                      <div>\n                        <label className=\"text-sm text-muted-foreground mb-2 block\">\n                          Or paste image URL\n                        </label>\n                        <Input\n                          placeholder=\"https://example.com/avatar.jpg\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          onChange={(e) => {\n                            field.onChange(e);\n                            if (e.target.value && !e.target.value.includes(\"data:\")) {\n                              setAvatarPreview(e.target.value);\n                            }\n                          }}\n                          data-testid=\"input-testimonial-avatar-url\"\n                        />\n                      </div>\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </form>\n          </Form>\n        </div>\n\n        <div className=\"flex gap-2 justify-end pt-4 border-t border-border mt-6\">\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} type=\"button\">\n            Cancel\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isPending}\n            data-testid=\"button-submit-testimonial\"\n            onClick={() => form.handleSubmit(handleFormSubmit)()}\n          >\n            {isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Saving...\n              </>\n            ) : (\n              <>{editingTestimonial ? \"Update\" : \"Add\"} Testimonial</>\n            )}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":12190,"size_tokens":null},"client/src/pages/admin/content/adminservices/components/ServiceComparisonTable.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Check } from \"lucide-react\";\nimport type { Service } from \"../types\";\n\ninterface ServiceComparisonTableProps {\n  services: Service[];\n}\n\nexport function ServiceComparisonTable({ services }: ServiceComparisonTableProps) {\n  const sortedServices = [...services].sort((a, b) => a.order - b.order);\n  const maxFeatures = Math.max(0, Math.max(...services.map((s) => (s.features || []).length)));\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Service Comparison</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-sm\">\n            <thead>\n              <tr className=\"border-b\">\n                <th className=\"text-left py-3 px-2\">Feature</th>\n                {sortedServices.map((service) => (\n                  <th key={service.id} className=\"text-center py-3 px-2\">\n                    {service.title}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              <tr className=\"border-b\">\n                <td className=\"py-3 px-2 font-medium\">Price</td>\n                {sortedServices.map((service) => (\n                  <td key={service.id} className=\"text-center py-3 px-2\">\n                    <span className=\"font-semibold\">{service.price}</span>\n                  </td>\n                ))}\n              </tr>\n              {Array.from({ length: maxFeatures }).map((_, featureIdx) => (\n                <tr key={featureIdx} className=\"border-b\">\n                  <td className=\"py-3 px-2 font-medium text-sm\">\n                    {services[0]?.features?.[featureIdx] || \"Feature\"}\n                  </td>\n                  {sortedServices.map((service) => (\n                    <td key={service.id} className=\"text-center py-3 px-2\">\n                      {service.features && service.features[featureIdx] ? (\n                        <Check className=\"w-4 h-4 text-green-500 mx-auto\" />\n                      ) : (\n                        <span className=\"text-muted-foreground\">-</span>\n                      )}\n                    </td>\n                  ))}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2346,"size_tokens":null},"client/src/pages/admin/content/adminposts/components/DeletePostDialog.tsx":{"content":"import {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface DeletePostDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: () => void;\n}\n\nexport function DeletePostDialog({ open, onOpenChange, onConfirm }: DeletePostDialogProps) {\n  return (\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>Delete Post</AlertDialogTitle>\n          <AlertDialogDescription>\n            Are you sure you want to delete this post? This action cannot be undone.\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n          <AlertDialogAction\n            onClick={onConfirm}\n            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            data-testid=\"button-confirm-delete\"\n          >\n            Delete\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n","path":null,"size_bytes":1261,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/types.ts":{"content":"import type { Comment, Review, FAQ } from \"@shared/schema\";\n\nexport interface FAQFormData {\n  question: string;\n  answer: string;\n  visible: boolean;\n  order: number;\n}\n\nexport const getEmptyFAQForm = (defaultOrder: number = 0): FAQFormData => ({\n  question: \"\",\n  answer: \"\",\n  visible: true,\n  order: defaultOrder,\n});\n\nexport const mapFAQToFormData = (faq: FAQ): FAQFormData => ({\n  question: faq.question,\n  answer: faq.answer,\n  visible: faq.visible,\n  order: faq.order,\n});\n\nexport const getStatusColor = (status: string): string => {\n  switch (status) {\n    case \"Approved\":\n      return \"border-l-green-500\";\n    case \"Pending\":\n      return \"border-l-yellow-500\";\n    case \"Spam\":\n      return \"border-l-red-500\";\n    default:\n      return \"border-l-gray-500\";\n  }\n};\n\nexport type { Comment, Review, FAQ };\n","path":null,"size_bytes":816,"size_tokens":null},"client/src/pages/admin/content/adminskills/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Plus, Search, Wrench, Loader2 } from \"lucide-react\";\nimport { useSkills, useCreateSkill, useUpdateSkill, useDeleteSkill } from \"./hooks\";\nimport { SkillCard, SkillForm } from \"./components\";\nimport type { Skill, SkillFormData } from \"./types\";\n\nexport default function AdminSkillsPage() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"all\");\n  const [dialogOpen, setDialogOpen] = useState(false);\n  const [editingSkill, setEditingSkill] = useState<Skill | null>(null);\n\n  const { data: skills = [], isLoading } = useSkills();\n\n  const handleFormClose = () => {\n    setDialogOpen(false);\n    setEditingSkill(null);\n  };\n\n  const createMutation = useCreateSkill(handleFormClose);\n  const updateMutation = useUpdateSkill(handleFormClose);\n  const deleteMutation = useDeleteSkill();\n\n  const handleOpenCreate = () => {\n    setEditingSkill(null);\n    setDialogOpen(true);\n  };\n\n  const handleOpenEdit = (skill: Skill) => {\n    setEditingSkill(skill);\n    setDialogOpen(true);\n  };\n\n  const handleSubmit = (data: SkillFormData, isEditing: boolean) => {\n    if (isEditing && editingSkill) {\n      updateMutation.mutate({ id: editingSkill.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number, name: string) => {\n    if (confirm(`Delete skill \"${name}\"? This action cannot be undone.`)) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredSkills = skills.filter((skill) => {\n    const matchesSearch =\n      searchQuery === \"\" || skill.name.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesCategory =\n      activeTab === \"all\" || skill.category.toLowerCase() === activeTab.toLowerCase();\n    return matchesSearch && matchesCategory;\n  });\n\n  const availableCategories = Array.from(new Set(skills.map((s) => s.category))).filter(\n    Boolean\n  ) as string[];\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  if (isLoading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n        </div>\n      </AdminLayout>\n    );\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Skills & Technologies</h1>\n            <p className=\"text-muted-foreground\">\n              Manage your technical expertise ({skills.length} skills)\n            </p>\n          </div>\n          <Button onClick={handleOpenCreate} data-testid=\"button-add-skill\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add New Skill\n          </Button>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6\">\n            <TabsList className=\"flex-wrap h-auto\">\n              <TabsTrigger value=\"all\">All ({skills.length})</TabsTrigger>\n              {availableCategories.map((cat) => (\n                <TabsTrigger key={cat} value={cat.toLowerCase()}>\n                  {cat} ({skills.filter((s) => s.category === cat).length})\n                </TabsTrigger>\n              ))}\n            </TabsList>\n\n            <div className=\"relative w-full sm:w-64\">\n              <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search skills...\"\n                className=\"pl-9\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                data-testid=\"input-search-skills\"\n              />\n            </div>\n          </div>\n\n          <TabsContent value={activeTab} className=\"mt-0\">\n            {filteredSkills.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Wrench className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No skills found</h3>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    {searchQuery ? \"Try adjusting your search\" : \"Start by adding your first skill\"}\n                  </p>\n                  <Button onClick={handleOpenCreate}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Add Skill\n                  </Button>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {filteredSkills.map((skill) => (\n                  <SkillCard\n                    key={skill.id}\n                    skill={skill}\n                    onEdit={handleOpenEdit}\n                    onDelete={handleDelete}\n                  />\n                ))}\n\n                <div\n                  onClick={handleOpenCreate}\n                  className=\"border-2 border-dashed border-muted-foreground/20 rounded-xl flex flex-col items-center justify-center p-6 cursor-pointer hover:border-primary/50 hover:bg-primary/5 transition-all h-full min-h-[88px]\"\n                  data-testid=\"button-add-skill-card\"\n                >\n                  <Plus className=\"w-6 h-6 text-muted-foreground mb-2\" />\n                  <span className=\"text-sm font-medium text-muted-foreground\">Add new skill</span>\n                </div>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n\n        <SkillForm\n          open={dialogOpen}\n          onOpenChange={(open) => {\n            if (!open) handleFormClose();\n            else setDialogOpen(open);\n          }}\n          editingSkill={editingSkill}\n          onSubmit={handleSubmit}\n          isPending={isPending}\n        />\n      </div>\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":6274,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Plus, Search, AlertCircle, Loader2 } from \"lucide-react\";\nimport { useTestimonials, useCreateTestimonial, useUpdateTestimonial, useDeleteTestimonial } from \"./hooks\";\nimport { TestimonialCard, TestimonialForm } from \"./components\";\nimport type { Testimonial, TestimonialFormData } from \"./types\";\n\nexport default function AdminTestimonialsPage() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [editingTestimonial, setEditingTestimonial] = useState<Testimonial | null>(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  const { data: testimonials = [], isLoading } = useTestimonials();\n\n  const handleFormClose = () => {\n    setIsOpen(false);\n    setEditingTestimonial(null);\n  };\n\n  const createMutation = useCreateTestimonial(handleFormClose);\n  const updateMutation = useUpdateTestimonial(handleFormClose);\n  const deleteMutation = useDeleteTestimonial();\n\n  const handleOpenDialog = (testimonial?: Testimonial) => {\n    if (testimonial) {\n      setEditingTestimonial(testimonial);\n    } else {\n      setEditingTestimonial(null);\n    }\n    setIsOpen(true);\n  };\n\n  const handleSubmit = (data: TestimonialFormData, isEditing: boolean) => {\n    if (isEditing && editingTestimonial) {\n      updateMutation.mutate({ id: editingTestimonial.id, data });\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const handleDelete = (id: number) => {\n    if (confirm(\"Delete this testimonial?\")) {\n      deleteMutation.mutate(id);\n    }\n  };\n\n  const filteredTestimonials = testimonials.filter(\n    (t) =>\n      t.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      t.company?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const isPending = createMutation.isPending || updateMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Testimonials</h1>\n            <p className=\"text-muted-foreground\">Manage customer reviews and feedback</p>\n          </div>\n          <Button\n            className=\"bg-primary gap-2\"\n            onClick={() => handleOpenDialog()}\n            data-testid=\"button-add-testimonial-admin\"\n          >\n            <Plus className=\"w-4 h-4\" /> Add Testimonial\n          </Button>\n        </div>\n\n        <div className=\"flex gap-4 bg-card p-4 rounded-lg border\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search testimonials...\"\n              className=\"pl-9\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              data-testid=\"input-search-testimonials\"\n            />\n          </div>\n        </div>\n\n        {isLoading && (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n          </div>\n        )}\n\n        {!isLoading && (\n          <>\n            {filteredTestimonials.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <AlertCircle className=\"w-8 h-8 text-muted-foreground mb-2\" />\n                  <p className=\"text-muted-foreground\">\n                    {searchTerm\n                      ? \"No testimonials found matching your search\"\n                      : \"No testimonials yet. Add one to get started!\"}\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {filteredTestimonials.map((testimonial) => (\n                  <TestimonialCard\n                    key={testimonial.id}\n                    testimonial={testimonial}\n                    onEdit={handleOpenDialog}\n                    onDelete={handleDelete}\n                    isDeleting={deleteMutation.isPending}\n                  />\n                ))}\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      <TestimonialForm\n        open={isOpen}\n        onOpenChange={(open) => {\n          if (!open) handleFormClose();\n          else setIsOpen(open);\n        }}\n        editingTestimonial={editingTestimonial}\n        onSubmit={handleSubmit}\n        isPending={isPending}\n      />\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":4706,"size_tokens":null},"client/src/pages/admin/content/adminservices/components/index.ts":{"content":"export { ServiceCard } from \"./ServiceCard\";\nexport { ServiceComparisonTable } from \"./ServiceComparisonTable\";\nexport { ServiceForm } from \"./ServiceForm\";\nexport { DeleteServiceDialog } from \"./DeleteServiceDialog\";\n","path":null,"size_bytes":218,"size_tokens":null},"client/src/pages/admin/content/adminservices/components/DeleteServiceDialog.tsx":{"content":"import {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface DeleteServiceDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: () => void;\n}\n\nexport function DeleteServiceDialog({\n  open,\n  onOpenChange,\n  onConfirm,\n}: DeleteServiceDialogProps) {\n  return (\n    <AlertDialog open={open} onOpenChange={onOpenChange}>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>Delete Service</AlertDialogTitle>\n          <AlertDialogDescription>\n            Are you sure you want to delete this service? This action cannot be undone.\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\n          <AlertDialogAction\n            onClick={onConfirm}\n            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            data-testid=\"button-confirm-delete\"\n          >\n            Delete\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n","path":null,"size_bytes":1248,"size_tokens":null},"client/src/pages/admin/content/adminposts/components/PostCard.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar, Eye, Edit, Trash } from \"lucide-react\";\nimport type { Post } from \"../types\";\nimport { bgImages } from \"../types\";\n\ninterface PostCardProps {\n  post: Post;\n  onEdit: (postId: number) => void;\n  onDelete: (postId: number) => void;\n}\n\nexport function PostCard({ post, onEdit, onDelete }: PostCardProps) {\n  const formatDate = (date: Date | string | null) => {\n    if (!date) return \"N/A\";\n    return new Date(date).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n    });\n  };\n\n  const imageUrl = post.featuredImage || bgImages[post.id % bgImages.length];\n\n  return (\n    <Card data-testid={`card-post-${post.id}`} className=\"overflow-hidden\">\n      <div\n        className=\"h-32 bg-cover bg-center bg-no-repeat\"\n        style={{ backgroundImage: `url('${imageUrl}')` }}\n      >\n        <div className=\"w-full h-full bg-black/40\" />\n      </div>\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <h3 className=\"font-bold\" data-testid={`text-post-title-${post.id}`}>\n                {post.title}\n              </h3>\n              <Badge variant=\"secondary\">{post.category}</Badge>\n              <Badge\n                variant={post.status === \"Published\" ? \"default\" : \"outline\"}\n                className={post.status === \"Published\" ? \"bg-green-500\" : \"\"}\n              >\n                {post.status}\n              </Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground mb-2 line-clamp-2\">\n              {post.excerpt || post.content?.substring(0, 100) || \"No excerpt available\"}\n            </p>\n            <div className=\"flex gap-4 text-xs text-muted-foreground flex-wrap\">\n              <span className=\"flex items-center gap-1\">\n                <Calendar className=\"w-3 h-3\" /> {formatDate(post.publishedAt || post.createdAt)}\n              </span>\n              <span className=\"flex items-center gap-1\">\n                <Eye className=\"w-3 h-3\" /> {post.views || 0} views\n              </span>\n              {post.tags && post.tags.length > 0 && (\n                <span className=\"text-primary\">\n                  {post.tags.slice(0, 3).join(\", \")}\n                  {post.tags.length > 3 && \"...\"}\n                </span>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onEdit(post.id)}\n              data-testid={`button-edit-post-${post.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-destructive hover:text-destructive\"\n              onClick={() => onDelete(post.id)}\n              data-testid={`button-delete-post-${post.id}`}\n            >\n              <Trash className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":3326,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/index.tsx":{"content":"import { useState } from \"react\";\nimport { AdminLayout } from \"@/layouts/AdminLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Plus, Loader2, MessageSquare, Star, HelpCircle } from \"lucide-react\";\nimport {\n  useComments,\n  useReviews,\n  useFAQs,\n  usePosts,\n  useProjectsList,\n  useDeleteComment,\n  useMarkCommentAsRead,\n  useApproveComment,\n  useRejectComment,\n  useDeleteReview,\n  useMarkReviewAsRead,\n  useCreateFAQ,\n  useUpdateFAQ,\n  useDeleteFAQ,\n} from \"./hooks\";\nimport { CommentCard, ReviewCard, FAQCard, FAQForm } from \"./components\";\nimport type { FAQ, FAQFormData } from \"./types\";\n\nexport default function AdminInteractionsPage() {\n  const [activeTab, setActiveTab] = useState(\"comments\");\n  const [isFAQFormOpen, setIsFAQFormOpen] = useState(false);\n  const [editingFAQ, setEditingFAQ] = useState<FAQ | null>(null);\n\n  const { data: comments = [], isLoading: loadingComments } = useComments();\n  const { data: reviews = [], isLoading: loadingReviews } = useReviews();\n  const { data: faqs = [], isLoading: loadingFAQs } = useFAQs();\n  const { data: posts = [] } = usePosts();\n  const { data: projects = [] } = useProjectsList();\n\n  const deleteCommentMutation = useDeleteComment();\n  const markCommentAsReadMutation = useMarkCommentAsRead();\n  const approveCommentMutation = useApproveComment();\n  const rejectCommentMutation = useRejectComment();\n  const deleteReviewMutation = useDeleteReview();\n  const markReviewAsReadMutation = useMarkReviewAsRead();\n\n  const handleFAQFormClose = () => {\n    setIsFAQFormOpen(false);\n    setEditingFAQ(null);\n  };\n\n  const createFAQMutation = useCreateFAQ(handleFAQFormClose);\n  const updateFAQMutation = useUpdateFAQ(handleFAQFormClose);\n  const deleteFAQMutation = useDeleteFAQ();\n\n  const handleOpenFAQForm = (faq?: FAQ) => {\n    if (faq) {\n      setEditingFAQ(faq);\n    } else {\n      setEditingFAQ(null);\n    }\n    setIsFAQFormOpen(true);\n  };\n\n  const handleFAQSubmit = (data: FAQFormData, isEditing: boolean) => {\n    if (isEditing && editingFAQ) {\n      updateFAQMutation.mutate({ id: editingFAQ.id, data });\n    } else {\n      createFAQMutation.mutate(data);\n    }\n  };\n\n  const handleToggleFAQVisibility = (faq: FAQ) => {\n    updateFAQMutation.mutate({ id: faq.id, data: { visible: !faq.visible } });\n  };\n\n  const pendingCommentsCount = comments.filter((c) => c.status === \"Pending\").length;\n  const unreadReviewsCount = reviews.filter((r) => !r.read).length;\n\n  const isFAQPending = createFAQMutation.isPending || updateFAQMutation.isPending;\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-heading font-bold\">Interactions</h1>\n            <p className=\"text-muted-foreground\">\n              Manage comments, reviews, and FAQs\n            </p>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Comments</CardTitle>\n              <MessageSquare className=\"w-4 h-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{comments.length}</div>\n              <p className=\"text-xs text-muted-foreground\">\n                {pendingCommentsCount} pending approval\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Reviews</CardTitle>\n              <Star className=\"w-4 h-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{reviews.length}</div>\n              <p className=\"text-xs text-muted-foreground\">{unreadReviewsCount} unread</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">FAQs</CardTitle>\n              <HelpCircle className=\"w-4 h-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{faqs.length}</div>\n              <p className=\"text-xs text-muted-foreground\">\n                {faqs.filter((f) => f.visible).length} visible\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList>\n            <TabsTrigger value=\"comments\" data-testid=\"tab-comments\">\n              Comments ({comments.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"reviews\" data-testid=\"tab-reviews\">\n              Reviews ({reviews.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"faqs\" data-testid=\"tab-faqs\">\n              FAQs ({faqs.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"comments\" className=\"space-y-4 mt-4\">\n            {loadingComments ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : comments.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <MessageSquare className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">No comments yet</p>\n                </CardContent>\n              </Card>\n            ) : (\n              comments.map((comment) => (\n                <CommentCard\n                  key={comment.id}\n                  comment={comment}\n                  posts={posts}\n                  onApprove={(id) => approveCommentMutation.mutate(id)}\n                  onReject={(id) => rejectCommentMutation.mutate(id)}\n                  onMarkAsRead={(id) => markCommentAsReadMutation.mutate(id)}\n                />\n              ))\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"reviews\" className=\"space-y-4 mt-4\">\n            {loadingReviews ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : reviews.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Star className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">No reviews yet</p>\n                </CardContent>\n              </Card>\n            ) : (\n              reviews.map((review) => (\n                <ReviewCard\n                  key={review.id}\n                  review={review}\n                  projects={projects}\n                  onDelete={(id) => deleteReviewMutation.mutate(id)}\n                  onMarkAsRead={(id) => markReviewAsReadMutation.mutate(id)}\n                />\n              ))\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"faqs\" className=\"space-y-4 mt-4\">\n            <div className=\"flex justify-end\">\n              <Button onClick={() => handleOpenFAQForm()} data-testid=\"button-create-faq\">\n                <Plus className=\"w-4 h-4 mr-2\" /> New FAQ\n              </Button>\n            </div>\n\n            {loadingFAQs ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : faqs.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <HelpCircle className=\"w-12 h-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground mb-4\">No FAQs yet</p>\n                  <Button onClick={() => handleOpenFAQForm()}>\n                    <Plus className=\"w-4 h-4 mr-2\" /> Create your first FAQ\n                  </Button>\n                </CardContent>\n              </Card>\n            ) : (\n              faqs.map((faq) => (\n                <FAQCard\n                  key={faq.id}\n                  faq={faq}\n                  onEdit={handleOpenFAQForm}\n                  onDelete={(id) => deleteFAQMutation.mutate(id)}\n                  onToggleVisibility={handleToggleFAQVisibility}\n                />\n              ))\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <FAQForm\n        open={isFAQFormOpen}\n        onOpenChange={(open) => {\n          if (!open) handleFAQFormClose();\n          else setIsFAQFormOpen(open);\n        }}\n        editingFAQ={editingFAQ}\n        onSubmit={handleFAQSubmit}\n        isPending={isFAQPending}\n        defaultOrder={faqs.length}\n      />\n    </AdminLayout>\n  );\n}\n","path":null,"size_bytes":9278,"size_tokens":null},"client/src/pages/admin/content/adminservices/components/ServiceForm.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { X, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Service, ServiceFormData } from \"../types\";\nimport { getEmptyServiceForm, mapServiceToFormData } from \"../types\";\n\ninterface ServiceFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingService: Service | null;\n  onSubmit: (data: ServiceFormData, isEditing: boolean) => void;\n  isPending: boolean;\n}\n\nexport function ServiceForm({\n  open,\n  onOpenChange,\n  editingService,\n  onSubmit,\n  isPending,\n}: ServiceFormProps) {\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<ServiceFormData>(\n    editingService ? mapServiceToFormData(editingService) : getEmptyServiceForm()\n  );\n  const [featureInput, setFeatureInput] = useState(\"\");\n\n  const handleOpenChange = (isOpen: boolean) => {\n    if (isOpen && editingService) {\n      setFormData(mapServiceToFormData(editingService));\n    } else if (isOpen) {\n      setFormData(getEmptyServiceForm());\n    }\n    setFeatureInput(\"\");\n    onOpenChange(isOpen);\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim() && !formData.features.includes(featureInput.trim())) {\n      setFormData({\n        ...formData,\n        features: [...formData.features, featureInput.trim()],\n      });\n      setFeatureInput(\"\");\n    }\n  };\n\n  const removeFeature = (feature: string) => {\n    setFormData({\n      ...formData,\n      features: formData.features.filter((f) => f !== feature),\n    });\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Service title is required\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    onSubmit(formData, !!editingService);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {editingService ? \"Edit Service\" : \"Create New Service\"}\n          </DialogTitle>\n          <DialogDescription>\n            {editingService\n              ? \"Update the service details below.\"\n              : \"Fill in the details to create a new service.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"title\">Service Title *</Label>\n            <Input\n              id=\"title\"\n              placeholder=\"e.g., Web Development\"\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              data-testid=\"input-title\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"description\">Description</Label>\n            <Textarea\n              id=\"description\"\n              placeholder=\"Brief description of the service\"\n              value={formData.description}\n              onChange={(e) =>\n                setFormData({ ...formData, description: e.target.value })\n              }\n              data-testid=\"input-description\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"price\">Price</Label>\n              <Input\n                id=\"price\"\n                placeholder=\"e.g., From $2,000\"\n                value={formData.price}\n                onChange={(e) => setFormData({ ...formData, price: e.target.value })}\n                data-testid=\"input-price\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"icon\">Icon</Label>\n              <Input\n                id=\"icon\"\n                placeholder=\"e.g., code, smartphone, palette\"\n                value={formData.icon}\n                onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n                data-testid=\"input-icon\"\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"order\">Order</Label>\n              <Input\n                id=\"order\"\n                type=\"number\"\n                value={formData.order}\n                onChange={(e) =>\n                  setFormData({ ...formData, order: parseInt(e.target.value) || 0 })\n                }\n                data-testid=\"input-order\"\n              />\n            </div>\n\n            <div className=\"flex items-end gap-2\">\n              <div className=\"flex-1 space-y-2\">\n                <Label htmlFor=\"active\">Active</Label>\n                <div className=\"flex items-center gap-2 pt-1\">\n                  <Switch\n                    id=\"active\"\n                    checked={formData.active}\n                    onCheckedChange={(checked) =>\n                      setFormData({ ...formData, active: checked })\n                    }\n                    data-testid=\"switch-active\"\n                  />\n                  <span className=\"text-sm text-muted-foreground\">\n                    {formData.active ? \"Active\" : \"Inactive\"}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Features</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                placeholder=\"Add feature (e.g., Responsive Design)\"\n                value={featureInput}\n                onChange={(e) => setFeatureInput(e.target.value)}\n                onKeyPress={(e) =>\n                  e.key === \"Enter\" && (e.preventDefault(), addFeature())\n                }\n                data-testid=\"input-feature\"\n              />\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={addFeature}\n                data-testid=\"button-add-feature\"\n              >\n                Add\n              </Button>\n            </div>\n            <div className=\"flex flex-wrap gap-2 mt-2\">\n              {formData.features.map((feature) => (\n                <Badge key={feature} variant=\"secondary\" className=\"gap-1\">\n                  {feature}\n                  <button\n                    onClick={() => removeFeature(feature)}\n                    className=\"ml-1 hover:text-destructive\"\n                    data-testid={`button-remove-feature-${feature}`}\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </button>\n                </Badge>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            data-testid=\"button-cancel\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleSubmit}\n            disabled={isPending}\n            data-testid=\"button-save-service\"\n          >\n            {isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Saving...\n              </>\n            ) : editingService ? (\n              \"Update Service\"\n            ) : (\n              \"Create Service\"\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":7792,"size_tokens":null},"client/src/pages/admin/content/adminprojects/components/ProjectForm.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { X, Loader2, Image as ImageIcon } from \"lucide-react\";\nimport { ProjectEditor } from \"@/components/admin/project-editor\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Project, Category, ProjectFormData } from \"../types\";\nimport { getEmptyProjectForm, mapProjectToFormData } from \"../types\";\n\ninterface ProjectFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingProject: Project | null;\n  categories: Category[];\n  onSubmit: (data: ProjectFormData, isEditing: boolean) => void;\n  isPending: boolean;\n}\n\nexport function ProjectForm({\n  open,\n  onOpenChange,\n  editingProject,\n  categories,\n  onSubmit,\n  isPending,\n}: ProjectFormProps) {\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<ProjectFormData>(getEmptyProjectForm());\n  const [techInput, setTechInput] = useState(\"\");\n  const [uploadingImage, setUploadingImage] = useState(false);\n\n  useEffect(() => {\n    if (open) {\n      if (editingProject) {\n        setFormData(mapProjectToFormData(editingProject));\n      } else {\n        setFormData(getEmptyProjectForm());\n      }\n      setTechInput(\"\");\n    }\n  }, [open, editingProject]);\n\n  const addTech = () => {\n    if (techInput.trim() && !formData.tech.includes(techInput.trim())) {\n      setFormData({ ...formData, tech: [...formData.tech, techInput.trim()] });\n      setTechInput(\"\");\n    }\n  };\n\n  const removeTech = (tech: string) => {\n    setFormData({ ...formData, tech: formData.tech.filter((t) => t !== tech) });\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"Error\",\n        description: \"Image size must be less than 5MB\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setUploadingImage(true);\n    try {\n      const reader = new FileReader();\n      reader.onloadend = async () => {\n        const base64 = reader.result as string;\n        try {\n          const result = await api.uploadImage(base64, file.name);\n          setFormData({ ...formData, image: result.url });\n          toast({ title: \"Success\", description: \"Image uploaded successfully\" });\n        } catch (error: any) {\n          toast({\n            title: \"Error\",\n            description: error.message || \"Failed to upload image\",\n            variant: \"destructive\",\n          });\n        } finally {\n          setUploadingImage(false);\n        }\n      };\n      reader.readAsDataURL(file);\n    } catch (error) {\n      setUploadingImage(false);\n      toast({ title: \"Error\", description: \"Failed to read image file\", variant: \"destructive\" });\n    }\n  };\n\n  const handleSubmit = () => {\n    if (!formData.title.trim()) {\n      toast({ title: \"Error\", description: \"Title is required\", variant: \"destructive\" });\n      return;\n    }\n    onSubmit(formData, !!editingProject);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{editingProject ? \"Edit Project\" : \"Create New Project\"}</DialogTitle>\n          <DialogDescription>\n            {editingProject ? \"Update your project details\" : \"Add a new project to your portfolio\"}\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-6 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"title\">Title *</Label>\n            <Input\n              id=\"title\"\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              placeholder=\"Project title\"\n              data-testid=\"input-title\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"category\">Category</Label>\n              <Select\n                value={formData.category}\n                onValueChange={(value) => setFormData({ ...formData, category: value })}\n              >\n                <SelectTrigger data-testid=\"select-category\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {categories.length > 0 ? (\n                    categories.map((cat: Category) => (\n                      <SelectItem\n                        key={cat.id}\n                        value={cat.slug}\n                        data-testid={`option-${cat.slug}`}\n                      >\n                        {cat.name}\n                      </SelectItem>\n                    ))\n                  ) : (\n                    <SelectItem value=\"default\" disabled>\n                      No categories available\n                    </SelectItem>\n                  )}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"status\">Status</Label>\n              <Select\n                value={formData.status}\n                onValueChange={(value) => setFormData({ ...formData, status: value })}\n              >\n                <SelectTrigger data-testid=\"select-status\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"Draft\">Draft</SelectItem>\n                  <SelectItem value=\"Published\">Published</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"shortDescription\">Short Description</Label>\n            <p className=\"text-sm text-muted-foreground\">\n              A brief summary shown in featured project cards (max 150 characters)\n            </p>\n            <Input\n              id=\"shortDescription\"\n              value={formData.shortDescription}\n              onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}\n              placeholder=\"Brief project summary for featured display...\"\n              maxLength={150}\n              data-testid=\"input-short-description\"\n            />\n            <p className=\"text-xs text-muted-foreground text-right\">\n              {formData.shortDescription.length}/150\n            </p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"description\">Full Description</Label>\n            <p className=\"text-sm text-muted-foreground mb-3\">\n              Add detailed information about your project with rich formatting support\n            </p>\n            <ProjectEditor\n              value={formData.description}\n              onChange={(html) => setFormData({ ...formData, description: html })}\n              placeholder=\"Describe your project with details, features, and technologies...\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Project Image</Label>\n            <div className=\"flex items-center gap-4\">\n              {formData.image ? (\n                <div className=\"relative w-32 h-20 rounded-lg overflow-hidden bg-muted\">\n                  <img\n                    src={formData.image}\n                    alt=\"Preview\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                  <Button\n                    size=\"icon\"\n                    variant=\"destructive\"\n                    className=\"absolute top-1 right-1 h-6 w-6\"\n                    onClick={() => setFormData({ ...formData, image: \"\" })}\n                  >\n                    <X className=\"w-3 h-3\" />\n                  </Button>\n                </div>\n              ) : (\n                <div className=\"w-32 h-20 rounded-lg bg-muted flex items-center justify-center\">\n                  <ImageIcon className=\"w-8 h-8 text-muted-foreground\" />\n                </div>\n              )}\n              <div className=\"flex-1\">\n                <Input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleImageUpload}\n                  disabled={uploadingImage}\n                  data-testid=\"input-image\"\n                />\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Max 5MB. Recommended: 1200x630px\n                </p>\n              </div>\n              {uploadingImage && <Loader2 className=\"w-5 h-5 animate-spin\" />}\n            </div>\n            <div className=\"flex items-center gap-2 mt-2\">\n              <span className=\"text-sm text-muted-foreground\">Or enter URL:</span>\n              <Input\n                placeholder=\"https://example.com/image.jpg\"\n                value={formData.image}\n                onChange={(e) => setFormData({ ...formData, image: e.target.value })}\n                className=\"flex-1\"\n                data-testid=\"input-image-url\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Technologies</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                value={techInput}\n                onChange={(e) => setTechInput(e.target.value)}\n                placeholder=\"Add technology (e.g., React)\"\n                onKeyPress={(e) => e.key === \"Enter\" && (e.preventDefault(), addTech())}\n                data-testid=\"input-tech\"\n              />\n              <Button type=\"button\" onClick={addTech} variant=\"outline\">\n                Add\n              </Button>\n            </div>\n            <div className=\"flex flex-wrap gap-2 mt-2\">\n              {formData.tech.map((tech) => (\n                <Badge key={tech} variant=\"secondary\" className=\"gap-1\">\n                  {tech}\n                  <button onClick={() => removeTech(tech)} className=\"ml-1 hover:text-destructive\">\n                    <X className=\"w-3 h-3\" />\n                  </button>\n                </Badge>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"link\">Live URL</Label>\n              <Input\n                id=\"link\"\n                value={formData.link}\n                onChange={(e) => setFormData({ ...formData, link: e.target.value })}\n                placeholder=\"https://example.com\"\n                data-testid=\"input-link\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"github\">GitHub URL</Label>\n              <Input\n                id=\"github\"\n                value={formData.github}\n                onChange={(e) => setFormData({ ...formData, github: e.target.value })}\n                placeholder=\"https://github.com/...\"\n                data-testid=\"input-github\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              checked={formData.featured}\n              onCheckedChange={(checked) => setFormData({ ...formData, featured: checked })}\n              data-testid=\"switch-featured\"\n            />\n            <Label>Featured project</Label>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            Cancel\n          </Button>\n          <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-save-project\">\n            {isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Saving...\n              </>\n            ) : editingProject ? (\n              \"Update Project\"\n            ) : (\n              \"Create Project\"\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":12338,"size_tokens":null},"client/src/pages/admin/content/adminskills/hooks.ts":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Skill, SkillFormData } from \"./types\";\n\nexport function useSkills() {\n  return useQuery<Skill[]>({\n    queryKey: [\"/api/skills\"],\n  });\n}\n\nexport function useCreateSkill(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (data: SkillFormData) => api.createSkill(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/skills\"] });\n      queryClient.invalidateQueries({ queryKey: [\"skills\"] });\n      toast({ title: \"Success\", description: \"Skill created successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useUpdateSkill(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: number; data: SkillFormData }) => api.updateSkill(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/skills\"] });\n      queryClient.invalidateQueries({ queryKey: [\"skills\"] });\n      toast({ title: \"Success\", description: \"Skill updated successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useDeleteSkill(onSuccess?: () => void) {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: (id: number) => api.deleteSkill(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/skills\"] });\n      queryClient.invalidateQueries({ queryKey: [\"skills\"] });\n      toast({ title: \"Success\", description: \"Skill deleted successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n","path":null,"size_bytes":2073,"size_tokens":null},"client/src/pages/admin/content/adminprojects/types.ts":{"content":"export interface Project {\n  id: number;\n  title: string;\n  category: string;\n  image: string | null;\n  shortDescription: string | null;\n  description: string | null;\n  tech: string[];\n  link: string | null;\n  github: string | null;\n  status: string;\n  views: number;\n  featured: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\nexport interface ProjectFormData {\n  title: string;\n  category: string;\n  image: string;\n  shortDescription: string;\n  description: string;\n  tech: string[];\n  link: string;\n  github: string;\n  status: string;\n  featured: boolean;\n}\n\nexport const getEmptyProjectForm = (): ProjectFormData => ({\n  title: \"\",\n  category: \"full-stack\",\n  image: \"\",\n  shortDescription: \"\",\n  description: \"\",\n  tech: [],\n  link: \"\",\n  github: \"\",\n  status: \"Draft\",\n  featured: false,\n});\n\nexport const mapProjectToFormData = (project: Project): ProjectFormData => ({\n  title: project.title,\n  category: project.category,\n  image: project.image || \"\",\n  shortDescription: project.shortDescription || \"\",\n  description: project.description || \"\",\n  tech: project.tech || [],\n  link: project.link || \"\",\n  github: project.github || \"\",\n  status: project.status,\n  featured: project.featured,\n});\n","path":null,"size_bytes":1326,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/types.ts":{"content":"import { insertTestimonialSchema, type Testimonial } from \"@shared/schema\";\nimport type { z } from \"zod\";\n\nexport type TestimonialFormData = z.infer<typeof insertTestimonialSchema>;\n\nexport const getEmptyTestimonialForm = (): TestimonialFormData => ({\n  name: \"\",\n  role: \"\",\n  company: \"\",\n  content: \"\",\n  rating: 5,\n  avatar: \"\",\n  active: true,\n});\n\nexport const mapTestimonialToFormData = (testimonial: Testimonial): TestimonialFormData => ({\n  name: testimonial.name,\n  role: testimonial.role || \"\",\n  company: testimonial.company || \"\",\n  content: testimonial.content,\n  rating: testimonial.rating || 5,\n  avatar: testimonial.avatar || \"\",\n  active: testimonial.active !== false,\n});\n\nexport type { Testimonial };\nexport { insertTestimonialSchema };\n","path":null,"size_bytes":757,"size_tokens":null},"client/src/pages/admin/communications/admininteractions/components/CommentCard.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Check, Trash2, Mail, MailOpen } from \"lucide-react\";\nimport type { Comment } from \"../types\";\nimport { getStatusColor } from \"../types\";\n\ninterface CommentCardProps {\n  comment: Comment;\n  posts: any[];\n  onApprove: (id: number) => void;\n  onReject: (id: number) => void;\n  onMarkAsRead: (id: number) => void;\n}\n\nexport function CommentCard({\n  comment,\n  posts,\n  onApprove,\n  onReject,\n  onMarkAsRead,\n}: CommentCardProps) {\n  const post = posts.find((p) => p.id === comment.postId);\n\n  return (\n    <Card\n      className={`${!comment.read ? \"bg-muted/20\" : \"\"} border-l-4 ${getStatusColor(comment.status)}`}\n      data-testid={`card-comment-${comment.id}`}\n    >\n      <CardContent className=\"p-4\">\n        <div className=\"flex flex-col sm:flex-row sm:items-start justify-between gap-4\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-2 mb-2 flex-wrap\">\n              <span className=\"font-medium\">{comment.authorName}</span>\n              <span className=\"text-sm text-muted-foreground\">{comment.authorEmail}</span>\n              <Badge\n                variant={comment.status === \"Approved\" ? \"default\" : \"secondary\"}\n                className={comment.status === \"Approved\" ? \"bg-green-500\" : \"\"}\n              >\n                {comment.status}\n              </Badge>\n              {!comment.read && (\n                <Badge variant=\"outline\" className=\"text-blue-500 border-blue-500\">\n                  New\n                </Badge>\n              )}\n            </div>\n            <p className=\"text-sm mb-2\">{comment.content}</p>\n            <div className=\"text-xs text-muted-foreground\">\n              <span>On: {post?.title || `Post #${comment.postId}`}</span>\n              <span className=\"mx-2\">â€¢</span>\n              <span>{comment.createdAt ? new Date(comment.createdAt).toLocaleDateString() : \"N/A\"}</span>\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onMarkAsRead(comment.id)}\n              title={comment.read ? \"Mark as unread\" : \"Mark as read\"}\n              data-testid={`button-mark-read-${comment.id}`}\n            >\n              {comment.read ? <MailOpen className=\"w-4 h-4\" /> : <Mail className=\"w-4 h-4\" />}\n            </Button>\n            {comment.status === \"Pending\" && (\n              <Button\n                variant=\"outline\"\n                size=\"icon\"\n                onClick={() => onApprove(comment.id)}\n                className=\"text-green-500 hover:text-green-600\"\n                title=\"Approve\"\n                data-testid={`button-approve-${comment.id}`}\n              >\n                <Check className=\"w-4 h-4\" />\n              </Button>\n            )}\n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => onReject(comment.id)}\n              className=\"text-destructive hover:text-destructive\"\n              title=\"Delete\"\n              data-testid={`button-delete-${comment.id}`}\n            >\n              <Trash2 className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":3376,"size_tokens":null},"client/src/pages/admin/content/adminprojects/hooks.ts":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Project, Category, ProjectFormData } from \"./types\";\n\nexport function useProjects() {\n  return useQuery({\n    queryKey: [\"/api/projects\"],\n    queryFn: () => api.getProjects(),\n  });\n}\n\nexport function useProjectCategories() {\n  return useQuery({\n    queryKey: [\"/api/categories\", \"project\"],\n    queryFn: () =>\n      fetch(\"/api/categories?type=project\", { credentials: \"include\" })\n        .then((res) => res.json() as Promise<Category[]>)\n        .catch(() => []),\n  });\n}\n\nexport function useCreateProject(onSuccess?: () => void) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: ProjectFormData) => api.createProject(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project created successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useUpdateProject(onSuccess?: () => void) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: number; data: Partial<ProjectFormData> }) =>\n      api.updateProject(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project updated successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useDeleteProject() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: number) => api.deleteProject(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      toast({ title: \"Success\", description: \"Project deleted successfully\" });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useToggleFeatured() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, featured }: { id: number; featured: boolean }) =>\n      api.updateProject(id, { featured }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n\nexport function useToggleStatus() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, status }: { id: number; status: string }) =>\n      api.updateProject(id, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n    },\n    onError: (error: any) => {\n      toast({ title: \"Error\", description: error.message, variant: \"destructive\" });\n    },\n  });\n}\n","path":null,"size_bytes":3264,"size_tokens":null},"client/src/pages/admin/content/adminprojects/components/ProjectCard.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Edit, Trash2, Eye, Star, ExternalLink, Github, Image as ImageIcon } from \"lucide-react\";\nimport type { Project, Category } from \"../types\";\n\ninterface ProjectCardProps {\n  project: Project;\n  categories: Category[];\n  onEdit: (project: Project) => void;\n  onDelete: (id: number) => void;\n  onToggleFeatured: (id: number, featured: boolean) => void;\n}\n\nexport function ProjectCard({\n  project,\n  categories,\n  onEdit,\n  onDelete,\n  onToggleFeatured,\n}: ProjectCardProps) {\n  return (\n    <Card className=\"overflow-hidden group\" data-testid={`card-project-${project.id}`}>\n      <div className=\"aspect-video relative bg-muted overflow-hidden\">\n        {project.image ? (\n          <img\n            src={project.image}\n            alt={project.title}\n            className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n          />\n        ) : (\n          <div className=\"w-full h-full flex items-center justify-center\">\n            <ImageIcon className=\"w-12 h-12 text-muted-foreground/50\" />\n          </div>\n        )}\n        <div className=\"absolute top-2 left-2 flex gap-1\">\n          <Badge variant={project.status === \"Published\" ? \"default\" : \"secondary\"}>\n            {project.status}\n          </Badge>\n          {project.featured && (\n            <Badge variant=\"default\" className=\"bg-yellow-500\">\n              <Star className=\"w-3 h-3 mr-1\" /> Featured\n            </Badge>\n          )}\n        </div>\n      </div>\n      <CardHeader className=\"pb-2\">\n        <CardTitle className=\"text-lg line-clamp-1\">{project.title}</CardTitle>\n        <CardDescription className=\"line-clamp-2\">\n          {project.description || \"No description\"}\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"flex flex-wrap gap-1\">\n          {(project.tech || []).slice(0, 4).map((tech) => (\n            <Badge key={tech} variant=\"outline\" className=\"text-xs\">\n              {tech}\n            </Badge>\n          ))}\n          {(project.tech || []).length > 4 && (\n            <Badge variant=\"outline\" className=\"text-xs\">\n              +{project.tech.length - 4}\n            </Badge>\n          )}\n        </div>\n        <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n          <span className=\"flex items-center gap-1\">\n            <Eye className=\"w-4 h-4\" /> {project.views}\n          </span>\n          <span>\n            {categories.find((c) => c.slug === project.category)?.name || project.category}\n          </span>\n        </div>\n        <div className=\"flex items-center justify-between pt-2 border-t\">\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              checked={project.featured}\n              onCheckedChange={(checked) => onToggleFeatured(project.id, checked)}\n              data-testid={`switch-featured-${project.id}`}\n            />\n            <span className=\"text-sm text-muted-foreground\">Featured</span>\n          </div>\n          <div className=\"flex gap-1\">\n            {project.link && (\n              <Button size=\"icon\" variant=\"ghost\" asChild>\n                <a href={project.link} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <ExternalLink className=\"w-4 h-4\" />\n                </a>\n              </Button>\n            )}\n            {project.github && (\n              <Button size=\"icon\" variant=\"ghost\" asChild>\n                <a href={project.github} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <Github className=\"w-4 h-4\" />\n                </a>\n              </Button>\n            )}\n            <Button\n              size=\"icon\"\n              variant=\"ghost\"\n              onClick={() => onEdit(project)}\n              data-testid={`button-edit-${project.id}`}\n            >\n              <Edit className=\"w-4 h-4\" />\n            </Button>\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button size=\"icon\" variant=\"ghost\" data-testid={`button-delete-${project.id}`}>\n                  <Trash2 className=\"w-4 h-4\" />\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Delete Project</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Are you sure you want to delete \"{project.title}\"? This action cannot be undone.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={() => onDelete(project.id)}\n                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                  >\n                    Delete\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":5537,"size_tokens":null},"client/src/pages/admin/content/adminskills/components/index.ts":{"content":"export { SkillCard } from \"./SkillCard\";\nexport { SkillForm } from \"./SkillForm\";\n","path":null,"size_bytes":82,"size_tokens":null},"client/src/pages/admin/content/adminskills/components/SkillForm.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Slider } from \"@/components/ui/slider\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Loader2, Save, X } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Skill, SkillFormData } from \"../types\";\nimport { skillCategories, getEmptySkillForm, mapSkillToFormData, getLevelLabel, getLevelColor } from \"../types\";\n\ninterface SkillFormProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  editingSkill: Skill | null;\n  onSubmit: (data: SkillFormData, isEditing: boolean) => void;\n  isPending: boolean;\n}\n\nexport function SkillForm({\n  open,\n  onOpenChange,\n  editingSkill,\n  onSubmit,\n  isPending,\n}: SkillFormProps) {\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<SkillFormData>(getEmptySkillForm());\n\n  useEffect(() => {\n    if (open) {\n      if (editingSkill) {\n        setFormData(mapSkillToFormData(editingSkill));\n      } else {\n        setFormData(getEmptySkillForm());\n      }\n    }\n  }, [open, editingSkill]);\n\n  const handleSubmit = () => {\n    if (!formData.name.trim()) {\n      toast({ title: \"Error\", description: \"Skill name is required\", variant: \"destructive\" });\n      return;\n    }\n    onSubmit(formData, !!editingSkill);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle>{editingSkill ? \"Edit Skill\" : \"Add New Skill\"}</DialogTitle>\n          <DialogDescription>\n            {editingSkill ? \"Update the skill details below\" : \"Fill in the details for your new skill\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-5 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"skill-name\">Skill Name *</Label>\n            <Input\n              id=\"skill-name\"\n              value={formData.name}\n              onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n              placeholder=\"e.g., React.js, Node.js, PostgreSQL\"\n              data-testid=\"input-skill-name\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"skill-category\">Category</Label>\n            <Select\n              value={formData.category}\n              onValueChange={(value) => setFormData({ ...formData, category: value })}\n            >\n              <SelectTrigger data-testid=\"select-skill-category\">\n                <SelectValue placeholder=\"Select category\" />\n              </SelectTrigger>\n              <SelectContent>\n                {skillCategories.map((cat) => (\n                  <SelectItem key={cat} value={cat}>\n                    {cat}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <Label>Proficiency Level</Label>\n              <div className=\"flex items-center gap-2\">\n                <Badge variant=\"secondary\" className={getLevelColor(formData.level)}>\n                  {getLevelLabel(formData.level)}\n                </Badge>\n                <span className=\"text-sm font-mono text-muted-foreground\">{formData.level}%</span>\n              </div>\n            </div>\n            <Slider\n              value={[formData.level]}\n              onValueChange={(value) => setFormData({ ...formData, level: value[0] })}\n              min={0}\n              max={100}\n              step={5}\n              className=\"w-full\"\n              data-testid=\"slider-skill-level\"\n            />\n            <div className=\"flex justify-between text-xs text-muted-foreground\">\n              <span>Beginner</span>\n              <span>Intermediate</span>\n              <span>Expert</span>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"skill-icon\">Icon (optional)</Label>\n            <Input\n              id=\"skill-icon\"\n              value={formData.icon}\n              onChange={(e) => setFormData({ ...formData, icon: e.target.value })}\n              placeholder=\"Icon name or URL\"\n              data-testid=\"input-skill-icon\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Leave empty to use default category icon</p>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"skill-order\">Display Order</Label>\n            <Input\n              id=\"skill-order\"\n              type=\"number\"\n              value={formData.order}\n              onChange={(e) => setFormData({ ...formData, order: parseInt(e.target.value) || 0 })}\n              placeholder=\"0\"\n              data-testid=\"input-skill-order\"\n            />\n            <p className=\"text-xs text-muted-foreground\">Lower numbers appear first</p>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            <X className=\"w-4 h-4 mr-2\" /> Cancel\n          </Button>\n          <Button onClick={handleSubmit} disabled={isPending} data-testid=\"button-save-skill\">\n            {isPending ? (\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n            ) : (\n              <Save className=\"w-4 h-4 mr-2\" />\n            )}\n            {editingSkill ? \"Update\" : \"Create\"} Skill\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":5876,"size_tokens":null},"client/src/pages/admin/content/adminposts/types.ts":{"content":"import type { Post, InsertPost } from \"@shared/schema\";\n\nexport interface Category {\n  id: number;\n  name: string;\n  slug: string;\n  type: string;\n  description?: string;\n}\n\nexport interface PostFormData {\n  title: string;\n  slug: string;\n  content: string;\n  excerpt: string;\n  category: string;\n  author: string;\n  status: \"Published\" | \"Draft\" | \"Archived\";\n  tags: string[];\n  featuredImage: string | null;\n  publishedAt: Date | null;\n}\n\nexport const getEmptyPostForm = (): PostFormData => ({\n  title: \"\",\n  slug: \"\",\n  content: \"\",\n  excerpt: \"\",\n  category: \"\",\n  author: \"Loi Developer\",\n  status: \"Draft\",\n  tags: [],\n  featuredImage: null,\n  publishedAt: null,\n});\n\nexport function generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/(^-|-$)/g, \"\");\n}\n\nexport function mapPostToFormData(post: Post): { formData: PostFormData; tagsInput: string } {\n  let parsedPublishedAt: Date | null = null;\n  if (post.publishedAt) {\n    const date = new Date(post.publishedAt);\n    if (!isNaN(date.getTime())) {\n      parsedPublishedAt = date;\n    }\n  }\n\n  return {\n    formData: {\n      title: post.title,\n      slug: post.slug,\n      content: post.content || \"\",\n      excerpt: post.excerpt || \"\",\n      category: post.category,\n      author: post.author,\n      status: post.status as \"Published\" | \"Draft\" | \"Archived\",\n      tags: post.tags || [],\n      featuredImage: post.featuredImage,\n      publishedAt: parsedPublishedAt,\n    },\n    tagsInput: post.tags?.join(\", \") || \"\",\n  };\n}\n\nexport const bgImages = ['/images/blog/bg-1.png', '/images/blog/bg-2.png', '/images/blog/bg-3.png'];\n\nexport type { Post, InsertPost };\n","path":null,"size_bytes":1688,"size_tokens":null},"client/src/pages/admin/content/admintestimonials/components/index.ts":{"content":"export { TestimonialCard } from \"./TestimonialCard\";\nexport { TestimonialForm } from \"./TestimonialForm\";\n","path":null,"size_bytes":106,"size_tokens":null},"client/src/pages/admin/content/adminservices/types.ts":{"content":"import type { Service } from \"@shared/schema\";\n\nexport interface ServiceFormData {\n  title: string;\n  description: string;\n  icon: string;\n  features: string[];\n  price: string;\n  order: number;\n  active: boolean;\n}\n\nexport const getEmptyServiceForm = (): ServiceFormData => ({\n  title: \"\",\n  description: \"\",\n  icon: \"code\",\n  features: [],\n  price: \"\",\n  order: 0,\n  active: true,\n});\n\nexport const mapServiceToFormData = (service: Service): ServiceFormData => ({\n  title: service.title,\n  description: service.description || \"\",\n  icon: service.icon || \"code\",\n  features: service.features || [],\n  price: service.price || \"\",\n  order: service.order,\n  active: service.active,\n});\n\nexport type { Service };\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/pages/admin/content/adminservices/components/ServiceCard.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Check, Edit, Trash2 } from \"lucide-react\";\nimport type { Service } from \"../types\";\n\ninterface ServiceCardProps {\n  service: Service;\n  onEdit: (service: Service) => void;\n  onDelete: (id: number) => void;\n}\n\nexport function ServiceCard({ service, onEdit, onDelete }: ServiceCardProps) {\n  return (\n    <Card\n      className=\"flex flex-col\"\n      data-testid={`card-service-${service.id}`}\n    >\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex-1\">\n            <CardTitle className=\"text-lg\">{service.title}</CardTitle>\n            {!service.active && (\n              <Badge variant=\"outline\" className=\"mt-2\">\n                Inactive\n              </Badge>\n            )}\n          </div>\n        </div>\n        <div className=\"flex items-baseline gap-1 mt-2\">\n          <span className=\"text-3xl font-bold\">{service.price}</span>\n        </div>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          {service.description}\n        </p>\n      </CardHeader>\n      <CardContent className=\"flex-1 space-y-4\">\n        {service.features && service.features.length > 0 && (\n          <ul className=\"space-y-2\">\n            {service.features.map((feature: string) => (\n              <li key={feature} className=\"flex items-center gap-2 text-sm\">\n                <Check className=\"w-4 h-4 text-green-500\" />\n                {feature}\n              </li>\n            ))}\n          </ul>\n        )}\n        <div className=\"flex gap-2 pt-4\">\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => onEdit(service)}\n            className=\"flex-1\"\n            data-testid={`button-edit-service-${service.id}`}\n          >\n            <Edit className=\"w-4 h-4 mr-1\" /> Edit\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            onClick={() => onDelete(service.id)}\n            data-testid={`button-delete-service-${service.id}`}\n          >\n            <Trash2 className=\"w-4 h-4 text-red-500\" />\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","path":null,"size_bytes":2306,"size_tokens":null},"client/src/pages/admin/content/adminservices/hooks.ts":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { api } from \"@/lib/api\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { ServiceFormData } from \"./types\";\n\nexport function useServices() {\n  return useQuery({\n    queryKey: [\"/api/services\"],\n    queryFn: () => api.getServices(),\n  });\n}\n\nexport function useCreateService(onSuccess?: () => void) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: ServiceFormData) => api.createService(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      toast({ title: \"Success\", description: \"Service created successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n\nexport function useUpdateService(onSuccess?: () => void) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: number; data: ServiceFormData }) =>\n      api.updateService(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      toast({ title: \"Success\", description: \"Service updated successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n\nexport function useDeleteService(onSuccess?: () => void) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: number) => api.deleteService(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/services\"] });\n      toast({ title: \"Success\", description: \"Service deleted successfully\" });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete service\",\n        variant: \"destructive\",\n      });\n    },\n  });\n}\n","path":null,"size_bytes":2216,"size_tokens":null},"client/src/pages/admin/content/adminprojects/components/index.ts":{"content":"export { ProjectCard } from \"./ProjectCard\";\nexport { ProjectForm } from \"./ProjectForm\";\n","path":null,"size_bytes":90,"size_tokens":null}},"version":2}